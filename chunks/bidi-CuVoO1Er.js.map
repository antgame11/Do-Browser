{"version":3,"file":"bidi-CuVoO1Er.js","sources":["../../../../../node_modules/.pnpm/mitt@3.0.1/node_modules/mitt/dist/mitt.mjs","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/EventEmitter.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/log.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/ProcessingQueue.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/protocol/cdp.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/protocol/chromium-bidi.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/protocol/generated/webdriver-bidi.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/protocol/ErrorResponse.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/protocol/generated/webdriver-bidi-permissions.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/protocol/generated/webdriver-bidi-bluetooth.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/protocol/generated/webdriver-bidi-nav-speculation.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/protocol/protocol.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/BidiNoOpParser.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/browser/BrowserProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/cdp/CdpProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/context/BrowsingContextProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/emulation/EmulationProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/assert.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/graphemeTools.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/input/InputSource.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/input/keyUtils.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/input/USKeyboardLayout.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/input/ActionDispatcher.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/Mutex.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/input/InputState.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/input/InputStateManager.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/input/InputProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/base64.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/network/NetworkUtils.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/network/NetworkProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/permissions/PermissionsProcessor.js","../../../__vite-browser-external","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/uuid.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/ChannelProxy.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/PreloadScript.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/ScriptProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/session/SessionProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/storage/StorageProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/webExtension/WebExtensionProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/OutgoingMessage.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/CommandProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/bluetooth/BluetoothProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/browser/ContextConfig.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/browser/ContextConfigStorage.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/browser/UserContextStorage.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/Deferred.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/time.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/unitConversions.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/SharedId.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/Realm.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/WindowRealm.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/urlHelpers.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/context/NavigationTracker.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/context/BrowsingContextImpl.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/WorkerRealm.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/log/logHelper.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/log/LogManager.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/network/CollectorsStorage.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/DefaultMap.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/network/NetworkRequest.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/network/NetworkStorage.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/cdp/CdpTarget.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/cdp/CdpTargetManager.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/context/BrowsingContextStorage.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/PreloadScriptStorage.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/script/RealmStorage.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/Buffer.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/utils/IdWrapper.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/session/events.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/session/SubscriptionManager.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/session/EventManager.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/modules/speculation/SpeculationProcessor.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/BidiServer.js","../../../../../node_modules/.pnpm/chromium-bidi@11.0.0_devtools-protocol@0.0.1521046/node_modules/chromium-bidi/lib/cjs/bidiMapper/BidiMapper.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/CDPSession.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Connection.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/BidiOverCdp.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/core/Navigation.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/core/Realm.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/core/Request.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/core/UserPrompt.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/core/BrowsingContext.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/core/UserContext.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Deserializer.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/JSHandle.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/ElementHandle.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Dialog.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/ExposedFunction.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/HTTPResponse.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/HTTPRequest.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Serializer.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/util.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Realm.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/WebWorker.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Frame.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Input.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Page.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Target.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/BrowserContext.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/core/Browser.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/core/Session.js","../../../../../node_modules/.pnpm/puppeteer-core@24.31.0/node_modules/puppeteer-core/lib/esm/puppeteer/bidi/Browser.js"],"sourcesContent":["export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i?i.push(e):n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&(e?i.splice(i.indexOf(e)>>>0,1):n.set(t,[]))},emit:function(t,e){var i=n.get(t);i&&i.slice().map(function(n){n(e)}),(i=n.get(\"*\"))&&i.slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.mjs.map\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EventEmitter = void 0;\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst mitt_1 = __importDefault(require(\"mitt\"));\nclass EventEmitter {\n    #emitter = (0, mitt_1.default)();\n    on(type, handler) {\n        this.#emitter.on(type, handler);\n        return this;\n    }\n    /**\n     * Like `on` but the listener will only be fired once and then it will be removed.\n     * @param event The event you'd like to listen to\n     * @param handler The handler function to run when the event occurs\n     * @return `this` to enable chaining method calls.\n     */\n    once(event, handler) {\n        const onceHandler = (eventData) => {\n            handler(eventData);\n            this.off(event, onceHandler);\n        };\n        return this.on(event, onceHandler);\n    }\n    off(type, handler) {\n        this.#emitter.off(type, handler);\n        return this;\n    }\n    /**\n     * Emits an event and call any associated listeners.\n     *\n     * @param event The event to emit.\n     * @param eventData Any data to emit with the event.\n     * @return `true` if there are any listeners, `false` otherwise.\n     */\n    emit(event, eventData) {\n        this.#emitter.emit(event, eventData);\n    }\n    /**\n     * Removes all listeners. If given an event argument, it will remove only\n     * listeners for that event.\n     * @param event - the event to remove listeners for.\n     * @returns `this` to enable you to chain method calls.\n     */\n    removeAllListeners(event) {\n        if (event) {\n            this.#emitter.all.delete(event);\n        }\n        else {\n            this.#emitter.all.clear();\n        }\n        return this;\n    }\n}\nexports.EventEmitter = EventEmitter;\n//# sourceMappingURL=EventEmitter.js.map","\"use strict\";\n/**\n * Copyright 2021 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LogType = void 0;\nvar LogType;\n(function (LogType) {\n    // keep-sorted start\n    LogType[\"bidi\"] = \"bidi\";\n    LogType[\"cdp\"] = \"cdp\";\n    LogType[\"debug\"] = \"debug\";\n    LogType[\"debugError\"] = \"debug:error\";\n    LogType[\"debugInfo\"] = \"debug:info\";\n    LogType[\"debugWarn\"] = \"debug:warn\";\n    // keep-sorted end\n})(LogType || (exports.LogType = LogType = {}));\n//# sourceMappingURL=log.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ProcessingQueue = void 0;\nconst log_js_1 = require(\"./log.js\");\nclass ProcessingQueue {\n    static LOGGER_PREFIX = `${log_js_1.LogType.debug}:queue`;\n    #logger;\n    #processor;\n    #queue = [];\n    // Flag to keep only 1 active processor.\n    #isProcessing = false;\n    constructor(processor, logger) {\n        this.#processor = processor;\n        this.#logger = logger;\n    }\n    add(entry, name) {\n        this.#queue.push([entry, name]);\n        // No need in waiting. Just initialize processor if needed.\n        void this.#processIfNeeded();\n    }\n    async #processIfNeeded() {\n        if (this.#isProcessing) {\n            return;\n        }\n        this.#isProcessing = true;\n        while (this.#queue.length > 0) {\n            const arrayEntry = this.#queue.shift();\n            if (!arrayEntry) {\n                continue;\n            }\n            const [entryPromise, name] = arrayEntry;\n            this.#logger?.(_a.LOGGER_PREFIX, 'Processing event:', name);\n            await entryPromise\n                .then((entry) => {\n                if (entry.kind === 'error') {\n                    this.#logger?.(log_js_1.LogType.debugError, 'Event threw before sending:', entry.error.message, entry.error.stack);\n                    return;\n                }\n                return this.#processor(entry.value);\n            })\n                .catch((error) => {\n                this.#logger?.(log_js_1.LogType.debugError, 'Event was not processed:', error?.message);\n            });\n        }\n        this.#isProcessing = false;\n    }\n}\nexports.ProcessingQueue = ProcessingQueue;\n_a = ProcessingQueue;\n//# sourceMappingURL=ProcessingQueue.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=cdp.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EVENT_NAMES = exports.Speculation = exports.Bluetooth = exports.Network = exports.Input = exports.BrowsingContext = exports.Log = exports.Script = exports.BiDiModule = void 0;\n// keep-sorted end\nvar BiDiModule;\n(function (BiDiModule) {\n    // keep-sorted start\n    BiDiModule[\"Bluetooth\"] = \"bluetooth\";\n    BiDiModule[\"Browser\"] = \"browser\";\n    BiDiModule[\"BrowsingContext\"] = \"browsingContext\";\n    BiDiModule[\"Cdp\"] = \"goog:cdp\";\n    BiDiModule[\"Input\"] = \"input\";\n    BiDiModule[\"Log\"] = \"log\";\n    BiDiModule[\"Network\"] = \"network\";\n    BiDiModule[\"Script\"] = \"script\";\n    BiDiModule[\"Session\"] = \"session\";\n    BiDiModule[\"Speculation\"] = \"speculation\";\n    // keep-sorted end\n})(BiDiModule || (exports.BiDiModule = BiDiModule = {}));\nvar Script;\n(function (Script) {\n    let EventNames;\n    (function (EventNames) {\n        // keep-sorted start\n        EventNames[\"Message\"] = \"script.message\";\n        EventNames[\"RealmCreated\"] = \"script.realmCreated\";\n        EventNames[\"RealmDestroyed\"] = \"script.realmDestroyed\";\n        // keep-sorted end\n    })(EventNames = Script.EventNames || (Script.EventNames = {}));\n})(Script || (exports.Script = Script = {}));\nvar Log;\n(function (Log) {\n    let EventNames;\n    (function (EventNames) {\n        EventNames[\"LogEntryAdded\"] = \"log.entryAdded\";\n    })(EventNames = Log.EventNames || (Log.EventNames = {}));\n})(Log || (exports.Log = Log = {}));\nvar BrowsingContext;\n(function (BrowsingContext) {\n    let EventNames;\n    (function (EventNames) {\n        // keep-sorted start\n        EventNames[\"ContextCreated\"] = \"browsingContext.contextCreated\";\n        EventNames[\"ContextDestroyed\"] = \"browsingContext.contextDestroyed\";\n        EventNames[\"DomContentLoaded\"] = \"browsingContext.domContentLoaded\";\n        EventNames[\"DownloadEnd\"] = \"browsingContext.downloadEnd\";\n        EventNames[\"DownloadWillBegin\"] = \"browsingContext.downloadWillBegin\";\n        EventNames[\"FragmentNavigated\"] = \"browsingContext.fragmentNavigated\";\n        EventNames[\"HistoryUpdated\"] = \"browsingContext.historyUpdated\";\n        EventNames[\"Load\"] = \"browsingContext.load\";\n        EventNames[\"NavigationAborted\"] = \"browsingContext.navigationAborted\";\n        EventNames[\"NavigationCommitted\"] = \"browsingContext.navigationCommitted\";\n        EventNames[\"NavigationFailed\"] = \"browsingContext.navigationFailed\";\n        EventNames[\"NavigationStarted\"] = \"browsingContext.navigationStarted\";\n        EventNames[\"UserPromptClosed\"] = \"browsingContext.userPromptClosed\";\n        EventNames[\"UserPromptOpened\"] = \"browsingContext.userPromptOpened\";\n        // keep-sorted end\n    })(EventNames = BrowsingContext.EventNames || (BrowsingContext.EventNames = {}));\n})(BrowsingContext || (exports.BrowsingContext = BrowsingContext = {}));\nvar Input;\n(function (Input) {\n    let EventNames;\n    (function (EventNames) {\n        // keep-sorted start\n        EventNames[\"FileDialogOpened\"] = \"input.fileDialogOpened\";\n        // keep-sorted end\n    })(EventNames = Input.EventNames || (Input.EventNames = {}));\n})(Input || (exports.Input = Input = {}));\nvar Network;\n(function (Network) {\n    let EventNames;\n    (function (EventNames) {\n        // keep-sorted start\n        EventNames[\"AuthRequired\"] = \"network.authRequired\";\n        EventNames[\"BeforeRequestSent\"] = \"network.beforeRequestSent\";\n        EventNames[\"FetchError\"] = \"network.fetchError\";\n        EventNames[\"ResponseCompleted\"] = \"network.responseCompleted\";\n        EventNames[\"ResponseStarted\"] = \"network.responseStarted\";\n        // keep-sorted end\n    })(EventNames = Network.EventNames || (Network.EventNames = {}));\n})(Network || (exports.Network = Network = {}));\nvar Bluetooth;\n(function (Bluetooth) {\n    let EventNames;\n    (function (EventNames) {\n        EventNames[\"RequestDevicePromptUpdated\"] = \"bluetooth.requestDevicePromptUpdated\";\n        EventNames[\"GattConnectionAttempted\"] = \"bluetooth.gattConnectionAttempted\";\n        EventNames[\"CharacteristicEventGenerated\"] = \"bluetooth.characteristicEventGenerated\";\n        EventNames[\"DescriptorEventGenerated\"] = \"bluetooth.descriptorEventGenerated\";\n    })(EventNames = Bluetooth.EventNames || (Bluetooth.EventNames = {}));\n})(Bluetooth || (exports.Bluetooth = Bluetooth = {}));\nvar Speculation;\n(function (Speculation) {\n    let EventNames;\n    (function (EventNames) {\n        EventNames[\"PrefetchStatusUpdated\"] = \"speculation.prefetchStatusUpdated\";\n    })(EventNames = Speculation.EventNames || (Speculation.EventNames = {}));\n})(Speculation || (exports.Speculation = Speculation = {}));\nexports.EVENT_NAMES = new Set([\n    // keep-sorted start\n    ...Object.values(BiDiModule),\n    ...Object.values(Bluetooth.EventNames),\n    ...Object.values(BrowsingContext.EventNames),\n    ...Object.values(Input.EventNames),\n    ...Object.values(Log.EventNames),\n    ...Object.values(Network.EventNames),\n    ...Object.values(Script.EventNames),\n    ...Object.values(Speculation.EventNames),\n    // keep-sorted end\n]);\n//# sourceMappingURL=chromium-bidi.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=webdriver-bidi.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UnavailableNetworkDataException = exports.NoSuchNetworkDataException = exports.NoSuchNetworkCollectorException = exports.NoSuchWebExtensionException = exports.InvalidWebExtensionException = exports.UnderspecifiedStoragePartitionException = exports.UnableToSetFileInputException = exports.UnableToSetCookieException = exports.NoSuchStoragePartitionException = exports.UnsupportedOperationException = exports.UnableToCloseBrowserException = exports.UnableToCaptureScreenException = exports.UnknownErrorException = exports.UnknownCommandException = exports.SessionNotCreatedException = exports.NoSuchUserContextException = exports.NoSuchScriptException = exports.NoSuchRequestException = exports.NoSuchNodeException = exports.NoSuchInterceptException = exports.NoSuchHistoryEntryException = exports.NoSuchHandleException = exports.NoSuchFrameException = exports.NoSuchElementException = exports.NoSuchAlertException = exports.MoveTargetOutOfBoundsException = exports.InvalidSessionIdException = exports.InvalidSelectorException = exports.InvalidArgumentException = exports.Exception = void 0;\nclass Exception extends Error {\n    error;\n    message;\n    stacktrace;\n    constructor(error, message, stacktrace) {\n        super();\n        this.error = error;\n        this.message = message;\n        this.stacktrace = stacktrace;\n    }\n    toErrorResponse(commandId) {\n        return {\n            type: 'error',\n            id: commandId,\n            error: this.error,\n            message: this.message,\n            stacktrace: this.stacktrace,\n        };\n    }\n}\nexports.Exception = Exception;\nclass InvalidArgumentException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"invalid argument\" /* ErrorCode.InvalidArgument */, message, stacktrace);\n    }\n}\nexports.InvalidArgumentException = InvalidArgumentException;\nclass InvalidSelectorException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"invalid selector\" /* ErrorCode.InvalidSelector */, message, stacktrace);\n    }\n}\nexports.InvalidSelectorException = InvalidSelectorException;\nclass InvalidSessionIdException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"invalid session id\" /* ErrorCode.InvalidSessionId */, message, stacktrace);\n    }\n}\nexports.InvalidSessionIdException = InvalidSessionIdException;\nclass MoveTargetOutOfBoundsException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"move target out of bounds\" /* ErrorCode.MoveTargetOutOfBounds */, message, stacktrace);\n    }\n}\nexports.MoveTargetOutOfBoundsException = MoveTargetOutOfBoundsException;\nclass NoSuchAlertException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such alert\" /* ErrorCode.NoSuchAlert */, message, stacktrace);\n    }\n}\nexports.NoSuchAlertException = NoSuchAlertException;\nclass NoSuchElementException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such element\" /* ErrorCode.NoSuchElement */, message, stacktrace);\n    }\n}\nexports.NoSuchElementException = NoSuchElementException;\nclass NoSuchFrameException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such frame\" /* ErrorCode.NoSuchFrame */, message, stacktrace);\n    }\n}\nexports.NoSuchFrameException = NoSuchFrameException;\nclass NoSuchHandleException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such handle\" /* ErrorCode.NoSuchHandle */, message, stacktrace);\n    }\n}\nexports.NoSuchHandleException = NoSuchHandleException;\nclass NoSuchHistoryEntryException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such history entry\" /* ErrorCode.NoSuchHistoryEntry */, message, stacktrace);\n    }\n}\nexports.NoSuchHistoryEntryException = NoSuchHistoryEntryException;\nclass NoSuchInterceptException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such intercept\" /* ErrorCode.NoSuchIntercept */, message, stacktrace);\n    }\n}\nexports.NoSuchInterceptException = NoSuchInterceptException;\nclass NoSuchNodeException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such node\" /* ErrorCode.NoSuchNode */, message, stacktrace);\n    }\n}\nexports.NoSuchNodeException = NoSuchNodeException;\nclass NoSuchRequestException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such request\" /* ErrorCode.NoSuchRequest */, message, stacktrace);\n    }\n}\nexports.NoSuchRequestException = NoSuchRequestException;\nclass NoSuchScriptException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such script\" /* ErrorCode.NoSuchScript */, message, stacktrace);\n    }\n}\nexports.NoSuchScriptException = NoSuchScriptException;\nclass NoSuchUserContextException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such user context\" /* ErrorCode.NoSuchUserContext */, message, stacktrace);\n    }\n}\nexports.NoSuchUserContextException = NoSuchUserContextException;\nclass SessionNotCreatedException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"session not created\" /* ErrorCode.SessionNotCreated */, message, stacktrace);\n    }\n}\nexports.SessionNotCreatedException = SessionNotCreatedException;\nclass UnknownCommandException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"unknown command\" /* ErrorCode.UnknownCommand */, message, stacktrace);\n    }\n}\nexports.UnknownCommandException = UnknownCommandException;\nclass UnknownErrorException extends Exception {\n    constructor(message, stacktrace = new Error().stack) {\n        super(\"unknown error\" /* ErrorCode.UnknownError */, message, stacktrace);\n    }\n}\nexports.UnknownErrorException = UnknownErrorException;\nclass UnableToCaptureScreenException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"unable to capture screen\" /* ErrorCode.UnableToCaptureScreen */, message, stacktrace);\n    }\n}\nexports.UnableToCaptureScreenException = UnableToCaptureScreenException;\nclass UnableToCloseBrowserException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"unable to close browser\" /* ErrorCode.UnableToCloseBrowser */, message, stacktrace);\n    }\n}\nexports.UnableToCloseBrowserException = UnableToCloseBrowserException;\nclass UnsupportedOperationException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"unsupported operation\" /* ErrorCode.UnsupportedOperation */, message, stacktrace);\n    }\n}\nexports.UnsupportedOperationException = UnsupportedOperationException;\nclass NoSuchStoragePartitionException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such storage partition\" /* ErrorCode.NoSuchStoragePartition */, message, stacktrace);\n    }\n}\nexports.NoSuchStoragePartitionException = NoSuchStoragePartitionException;\nclass UnableToSetCookieException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"unable to set cookie\" /* ErrorCode.UnableToSetCookie */, message, stacktrace);\n    }\n}\nexports.UnableToSetCookieException = UnableToSetCookieException;\nclass UnableToSetFileInputException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"unable to set file input\" /* ErrorCode.UnableToSetFileInput */, message, stacktrace);\n    }\n}\nexports.UnableToSetFileInputException = UnableToSetFileInputException;\nclass UnderspecifiedStoragePartitionException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"underspecified storage partition\" /* ErrorCode.UnderspecifiedStoragePartition */, message, stacktrace);\n    }\n}\nexports.UnderspecifiedStoragePartitionException = UnderspecifiedStoragePartitionException;\nclass InvalidWebExtensionException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"invalid web extension\" /* ErrorCode.InvalidWebExtension */, message, stacktrace);\n    }\n}\nexports.InvalidWebExtensionException = InvalidWebExtensionException;\nclass NoSuchWebExtensionException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such web extension\" /* ErrorCode.NoSuchWebExtension */, message, stacktrace);\n    }\n}\nexports.NoSuchWebExtensionException = NoSuchWebExtensionException;\nclass NoSuchNetworkCollectorException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such network collector\" /* ErrorCode.NoSuchNetworkCollector */, message, stacktrace);\n    }\n}\nexports.NoSuchNetworkCollectorException = NoSuchNetworkCollectorException;\nclass NoSuchNetworkDataException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"no such network data\" /* ErrorCode.NoSuchNetworkData */, message, stacktrace);\n    }\n}\nexports.NoSuchNetworkDataException = NoSuchNetworkDataException;\nclass UnavailableNetworkDataException extends Exception {\n    constructor(message, stacktrace) {\n        super(\"unavailable network data\" /* ErrorCode.UnavailableNetworkData */, message, stacktrace);\n    }\n}\nexports.UnavailableNetworkDataException = UnavailableNetworkDataException;\n//# sourceMappingURL=ErrorResponse.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=webdriver-bidi-permissions.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=webdriver-bidi-bluetooth.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=webdriver-bidi-nav-speculation.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ChromiumBidi = exports.Cdp = void 0;\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexports.Cdp = __importStar(require(\"./cdp.js\"));\nexports.ChromiumBidi = __importStar(require(\"./chromium-bidi.js\"));\n__exportStar(require(\"./generated/webdriver-bidi.js\"), exports);\n__exportStar(require(\"./ErrorResponse.js\"), exports);\n__exportStar(require(\"./generated/webdriver-bidi-permissions.js\"), exports);\n__exportStar(require(\"./generated/webdriver-bidi-bluetooth.js\"), exports);\n__exportStar(require(\"./generated/webdriver-bidi-nav-speculation.js\"), exports);\n//# sourceMappingURL=protocol.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BidiNoOpParser = void 0;\nclass BidiNoOpParser {\n    // Bluetooth module\n    // keep-sorted start block=yes\n    parseDisableSimulationParameters(params) {\n        return params;\n    }\n    parseHandleRequestDevicePromptParams(params) {\n        return params;\n    }\n    parseSimulateAdapterParameters(params) {\n        return params;\n    }\n    parseSimulateAdvertisementParameters(params) {\n        return params;\n    }\n    parseSimulateCharacteristicParameters(params) {\n        return params;\n    }\n    parseSimulateCharacteristicResponseParameters(params) {\n        return params;\n    }\n    parseSimulateDescriptorParameters(params) {\n        return params;\n    }\n    parseSimulateDescriptorResponseParameters(params) {\n        return params;\n    }\n    parseSimulateGattConnectionResponseParameters(params) {\n        return params;\n    }\n    parseSimulateGattDisconnectionParameters(params) {\n        return params;\n    }\n    parseSimulatePreconnectedPeripheralParameters(params) {\n        return params;\n    }\n    parseSimulateServiceParameters(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Browser module\n    // keep-sorted start block=yes\n    parseCreateUserContextParameters(params) {\n        return params;\n    }\n    parseRemoveUserContextParameters(params) {\n        return params;\n    }\n    parseSetClientWindowStateParameters(params) {\n        return params;\n    }\n    parseSetDownloadBehaviorParameters(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Browsing Context module\n    // keep-sorted start block=yes\n    parseActivateParams(params) {\n        return params;\n    }\n    parseCaptureScreenshotParams(params) {\n        return params;\n    }\n    parseCloseParams(params) {\n        return params;\n    }\n    parseCreateParams(params) {\n        return params;\n    }\n    parseGetTreeParams(params) {\n        return params;\n    }\n    parseHandleUserPromptParams(params) {\n        return params;\n    }\n    parseLocateNodesParams(params) {\n        return params;\n    }\n    parseNavigateParams(params) {\n        return params;\n    }\n    parsePrintParams(params) {\n        return params;\n    }\n    parseReloadParams(params) {\n        return params;\n    }\n    parseSetViewportParams(params) {\n        return params;\n    }\n    parseTraverseHistoryParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // CDP module\n    // keep-sorted start block=yes\n    parseGetSessionParams(params) {\n        return params;\n    }\n    parseResolveRealmParams(params) {\n        return params;\n    }\n    parseSendCommandParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Emulation module\n    // keep-sorted start block=yes\n    parseSetForcedColorsModeThemeOverrideParams(params) {\n        return params;\n    }\n    parseSetGeolocationOverrideParams(params) {\n        return params;\n    }\n    parseSetLocaleOverrideParams(params) {\n        return params;\n    }\n    parseSetNetworkConditionsParams(params) {\n        return params;\n    }\n    parseSetScreenOrientationOverrideParams(params) {\n        return params;\n    }\n    parseSetScriptingEnabledParams(params) {\n        return params;\n    }\n    parseSetTimezoneOverrideParams(params) {\n        return params;\n    }\n    parseSetUserAgentOverrideParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Script module\n    // keep-sorted start block=yes\n    parseAddPreloadScriptParams(params) {\n        return params;\n    }\n    parseCallFunctionParams(params) {\n        return params;\n    }\n    parseDisownParams(params) {\n        return params;\n    }\n    parseEvaluateParams(params) {\n        return params;\n    }\n    parseGetRealmsParams(params) {\n        return params;\n    }\n    parseRemovePreloadScriptParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Input module\n    // keep-sorted start block=yes\n    parsePerformActionsParams(params) {\n        return params;\n    }\n    parseReleaseActionsParams(params) {\n        return params;\n    }\n    parseSetFilesParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Network module\n    // keep-sorted start block=yes\n    parseAddDataCollectorParams(params) {\n        return params;\n    }\n    parseAddInterceptParams(params) {\n        return params;\n    }\n    parseContinueRequestParams(params) {\n        return params;\n    }\n    parseContinueResponseParams(params) {\n        return params;\n    }\n    parseContinueWithAuthParams(params) {\n        return params;\n    }\n    parseDisownDataParams(params) {\n        return params;\n    }\n    parseFailRequestParams(params) {\n        return params;\n    }\n    parseGetDataParams(params) {\n        return params;\n    }\n    parseProvideResponseParams(params) {\n        return params;\n    }\n    parseRemoveDataCollectorParams(params) {\n        return params;\n    }\n    parseRemoveInterceptParams(params) {\n        return params;\n    }\n    parseSetCacheBehaviorParams(params) {\n        return params;\n    }\n    parseSetExtraHeadersParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Permissions module\n    // keep-sorted start block=yes\n    parseSetPermissionsParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Session module\n    // keep-sorted start block=yes\n    parseSubscribeParams(params) {\n        return params;\n    }\n    parseUnsubscribeParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // Storage module\n    // keep-sorted start block=yes\n    parseDeleteCookiesParams(params) {\n        return params;\n    }\n    parseGetCookiesParams(params) {\n        return params;\n    }\n    parseSetCookieParams(params) {\n        return params;\n    }\n    // keep-sorted end\n    // WebExtenstion module\n    // keep-sorted start block=yes\n    parseInstallParams(params) {\n        return params;\n    }\n    parseUninstallParams(params) {\n        return params;\n    }\n}\nexports.BidiNoOpParser = BidiNoOpParser;\n//# sourceMappingURL=BidiNoOpParser.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BrowserProcessor = void 0;\nexports.getProxyStr = getProxyStr;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nclass BrowserProcessor {\n    #browserCdpClient;\n    #browsingContextStorage;\n    #configStorage;\n    #userContextStorage;\n    constructor(browserCdpClient, browsingContextStorage, configStorage, userContextStorage) {\n        this.#browserCdpClient = browserCdpClient;\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#configStorage = configStorage;\n        this.#userContextStorage = userContextStorage;\n    }\n    close() {\n        // Ensure that it is put at the end of the event loop.\n        // This way we send back the response before closing the tab.\n        setTimeout(() => this.#browserCdpClient.sendCommand('Browser.close'), 0);\n        return {};\n    }\n    async createUserContext(params) {\n        // `params` is a record to provide legacy `goog:` parameters. Now as the `proxy`\n        // parameter is specified, we should get rid of `goog:proxyServer` and\n        // `goog:proxyBypassList` and make the params of type\n        // `Browser.CreateUserContextParameters`.\n        const w3cParams = params;\n        const globalConfig = this.#configStorage.getGlobalConfig();\n        if (w3cParams.acceptInsecureCerts !== undefined) {\n            if (w3cParams.acceptInsecureCerts === false &&\n                globalConfig.acceptInsecureCerts === true)\n                // TODO: https://github.com/GoogleChromeLabs/chromium-bidi/issues/3398\n                throw new protocol_js_1.UnknownErrorException(`Cannot set user context's \"acceptInsecureCerts\" to false, when a capability \"acceptInsecureCerts\" is set to true`);\n        }\n        const request = {};\n        if (w3cParams.proxy) {\n            const proxyStr = getProxyStr(w3cParams.proxy);\n            if (proxyStr) {\n                request.proxyServer = proxyStr;\n            }\n            if (w3cParams.proxy.noProxy) {\n                request.proxyBypassList = w3cParams.proxy.noProxy.join(',');\n            }\n        }\n        else {\n            // TODO: remove after Puppeteer stops using it.\n            if (params['goog:proxyServer'] !== undefined) {\n                request.proxyServer = params['goog:proxyServer'];\n            }\n            const proxyBypassList = params['goog:proxyBypassList'] ?? undefined;\n            if (proxyBypassList) {\n                request.proxyBypassList = proxyBypassList.join(',');\n            }\n        }\n        const context = await this.#browserCdpClient.sendCommand('Target.createBrowserContext', request);\n        await this.#applyDownloadBehavior(globalConfig.downloadBehavior ?? null, context.browserContextId);\n        this.#configStorage.updateUserContextConfig(context.browserContextId, {\n            acceptInsecureCerts: params['acceptInsecureCerts'],\n            userPromptHandler: params['unhandledPromptBehavior'],\n        });\n        return {\n            userContext: context.browserContextId,\n        };\n    }\n    async removeUserContext(params) {\n        const userContext = params.userContext;\n        if (userContext === 'default') {\n            throw new protocol_js_1.InvalidArgumentException('`default` user context cannot be removed');\n        }\n        try {\n            await this.#browserCdpClient.sendCommand('Target.disposeBrowserContext', {\n                browserContextId: userContext,\n            });\n        }\n        catch (err) {\n            // https://source.chromium.org/chromium/chromium/src/+/main:content/browser/devtools/protocol/target_handler.cc;l=1424;drc=c686e8f4fd379312469fe018f5c390e9c8f20d0d\n            if (err.message.startsWith('Failed to find context with id')) {\n                throw new protocol_js_1.NoSuchUserContextException(err.message);\n            }\n            throw err;\n        }\n        return {};\n    }\n    async getUserContexts() {\n        return {\n            userContexts: await this.#userContextStorage.getUserContexts(),\n        };\n    }\n    async #getWindowInfo(targetId) {\n        const windowInfo = await this.#browserCdpClient.sendCommand('Browser.getWindowForTarget', { targetId });\n        return {\n            // `active` is not supported in CDP yet.\n            active: false,\n            clientWindow: `${windowInfo.windowId}`,\n            state: windowInfo.bounds.windowState ?? 'normal',\n            height: windowInfo.bounds.height ?? 0,\n            width: windowInfo.bounds.width ?? 0,\n            x: windowInfo.bounds.left ?? 0,\n            y: windowInfo.bounds.top ?? 0,\n        };\n    }\n    async getClientWindows() {\n        const topLevelTargetIds = this.#browsingContextStorage\n            .getTopLevelContexts()\n            .map((b) => b.cdpTarget.id);\n        const clientWindows = await Promise.all(topLevelTargetIds.map(async (targetId) => await this.#getWindowInfo(targetId)));\n        const uniqueClientWindowIds = new Set();\n        const uniqueClientWindows = new Array();\n        // Filter out duplicated client windows.\n        for (const window of clientWindows) {\n            if (!uniqueClientWindowIds.has(window.clientWindow)) {\n                uniqueClientWindowIds.add(window.clientWindow);\n                uniqueClientWindows.push(window);\n            }\n        }\n        return { clientWindows: uniqueClientWindows };\n    }\n    #toCdpDownloadBehavior(downloadBehavior) {\n        if (downloadBehavior === null)\n            // CDP \"default\" behavior.\n            return {\n                behavior: 'default',\n            };\n        if (downloadBehavior?.type === 'denied')\n            // Deny all the downloads.\n            return {\n                behavior: 'deny',\n            };\n        if (downloadBehavior?.type === 'allowed') {\n            // CDP behavior \"allow\" means \"save downloaded files to the specific download path\".\n            return {\n                behavior: 'allow',\n                downloadPath: downloadBehavior.destinationFolder,\n            };\n        }\n        // Unreachable. Handled by params parser.\n        throw new protocol_js_1.UnknownErrorException('Unexpected download behavior');\n    }\n    async #applyDownloadBehavior(downloadBehavior, userContext) {\n        await this.#browserCdpClient.sendCommand('Browser.setDownloadBehavior', {\n            ...this.#toCdpDownloadBehavior(downloadBehavior),\n            browserContextId: userContext === 'default' ? undefined : userContext,\n            // Required for enabling download events.\n            eventsEnabled: true,\n        });\n    }\n    async setDownloadBehavior(params) {\n        let userContexts;\n        if (params.userContexts === undefined) {\n            // Global download behavior.\n            userContexts = (await this.#userContextStorage.getUserContexts()).map((c) => c.userContext);\n        }\n        else {\n            // Download behavior for the specific user contexts.\n            userContexts = Array.from(await this.#userContextStorage.verifyUserContextIdList(params.userContexts));\n        }\n        if (params.userContexts === undefined) {\n            // Store the global setting to be applied for the future user contexts.\n            this.#configStorage.updateGlobalConfig({\n                downloadBehavior: params.downloadBehavior,\n            });\n        }\n        else {\n            params.userContexts.map((userContext) => this.#configStorage.updateUserContextConfig(userContext, {\n                downloadBehavior: params.downloadBehavior,\n            }));\n        }\n        await Promise.all(userContexts.map(async (userContext) => {\n            // Download behavior can be already set per user context, in which case the global\n            // one should not be applied.\n            const downloadBehavior = this.#configStorage.getActiveConfig(undefined, userContext)\n                .downloadBehavior ?? null;\n            await this.#applyDownloadBehavior(downloadBehavior, userContext);\n        }));\n        return {};\n    }\n}\nexports.BrowserProcessor = BrowserProcessor;\n/**\n * Proxy config parse implementation:\n * https://source.chromium.org/chromium/chromium/src/+/main:net/proxy_resolution/proxy_config.h;drc=743a82d08e59d803c94ee1b8564b8b11dd7b462f;l=107\n */\nfunction getProxyStr(proxyConfig) {\n    if (proxyConfig.proxyType === 'direct' ||\n        proxyConfig.proxyType === 'system') {\n        // These types imply that Chrome should use its default behavior (e.g., direct\n        // connection or system-configured proxy). No specific `proxyServer` string is\n        // needed.\n        return undefined;\n    }\n    if (proxyConfig.proxyType === 'pac') {\n        throw new protocol_js_1.UnsupportedOperationException(`PAC proxy configuration is not supported per user context`);\n    }\n    if (proxyConfig.proxyType === 'autodetect') {\n        throw new protocol_js_1.UnsupportedOperationException(`Autodetect proxy is not supported per user context`);\n    }\n    if (proxyConfig.proxyType === 'manual') {\n        const servers = [];\n        // HTTP Proxy\n        if (proxyConfig.httpProxy !== undefined) {\n            // servers.push(proxyConfig.httpProxy);\n            servers.push(`http=${proxyConfig.httpProxy}`);\n        }\n        // SSL Proxy (uses 'https' scheme)\n        if (proxyConfig.sslProxy !== undefined) {\n            // servers.push(proxyConfig.sslProxy);\n            servers.push(`https=${proxyConfig.sslProxy}`);\n        }\n        // SOCKS Proxy\n        if (proxyConfig.socksProxy !== undefined ||\n            proxyConfig.socksVersion !== undefined) {\n            // socksVersion is mandatory and must be a valid integer if socksProxy is\n            // specified.\n            if (proxyConfig.socksProxy === undefined) {\n                throw new protocol_js_1.InvalidArgumentException(`'socksVersion' cannot be set without 'socksProxy'`);\n            }\n            if (proxyConfig.socksVersion === undefined ||\n                typeof proxyConfig.socksVersion !== 'number' ||\n                !Number.isInteger(proxyConfig.socksVersion) ||\n                proxyConfig.socksVersion < 0 ||\n                proxyConfig.socksVersion > 255) {\n                throw new protocol_js_1.InvalidArgumentException(`'socksVersion' must be between 0 and 255`);\n            }\n            servers.push(`socks=socks${proxyConfig.socksVersion}://${proxyConfig.socksProxy}`);\n        }\n        if (servers.length === 0) {\n            // If 'manual' proxyType is chosen but no specific proxy servers (http, ssl, socks)\n            // are provided, it means no proxy server should be configured.\n            return undefined;\n        }\n        return servers.join(';');\n    }\n    // Unreachable.\n    throw new protocol_js_1.UnknownErrorException(`Unknown proxy type`);\n}\n//# sourceMappingURL=BrowserProcessor.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CdpProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nclass CdpProcessor {\n    #browsingContextStorage;\n    #realmStorage;\n    #cdpConnection;\n    #browserCdpClient;\n    constructor(browsingContextStorage, realmStorage, cdpConnection, browserCdpClient) {\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#realmStorage = realmStorage;\n        this.#cdpConnection = cdpConnection;\n        this.#browserCdpClient = browserCdpClient;\n    }\n    getSession(params) {\n        const context = params.context;\n        const sessionId = this.#browsingContextStorage.getContext(context).cdpTarget.cdpSessionId;\n        if (sessionId === undefined) {\n            return {};\n        }\n        return { session: sessionId };\n    }\n    resolveRealm(params) {\n        const context = params.realm;\n        const realm = this.#realmStorage.getRealm({ realmId: context });\n        if (realm === undefined) {\n            throw new protocol_js_1.UnknownErrorException(`Could not find realm ${params.realm}`);\n        }\n        return { executionContextId: realm.executionContextId };\n    }\n    async sendCommand(params) {\n        const client = params.session\n            ? this.#cdpConnection.getCdpClient(params.session)\n            : this.#browserCdpClient;\n        const result = await client.sendCommand(params.method, params.params);\n        return {\n            result,\n            session: params.session,\n        };\n    }\n}\nexports.CdpProcessor = CdpProcessor;\n//# sourceMappingURL=CdpProcessor.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BrowsingContextProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nclass BrowsingContextProcessor {\n    #browserCdpClient;\n    #browsingContextStorage;\n    #contextConfigStorage;\n    #eventManager;\n    #userContextStorage;\n    constructor(browserCdpClient, browsingContextStorage, userContextStorage, contextConfigStorage, eventManager) {\n        this.#contextConfigStorage = contextConfigStorage;\n        this.#userContextStorage = userContextStorage;\n        this.#browserCdpClient = browserCdpClient;\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#eventManager = eventManager;\n        this.#eventManager.addSubscribeHook(protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.ContextCreated, this.#onContextCreatedSubscribeHook.bind(this));\n    }\n    getTree(params) {\n        const resultContexts = params.root === undefined\n            ? this.#browsingContextStorage.getTopLevelContexts()\n            : [this.#browsingContextStorage.getContext(params.root)];\n        return {\n            contexts: resultContexts.map((c) => c.serializeToBidiValue(params.maxDepth ?? Number.MAX_VALUE)),\n        };\n    }\n    async create(params) {\n        let referenceContext;\n        let userContext = 'default';\n        if (params.referenceContext !== undefined) {\n            referenceContext = this.#browsingContextStorage.getContext(params.referenceContext);\n            if (!referenceContext.isTopLevelContext()) {\n                throw new protocol_js_1.InvalidArgumentException(`referenceContext should be a top-level context`);\n            }\n            userContext = referenceContext.userContext;\n        }\n        if (params.userContext !== undefined) {\n            userContext = params.userContext;\n        }\n        const existingContexts = this.#browsingContextStorage\n            .getAllContexts()\n            .filter((context) => context.userContext === userContext);\n        let newWindow = false;\n        switch (params.type) {\n            case \"tab\" /* BrowsingContext.CreateType.Tab */:\n                newWindow = false;\n                break;\n            case \"window\" /* BrowsingContext.CreateType.Window */:\n                newWindow = true;\n                break;\n        }\n        if (!existingContexts.length) {\n            // If there are no contexts in the given user context, we need to set\n            // newWindow to true as newWindow=false will be rejected.\n            newWindow = true;\n        }\n        let result;\n        try {\n            result = await this.#browserCdpClient.sendCommand('Target.createTarget', {\n                url: 'about:blank',\n                newWindow,\n                browserContextId: userContext === 'default' ? undefined : userContext,\n                background: params.background === true,\n            });\n        }\n        catch (err) {\n            if (\n            // See https://source.chromium.org/chromium/chromium/src/+/main:chrome/browser/devtools/protocol/target_handler.cc;l=90;drc=e80392ac11e48a691f4309964cab83a3a59e01c8\n            err.message.startsWith('Failed to find browser context with id') ||\n                // See https://source.chromium.org/chromium/chromium/src/+/main:headless/lib/browser/protocol/target_handler.cc;l=49;drc=e80392ac11e48a691f4309964cab83a3a59e01c8\n                err.message === 'browserContextId') {\n                throw new protocol_js_1.NoSuchUserContextException(`The context ${userContext} was not found`);\n            }\n            throw err;\n        }\n        // Wait for the new target to be attached and to be added to the browsing context\n        // storage.\n        const context = await this.#browsingContextStorage.waitForContext(result.targetId);\n        // Wait for the new tab to be loaded to avoid race conditions in the\n        // `browsingContext` events, when the `browsingContext.domContentLoaded` and\n        // `browsingContext.load` events from the initial `about:blank` navigation\n        // are emitted after the next navigation is started.\n        // Details: https://github.com/web-platform-tests/wpt/issues/35846\n        await context.lifecycleLoaded();\n        return { context: context.id };\n    }\n    navigate(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        return context.navigate(params.url, params.wait ?? \"none\" /* BrowsingContext.ReadinessState.None */);\n    }\n    reload(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        return context.reload(params.ignoreCache ?? false, params.wait ?? \"none\" /* BrowsingContext.ReadinessState.None */);\n    }\n    async activate(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        if (!context.isTopLevelContext()) {\n            throw new protocol_js_1.InvalidArgumentException('Activation is only supported on the top-level context');\n        }\n        await context.activate();\n        return {};\n    }\n    async captureScreenshot(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        return await context.captureScreenshot(params);\n    }\n    async print(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        return await context.print(params);\n    }\n    async setViewport(params) {\n        // Check the The viewport size limits is not checked by protocol parser, so we need to validate\n        // it manually:\n        // https://crsrc.org/c/content/browser/devtools/protocol/emulation_handler.cc;drc=f49e23d8e2bd190b42ec62284b8be10dcccd0446;l=660\n        const maxDimensionSize = 10_000_000;\n        if ((params.viewport?.height ?? 0) > maxDimensionSize ||\n            (params.viewport?.width ?? 0) > maxDimensionSize) {\n            throw new protocol_js_1.UnsupportedOperationException(`Viewport dimension over ${maxDimensionSize} are not supported`);\n        }\n        const config = {};\n        // `undefined` means no changes should be done to the config.\n        if (params.devicePixelRatio !== undefined) {\n            config.devicePixelRatio = params.devicePixelRatio;\n        }\n        if (params.viewport !== undefined) {\n            config.viewport = params.viewport;\n        }\n        const impactedTopLevelContexts = await this.#getRelatedTopLevelBrowsingContexts(params.context, params.userContexts);\n        for (const userContextId of params.userContexts ?? []) {\n            this.#contextConfigStorage.updateUserContextConfig(userContextId, config);\n        }\n        if (params.context !== undefined) {\n            this.#contextConfigStorage.updateBrowsingContextConfig(params.context, config);\n        }\n        await Promise.all(impactedTopLevelContexts.map(async (context) => {\n            const config = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext);\n            await context.setViewport(config.viewport ?? null, config.devicePixelRatio ?? null, config.screenOrientation ?? null);\n        }));\n        return {};\n    }\n    /**\n     * Returns a list of top-level browsing context ids.\n     */\n    async #getRelatedTopLevelBrowsingContexts(browsingContextId, userContextIds) {\n        if (browsingContextId === undefined && userContextIds === undefined) {\n            throw new protocol_js_1.InvalidArgumentException('Either userContexts or context must be provided');\n        }\n        if (browsingContextId !== undefined && userContextIds !== undefined) {\n            throw new protocol_js_1.InvalidArgumentException('userContexts and context are mutually exclusive');\n        }\n        if (browsingContextId !== undefined) {\n            const context = this.#browsingContextStorage.getContext(browsingContextId);\n            if (!context.isTopLevelContext()) {\n                throw new protocol_js_1.InvalidArgumentException('Emulating viewport is only supported on the top-level context');\n            }\n            return [context];\n        }\n        // Verify that all user contexts exist.\n        await this.#userContextStorage.verifyUserContextIdList(userContextIds);\n        const result = [];\n        for (const userContextId of userContextIds) {\n            const topLevelBrowsingContexts = this.#browsingContextStorage\n                .getTopLevelContexts()\n                .filter((browsingContext) => browsingContext.userContext === userContextId);\n            result.push(...topLevelBrowsingContexts);\n        }\n        // Remove duplicates. Compare `BrowsingContextImpl` by reference is correct here, as\n        // `browsingContextStorage` returns the same instance for the same id.\n        return [...new Set(result).values()];\n    }\n    async traverseHistory(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        if (!context) {\n            throw new protocol_js_1.InvalidArgumentException(`No browsing context with id ${params.context}`);\n        }\n        if (!context.isTopLevelContext()) {\n            throw new protocol_js_1.InvalidArgumentException('Traversing history is only supported on the top-level context');\n        }\n        await context.traverseHistory(params.delta);\n        return {};\n    }\n    async handleUserPrompt(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        try {\n            await context.handleUserPrompt(params.accept, params.userText);\n        }\n        catch (error) {\n            // Heuristically determine the error\n            // https://source.chromium.org/chromium/chromium/src/+/main:content/browser/devtools/protocol/page_handler.cc;l=1085?q=%22No%20dialog%20is%20showing%22&ss=chromium\n            if (error.message?.includes('No dialog is showing')) {\n                throw new protocol_js_1.NoSuchAlertException('No dialog is showing');\n            }\n            throw error;\n        }\n        return {};\n    }\n    async close(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        if (!context.isTopLevelContext()) {\n            throw new protocol_js_1.InvalidArgumentException(`Non top-level browsing context ${context.id} cannot be closed.`);\n        }\n        // Parent session of a page target session can be a `browser` or a `tab` session.\n        const parentCdpClient = context.cdpTarget.parentCdpClient;\n        try {\n            const detachedFromTargetPromise = new Promise((resolve) => {\n                const onContextDestroyed = (event) => {\n                    if (event.targetId === params.context) {\n                        parentCdpClient.off('Target.detachedFromTarget', onContextDestroyed);\n                        resolve();\n                    }\n                };\n                parentCdpClient.on('Target.detachedFromTarget', onContextDestroyed);\n            });\n            try {\n                if (params.promptUnload) {\n                    await context.close();\n                }\n                else {\n                    await parentCdpClient.sendCommand('Target.closeTarget', {\n                        targetId: params.context,\n                    });\n                }\n            }\n            catch (error) {\n                // Swallow error that arise from the session being destroyed. Rely on the\n                // `detachedFromTargetPromise` event to be resolved.\n                if (!parentCdpClient.isCloseError(error)) {\n                    throw error;\n                }\n            }\n            // Sometimes CDP command finishes before `detachedFromTarget` event,\n            // sometimes after. Wait for the CDP command to be finished, and then wait\n            // for `detachedFromTarget` if it hasn't emitted.\n            await detachedFromTargetPromise;\n        }\n        catch (error) {\n            // Swallow error that arise from the page being destroyed\n            // Example is navigating to faulty SSL certificate\n            if (!(error.code === -32000 /* CdpErrorConstants.GENERIC_ERROR */ &&\n                error.message === 'Not attached to an active page')) {\n                throw error;\n            }\n        }\n        return {};\n    }\n    async locateNodes(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        return await context.locateNodes(params);\n    }\n    #onContextCreatedSubscribeHook(contextId) {\n        const context = this.#browsingContextStorage.getContext(contextId);\n        const contextsToReport = [\n            context,\n            ...this.#browsingContextStorage.getContext(contextId).allChildren,\n        ];\n        contextsToReport.forEach((context) => {\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.ContextCreated,\n                params: context.serializeToBidiValue(),\n            }, context.id);\n        });\n        return Promise.resolve();\n    }\n}\nexports.BrowsingContextProcessor = BrowsingContextProcessor;\n//# sourceMappingURL=BrowsingContextProcessor.js.map","\"use strict\";\n/**\n * Copyright 2025 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EmulationProcessor = void 0;\nexports.isValidLocale = isValidLocale;\nexports.isValidTimezone = isValidTimezone;\nexports.isTimeZoneOffsetString = isTimeZoneOffsetString;\nconst ErrorResponse_js_1 = require(\"../../../protocol/ErrorResponse.js\");\nclass EmulationProcessor {\n    #userContextStorage;\n    #browsingContextStorage;\n    #contextConfigStorage;\n    constructor(browsingContextStorage, userContextStorage, contextConfigStorage) {\n        this.#userContextStorage = userContextStorage;\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#contextConfigStorage = contextConfigStorage;\n    }\n    async setGeolocationOverride(params) {\n        if ('coordinates' in params && 'error' in params) {\n            // Unreachable. Handled by params parser.\n            throw new ErrorResponse_js_1.InvalidArgumentException('Coordinates and error cannot be set at the same time');\n        }\n        let geolocation = null;\n        if ('coordinates' in params) {\n            if ((params.coordinates?.altitude ?? null) === null &&\n                (params.coordinates?.altitudeAccuracy ?? null) !== null) {\n                throw new ErrorResponse_js_1.InvalidArgumentException('Geolocation altitudeAccuracy can be set only with altitude');\n            }\n            geolocation = params.coordinates;\n        }\n        else if ('error' in params) {\n            if (params.error.type !== 'positionUnavailable') {\n                // Unreachable. Handled by params parser.\n                throw new ErrorResponse_js_1.InvalidArgumentException(`Unknown geolocation error ${params.error.type}`);\n            }\n            geolocation = params.error;\n        }\n        else {\n            // Unreachable. Handled by params parser.\n            throw new ErrorResponse_js_1.InvalidArgumentException(`Coordinates or error should be set`);\n        }\n        const browsingContexts = await this.#getRelatedTopLevelBrowsingContexts(params.contexts, params.userContexts);\n        for (const browsingContextId of params.contexts ?? []) {\n            this.#contextConfigStorage.updateBrowsingContextConfig(browsingContextId, {\n                geolocation,\n            });\n        }\n        for (const userContextId of params.userContexts ?? []) {\n            this.#contextConfigStorage.updateUserContextConfig(userContextId, {\n                geolocation,\n            });\n        }\n        await Promise.all(browsingContexts.map(async (context) => {\n            // Actual value can be different from the one in params, e.g. in case of already\n            // existing more granular setting.\n            const config = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext);\n            await context.setGeolocationOverride(config.geolocation ?? null);\n        }));\n        return {};\n    }\n    async setLocaleOverride(params) {\n        const locale = params.locale ?? null;\n        if (locale !== null && !isValidLocale(locale)) {\n            throw new ErrorResponse_js_1.InvalidArgumentException(`Invalid locale \"${locale}\"`);\n        }\n        const browsingContexts = await this.#getRelatedTopLevelBrowsingContexts(params.contexts, params.userContexts);\n        for (const browsingContextId of params.contexts ?? []) {\n            this.#contextConfigStorage.updateBrowsingContextConfig(browsingContextId, {\n                locale,\n            });\n        }\n        for (const userContextId of params.userContexts ?? []) {\n            this.#contextConfigStorage.updateUserContextConfig(userContextId, {\n                locale,\n            });\n        }\n        await Promise.all(browsingContexts.map(async (context) => {\n            // Actual value can be different from the one in params, e.g. in case of already\n            // existing more granular setting.\n            const config = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext);\n            await Promise.all([\n                context.setLocaleOverride(config.locale ?? null),\n                // Set `AcceptLanguage` to locale.\n                context.setUserAgentAndAcceptLanguage(config.userAgent, config.locale),\n            ]);\n        }));\n        return {};\n    }\n    async setScriptingEnabled(params) {\n        const scriptingEnabled = params.enabled;\n        const browsingContexts = await this.#getRelatedTopLevelBrowsingContexts(params.contexts, params.userContexts);\n        for (const browsingContextId of params.contexts ?? []) {\n            this.#contextConfigStorage.updateBrowsingContextConfig(browsingContextId, {\n                scriptingEnabled,\n            });\n        }\n        for (const userContextId of params.userContexts ?? []) {\n            this.#contextConfigStorage.updateUserContextConfig(userContextId, {\n                scriptingEnabled,\n            });\n        }\n        await Promise.all(browsingContexts.map(async (context) => {\n            // Actual value can be different from the one in params, e.g. in case of already\n            // existing more granular setting.\n            const config = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext);\n            await context.setScriptingEnabled(config.scriptingEnabled ?? null);\n        }));\n        return {};\n    }\n    async setScreenOrientationOverride(params) {\n        const browsingContexts = await this.#getRelatedTopLevelBrowsingContexts(params.contexts, params.userContexts);\n        for (const browsingContextId of params.contexts ?? []) {\n            this.#contextConfigStorage.updateBrowsingContextConfig(browsingContextId, {\n                screenOrientation: params.screenOrientation,\n            });\n        }\n        for (const userContextId of params.userContexts ?? []) {\n            this.#contextConfigStorage.updateUserContextConfig(userContextId, {\n                screenOrientation: params.screenOrientation,\n            });\n        }\n        await Promise.all(browsingContexts.map(async (context) => {\n            // Actual value can be different from the one in params, e.g. in case of already\n            // existing more granular setting.\n            const config = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext);\n            await context.setViewport(config.viewport ?? null, config.devicePixelRatio ?? null, config.screenOrientation ?? null);\n        }));\n        return {};\n    }\n    /**\n     * Returns a list of top-level browsing contexts.\n     */\n    async #getRelatedTopLevelBrowsingContexts(browsingContextIds, userContextIds, allowGlobal = false) {\n        if (browsingContextIds === undefined && userContextIds === undefined) {\n            if (allowGlobal) {\n                return this.#browsingContextStorage.getTopLevelContexts();\n            }\n            throw new ErrorResponse_js_1.InvalidArgumentException('Either user contexts or browsing contexts must be provided');\n        }\n        if (browsingContextIds !== undefined && userContextIds !== undefined) {\n            throw new ErrorResponse_js_1.InvalidArgumentException('User contexts and browsing contexts are mutually exclusive');\n        }\n        const result = [];\n        if (browsingContextIds === undefined) {\n            // userContextIds !== undefined\n            if (userContextIds.length === 0) {\n                throw new ErrorResponse_js_1.InvalidArgumentException('user context should be provided');\n            }\n            // Verify that all user contexts exist.\n            await this.#userContextStorage.verifyUserContextIdList(userContextIds);\n            for (const userContextId of userContextIds) {\n                const topLevelBrowsingContexts = this.#browsingContextStorage\n                    .getTopLevelContexts()\n                    .filter((browsingContext) => browsingContext.userContext === userContextId);\n                result.push(...topLevelBrowsingContexts);\n            }\n        }\n        else {\n            if (browsingContextIds.length === 0) {\n                throw new ErrorResponse_js_1.InvalidArgumentException('browsing context should be provided');\n            }\n            for (const browsingContextId of browsingContextIds) {\n                const browsingContext = this.#browsingContextStorage.getContext(browsingContextId);\n                if (!browsingContext.isTopLevelContext()) {\n                    throw new ErrorResponse_js_1.InvalidArgumentException('The command is only supported on the top-level context');\n                }\n                result.push(browsingContext);\n            }\n        }\n        // Remove duplicates. Compare `BrowsingContextImpl` by reference is correct here, as\n        // `browsingContextStorage` returns the same instance for the same id.\n        return [...new Set(result).values()];\n    }\n    async setTimezoneOverride(params) {\n        let timezone = params.timezone ?? null;\n        if (timezone !== null && !isValidTimezone(timezone)) {\n            throw new ErrorResponse_js_1.InvalidArgumentException(`Invalid timezone \"${timezone}\"`);\n        }\n        if (timezone !== null && isTimeZoneOffsetString(timezone)) {\n            // CDP supports offset timezone with `GMT` prefix.\n            timezone = `GMT${timezone}`;\n        }\n        const browsingContexts = await this.#getRelatedTopLevelBrowsingContexts(params.contexts, params.userContexts);\n        for (const browsingContextId of params.contexts ?? []) {\n            this.#contextConfigStorage.updateBrowsingContextConfig(browsingContextId, {\n                timezone,\n            });\n        }\n        for (const userContextId of params.userContexts ?? []) {\n            this.#contextConfigStorage.updateUserContextConfig(userContextId, {\n                timezone,\n            });\n        }\n        await Promise.all(browsingContexts.map(async (context) => {\n            // Actual value can be different from the one in params, e.g. in case of already\n            // existing more granular setting.\n            const config = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext);\n            await context.setTimezoneOverride(config.timezone ?? null);\n        }));\n        return {};\n    }\n    async setUserAgentOverrideParams(params) {\n        if (params.userAgent === '') {\n            throw new ErrorResponse_js_1.UnsupportedOperationException('empty user agent string is not supported');\n        }\n        const browsingContexts = await this.#getRelatedTopLevelBrowsingContexts(params.contexts, params.userContexts, true);\n        for (const browsingContextId of params.contexts ?? []) {\n            this.#contextConfigStorage.updateBrowsingContextConfig(browsingContextId, {\n                userAgent: params.userAgent,\n            });\n        }\n        for (const userContextId of params.userContexts ?? []) {\n            this.#contextConfigStorage.updateUserContextConfig(userContextId, {\n                userAgent: params.userAgent,\n            });\n        }\n        if (params.contexts === undefined && params.userContexts === undefined) {\n            this.#contextConfigStorage.updateGlobalConfig({\n                userAgent: params.userAgent,\n            });\n        }\n        await Promise.all(browsingContexts.map(async (context) => {\n            // Actual value can be different from the one in params, e.g. in case of already\n            // existing more granular setting.\n            const config = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext);\n            await context.setUserAgentAndAcceptLanguage(config.userAgent, config.locale);\n        }));\n        return {};\n    }\n    async setNetworkConditions(params) {\n        const browsingContexts = await this.#getRelatedTopLevelBrowsingContexts(params.contexts, params.userContexts, true);\n        for (const browsingContextId of params.contexts ?? []) {\n            this.#contextConfigStorage.updateBrowsingContextConfig(browsingContextId, {\n                emulatedNetworkConditions: params.networkConditions,\n            });\n        }\n        for (const userContextId of params.userContexts ?? []) {\n            this.#contextConfigStorage.updateUserContextConfig(userContextId, {\n                emulatedNetworkConditions: params.networkConditions,\n            });\n        }\n        if (params.contexts === undefined && params.userContexts === undefined) {\n            this.#contextConfigStorage.updateGlobalConfig({\n                emulatedNetworkConditions: params.networkConditions,\n            });\n        }\n        if (params.networkConditions !== null &&\n            params.networkConditions.type !== 'offline') {\n            throw new ErrorResponse_js_1.UnsupportedOperationException(`Unsupported network conditions ${params.networkConditions.type}`);\n        }\n        await Promise.all(browsingContexts.map(async (context) => {\n            // Actual value can be different from the one in params, e.g. in case of already\n            // existing more granular setting.\n            const config = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext);\n            await context.setEmulatedNetworkConditions(config.emulatedNetworkConditions ?? null);\n        }));\n        return {};\n    }\n}\nexports.EmulationProcessor = EmulationProcessor;\n// Export for testing.\nfunction isValidLocale(locale) {\n    try {\n        new Intl.Locale(locale);\n        return true;\n    }\n    catch (e) {\n        if (e instanceof RangeError) {\n            return false;\n        }\n        // Re-throw other errors\n        throw e;\n    }\n}\n// Export for testing.\nfunction isValidTimezone(timezone) {\n    try {\n        Intl.DateTimeFormat(undefined, { timeZone: timezone });\n        return true;\n    }\n    catch (e) {\n        if (e instanceof RangeError) {\n            return false;\n        }\n        // Re-throw other errors\n        throw e;\n    }\n}\n// Export for testing.\nfunction isTimeZoneOffsetString(timezone) {\n    return /^[+-](?:2[0-3]|[01]\\d)(?::[0-5]\\d)?$/.test(timezone);\n}\n//# sourceMappingURL=EmulationProcessor.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.assert = assert;\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction assert(predicate, message) {\n    if (!predicate) {\n        throw new Error(message ?? 'Internal assertion failed.');\n    }\n}\n//# sourceMappingURL=assert.js.map","\"use strict\";\n/*\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isSingleComplexGrapheme = isSingleComplexGrapheme;\nexports.isSingleGrapheme = isSingleGrapheme;\n/**\n * Check if the given string is a single complex grapheme. A complex grapheme is one that\n * is made up of multiple characters.\n */\nfunction isSingleComplexGrapheme(value) {\n    return isSingleGrapheme(value) && value.length > 1;\n}\n/**\n * Check if the given string is a single grapheme.\n */\nfunction isSingleGrapheme(value) {\n    // Theoretically there can be some strings considered a grapheme in some locales, like\n    // slovak \"ch\" digraph. Use english locale for consistency.\n    // https://www.unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries\n    const segmenter = new Intl.Segmenter('en', { granularity: 'grapheme' });\n    return [...segmenter.segment(value)].length === 1;\n}\n//# sourceMappingURL=graphemeTools.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WheelSource = exports.PointerSource = exports.KeySource = exports.NoneSource = void 0;\nclass NoneSource {\n    type = \"none\" /* SourceType.None */;\n}\nexports.NoneSource = NoneSource;\nclass KeySource {\n    type = \"key\" /* SourceType.Key */;\n    pressed = new Set();\n    // This is a bitfield that matches the modifiers parameter of\n    // https://chromedevtools.github.io/devtools-protocol/tot/Input/#method-dispatchKeyEvent\n    #modifiers = 0;\n    get modifiers() {\n        return this.#modifiers;\n    }\n    get alt() {\n        return (this.#modifiers & 1) === 1;\n    }\n    set alt(value) {\n        this.#setModifier(value, 1);\n    }\n    get ctrl() {\n        return (this.#modifiers & 2) === 2;\n    }\n    set ctrl(value) {\n        this.#setModifier(value, 2);\n    }\n    get meta() {\n        return (this.#modifiers & 4) === 4;\n    }\n    set meta(value) {\n        this.#setModifier(value, 4);\n    }\n    get shift() {\n        return (this.#modifiers & 8) === 8;\n    }\n    set shift(value) {\n        this.#setModifier(value, 8);\n    }\n    #setModifier(value, bit) {\n        if (value) {\n            this.#modifiers |= bit;\n        }\n        else {\n            this.#modifiers &= ~bit;\n        }\n    }\n}\nexports.KeySource = KeySource;\nclass PointerSource {\n    type = \"pointer\" /* SourceType.Pointer */;\n    subtype;\n    pointerId;\n    pressed = new Set();\n    x = 0;\n    y = 0;\n    radiusX;\n    radiusY;\n    force;\n    constructor(id, subtype) {\n        this.pointerId = id;\n        this.subtype = subtype;\n    }\n    // This is a bitfield that matches the buttons parameter of\n    // https://chromedevtools.github.io/devtools-protocol/tot/Input/#method-dispatchMouseEvent\n    get buttons() {\n        let buttons = 0;\n        for (const button of this.pressed) {\n            switch (button) {\n                case 0:\n                    buttons |= 1;\n                    break;\n                case 1:\n                    buttons |= 4;\n                    break;\n                case 2:\n                    buttons |= 2;\n                    break;\n                case 3:\n                    buttons |= 8;\n                    break;\n                case 4:\n                    buttons |= 16;\n                    break;\n            }\n        }\n        return buttons;\n    }\n    // --- Platform-specific code starts here ---\n    // Input.dispatchMouseEvent doesn't know the concept of double click, so we\n    // need to create the logic, similar to how it's done for OSes:\n    // https://source.chromium.org/chromium/chromium/src/+/refs/heads/main:ui/events/event.cc;l=479\n    static ClickContext = class ClickContext {\n        static #DOUBLE_CLICK_TIME_MS = 500;\n        static #MAX_DOUBLE_CLICK_RADIUS = 2;\n        count = 0;\n        #x;\n        #y;\n        #time;\n        constructor(x, y, time) {\n            this.#x = x;\n            this.#y = y;\n            this.#time = time;\n        }\n        compare(context) {\n            return (\n            // The click needs to be within a certain amount of ms.\n            context.#time - this.#time > ClickContext.#DOUBLE_CLICK_TIME_MS ||\n                // The click needs to be within a certain square radius.\n                Math.abs(context.#x - this.#x) >\n                    ClickContext.#MAX_DOUBLE_CLICK_RADIUS ||\n                Math.abs(context.#y - this.#y) > ClickContext.#MAX_DOUBLE_CLICK_RADIUS);\n        }\n    };\n    #clickContexts = new Map();\n    setClickCount(button, context) {\n        let storedContext = this.#clickContexts.get(button);\n        if (!storedContext || storedContext.compare(context)) {\n            storedContext = context;\n        }\n        ++storedContext.count;\n        this.#clickContexts.set(button, storedContext);\n        return storedContext.count;\n    }\n    getClickCount(button) {\n        return this.#clickContexts.get(button)?.count ?? 0;\n    }\n    /**\n     * Resets click count. Resets consequent click counter. Prevents grouping clicks in\n     * different `performActions` calls, so that they are not grouped as double, triple etc\n     * clicks. Required for https://github.com/GoogleChromeLabs/chromium-bidi/issues/3043.\n     */\n    resetClickCount() {\n        this.#clickContexts = new Map();\n    }\n}\nexports.PointerSource = PointerSource;\n_a = PointerSource;\nclass WheelSource {\n    type = \"wheel\" /* SourceType.Wheel */;\n}\nexports.WheelSource = WheelSource;\n//# sourceMappingURL=InputSource.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getNormalizedKey = getNormalizedKey;\nexports.getKeyCode = getKeyCode;\nexports.getKeyLocation = getKeyLocation;\n/**\n * Returns the normalized key value for a given key according to the table:\n * https://w3c.github.io/webdriver/#dfn-normalized-key-value\n */\nfunction getNormalizedKey(value) {\n    switch (value) {\n        case '\\uE000':\n            return 'Unidentified';\n        case '\\uE001':\n            return 'Cancel';\n        case '\\uE002':\n            return 'Help';\n        case '\\uE003':\n            return 'Backspace';\n        case '\\uE004':\n            return 'Tab';\n        case '\\uE005':\n            return 'Clear';\n        // Specification declares the '\\uE006' to be `Return`, but it is not supported by\n        // Chrome, so fall back to `Enter`, which aligns with WPT.\n        case '\\uE006':\n        case '\\uE007':\n            return 'Enter';\n        case '\\uE008':\n            return 'Shift';\n        case '\\uE009':\n            return 'Control';\n        case '\\uE00A':\n            return 'Alt';\n        case '\\uE00B':\n            return 'Pause';\n        case '\\uE00C':\n            return 'Escape';\n        case '\\uE00D':\n            return ' ';\n        case '\\uE00E':\n            return 'PageUp';\n        case '\\uE00F':\n            return 'PageDown';\n        case '\\uE010':\n            return 'End';\n        case '\\uE011':\n            return 'Home';\n        case '\\uE012':\n            return 'ArrowLeft';\n        case '\\uE013':\n            return 'ArrowUp';\n        case '\\uE014':\n            return 'ArrowRight';\n        case '\\uE015':\n            return 'ArrowDown';\n        case '\\uE016':\n            return 'Insert';\n        case '\\uE017':\n            return 'Delete';\n        case '\\uE018':\n            return ';';\n        case '\\uE019':\n            return '=';\n        case '\\uE01A':\n            return '0';\n        case '\\uE01B':\n            return '1';\n        case '\\uE01C':\n            return '2';\n        case '\\uE01D':\n            return '3';\n        case '\\uE01E':\n            return '4';\n        case '\\uE01F':\n            return '5';\n        case '\\uE020':\n            return '6';\n        case '\\uE021':\n            return '7';\n        case '\\uE022':\n            return '8';\n        case '\\uE023':\n            return '9';\n        case '\\uE024':\n            return '*';\n        case '\\uE025':\n            return '+';\n        case '\\uE026':\n            return ',';\n        case '\\uE027':\n            return '-';\n        case '\\uE028':\n            return '.';\n        case '\\uE029':\n            return '/';\n        case '\\uE031':\n            return 'F1';\n        case '\\uE032':\n            return 'F2';\n        case '\\uE033':\n            return 'F3';\n        case '\\uE034':\n            return 'F4';\n        case '\\uE035':\n            return 'F5';\n        case '\\uE036':\n            return 'F6';\n        case '\\uE037':\n            return 'F7';\n        case '\\uE038':\n            return 'F8';\n        case '\\uE039':\n            return 'F9';\n        case '\\uE03A':\n            return 'F10';\n        case '\\uE03B':\n            return 'F11';\n        case '\\uE03C':\n            return 'F12';\n        case '\\uE03D':\n            return 'Meta';\n        case '\\uE040':\n            return 'ZenkakuHankaku';\n        case '\\uE050':\n            return 'Shift';\n        case '\\uE051':\n            return 'Control';\n        case '\\uE052':\n            return 'Alt';\n        case '\\uE053':\n            return 'Meta';\n        case '\\uE054':\n            return 'PageUp';\n        case '\\uE055':\n            return 'PageDown';\n        case '\\uE056':\n            return 'End';\n        case '\\uE057':\n            return 'Home';\n        case '\\uE058':\n            return 'ArrowLeft';\n        case '\\uE059':\n            return 'ArrowUp';\n        case '\\uE05A':\n            return 'ArrowRight';\n        case '\\uE05B':\n            return 'ArrowDown';\n        case '\\uE05C':\n            return 'Insert';\n        case '\\uE05D':\n            return 'Delete';\n        default:\n            return value;\n    }\n}\n/**\n * Returns the key code for a given key according to the table:\n * https://w3c.github.io/webdriver/#dfn-shifted-character\n */\nfunction getKeyCode(key) {\n    switch (key) {\n        case '`':\n        case '~':\n            return 'Backquote';\n        case '\\\\':\n        case '|':\n            return 'Backslash';\n        case '\\uE003':\n            return 'Backspace';\n        case '[':\n        case '{':\n            return 'BracketLeft';\n        case ']':\n        case '}':\n            return 'BracketRight';\n        case ',':\n        case '<':\n            return 'Comma';\n        case '0':\n        case ')':\n            return 'Digit0';\n        case '1':\n        case '!':\n            return 'Digit1';\n        case '2':\n        case '@':\n            return 'Digit2';\n        case '3':\n        case '#':\n            return 'Digit3';\n        case '4':\n        case '$':\n            return 'Digit4';\n        case '5':\n        case '%':\n            return 'Digit5';\n        case '6':\n        case '^':\n            return 'Digit6';\n        case '7':\n        case '&':\n            return 'Digit7';\n        case '8':\n        case '*':\n            return 'Digit8';\n        case '9':\n        case '(':\n            return 'Digit9';\n        case '=':\n        case '+':\n            return 'Equal';\n        // The spec declares the '<' to be `IntlBackslash` as well, but it is already covered\n        // in the `Comma` above.\n        case '>':\n            return 'IntlBackslash';\n        case 'a':\n        case 'A':\n            return 'KeyA';\n        case 'b':\n        case 'B':\n            return 'KeyB';\n        case 'c':\n        case 'C':\n            return 'KeyC';\n        case 'd':\n        case 'D':\n            return 'KeyD';\n        case 'e':\n        case 'E':\n            return 'KeyE';\n        case 'f':\n        case 'F':\n            return 'KeyF';\n        case 'g':\n        case 'G':\n            return 'KeyG';\n        case 'h':\n        case 'H':\n            return 'KeyH';\n        case 'i':\n        case 'I':\n            return 'KeyI';\n        case 'j':\n        case 'J':\n            return 'KeyJ';\n        case 'k':\n        case 'K':\n            return 'KeyK';\n        case 'l':\n        case 'L':\n            return 'KeyL';\n        case 'm':\n        case 'M':\n            return 'KeyM';\n        case 'n':\n        case 'N':\n            return 'KeyN';\n        case 'o':\n        case 'O':\n            return 'KeyO';\n        case 'p':\n        case 'P':\n            return 'KeyP';\n        case 'q':\n        case 'Q':\n            return 'KeyQ';\n        case 'r':\n        case 'R':\n            return 'KeyR';\n        case 's':\n        case 'S':\n            return 'KeyS';\n        case 't':\n        case 'T':\n            return 'KeyT';\n        case 'u':\n        case 'U':\n            return 'KeyU';\n        case 'v':\n        case 'V':\n            return 'KeyV';\n        case 'w':\n        case 'W':\n            return 'KeyW';\n        case 'x':\n        case 'X':\n            return 'KeyX';\n        case 'y':\n        case 'Y':\n            return 'KeyY';\n        case 'z':\n        case 'Z':\n            return 'KeyZ';\n        case '-':\n        case '_':\n            return 'Minus';\n        case '.':\n            return 'Period';\n        case \"'\":\n        case '\"':\n            return 'Quote';\n        case ';':\n        case ':':\n            return 'Semicolon';\n        case '/':\n        case '?':\n            return 'Slash';\n        case '\\uE00A':\n            return 'AltLeft';\n        case '\\uE052':\n            return 'AltRight';\n        case '\\uE009':\n            return 'ControlLeft';\n        case '\\uE051':\n            return 'ControlRight';\n        case '\\uE006':\n            return 'Enter';\n        case '\\uE00B':\n            return 'Pause';\n        case '\\uE03D':\n            return 'MetaLeft';\n        case '\\uE053':\n            return 'MetaRight';\n        case '\\uE008':\n            return 'ShiftLeft';\n        case '\\uE050':\n            return 'ShiftRight';\n        case ' ':\n        case '\\uE00D':\n            return 'Space';\n        case '\\uE004':\n            return 'Tab';\n        case '\\uE017':\n            return 'Delete';\n        case '\\uE010':\n            return 'End';\n        case '\\uE002':\n            return 'Help';\n        case '\\uE011':\n            return 'Home';\n        case '\\uE016':\n            return 'Insert';\n        case '\\uE00F':\n            return 'PageDown';\n        case '\\uE00E':\n            return 'PageUp';\n        case '\\uE015':\n            return 'ArrowDown';\n        case '\\uE012':\n            return 'ArrowLeft';\n        case '\\uE014':\n            return 'ArrowRight';\n        case '\\uE013':\n            return 'ArrowUp';\n        case '\\uE00C':\n            return 'Escape';\n        case '\\uE031':\n            return 'F1';\n        case '\\uE032':\n            return 'F2';\n        case '\\uE033':\n            return 'F3';\n        case '\\uE034':\n            return 'F4';\n        case '\\uE035':\n            return 'F5';\n        case '\\uE036':\n            return 'F6';\n        case '\\uE037':\n            return 'F7';\n        case '\\uE038':\n            return 'F8';\n        case '\\uE039':\n            return 'F9';\n        case '\\uE03A':\n            return 'F10';\n        case '\\uE03B':\n            return 'F11';\n        case '\\uE03C':\n            return 'F12';\n        case '\\uE019':\n            return 'NumpadEqual';\n        case '\\uE01A':\n        case '\\uE05C':\n            return 'Numpad0';\n        case '\\uE01B':\n        case '\\uE056':\n            return 'Numpad1';\n        case '\\uE01C':\n        case '\\uE05B':\n            return 'Numpad2';\n        case '\\uE01D':\n        case '\\uE055':\n            return 'Numpad3';\n        case '\\uE01E':\n        case '\\uE058':\n            return 'Numpad4';\n        case '\\uE01F':\n            return 'Numpad5';\n        case '\\uE020':\n        case '\\uE05A':\n            return 'Numpad6';\n        case '\\uE021':\n        case '\\uE057':\n            return 'Numpad7';\n        case '\\uE022':\n        case '\\uE059':\n            return 'Numpad8';\n        case '\\uE023':\n        case '\\uE054':\n            return 'Numpad9';\n        case '\\uE025':\n            return 'NumpadAdd';\n        case '\\uE026':\n            return 'NumpadComma';\n        case '\\uE028':\n        case '\\uE05D':\n            return 'NumpadDecimal';\n        case '\\uE029':\n            return 'NumpadDivide';\n        case '\\uE007':\n            return 'NumpadEnter';\n        case '\\uE024':\n            return 'NumpadMultiply';\n        case '\\uE027':\n            return 'NumpadSubtract';\n        default:\n            return;\n    }\n}\n/**\n * Returns the location of the key according to the table:\n * https://w3c.github.io/webdriver/#dfn-key-location\n */\nfunction getKeyLocation(key) {\n    switch (key) {\n        case '\\uE007':\n        case '\\uE008':\n        case '\\uE009':\n        case '\\uE00A':\n        case '\\uE03D':\n            return 1;\n        case '\\uE019':\n        case '\\uE01A':\n        case '\\uE01B':\n        case '\\uE01C':\n        case '\\uE01D':\n        case '\\uE01E':\n        case '\\uE01F':\n        case '\\uE020':\n        case '\\uE021':\n        case '\\uE022':\n        case '\\uE023':\n        case '\\uE024':\n        case '\\uE025':\n        case '\\uE026':\n        case '\\uE027':\n        case '\\uE028':\n        case '\\uE029':\n        case '\\uE054':\n        case '\\uE055':\n        case '\\uE056':\n        case '\\uE057':\n        case '\\uE058':\n        case '\\uE059':\n        case '\\uE05A':\n        case '\\uE05B':\n        case '\\uE05C':\n        case '\\uE05D':\n            return 3;\n        case '\\uE050':\n        case '\\uE051':\n        case '\\uE052':\n        case '\\uE053':\n            return 2;\n        default:\n            return 0;\n    }\n}\n//# sourceMappingURL=keyUtils.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.KeyToKeyCode = void 0;\n// TODO: Remove this once https://crrev.com/c/4548290 is stably in Chromium.\n// `Input.dispatchKeyboardEvent` will automatically handle these conversions.\nexports.KeyToKeyCode = {\n    '0': 48,\n    '1': 49,\n    '2': 50,\n    '3': 51,\n    '4': 52,\n    '5': 53,\n    '6': 54,\n    '7': 55,\n    '8': 56,\n    '9': 57,\n    Abort: 3,\n    Help: 6,\n    Backspace: 8,\n    Tab: 9,\n    Numpad5: 12,\n    NumpadEnter: 13,\n    Enter: 13,\n    '\\\\r': 13,\n    '\\\\n': 13,\n    ShiftLeft: 16,\n    ShiftRight: 16,\n    ControlLeft: 17,\n    ControlRight: 17,\n    AltLeft: 18,\n    AltRight: 18,\n    Pause: 19,\n    CapsLock: 20,\n    Escape: 27,\n    Convert: 28,\n    NonConvert: 29,\n    Space: 32,\n    Numpad9: 33,\n    PageUp: 33,\n    Numpad3: 34,\n    PageDown: 34,\n    End: 35,\n    Numpad1: 35,\n    Home: 36,\n    Numpad7: 36,\n    ArrowLeft: 37,\n    Numpad4: 37,\n    Numpad8: 38,\n    ArrowUp: 38,\n    ArrowRight: 39,\n    Numpad6: 39,\n    Numpad2: 40,\n    ArrowDown: 40,\n    Select: 41,\n    Open: 43,\n    PrintScreen: 44,\n    Insert: 45,\n    Numpad0: 45,\n    Delete: 46,\n    NumpadDecimal: 46,\n    Digit0: 48,\n    Digit1: 49,\n    Digit2: 50,\n    Digit3: 51,\n    Digit4: 52,\n    Digit5: 53,\n    Digit6: 54,\n    Digit7: 55,\n    Digit8: 56,\n    Digit9: 57,\n    KeyA: 65,\n    KeyB: 66,\n    KeyC: 67,\n    KeyD: 68,\n    KeyE: 69,\n    KeyF: 70,\n    KeyG: 71,\n    KeyH: 72,\n    KeyI: 73,\n    KeyJ: 74,\n    KeyK: 75,\n    KeyL: 76,\n    KeyM: 77,\n    KeyN: 78,\n    KeyO: 79,\n    KeyP: 80,\n    KeyQ: 81,\n    KeyR: 82,\n    KeyS: 83,\n    KeyT: 84,\n    KeyU: 85,\n    KeyV: 86,\n    KeyW: 87,\n    KeyX: 88,\n    KeyY: 89,\n    KeyZ: 90,\n    MetaLeft: 91,\n    MetaRight: 92,\n    ContextMenu: 93,\n    NumpadMultiply: 106,\n    NumpadAdd: 107,\n    NumpadSubtract: 109,\n    NumpadDivide: 111,\n    F1: 112,\n    F2: 113,\n    F3: 114,\n    F4: 115,\n    F5: 116,\n    F6: 117,\n    F7: 118,\n    F8: 119,\n    F9: 120,\n    F10: 121,\n    F11: 122,\n    F12: 123,\n    F13: 124,\n    F14: 125,\n    F15: 126,\n    F16: 127,\n    F17: 128,\n    F18: 129,\n    F19: 130,\n    F20: 131,\n    F21: 132,\n    F22: 133,\n    F23: 134,\n    F24: 135,\n    NumLock: 144,\n    ScrollLock: 145,\n    AudioVolumeMute: 173,\n    AudioVolumeDown: 174,\n    AudioVolumeUp: 175,\n    MediaTrackNext: 176,\n    MediaTrackPrevious: 177,\n    MediaStop: 178,\n    MediaPlayPause: 179,\n    Semicolon: 186,\n    Equal: 187,\n    NumpadEqual: 187,\n    Comma: 188,\n    Minus: 189,\n    Period: 190,\n    Slash: 191,\n    Backquote: 192,\n    BracketLeft: 219,\n    Backslash: 220,\n    BracketRight: 221,\n    Quote: 222,\n    AltGraph: 225,\n    Props: 247,\n    Cancel: 3,\n    Clear: 12,\n    Shift: 16,\n    Control: 17,\n    Alt: 18,\n    Accept: 30,\n    ModeChange: 31,\n    ' ': 32,\n    Print: 42,\n    Execute: 43,\n    '\\\\u0000': 46,\n    a: 65,\n    b: 66,\n    c: 67,\n    d: 68,\n    e: 69,\n    f: 70,\n    g: 71,\n    h: 72,\n    i: 73,\n    j: 74,\n    k: 75,\n    l: 76,\n    m: 77,\n    n: 78,\n    o: 79,\n    p: 80,\n    q: 81,\n    r: 82,\n    s: 83,\n    t: 84,\n    u: 85,\n    v: 86,\n    w: 87,\n    x: 88,\n    y: 89,\n    z: 90,\n    Meta: 91,\n    '*': 106,\n    '+': 107,\n    '-': 109,\n    '/': 111,\n    ';': 186,\n    '=': 187,\n    ',': 188,\n    '.': 190,\n    '`': 192,\n    '[': 219,\n    '\\\\\\\\': 220,\n    ']': 221,\n    \"'\": 222,\n    Attn: 246,\n    CrSel: 247,\n    ExSel: 248,\n    EraseEof: 249,\n    Play: 250,\n    ZoomOut: 251,\n    ')': 48,\n    '!': 49,\n    '@': 50,\n    '#': 51,\n    $: 52,\n    '%': 53,\n    '^': 54,\n    '&': 55,\n    '(': 57,\n    A: 65,\n    B: 66,\n    C: 67,\n    D: 68,\n    E: 69,\n    F: 70,\n    G: 71,\n    H: 72,\n    I: 73,\n    J: 74,\n    K: 75,\n    L: 76,\n    M: 77,\n    N: 78,\n    O: 79,\n    P: 80,\n    Q: 81,\n    R: 82,\n    S: 83,\n    T: 84,\n    U: 85,\n    V: 86,\n    W: 87,\n    X: 88,\n    Y: 89,\n    Z: 90,\n    ':': 186,\n    '<': 188,\n    _: 189,\n    '>': 190,\n    '?': 191,\n    '~': 192,\n    '{': 219,\n    '|': 220,\n    '}': 221,\n    '\"': 222,\n    Camera: 44,\n    EndCall: 95,\n    VolumeDown: 182,\n    VolumeUp: 183,\n};\n//# sourceMappingURL=USKeyboardLayout.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ActionDispatcher = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst assert_js_1 = require(\"../../../utils/assert.js\");\nconst graphemeTools_js_1 = require(\"../../../utils/graphemeTools.js\");\nconst InputSource_js_1 = require(\"./InputSource.js\");\nconst keyUtils_js_1 = require(\"./keyUtils.js\");\nconst USKeyboardLayout_js_1 = require(\"./USKeyboardLayout.js\");\n/** https://w3c.github.io/webdriver/#dfn-center-point */\nconst CALCULATE_IN_VIEW_CENTER_PT_DECL = ((i) => {\n    const t = i.getClientRects()[0], e = Math.max(0, Math.min(t.x, t.x + t.width)), n = Math.min(window.innerWidth, Math.max(t.x, t.x + t.width)), h = Math.max(0, Math.min(t.y, t.y + t.height)), m = Math.min(window.innerHeight, Math.max(t.y, t.y + t.height));\n    return [e + ((n - e) >> 1), h + ((m - h) >> 1)];\n}).toString();\nconst IS_MAC_DECL = (() => {\n    return navigator.platform.toLowerCase().includes('mac');\n}).toString();\nasync function getElementCenter(context, element) {\n    const hiddenSandboxRealm = await context.getOrCreateHiddenSandbox();\n    const result = await hiddenSandboxRealm.callFunction(CALCULATE_IN_VIEW_CENTER_PT_DECL, false, { type: 'undefined' }, [element]);\n    if (result.type === 'exception') {\n        throw new protocol_js_1.NoSuchElementException(`Origin element ${element.sharedId} was not found`);\n    }\n    (0, assert_js_1.assert)(result.result.type === 'array');\n    (0, assert_js_1.assert)(result.result.value?.[0]?.type === 'number');\n    (0, assert_js_1.assert)(result.result.value?.[1]?.type === 'number');\n    const { result: { value: [{ value: x }, { value: y }], }, } = result;\n    return { x: x, y: y };\n}\nclass ActionDispatcher {\n    static isMacOS = async (context) => {\n        const hiddenSandboxRealm = await context.getOrCreateHiddenSandbox();\n        const result = await hiddenSandboxRealm.callFunction(IS_MAC_DECL, false);\n        (0, assert_js_1.assert)(result.type !== 'exception');\n        (0, assert_js_1.assert)(result.result.type === 'boolean');\n        return result.result.value;\n    };\n    #browsingContextStorage;\n    #tickStart = 0;\n    #tickDuration = 0;\n    #inputState;\n    #contextId;\n    #isMacOS;\n    constructor(inputState, browsingContextStorage, contextId, isMacOS) {\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#inputState = inputState;\n        this.#contextId = contextId;\n        this.#isMacOS = isMacOS;\n    }\n    /**\n     * The context can be disposed between action ticks, so need to get it each time.\n     */\n    get #context() {\n        return this.#browsingContextStorage.getContext(this.#contextId);\n    }\n    async dispatchActions(optionsByTick) {\n        await this.#inputState.queue.run(async () => {\n            for (const options of optionsByTick) {\n                await this.dispatchTickActions(options);\n            }\n        });\n    }\n    async dispatchTickActions(options) {\n        this.#tickStart = performance.now();\n        this.#tickDuration = 0;\n        for (const { action } of options) {\n            if ('duration' in action && action.duration !== undefined) {\n                this.#tickDuration = Math.max(this.#tickDuration, action.duration);\n            }\n        }\n        const promises = [\n            new Promise((resolve) => setTimeout(resolve, this.#tickDuration)),\n        ];\n        for (const option of options) {\n            // In theory we have to wait for each action to happen, but CDP is serial,\n            // so as an optimization, we queue all CDP commands at once and await all\n            // of them.\n            promises.push(this.#dispatchAction(option));\n        }\n        await Promise.all(promises);\n    }\n    async #dispatchAction({ id, action }) {\n        const source = this.#inputState.get(id);\n        const keyState = this.#inputState.getGlobalKeyState();\n        switch (action.type) {\n            case 'keyDown': {\n                // SAFETY: The source is validated before.\n                await this.#dispatchKeyDownAction(source, action);\n                this.#inputState.cancelList.push({\n                    id,\n                    action: {\n                        ...action,\n                        type: 'keyUp',\n                    },\n                });\n                break;\n            }\n            case 'keyUp': {\n                // SAFETY: The source is validated before.\n                await this.#dispatchKeyUpAction(source, action);\n                break;\n            }\n            case 'pause': {\n                // TODO: Implement waiting on the input source.\n                break;\n            }\n            case 'pointerDown': {\n                // SAFETY: The source is validated before.\n                await this.#dispatchPointerDownAction(source, keyState, action);\n                this.#inputState.cancelList.push({\n                    id,\n                    action: {\n                        ...action,\n                        type: 'pointerUp',\n                    },\n                });\n                break;\n            }\n            case 'pointerMove': {\n                // SAFETY: The source is validated before.\n                await this.#dispatchPointerMoveAction(source, keyState, action);\n                break;\n            }\n            case 'pointerUp': {\n                // SAFETY: The source is validated before.\n                await this.#dispatchPointerUpAction(source, keyState, action);\n                break;\n            }\n            case 'scroll': {\n                // SAFETY: The source is validated before.\n                await this.#dispatchScrollAction(source, keyState, action);\n                break;\n            }\n        }\n    }\n    async #dispatchPointerDownAction(source, keyState, action) {\n        const { button } = action;\n        if (source.pressed.has(button)) {\n            return;\n        }\n        source.pressed.add(button);\n        const { x, y, subtype: pointerType } = source;\n        const { width, height, pressure, twist, tangentialPressure } = action;\n        const { tiltX, tiltY } = getTilt(action);\n        // --- Platform-specific code begins here ---\n        const { modifiers } = keyState;\n        const { radiusX, radiusY } = getRadii(width ?? 1, height ?? 1);\n        switch (pointerType) {\n            case \"mouse\" /* Input.PointerType.Mouse */:\n            case \"pen\" /* Input.PointerType.Pen */:\n                // TODO: Implement width and height when available.\n                await this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchMouseEvent', {\n                    type: 'mousePressed',\n                    x,\n                    y,\n                    modifiers,\n                    button: getCdpButton(button),\n                    buttons: source.buttons,\n                    clickCount: source.setClickCount(button, new InputSource_js_1.PointerSource.ClickContext(x, y, performance.now())),\n                    pointerType,\n                    tangentialPressure,\n                    tiltX,\n                    tiltY,\n                    twist,\n                    force: pressure,\n                });\n                break;\n            case \"touch\" /* Input.PointerType.Touch */:\n                await this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchTouchEvent', {\n                    type: 'touchStart',\n                    touchPoints: [\n                        {\n                            x,\n                            y,\n                            radiusX,\n                            radiusY,\n                            tangentialPressure,\n                            tiltX,\n                            tiltY,\n                            twist,\n                            force: pressure,\n                            id: source.pointerId,\n                        },\n                    ],\n                    modifiers,\n                });\n                break;\n        }\n        source.radiusX = radiusX;\n        source.radiusY = radiusY;\n        source.force = pressure;\n        // --- Platform-specific code ends here ---\n    }\n    #dispatchPointerUpAction(source, keyState, action) {\n        const { button } = action;\n        if (!source.pressed.has(button)) {\n            return;\n        }\n        source.pressed.delete(button);\n        const { x, y, force, radiusX, radiusY, subtype: pointerType } = source;\n        // --- Platform-specific code begins here ---\n        const { modifiers } = keyState;\n        switch (pointerType) {\n            case \"mouse\" /* Input.PointerType.Mouse */:\n            case \"pen\" /* Input.PointerType.Pen */:\n                // TODO: Implement width and height when available.\n                return this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchMouseEvent', {\n                    type: 'mouseReleased',\n                    x,\n                    y,\n                    modifiers,\n                    button: getCdpButton(button),\n                    buttons: source.buttons,\n                    clickCount: source.getClickCount(button),\n                    pointerType,\n                });\n            case \"touch\" /* Input.PointerType.Touch */:\n                return this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchTouchEvent', {\n                    type: 'touchEnd',\n                    touchPoints: [\n                        {\n                            x,\n                            y,\n                            id: source.pointerId,\n                            force,\n                            radiusX,\n                            radiusY,\n                        },\n                    ],\n                    modifiers,\n                });\n        }\n        // --- Platform-specific code ends here ---\n    }\n    async #dispatchPointerMoveAction(source, keyState, action) {\n        const { x: startX, y: startY, subtype: pointerType } = source;\n        const { width, height, pressure, twist, tangentialPressure, x: offsetX, y: offsetY, origin = 'viewport', duration = this.#tickDuration, } = action;\n        const { tiltX, tiltY } = getTilt(action);\n        const { radiusX, radiusY } = getRadii(width ?? 1, height ?? 1);\n        const { targetX, targetY } = await this.#getCoordinateFromOrigin(origin, offsetX, offsetY, startX, startY);\n        if (targetX < 0 || targetY < 0) {\n            throw new protocol_js_1.MoveTargetOutOfBoundsException(`Cannot move beyond viewport (x: ${targetX}, y: ${targetY})`);\n        }\n        let last;\n        do {\n            const ratio = duration > 0 ? (performance.now() - this.#tickStart) / duration : 1;\n            last = ratio >= 1;\n            let x;\n            let y;\n            if (last) {\n                x = targetX;\n                y = targetY;\n            }\n            else {\n                x = Math.round(ratio * (targetX - startX) + startX);\n                y = Math.round(ratio * (targetY - startY) + startY);\n            }\n            if (source.x !== x || source.y !== y) {\n                // --- Platform-specific code begins here ---\n                const { modifiers } = keyState;\n                switch (pointerType) {\n                    case \"mouse\" /* Input.PointerType.Mouse */:\n                        // TODO: Implement width and height when available.\n                        await this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchMouseEvent', {\n                            type: 'mouseMoved',\n                            x,\n                            y,\n                            modifiers,\n                            clickCount: 0,\n                            button: getCdpButton(source.pressed.values().next().value ?? 5),\n                            buttons: source.buttons,\n                            pointerType,\n                            tangentialPressure,\n                            tiltX,\n                            tiltY,\n                            twist,\n                            force: pressure,\n                        });\n                        break;\n                    case \"pen\" /* Input.PointerType.Pen */:\n                        if (source.pressed.size !== 0) {\n                            // Empty `source.pressed.size` means the pen is not detected by digitizer.\n                            // Dispatch a mouse event for the pen only if either:\n                            // 1. the pen is hovering over the digitizer (0);\n                            // 2. the pen is in contact with the digitizer (1);\n                            // 3. the pen has at least one button pressed (2, 4, etc).\n                            // https://www.w3.org/TR/pointerevents/#the-buttons-property\n                            // TODO: Implement width and height when available.\n                            await this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchMouseEvent', {\n                                type: 'mouseMoved',\n                                x,\n                                y,\n                                modifiers,\n                                clickCount: 0,\n                                button: getCdpButton(source.pressed.values().next().value ?? 5),\n                                buttons: source.buttons,\n                                pointerType,\n                                tangentialPressure,\n                                tiltX,\n                                tiltY,\n                                twist,\n                                force: pressure ?? 0.5,\n                            });\n                        }\n                        break;\n                    case \"touch\" /* Input.PointerType.Touch */:\n                        if (source.pressed.size !== 0) {\n                            await this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchTouchEvent', {\n                                type: 'touchMove',\n                                touchPoints: [\n                                    {\n                                        x,\n                                        y,\n                                        radiusX,\n                                        radiusY,\n                                        tangentialPressure,\n                                        tiltX,\n                                        tiltY,\n                                        twist,\n                                        force: pressure,\n                                        id: source.pointerId,\n                                    },\n                                ],\n                                modifiers,\n                            });\n                        }\n                        break;\n                }\n                // --- Platform-specific code ends here ---\n                source.x = x;\n                source.y = y;\n                source.radiusX = radiusX;\n                source.radiusY = radiusY;\n                source.force = pressure;\n            }\n        } while (!last);\n    }\n    async #getFrameOffset() {\n        if (this.#context.id === this.#context.cdpTarget.id) {\n            return { x: 0, y: 0 };\n        }\n        // https://github.com/w3c/webdriver/pull/1847 proposes dispatching events from\n        // the top-level browsing context. This implementation dispatches it on the top-most\n        // same-target frame, which is not top-level one in case of OOPiF.\n        // TODO: switch to the top-level browsing context.\n        const { backendNodeId } = await this.#context.cdpTarget.cdpClient.sendCommand('DOM.getFrameOwner', { frameId: this.#context.id });\n        const { model: frameBoxModel } = await this.#context.cdpTarget.cdpClient.sendCommand('DOM.getBoxModel', {\n            backendNodeId,\n        });\n        return { x: frameBoxModel.content[0], y: frameBoxModel.content[1] };\n    }\n    async #getCoordinateFromOrigin(origin, offsetX, offsetY, startX, startY) {\n        let targetX;\n        let targetY;\n        const frameOffset = await this.#getFrameOffset();\n        switch (origin) {\n            case 'viewport':\n                targetX = offsetX + frameOffset.x;\n                targetY = offsetY + frameOffset.y;\n                break;\n            case 'pointer':\n                targetX = startX + offsetX + frameOffset.x;\n                targetY = startY + offsetY + frameOffset.y;\n                break;\n            default: {\n                const { x: posX, y: posY } = await getElementCenter(this.#context, origin.element);\n                // SAFETY: These can never be special numbers.\n                targetX = posX + offsetX + frameOffset.x;\n                targetY = posY + offsetY + frameOffset.y;\n                break;\n            }\n        }\n        return { targetX, targetY };\n    }\n    async #dispatchScrollAction(_source, keyState, action) {\n        const { deltaX: targetDeltaX, deltaY: targetDeltaY, x: offsetX, y: offsetY, origin = 'viewport', duration = this.#tickDuration, } = action;\n        if (origin === 'pointer') {\n            throw new protocol_js_1.InvalidArgumentException('\"pointer\" origin is invalid for scrolling.');\n        }\n        const { targetX, targetY } = await this.#getCoordinateFromOrigin(origin, offsetX, offsetY, 0, 0);\n        if (targetX < 0 || targetY < 0) {\n            throw new protocol_js_1.MoveTargetOutOfBoundsException(`Cannot move beyond viewport (x: ${targetX}, y: ${targetY})`);\n        }\n        let currentDeltaX = 0;\n        let currentDeltaY = 0;\n        let last;\n        do {\n            const ratio = duration > 0 ? (performance.now() - this.#tickStart) / duration : 1;\n            last = ratio >= 1;\n            let deltaX;\n            let deltaY;\n            if (last) {\n                deltaX = targetDeltaX - currentDeltaX;\n                deltaY = targetDeltaY - currentDeltaY;\n            }\n            else {\n                deltaX = Math.round(ratio * targetDeltaX - currentDeltaX);\n                deltaY = Math.round(ratio * targetDeltaY - currentDeltaY);\n            }\n            if (deltaX !== 0 || deltaY !== 0) {\n                // --- Platform-specific code begins here ---\n                const { modifiers } = keyState;\n                await this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchMouseEvent', {\n                    type: 'mouseWheel',\n                    deltaX,\n                    deltaY,\n                    x: targetX,\n                    y: targetY,\n                    modifiers,\n                });\n                // --- Platform-specific code ends here ---\n                currentDeltaX += deltaX;\n                currentDeltaY += deltaY;\n            }\n        } while (!last);\n    }\n    async #dispatchKeyDownAction(source, action) {\n        const rawKey = action.value;\n        if (!(0, graphemeTools_js_1.isSingleGrapheme)(rawKey)) {\n            // https://w3c.github.io/webdriver/#dfn-process-a-key-action\n            // WebDriver spec allows a grapheme to be used.\n            throw new protocol_js_1.InvalidArgumentException(`Invalid key value: ${rawKey}`);\n        }\n        const isGrapheme = (0, graphemeTools_js_1.isSingleComplexGrapheme)(rawKey);\n        const key = (0, keyUtils_js_1.getNormalizedKey)(rawKey);\n        const repeat = source.pressed.has(key);\n        const code = (0, keyUtils_js_1.getKeyCode)(rawKey);\n        const location = (0, keyUtils_js_1.getKeyLocation)(rawKey);\n        switch (key) {\n            case 'Alt':\n                source.alt = true;\n                break;\n            case 'Shift':\n                source.shift = true;\n                break;\n            case 'Control':\n                source.ctrl = true;\n                break;\n            case 'Meta':\n                source.meta = true;\n                break;\n        }\n        source.pressed.add(key);\n        const { modifiers } = source;\n        // --- Platform-specific code begins here ---\n        // The spread is a little hack so JS gives us an array of unicode characters\n        // to measure.\n        const unmodifiedText = getKeyEventUnmodifiedText(key, source, isGrapheme);\n        const text = getKeyEventText(code ?? '', source) ?? unmodifiedText;\n        let command;\n        // The following commands need to be declared because Chromium doesn't\n        // handle them. See\n        // https://source.chromium.org/chromium/chromium/src/+/refs/heads/main:third_party/blink/renderer/core/editing/editing_behavior.cc;l=169;drc=b8143cf1dfd24842890fcd831c4f5d909bef4fc4;bpv=0;bpt=1.\n        if (this.#isMacOS && source.meta) {\n            switch (code) {\n                case 'KeyA':\n                    command = 'SelectAll';\n                    break;\n                case 'KeyC':\n                    command = 'Copy';\n                    break;\n                case 'KeyV':\n                    command = source.shift ? 'PasteAndMatchStyle' : 'Paste';\n                    break;\n                case 'KeyX':\n                    command = 'Cut';\n                    break;\n                case 'KeyZ':\n                    command = source.shift ? 'Redo' : 'Undo';\n                    break;\n                default:\n                // Intentionally empty.\n            }\n        }\n        const promises = [\n            this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchKeyEvent', {\n                type: text ? 'keyDown' : 'rawKeyDown',\n                windowsVirtualKeyCode: USKeyboardLayout_js_1.KeyToKeyCode[key],\n                key,\n                code,\n                text,\n                unmodifiedText,\n                autoRepeat: repeat,\n                isSystemKey: source.alt || undefined,\n                location: location < 3 ? location : undefined,\n                isKeypad: location === 3,\n                modifiers,\n                commands: command ? [command] : undefined,\n            }),\n        ];\n        // Drag cancelling happens on escape.\n        if (key === 'Escape') {\n            if (!source.alt &&\n                ((this.#isMacOS && !source.ctrl && !source.meta) || !this.#isMacOS)) {\n                promises.push(this.#context.cdpTarget.cdpClient.sendCommand('Input.cancelDragging'));\n            }\n        }\n        await Promise.all(promises);\n        // --- Platform-specific code ends here ---\n    }\n    #dispatchKeyUpAction(source, action) {\n        const rawKey = action.value;\n        if (!(0, graphemeTools_js_1.isSingleGrapheme)(rawKey)) {\n            // https://w3c.github.io/webdriver/#dfn-process-a-key-action\n            // WebDriver spec allows a grapheme to be used.\n            throw new protocol_js_1.InvalidArgumentException(`Invalid key value: ${rawKey}`);\n        }\n        const isGrapheme = (0, graphemeTools_js_1.isSingleComplexGrapheme)(rawKey);\n        const key = (0, keyUtils_js_1.getNormalizedKey)(rawKey);\n        if (!source.pressed.has(key)) {\n            return;\n        }\n        const code = (0, keyUtils_js_1.getKeyCode)(rawKey);\n        const location = (0, keyUtils_js_1.getKeyLocation)(rawKey);\n        switch (key) {\n            case 'Alt':\n                source.alt = false;\n                break;\n            case 'Shift':\n                source.shift = false;\n                break;\n            case 'Control':\n                source.ctrl = false;\n                break;\n            case 'Meta':\n                source.meta = false;\n                break;\n        }\n        source.pressed.delete(key);\n        const { modifiers } = source;\n        // --- Platform-specific code begins here ---\n        // The spread is a little hack so JS gives us an array of unicode characters\n        // to measure.\n        const unmodifiedText = getKeyEventUnmodifiedText(key, source, isGrapheme);\n        const text = getKeyEventText(code ?? '', source) ?? unmodifiedText;\n        return this.#context.cdpTarget.cdpClient.sendCommand('Input.dispatchKeyEvent', {\n            type: 'keyUp',\n            windowsVirtualKeyCode: USKeyboardLayout_js_1.KeyToKeyCode[key],\n            key,\n            code,\n            text,\n            unmodifiedText,\n            location: location < 3 ? location : undefined,\n            isSystemKey: source.alt || undefined,\n            isKeypad: location === 3,\n            modifiers,\n        });\n        // --- Platform-specific code ends here ---\n    }\n}\nexports.ActionDispatcher = ActionDispatcher;\n/**\n * Translates a non-grapheme key to either an `undefined` for a special keys, or a single\n * character modified by shift if needed.\n */\nconst getKeyEventUnmodifiedText = (key, source, isGrapheme) => {\n    if (isGrapheme) {\n        // Graphemes should be presented as text in the CDP command.\n        return key;\n    }\n    if (key === 'Enter') {\n        return '\\r';\n    }\n    // If key is not a single character, it is a normalized key value, and should be\n    // presented as key, not text in the CDP command.\n    return [...key].length === 1\n        ? source.shift\n            ? key.toLocaleUpperCase('en-US')\n            : key\n        : undefined;\n};\nconst getKeyEventText = (code, source) => {\n    if (source.ctrl) {\n        switch (code) {\n            case 'Digit2':\n                if (source.shift) {\n                    return '\\x00';\n                }\n                break;\n            case 'KeyA':\n                return '\\x01';\n            case 'KeyB':\n                return '\\x02';\n            case 'KeyC':\n                return '\\x03';\n            case 'KeyD':\n                return '\\x04';\n            case 'KeyE':\n                return '\\x05';\n            case 'KeyF':\n                return '\\x06';\n            case 'KeyG':\n                return '\\x07';\n            case 'KeyH':\n                return '\\x08';\n            case 'KeyI':\n                return '\\x09';\n            case 'KeyJ':\n                return '\\x0A';\n            case 'KeyK':\n                return '\\x0B';\n            case 'KeyL':\n                return '\\x0C';\n            case 'KeyM':\n                return '\\x0D';\n            case 'KeyN':\n                return '\\x0E';\n            case 'KeyO':\n                return '\\x0F';\n            case 'KeyP':\n                return '\\x10';\n            case 'KeyQ':\n                return '\\x11';\n            case 'KeyR':\n                return '\\x12';\n            case 'KeyS':\n                return '\\x13';\n            case 'KeyT':\n                return '\\x14';\n            case 'KeyU':\n                return '\\x15';\n            case 'KeyV':\n                return '\\x16';\n            case 'KeyW':\n                return '\\x17';\n            case 'KeyX':\n                return '\\x18';\n            case 'KeyY':\n                return '\\x19';\n            case 'KeyZ':\n                return '\\x1A';\n            case 'BracketLeft':\n                return '\\x1B';\n            case 'Backslash':\n                return '\\x1C';\n            case 'BracketRight':\n                return '\\x1D';\n            case 'Digit6':\n                if (source.shift) {\n                    return '\\x1E';\n                }\n                break;\n            case 'Minus':\n                return '\\x1F';\n        }\n        return '';\n    }\n    if (source.alt) {\n        return '';\n    }\n    return;\n};\nfunction getCdpButton(button) {\n    // https://www.w3.org/TR/pointerevents/#the-button-property\n    switch (button) {\n        case 0:\n            return 'left';\n        case 1:\n            return 'middle';\n        case 2:\n            return 'right';\n        case 3:\n            return 'back';\n        case 4:\n            return 'forward';\n        default:\n            return 'none';\n    }\n}\nfunction getTilt(action) {\n    // https://w3c.github.io/pointerevents/#converting-between-tiltx-tilty-and-altitudeangle-azimuthangle\n    const altitudeAngle = action.altitudeAngle ?? Math.PI / 2;\n    const azimuthAngle = action.azimuthAngle ?? 0;\n    let tiltXRadians = 0;\n    let tiltYRadians = 0;\n    if (altitudeAngle === 0) {\n        // the pen is in the X-Y plane\n        if (azimuthAngle === 0 || azimuthAngle === 2 * Math.PI) {\n            // pen is on positive X axis\n            tiltXRadians = Math.PI / 2;\n        }\n        if (azimuthAngle === Math.PI / 2) {\n            // pen is on positive Y axis\n            tiltYRadians = Math.PI / 2;\n        }\n        if (azimuthAngle === Math.PI) {\n            // pen is on negative X axis\n            tiltXRadians = -Math.PI / 2;\n        }\n        if (azimuthAngle === (3 * Math.PI) / 2) {\n            // pen is on negative Y axis\n            tiltYRadians = -Math.PI / 2;\n        }\n        if (azimuthAngle > 0 && azimuthAngle < Math.PI / 2) {\n            tiltXRadians = Math.PI / 2;\n            tiltYRadians = Math.PI / 2;\n        }\n        if (azimuthAngle > Math.PI / 2 && azimuthAngle < Math.PI) {\n            tiltXRadians = -Math.PI / 2;\n            tiltYRadians = Math.PI / 2;\n        }\n        if (azimuthAngle > Math.PI && azimuthAngle < (3 * Math.PI) / 2) {\n            tiltXRadians = -Math.PI / 2;\n            tiltYRadians = -Math.PI / 2;\n        }\n        if (azimuthAngle > (3 * Math.PI) / 2 && azimuthAngle < 2 * Math.PI) {\n            tiltXRadians = Math.PI / 2;\n            tiltYRadians = -Math.PI / 2;\n        }\n    }\n    if (altitudeAngle !== 0) {\n        const tanAlt = Math.tan(altitudeAngle);\n        tiltXRadians = Math.atan(Math.cos(azimuthAngle) / tanAlt);\n        tiltYRadians = Math.atan(Math.sin(azimuthAngle) / tanAlt);\n    }\n    const factor = 180 / Math.PI;\n    return {\n        tiltX: Math.round(tiltXRadians * factor),\n        tiltY: Math.round(tiltYRadians * factor),\n    };\n}\nfunction getRadii(width, height) {\n    return {\n        radiusX: width ? width / 2 : 0.5,\n        radiusY: height ? height / 2 : 0.5,\n    };\n}\n//# sourceMappingURL=ActionDispatcher.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n * Copyright 2022 The Chromium Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Mutex = void 0;\n/**\n * Use Mutex class to coordinate local concurrent operations.\n * Once `acquire` promise resolves, you hold the lock and must\n * call `release` function returned by `acquire` to release the\n * lock. Failing to `release` the lock may lead to deadlocks.\n */\nclass Mutex {\n    #locked = false;\n    #acquirers = [];\n    // This is FIFO.\n    acquire() {\n        const state = { resolved: false };\n        if (this.#locked) {\n            return new Promise((resolve) => {\n                this.#acquirers.push(() => resolve(this.#release.bind(this, state)));\n            });\n        }\n        this.#locked = true;\n        return Promise.resolve(this.#release.bind(this, state));\n    }\n    #release(state) {\n        if (state.resolved) {\n            throw new Error('Cannot release more than once.');\n        }\n        state.resolved = true;\n        const resolve = this.#acquirers.shift();\n        if (!resolve) {\n            this.#locked = false;\n            return;\n        }\n        resolve();\n    }\n    async run(action) {\n        const release = await this.acquire();\n        try {\n            // Note we need to await here because we want the await to release AFTER\n            // that await happens. Returning action() will trigger the release\n            // immediately which is counter to what we want.\n            const result = await action();\n            return result;\n        }\n        finally {\n            release();\n        }\n    }\n}\nexports.Mutex = Mutex;\n//# sourceMappingURL=Mutex.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InputState = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst Mutex_js_1 = require(\"../../../utils/Mutex.js\");\nconst InputSource_js_1 = require(\"./InputSource.js\");\nclass InputState {\n    cancelList = [];\n    #sources = new Map();\n    #mutex = new Mutex_js_1.Mutex();\n    getOrCreate(id, type, subtype) {\n        let source = this.#sources.get(id);\n        if (!source) {\n            switch (type) {\n                case \"none\" /* SourceType.None */:\n                    source = new InputSource_js_1.NoneSource();\n                    break;\n                case \"key\" /* SourceType.Key */:\n                    source = new InputSource_js_1.KeySource();\n                    break;\n                case \"pointer\" /* SourceType.Pointer */: {\n                    let pointerId = subtype === \"mouse\" /* Input.PointerType.Mouse */ ? 0 : 2;\n                    const pointerIds = new Set();\n                    for (const [, source] of this.#sources) {\n                        if (source.type === \"pointer\" /* SourceType.Pointer */) {\n                            pointerIds.add(source.pointerId);\n                        }\n                    }\n                    while (pointerIds.has(pointerId)) {\n                        ++pointerId;\n                    }\n                    source = new InputSource_js_1.PointerSource(pointerId, subtype);\n                    break;\n                }\n                case \"wheel\" /* SourceType.Wheel */:\n                    source = new InputSource_js_1.WheelSource();\n                    break;\n                default:\n                    throw new protocol_js_1.InvalidArgumentException(`Expected \"${\"none\" /* SourceType.None */}\", \"${\"key\" /* SourceType.Key */}\", \"${\"pointer\" /* SourceType.Pointer */}\", or \"${\"wheel\" /* SourceType.Wheel */}\". Found unknown source type ${type}.`);\n            }\n            this.#sources.set(id, source);\n            return source;\n        }\n        if (source.type !== type) {\n            throw new protocol_js_1.InvalidArgumentException(`Input source type of ${id} is ${source.type}, but received ${type}.`);\n        }\n        return source;\n    }\n    get(id) {\n        const source = this.#sources.get(id);\n        if (!source) {\n            throw new protocol_js_1.UnknownErrorException(`Internal error.`);\n        }\n        return source;\n    }\n    getGlobalKeyState() {\n        const state = new InputSource_js_1.KeySource();\n        for (const [, source] of this.#sources) {\n            if (source.type !== \"key\" /* SourceType.Key */) {\n                continue;\n            }\n            for (const pressed of source.pressed) {\n                state.pressed.add(pressed);\n            }\n            state.alt ||= source.alt;\n            state.ctrl ||= source.ctrl;\n            state.meta ||= source.meta;\n            state.shift ||= source.shift;\n        }\n        return state;\n    }\n    get queue() {\n        return this.#mutex;\n    }\n}\nexports.InputState = InputState;\n//# sourceMappingURL=InputState.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InputStateManager = void 0;\nconst assert_js_1 = require(\"../../../utils/assert.js\");\nconst InputState_js_1 = require(\"./InputState.js\");\n// We use a weak map here as specified here:\n// https://www.w3.org/TR/webdriver/#dfn-browsing-context-input-state-map\nclass InputStateManager extends WeakMap {\n    get(context) {\n        (0, assert_js_1.assert)(context.isTopLevelContext());\n        if (!this.has(context)) {\n            this.set(context, new InputState_js_1.InputState());\n        }\n        return super.get(context);\n    }\n}\nexports.InputStateManager = InputStateManager;\n//# sourceMappingURL=InputStateManager.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InputProcessor = void 0;\n/*\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst assert_js_1 = require(\"../../../utils/assert.js\");\nconst ActionDispatcher_js_1 = require(\"../input/ActionDispatcher.js\");\nconst InputStateManager_js_1 = require(\"../input/InputStateManager.js\");\nclass InputProcessor {\n    #browsingContextStorage;\n    #inputStateManager = new InputStateManager_js_1.InputStateManager();\n    constructor(browsingContextStorage) {\n        this.#browsingContextStorage = browsingContextStorage;\n    }\n    async performActions(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        const inputState = this.#inputStateManager.get(context.top);\n        const actionsByTick = this.#getActionsByTick(params, inputState);\n        const dispatcher = new ActionDispatcher_js_1.ActionDispatcher(inputState, this.#browsingContextStorage, params.context, await ActionDispatcher_js_1.ActionDispatcher.isMacOS(context).catch(() => false));\n        await dispatcher.dispatchActions(actionsByTick);\n        return {};\n    }\n    async releaseActions(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        const topContext = context.top;\n        const inputState = this.#inputStateManager.get(topContext);\n        const dispatcher = new ActionDispatcher_js_1.ActionDispatcher(inputState, this.#browsingContextStorage, params.context, await ActionDispatcher_js_1.ActionDispatcher.isMacOS(context).catch(() => false));\n        await dispatcher.dispatchTickActions(inputState.cancelList.reverse());\n        this.#inputStateManager.delete(topContext);\n        return {};\n    }\n    async setFiles(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        const hiddenSandboxRealm = await context.getOrCreateHiddenSandbox();\n        let result;\n        try {\n            result = await hiddenSandboxRealm.callFunction(String(function getFiles(fileListLength) {\n                if (!(this instanceof HTMLInputElement)) {\n                    if (this instanceof Element) {\n                        return 1 /* ErrorCode.Element */;\n                    }\n                    return 0 /* ErrorCode.Node */;\n                }\n                if (this.type !== 'file') {\n                    return 2 /* ErrorCode.Type */;\n                }\n                if (this.disabled) {\n                    return 3 /* ErrorCode.Disabled */;\n                }\n                if (fileListLength > 1 && !this.multiple) {\n                    return 4 /* ErrorCode.Multiple */;\n                }\n                return;\n            }), false, params.element, [{ type: 'number', value: params.files.length }]);\n        }\n        catch {\n            throw new protocol_js_1.NoSuchNodeException(`Could not find element ${params.element.sharedId}`);\n        }\n        (0, assert_js_1.assert)(result.type === 'success');\n        if (result.result.type === 'number') {\n            switch (result.result.value) {\n                case 0 /* ErrorCode.Node */: {\n                    throw new protocol_js_1.NoSuchElementException(`Could not find element ${params.element.sharedId}`);\n                }\n                case 1 /* ErrorCode.Element */: {\n                    throw new protocol_js_1.UnableToSetFileInputException(`Element ${params.element.sharedId} is not a input`);\n                }\n                case 2 /* ErrorCode.Type */: {\n                    throw new protocol_js_1.UnableToSetFileInputException(`Input element ${params.element.sharedId} is not a file type`);\n                }\n                case 3 /* ErrorCode.Disabled */: {\n                    throw new protocol_js_1.UnableToSetFileInputException(`Input element ${params.element.sharedId} is disabled`);\n                }\n                case 4 /* ErrorCode.Multiple */: {\n                    throw new protocol_js_1.UnableToSetFileInputException(`Cannot set multiple files on a non-multiple input element`);\n                }\n            }\n        }\n        /**\n         * The zero-length array is a special case, it seems that\n         * DOM.setFileInputFiles does not actually update the files in that case, so\n         * the solution is to eval the element value to a new FileList directly.\n         */\n        if (params.files.length === 0) {\n            // XXX: These events should converted to trusted events. Perhaps do this\n            // in `DOM.setFileInputFiles`?\n            await hiddenSandboxRealm.callFunction(String(function dispatchEvent() {\n                if (this.files?.length === 0) {\n                    this.dispatchEvent(new Event('cancel', {\n                        bubbles: true,\n                    }));\n                    return;\n                }\n                this.files = new DataTransfer().files;\n                // Dispatch events for this case because it should behave akin to a user action.\n                this.dispatchEvent(new Event('input', { bubbles: true, composed: true }));\n                this.dispatchEvent(new Event('change', { bubbles: true }));\n            }), false, params.element);\n            return {};\n        }\n        // Our goal here is to iterate over the input element files and get their\n        // file paths.\n        const paths = [];\n        for (let i = 0; i < params.files.length; ++i) {\n            const result = await hiddenSandboxRealm.callFunction(String(function getFiles(index) {\n                return this.files?.item(index);\n            }), false, params.element, [{ type: 'number', value: 0 }], \"root\" /* Script.ResultOwnership.Root */);\n            (0, assert_js_1.assert)(result.type === 'success');\n            if (result.result.type !== 'object') {\n                break;\n            }\n            const { handle } = result.result;\n            (0, assert_js_1.assert)(handle !== undefined);\n            const { path } = await hiddenSandboxRealm.cdpClient.sendCommand('DOM.getFileInfo', {\n                objectId: handle,\n            });\n            paths.push(path);\n            // Cleanup the handle.\n            void hiddenSandboxRealm.disown(handle).catch(undefined);\n        }\n        paths.sort();\n        // We create a new array so we preserve the order of the original files.\n        const sortedFiles = [...params.files].sort();\n        if (paths.length !== params.files.length ||\n            sortedFiles.some((path, index) => {\n                return paths[index] !== path;\n            })) {\n            const { objectId } = await hiddenSandboxRealm.deserializeForCdp(params.element);\n            // This cannot throw since this was just used in `callFunction` above.\n            (0, assert_js_1.assert)(objectId !== undefined);\n            await hiddenSandboxRealm.cdpClient.sendCommand('DOM.setFileInputFiles', {\n                files: params.files,\n                objectId,\n            });\n        }\n        else {\n            // XXX: We should dispatch a trusted event.\n            await hiddenSandboxRealm.callFunction(String(function dispatchEvent() {\n                this.dispatchEvent(new Event('cancel', {\n                    bubbles: true,\n                }));\n            }), false, params.element);\n        }\n        return {};\n    }\n    #getActionsByTick(params, inputState) {\n        const actionsByTick = [];\n        for (const action of params.actions) {\n            switch (action.type) {\n                case \"pointer\" /* SourceType.Pointer */: {\n                    action.parameters ??= { pointerType: \"mouse\" /* Input.PointerType.Mouse */ };\n                    action.parameters.pointerType ??= \"mouse\" /* Input.PointerType.Mouse */;\n                    const source = inputState.getOrCreate(action.id, \"pointer\" /* SourceType.Pointer */, action.parameters.pointerType);\n                    if (source.subtype !== action.parameters.pointerType) {\n                        throw new protocol_js_1.InvalidArgumentException(`Expected input source ${action.id} to be ${source.subtype}; got ${action.parameters.pointerType}.`);\n                    }\n                    // https://github.com/GoogleChromeLabs/chromium-bidi/issues/3043\n                    source.resetClickCount();\n                    break;\n                }\n                default:\n                    inputState.getOrCreate(action.id, action.type);\n            }\n            const actions = action.actions.map((item) => ({\n                id: action.id,\n                action: item,\n            }));\n            for (let i = 0; i < actions.length; i++) {\n                if (actionsByTick.length === i) {\n                    actionsByTick.push([]);\n                }\n                actionsByTick[i].push(actions[i]);\n            }\n        }\n        return actionsByTick;\n    }\n}\nexports.InputProcessor = InputProcessor;\n//# sourceMappingURL=InputProcessor.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.base64ToString = base64ToString;\n/**\n * Encodes a string to base64.\n *\n * Uses the native Web API if available, otherwise falls back to a NodeJS Buffer.\n * @param {string} base64Str\n * @return {string}\n */\nfunction base64ToString(base64Str) {\n    // Available only if run in a browser context.\n    if ('atob' in globalThis) {\n        return globalThis.atob(base64Str);\n    }\n    // Available only if run in a NodeJS context.\n    return Buffer.from(base64Str, 'base64').toString('ascii');\n}\n//# sourceMappingURL=base64.js.map","\"use strict\";\n/*\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.computeHeadersSize = computeHeadersSize;\nexports.stringToBase64 = stringToBase64;\nexports.bidiNetworkHeadersFromCdpNetworkHeaders = bidiNetworkHeadersFromCdpNetworkHeaders;\nexports.bidiNetworkHeadersFromCdpNetworkHeadersEntries = bidiNetworkHeadersFromCdpNetworkHeadersEntries;\nexports.cdpNetworkHeadersFromBidiNetworkHeaders = cdpNetworkHeadersFromBidiNetworkHeaders;\nexports.bidiNetworkHeadersFromCdpFetchHeaders = bidiNetworkHeadersFromCdpFetchHeaders;\nexports.cdpFetchHeadersFromBidiNetworkHeaders = cdpFetchHeadersFromBidiNetworkHeaders;\nexports.networkHeaderFromCookieHeaders = networkHeaderFromCookieHeaders;\nexports.cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction = cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction;\nexports.cdpToBiDiCookie = cdpToBiDiCookie;\nexports.deserializeByteValue = deserializeByteValue;\nexports.bidiToCdpCookie = bidiToCdpCookie;\nexports.sameSiteBiDiToCdp = sameSiteBiDiToCdp;\nexports.isSpecialScheme = isSpecialScheme;\nexports.matchUrlPattern = matchUrlPattern;\nexports.bidiBodySizeFromCdpPostDataEntries = bidiBodySizeFromCdpPostDataEntries;\nexports.getTiming = getTiming;\nconst ErrorResponse_js_1 = require(\"../../../protocol/ErrorResponse.js\");\nconst base64_js_1 = require(\"../../../utils/base64.js\");\nfunction computeHeadersSize(headers) {\n    const requestHeaders = headers.reduce((acc, header) => {\n        return `${acc}${header.name}: ${header.value.value}\\r\\n`;\n    }, '');\n    return new TextEncoder().encode(requestHeaders).length;\n}\nfunction stringToBase64(str) {\n    return typedArrayToBase64(new TextEncoder().encode(str));\n}\nfunction typedArrayToBase64(typedArray) {\n    // chunkSize should be less V8 limit on number of arguments!\n    // https://github.com/v8/v8/blob/d3de848bea727518aee94dd2fd42ba0b62037a27/src/objects/code.h#L444\n    const chunkSize = 65534;\n    const chunks = [];\n    for (let i = 0; i < typedArray.length; i += chunkSize) {\n        const chunk = typedArray.subarray(i, i + chunkSize);\n        chunks.push(String.fromCodePoint.apply(null, chunk));\n    }\n    const binaryString = chunks.join('');\n    return btoa(binaryString);\n}\n/** Converts from CDP Network domain headers to BiDi network headers. */\nfunction bidiNetworkHeadersFromCdpNetworkHeaders(headers) {\n    if (!headers) {\n        return [];\n    }\n    return Object.entries(headers).map(([name, value]) => ({\n        name,\n        value: {\n            type: 'string',\n            value,\n        },\n    }));\n}\n/** Converts from CDP Fetch domain headers to BiDi network headers. */\nfunction bidiNetworkHeadersFromCdpNetworkHeadersEntries(headers) {\n    if (!headers) {\n        return [];\n    }\n    return headers.map(({ name, value }) => ({\n        name,\n        value: {\n            type: 'string',\n            value,\n        },\n    }));\n}\n/** Converts from Bidi network headers to CDP Network domain headers. */\nfunction cdpNetworkHeadersFromBidiNetworkHeaders(headers) {\n    if (headers === undefined) {\n        return undefined;\n    }\n    return headers.reduce((result, header) => {\n        // TODO: Distinguish between string and bytes?\n        result[header.name] = header.value.value;\n        return result;\n    }, {});\n}\n/** Converts from CDP Fetch domain header entries to Bidi network headers. */\nfunction bidiNetworkHeadersFromCdpFetchHeaders(headers) {\n    if (!headers) {\n        return [];\n    }\n    return headers.map(({ name, value }) => ({\n        name,\n        value: {\n            type: 'string',\n            value,\n        },\n    }));\n}\n/** Converts from Bidi network headers to CDP Fetch domain header entries. */\nfunction cdpFetchHeadersFromBidiNetworkHeaders(headers) {\n    if (headers === undefined) {\n        return undefined;\n    }\n    return headers.map(({ name, value }) => ({\n        name,\n        value: value.value,\n    }));\n}\nfunction networkHeaderFromCookieHeaders(headers) {\n    if (headers === undefined) {\n        return undefined;\n    }\n    const value = headers.reduce((acc, value, index) => {\n        if (index > 0) {\n            acc += ';';\n        }\n        const cookieValue = value.value.type === 'base64'\n            ? btoa(value.value.value)\n            : value.value.value;\n        acc += `${value.name}=${cookieValue}`;\n        return acc;\n    }, '');\n    return {\n        name: 'Cookie',\n        value: {\n            type: 'string',\n            value,\n        },\n    };\n}\n/** Converts from Bidi auth action to CDP auth challenge response. */\nfunction cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction(action) {\n    switch (action) {\n        case 'default':\n            return 'Default';\n        case 'cancel':\n            return 'CancelAuth';\n        case 'provideCredentials':\n            return 'ProvideCredentials';\n    }\n}\n/**\n * Converts from CDP Network domain cookie to BiDi network cookie.\n * * https://chromedevtools.github.io/devtools-protocol/tot/Network/#type-Cookie\n * * https://w3c.github.io/webdriver-bidi/#type-network-Cookie\n */\nfunction cdpToBiDiCookie(cookie) {\n    const result = {\n        name: cookie.name,\n        value: { type: 'string', value: cookie.value },\n        domain: cookie.domain,\n        path: cookie.path,\n        size: cookie.size,\n        httpOnly: cookie.httpOnly,\n        secure: cookie.secure,\n        sameSite: cookie.sameSite === undefined\n            ? \"none\" /* Network.SameSite.None */\n            : sameSiteCdpToBiDi(cookie.sameSite),\n        ...(cookie.expires >= 0 ? { expiry: cookie.expires } : undefined),\n    };\n    // Extending with CDP-specific properties with `goog:` prefix.\n    result[`goog:session`] = cookie.session;\n    result[`goog:priority`] = cookie.priority;\n    result[`goog:sameParty`] = cookie.sameParty;\n    result[`goog:sourceScheme`] = cookie.sourceScheme;\n    result[`goog:sourcePort`] = cookie.sourcePort;\n    if (cookie.partitionKey !== undefined) {\n        result[`goog:partitionKey`] = cookie.partitionKey;\n    }\n    if (cookie.partitionKeyOpaque !== undefined) {\n        result[`goog:partitionKeyOpaque`] = cookie.partitionKeyOpaque;\n    }\n    return result;\n}\n/**\n * Decodes a byte value to a string.\n * @param {Network.BytesValue} value\n * @return {string}\n */\nfunction deserializeByteValue(value) {\n    if (value.type === 'base64') {\n        return (0, base64_js_1.base64ToString)(value.value);\n    }\n    return value.value;\n}\n/**\n * Converts from BiDi set network cookie params to CDP Network domain cookie.\n * * https://w3c.github.io/webdriver-bidi/#type-network-Cookie\n * * https://chromedevtools.github.io/devtools-protocol/tot/Network/#type-CookieParam\n */\nfunction bidiToCdpCookie(params, partitionKey) {\n    const deserializedValue = deserializeByteValue(params.cookie.value);\n    const result = {\n        name: params.cookie.name,\n        value: deserializedValue,\n        domain: params.cookie.domain,\n        path: params.cookie.path ?? '/',\n        secure: params.cookie.secure ?? false,\n        httpOnly: params.cookie.httpOnly ?? false,\n        ...(partitionKey.sourceOrigin !== undefined && {\n            partitionKey: {\n                hasCrossSiteAncestor: false,\n                // CDP's `partitionKey.topLevelSite` is the BiDi's `partition.sourceOrigin`.\n                topLevelSite: partitionKey.sourceOrigin,\n            },\n        }),\n        ...(params.cookie.expiry !== undefined && {\n            expires: params.cookie.expiry,\n        }),\n        ...(params.cookie.sameSite !== undefined && {\n            sameSite: sameSiteBiDiToCdp(params.cookie.sameSite),\n        }),\n    };\n    // Extending with CDP-specific properties with `goog:` prefix.\n    if (params.cookie[`goog:url`] !== undefined) {\n        result.url = params.cookie[`goog:url`];\n    }\n    if (params.cookie[`goog:priority`] !== undefined) {\n        result.priority = params.cookie[`goog:priority`];\n    }\n    if (params.cookie[`goog:sameParty`] !== undefined) {\n        result.sameParty = params.cookie[`goog:sameParty`];\n    }\n    if (params.cookie[`goog:sourceScheme`] !== undefined) {\n        result.sourceScheme = params.cookie[`goog:sourceScheme`];\n    }\n    if (params.cookie[`goog:sourcePort`] !== undefined) {\n        result.sourcePort = params.cookie[`goog:sourcePort`];\n    }\n    return result;\n}\nfunction sameSiteCdpToBiDi(sameSite) {\n    switch (sameSite) {\n        case 'Strict':\n            return \"strict\" /* Network.SameSite.Strict */;\n        case 'None':\n            return \"none\" /* Network.SameSite.None */;\n        case 'Lax':\n            return \"lax\" /* Network.SameSite.Lax */;\n        default:\n            // Defaults to `Lax`:\n            // https://web.dev/articles/samesite-cookies-explained#samesitelax_by_default\n            return \"lax\" /* Network.SameSite.Lax */;\n    }\n}\nfunction sameSiteBiDiToCdp(sameSite) {\n    switch (sameSite) {\n        case \"none\" /* Network.SameSite.None */:\n            return 'None';\n        case \"strict\" /* Network.SameSite.Strict */:\n            return 'Strict';\n        // Defaults to `Lax`:\n        // https://web.dev/articles/samesite-cookies-explained#samesitelax_by_default\n        case \"default\" /* Network.SameSite.Default */:\n        case \"lax\" /* Network.SameSite.Lax */:\n            return 'Lax';\n    }\n    throw new ErrorResponse_js_1.InvalidArgumentException(`Unknown 'sameSite' value ${sameSite}`);\n}\n/**\n * Returns true if the given protocol is special.\n * Special protocols are those that have a default port.\n *\n * Example inputs: 'http', 'http:'\n *\n * @see https://url.spec.whatwg.org/#special-scheme\n */\nfunction isSpecialScheme(protocol) {\n    return ['ftp', 'file', 'http', 'https', 'ws', 'wss'].includes(protocol.replace(/:$/, ''));\n}\nfunction getScheme(url) {\n    return url.protocol.replace(/:$/, '');\n}\n/** Matches the given URLPattern against the given URL. */\nfunction matchUrlPattern(pattern, url) {\n    // Roughly https://w3c.github.io/webdriver-bidi/#match-url-pattern\n    // plus some differences based on the URL parsing methods.\n    const parsedUrl = new URL(url);\n    if (pattern.protocol !== undefined &&\n        pattern.protocol !== getScheme(parsedUrl)) {\n        return false;\n    }\n    if (pattern.hostname !== undefined &&\n        pattern.hostname !== parsedUrl.hostname) {\n        return false;\n    }\n    if (pattern.port !== undefined && pattern.port !== parsedUrl.port) {\n        return false;\n    }\n    if (pattern.pathname !== undefined &&\n        pattern.pathname !== parsedUrl.pathname) {\n        return false;\n    }\n    if (pattern.search !== undefined && pattern.search !== parsedUrl.search) {\n        return false;\n    }\n    return true;\n}\nfunction bidiBodySizeFromCdpPostDataEntries(entries) {\n    let size = 0;\n    for (const entry of entries) {\n        size += atob(entry.bytes ?? '').length;\n    }\n    return size;\n}\nfunction getTiming(timing, offset = 0) {\n    if (!timing) {\n        return 0;\n    }\n    if (timing <= 0 || timing + offset <= 0) {\n        return 0;\n    }\n    return timing + offset;\n}\n//# sourceMappingURL=NetworkUtils.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NetworkProcessor = void 0;\nexports.parseBiDiHeaders = parseBiDiHeaders;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst NetworkUtils_js_1 = require(\"./NetworkUtils.js\");\n/** Dispatches Network module commands. */\nclass NetworkProcessor {\n    #browsingContextStorage;\n    #networkStorage;\n    #userContextStorage;\n    #contextConfigStorage;\n    constructor(browsingContextStorage, networkStorage, userContextStorage, contextConfigStorage) {\n        this.#userContextStorage = userContextStorage;\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#networkStorage = networkStorage;\n        this.#contextConfigStorage = contextConfigStorage;\n    }\n    async addIntercept(params) {\n        this.#browsingContextStorage.verifyTopLevelContextsList(params.contexts);\n        const urlPatterns = params.urlPatterns ?? [];\n        const parsedUrlPatterns = NetworkProcessor.parseUrlPatterns(urlPatterns);\n        const intercept = this.#networkStorage.addIntercept({\n            urlPatterns: parsedUrlPatterns,\n            phases: params.phases,\n            contexts: params.contexts,\n        });\n        // Adding interception may require enabling CDP Network domains.\n        await this.#toggleNetwork();\n        return {\n            intercept,\n        };\n    }\n    async continueRequest(params) {\n        if (params.url !== undefined) {\n            NetworkProcessor.parseUrlString(params.url);\n        }\n        if (params.method !== undefined) {\n            if (!NetworkProcessor.isMethodValid(params.method)) {\n                throw new protocol_js_1.InvalidArgumentException(`Method '${params.method}' is invalid.`);\n            }\n        }\n        if (params.headers) {\n            NetworkProcessor.validateHeaders(params.headers);\n        }\n        const request = this.#getBlockedRequestOrFail(params.request, [\n            \"beforeRequestSent\" /* Network.InterceptPhase.BeforeRequestSent */,\n        ]);\n        try {\n            await request.continueRequest(params);\n        }\n        catch (error) {\n            throw NetworkProcessor.wrapInterceptionError(error);\n        }\n        return {};\n    }\n    async continueResponse(params) {\n        if (params.headers) {\n            NetworkProcessor.validateHeaders(params.headers);\n        }\n        const request = this.#getBlockedRequestOrFail(params.request, [\n            \"authRequired\" /* Network.InterceptPhase.AuthRequired */,\n            \"responseStarted\" /* Network.InterceptPhase.ResponseStarted */,\n        ]);\n        try {\n            await request.continueResponse(params);\n        }\n        catch (error) {\n            throw NetworkProcessor.wrapInterceptionError(error);\n        }\n        return {};\n    }\n    async continueWithAuth(params) {\n        const networkId = params.request;\n        const request = this.#getBlockedRequestOrFail(networkId, [\n            \"authRequired\" /* Network.InterceptPhase.AuthRequired */,\n        ]);\n        await request.continueWithAuth(params);\n        return {};\n    }\n    async failRequest({ request: networkId, }) {\n        const request = this.#getRequestOrFail(networkId);\n        if (request.interceptPhase === \"authRequired\" /* Network.InterceptPhase.AuthRequired */) {\n            throw new protocol_js_1.InvalidArgumentException(`Request '${networkId}' in 'authRequired' phase cannot be failed`);\n        }\n        if (!request.interceptPhase) {\n            throw new protocol_js_1.NoSuchRequestException(`No blocked request found for network id '${networkId}'`);\n        }\n        await request.failRequest('Failed');\n        return {};\n    }\n    async provideResponse(params) {\n        if (params.headers) {\n            NetworkProcessor.validateHeaders(params.headers);\n        }\n        const request = this.#getBlockedRequestOrFail(params.request, [\n            \"beforeRequestSent\" /* Network.InterceptPhase.BeforeRequestSent */,\n            \"responseStarted\" /* Network.InterceptPhase.ResponseStarted */,\n            \"authRequired\" /* Network.InterceptPhase.AuthRequired */,\n        ]);\n        try {\n            await request.provideResponse(params);\n        }\n        catch (error) {\n            throw NetworkProcessor.wrapInterceptionError(error);\n        }\n        return {};\n    }\n    /**\n     * In some states CDP Network and Fetch domains are not required, but in some they have\n     * to be updated. Whenever potential change in these kinds of states is introduced,\n     * update the states of all the CDP targets.\n     */\n    async #toggleNetwork() {\n        await Promise.all(this.#browsingContextStorage.getAllContexts().map((context) => {\n            return context.cdpTarget.toggleNetwork();\n        }));\n    }\n    async removeIntercept(params) {\n        this.#networkStorage.removeIntercept(params.intercept);\n        // Removing interception may allow for disabling CDP Network domains.\n        await this.#toggleNetwork();\n        return {};\n    }\n    async setCacheBehavior(params) {\n        const contexts = this.#browsingContextStorage.verifyTopLevelContextsList(params.contexts);\n        // Change all targets\n        if (contexts.size === 0) {\n            this.#networkStorage.defaultCacheBehavior = params.cacheBehavior;\n            await Promise.all(this.#browsingContextStorage.getAllContexts().map((context) => {\n                return context.cdpTarget.toggleSetCacheDisabled();\n            }));\n            return {};\n        }\n        const cacheDisabled = params.cacheBehavior === 'bypass';\n        await Promise.all([...contexts.values()].map((context) => {\n            return context.cdpTarget.toggleSetCacheDisabled(cacheDisabled);\n        }));\n        return {};\n    }\n    #getRequestOrFail(id) {\n        const request = this.#networkStorage.getRequestById(id);\n        if (!request) {\n            throw new protocol_js_1.NoSuchRequestException(`Network request with ID '${id}' doesn't exist`);\n        }\n        return request;\n    }\n    #getBlockedRequestOrFail(id, phases) {\n        const request = this.#getRequestOrFail(id);\n        if (!request.interceptPhase) {\n            throw new protocol_js_1.NoSuchRequestException(`No blocked request found for network id '${id}'`);\n        }\n        if (request.interceptPhase && !phases.includes(request.interceptPhase)) {\n            throw new protocol_js_1.InvalidArgumentException(`Blocked request for network id '${id}' is in '${request.interceptPhase}' phase`);\n        }\n        return request;\n    }\n    /**\n     * Validate https://fetch.spec.whatwg.org/#header-value\n     */\n    static validateHeaders(headers) {\n        for (const header of headers) {\n            let headerValue;\n            if (header.value.type === 'string') {\n                headerValue = header.value.value;\n            }\n            else {\n                headerValue = atob(header.value.value);\n            }\n            if (headerValue !== headerValue.trim() ||\n                headerValue.includes('\\n') ||\n                headerValue.includes('\\0')) {\n                throw new protocol_js_1.InvalidArgumentException(`Header value '${headerValue}' is not acceptable value`);\n            }\n        }\n    }\n    static isMethodValid(method) {\n        // https://httpwg.org/specs/rfc9110.html#method.overview\n        return /^[!#$%&'*+\\-.^_`|~a-zA-Z\\d]+$/.test(method);\n    }\n    /**\n     * Attempts to parse the given url.\n     * Throws an InvalidArgumentException if the url is invalid.\n     */\n    static parseUrlString(url) {\n        try {\n            return new URL(url);\n        }\n        catch (error) {\n            throw new protocol_js_1.InvalidArgumentException(`Invalid URL '${url}': ${error}`);\n        }\n    }\n    static parseUrlPatterns(urlPatterns) {\n        return urlPatterns.map((urlPattern) => {\n            let patternUrl = '';\n            let hasProtocol = true;\n            let hasHostname = true;\n            let hasPort = true;\n            let hasPathname = true;\n            let hasSearch = true;\n            switch (urlPattern.type) {\n                case 'string': {\n                    patternUrl = unescapeURLPattern(urlPattern.pattern);\n                    break;\n                }\n                case 'pattern': {\n                    if (urlPattern.protocol === undefined) {\n                        hasProtocol = false;\n                        patternUrl += 'http';\n                    }\n                    else {\n                        if (urlPattern.protocol === '') {\n                            throw new protocol_js_1.InvalidArgumentException('URL pattern must specify a protocol');\n                        }\n                        urlPattern.protocol = unescapeURLPattern(urlPattern.protocol);\n                        if (!urlPattern.protocol.match(/^[a-zA-Z+-.]+$/)) {\n                            throw new protocol_js_1.InvalidArgumentException('Forbidden characters');\n                        }\n                        patternUrl += urlPattern.protocol;\n                    }\n                    const scheme = patternUrl.toLocaleLowerCase();\n                    patternUrl += ':';\n                    if ((0, NetworkUtils_js_1.isSpecialScheme)(scheme)) {\n                        patternUrl += '//';\n                    }\n                    if (urlPattern.hostname === undefined) {\n                        if (scheme !== 'file') {\n                            patternUrl += 'placeholder';\n                        }\n                        hasHostname = false;\n                    }\n                    else {\n                        if (urlPattern.hostname === '') {\n                            throw new protocol_js_1.InvalidArgumentException('URL pattern must specify a hostname');\n                        }\n                        if (urlPattern.protocol === 'file') {\n                            throw new protocol_js_1.InvalidArgumentException(`URL pattern protocol cannot be 'file'`);\n                        }\n                        urlPattern.hostname = unescapeURLPattern(urlPattern.hostname);\n                        let insideBrackets = false;\n                        for (const c of urlPattern.hostname) {\n                            if (c === '/' || c === '?' || c === '#') {\n                                throw new protocol_js_1.InvalidArgumentException(`'/', '?', '#' are forbidden in hostname`);\n                            }\n                            if (!insideBrackets && c === ':') {\n                                throw new protocol_js_1.InvalidArgumentException(`':' is only allowed inside brackets in hostname`);\n                            }\n                            if (c === '[') {\n                                insideBrackets = true;\n                            }\n                            if (c === ']') {\n                                insideBrackets = false;\n                            }\n                        }\n                        patternUrl += urlPattern.hostname;\n                    }\n                    if (urlPattern.port === undefined) {\n                        hasPort = false;\n                    }\n                    else {\n                        if (urlPattern.port === '') {\n                            throw new protocol_js_1.InvalidArgumentException(`URL pattern must specify a port`);\n                        }\n                        urlPattern.port = unescapeURLPattern(urlPattern.port);\n                        patternUrl += ':';\n                        if (!urlPattern.port.match(/^\\d+$/)) {\n                            throw new protocol_js_1.InvalidArgumentException('Forbidden characters');\n                        }\n                        patternUrl += urlPattern.port;\n                    }\n                    if (urlPattern.pathname === undefined) {\n                        hasPathname = false;\n                    }\n                    else {\n                        urlPattern.pathname = unescapeURLPattern(urlPattern.pathname);\n                        if (urlPattern.pathname[0] !== '/') {\n                            patternUrl += '/';\n                        }\n                        if (urlPattern.pathname.includes('#') ||\n                            urlPattern.pathname.includes('?')) {\n                            throw new protocol_js_1.InvalidArgumentException('Forbidden characters');\n                        }\n                        patternUrl += urlPattern.pathname;\n                    }\n                    if (urlPattern.search === undefined) {\n                        hasSearch = false;\n                    }\n                    else {\n                        urlPattern.search = unescapeURLPattern(urlPattern.search);\n                        if (urlPattern.search[0] !== '?') {\n                            patternUrl += '?';\n                        }\n                        if (urlPattern.search.includes('#')) {\n                            throw new protocol_js_1.InvalidArgumentException('Forbidden characters');\n                        }\n                        patternUrl += urlPattern.search;\n                    }\n                    break;\n                }\n            }\n            const serializePort = (url) => {\n                const defaultPorts = {\n                    'ftp:': 21,\n                    'file:': null,\n                    'http:': 80,\n                    'https:': 443,\n                    'ws:': 80,\n                    'wss:': 443,\n                };\n                if ((0, NetworkUtils_js_1.isSpecialScheme)(url.protocol) &&\n                    defaultPorts[url.protocol] !== null &&\n                    (!url.port || String(defaultPorts[url.protocol]) === url.port)) {\n                    return '';\n                }\n                else if (url.port) {\n                    return url.port;\n                }\n                return undefined;\n            };\n            try {\n                const url = new URL(patternUrl);\n                return {\n                    protocol: hasProtocol ? url.protocol.replace(/:$/, '') : undefined,\n                    hostname: hasHostname ? url.hostname : undefined,\n                    port: hasPort ? serializePort(url) : undefined,\n                    pathname: hasPathname && url.pathname ? url.pathname : undefined,\n                    search: hasSearch ? url.search : undefined,\n                };\n            }\n            catch (err) {\n                throw new protocol_js_1.InvalidArgumentException(`${err.message} '${patternUrl}'`);\n            }\n        });\n    }\n    static wrapInterceptionError(error) {\n        // https://source.chromium.org/chromium/chromium/src/+/main:content/browser/devtools/protocol/fetch_handler.cc;l=169\n        if (error?.message.includes('Invalid header') ||\n            error?.message.includes('Unsafe header')) {\n            return new protocol_js_1.InvalidArgumentException(error.message);\n        }\n        return error;\n    }\n    async addDataCollector(params) {\n        if (params.userContexts !== undefined && params.contexts !== undefined) {\n            throw new protocol_js_1.InvalidArgumentException(\"'contexts' and 'userContexts' are mutually exclusive\");\n        }\n        if (params.userContexts !== undefined) {\n            // Assert the user contexts exist.\n            await this.#userContextStorage.verifyUserContextIdList(params.userContexts);\n        }\n        if (params.contexts !== undefined) {\n            for (const browsingContextId of params.contexts) {\n                // Assert the browsing context exists and are top-level.\n                const browsingContext = this.#browsingContextStorage.getContext(browsingContextId);\n                if (!browsingContext.isTopLevelContext()) {\n                    throw new protocol_js_1.InvalidArgumentException(`Data collectors are available only on top-level browsing contexts`);\n                }\n            }\n        }\n        const collectorId = this.#networkStorage.addDataCollector(params);\n        // Adding data collectors may require enabling CDP Network domains.\n        await this.#toggleNetwork();\n        return { collector: collectorId };\n    }\n    async getData(params) {\n        return await this.#networkStorage.getCollectedData(params);\n    }\n    async removeDataCollector(params) {\n        this.#networkStorage.removeDataCollector(params);\n        // Removing data collectors may allow disabling CDP Network domains.\n        await this.#toggleNetwork();\n        return {};\n    }\n    disownData(params) {\n        this.#networkStorage.disownData(params);\n        return {};\n    }\n    async #getRelatedTopLevelBrowsingContexts(browsingContextIds, userContextIds) {\n        // Duplicated with EmulationProcessor logic. Consider moving to ConfigStorage.\n        if (browsingContextIds === undefined && userContextIds === undefined) {\n            return this.#browsingContextStorage.getTopLevelContexts();\n        }\n        if (browsingContextIds !== undefined && userContextIds !== undefined) {\n            throw new protocol_js_1.InvalidArgumentException('User contexts and browsing contexts are mutually exclusive');\n        }\n        const result = [];\n        if (userContextIds !== undefined) {\n            if (userContextIds.length === 0) {\n                throw new protocol_js_1.InvalidArgumentException('user context should be provided');\n            }\n            // Verify that all user contexts exist.\n            await this.#userContextStorage.verifyUserContextIdList(userContextIds);\n            for (const userContextId of userContextIds) {\n                const topLevelBrowsingContexts = this.#browsingContextStorage\n                    .getTopLevelContexts()\n                    .filter((browsingContext) => browsingContext.userContext === userContextId);\n                result.push(...topLevelBrowsingContexts);\n            }\n        }\n        if (browsingContextIds !== undefined) {\n            if (browsingContextIds.length === 0) {\n                throw new protocol_js_1.InvalidArgumentException('browsing context should be provided');\n            }\n            for (const browsingContextId of browsingContextIds) {\n                const browsingContext = this.#browsingContextStorage.getContext(browsingContextId);\n                if (!browsingContext.isTopLevelContext()) {\n                    throw new protocol_js_1.InvalidArgumentException('The command is only supported on the top-level context');\n                }\n                result.push(browsingContext);\n            }\n        }\n        // Remove duplicates. Compare `BrowsingContextImpl` by reference is correct here, as\n        // `browsingContextStorage` returns the same instance for the same id.\n        return [...new Set(result).values()];\n    }\n    async setExtraHeaders(params) {\n        const affectedBrowsingContexts = await this.#getRelatedTopLevelBrowsingContexts(params.contexts, params.userContexts);\n        const cdpExtraHeaders = parseBiDiHeaders(params.headers);\n        if (params.userContexts === undefined && params.contexts === undefined) {\n            this.#contextConfigStorage.updateGlobalConfig({\n                extraHeaders: cdpExtraHeaders,\n            });\n        }\n        if (params.userContexts !== undefined) {\n            params.userContexts.forEach((userContext) => {\n                this.#contextConfigStorage.updateUserContextConfig(userContext, {\n                    extraHeaders: cdpExtraHeaders,\n                });\n            });\n        }\n        if (params.contexts !== undefined) {\n            params.contexts.forEach((browsingContextId) => {\n                this.#contextConfigStorage.updateBrowsingContextConfig(browsingContextId, { extraHeaders: cdpExtraHeaders });\n            });\n        }\n        await Promise.all(affectedBrowsingContexts.map(async (context) => {\n            // Actual value can be different from the one in params, e.g. in case of already\n            // existing setting.\n            const extraHeaders = this.#contextConfigStorage.getActiveConfig(context.id, context.userContext).extraHeaders ?? {};\n            await context.setExtraHeaders(extraHeaders);\n        }));\n        return {};\n    }\n}\nexports.NetworkProcessor = NetworkProcessor;\n/**\n * See https://w3c.github.io/webdriver-bidi/#unescape-url-pattern\n */\nfunction unescapeURLPattern(pattern) {\n    const forbidden = new Set(['(', ')', '*', '{', '}']);\n    let result = '';\n    let isEscaped = false;\n    for (const c of pattern) {\n        if (!isEscaped) {\n            if (forbidden.has(c)) {\n                throw new protocol_js_1.InvalidArgumentException('Forbidden characters');\n            }\n            if (c === '\\\\') {\n                isEscaped = true;\n                continue;\n            }\n        }\n        result += c;\n        isEscaped = false;\n    }\n    return result;\n}\n// https://fetch.spec.whatwg.org/#header-name\nconst FORBIDDEN_HEADER_NAME_SYMBOLS = new Set([\n    ' ',\n    '\\t',\n    '\\n',\n    '\"',\n    '(',\n    ')',\n    ',',\n    '/',\n    ':',\n    ';',\n    '<',\n    '=',\n    '>',\n    '?',\n    '@',\n    '[',\n    '\\\\',\n    ']',\n    '{',\n    '}',\n]);\n// https://fetch.spec.whatwg.org/#header-value\nconst FORBIDDEN_HEADER_VALUE_SYMBOLS = new Set(['\\0', '\\n', '\\r']);\nfunction includesChar(str, chars) {\n    for (const char of str) {\n        if (chars.has(char)) {\n            return true;\n        }\n    }\n    return false;\n}\n// Export for testing.\nfunction parseBiDiHeaders(headers) {\n    const parsedHeaders = {};\n    for (const bidiHeader of headers) {\n        if (bidiHeader.value.type === 'string') {\n            const name = bidiHeader.name;\n            const value = bidiHeader.value.value;\n            if (name.length === 0) {\n                throw new protocol_js_1.InvalidArgumentException(`Empty header name is not allowed`);\n            }\n            if (includesChar(name, FORBIDDEN_HEADER_NAME_SYMBOLS)) {\n                throw new protocol_js_1.InvalidArgumentException(`Header name '${name}' contains forbidden symbols`);\n            }\n            if (includesChar(value, FORBIDDEN_HEADER_VALUE_SYMBOLS)) {\n                throw new protocol_js_1.InvalidArgumentException(`Header value '${value}' contains forbidden symbols`);\n            }\n            if (value.trim() !== value) {\n                throw new protocol_js_1.InvalidArgumentException(`Header value should not contain trailing or ending whitespaces`);\n            }\n            // BiDi spec does not combine but overrides the headers with the same names.\n            // https://www.w3.org/TR/webdriver-bidi/#update-headers\n            parsedHeaders[bidiHeader.name] = bidiHeader.value.value;\n        }\n        else {\n            throw new protocol_js_1.UnsupportedOperationException('Only string headers values are supported');\n        }\n    }\n    return parsedHeaders;\n}\n//# sourceMappingURL=NetworkProcessor.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PermissionsProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nclass PermissionsProcessor {\n    #browserCdpClient;\n    constructor(browserCdpClient) {\n        this.#browserCdpClient = browserCdpClient;\n    }\n    async setPermissions(params) {\n        try {\n            const userContextId = params['goog:userContext'] ||\n                params.userContext;\n            await this.#browserCdpClient.sendCommand('Browser.setPermission', {\n                origin: params.origin,\n                embeddedOrigin: params.embeddedOrigin,\n                browserContextId: userContextId && userContextId !== 'default'\n                    ? userContextId\n                    : undefined,\n                permission: {\n                    name: params.descriptor.name,\n                },\n                setting: params.state,\n            });\n        }\n        catch (err) {\n            if (err.message ===\n                `Permission can't be granted to opaque origins.`) {\n                // Return success if the origin is not valid (does not match any\n                // existing origins).\n                return {};\n            }\n            throw new protocol_js_1.InvalidArgumentException(err.message);\n        }\n        return {};\n    }\n}\nexports.PermissionsProcessor = PermissionsProcessor;\n//# sourceMappingURL=PermissionsProcessor.js.map","export default {}","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uuidv4 = uuidv4;\nfunction bytesToHex(bytes) {\n    return bytes.reduce((str, byte) => str + byte.toString(16).padStart(2, '0'), '');\n}\n/**\n * Generates a random v4 UUID, as specified in RFC4122.\n *\n * Uses the native Web Crypto API if available, otherwise falls back to a\n * polyfill.\n *\n * Example: '9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d'\n */\nfunction uuidv4() {\n    // Available only in secure contexts\n    // https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API\n    if ('crypto' in globalThis && 'randomUUID' in globalThis.crypto) {\n        // Node with\n        // https://nodejs.org/dist/latest-v20.x/docs/api/globals.html#crypto_1 or\n        // secure browser context.\n        return globalThis.crypto.randomUUID();\n    }\n    const randomValues = new Uint8Array(16);\n    if ('crypto' in globalThis && 'getRandomValues' in globalThis.crypto) {\n        // Node (>=18) with\n        // https://nodejs.org/dist/latest-v20.x/docs/api/globals.html#crypto_1 or\n        // browser.\n        globalThis.crypto.getRandomValues(randomValues);\n    }\n    else {\n        // Node (<=16) without\n        // https://nodejs.org/dist/latest-v20.x/docs/api/globals.html#crypto_1.\n        // eslint-disable-next-line @typescript-eslint/no-require-imports\n        require('crypto').webcrypto.getRandomValues(randomValues);\n    }\n    // Set version (4) and variant (RFC4122) bits.\n    randomValues[6] = (randomValues[6] & 0x0f) | 0x40;\n    randomValues[8] = (randomValues[8] & 0x3f) | 0x80;\n    return [\n        bytesToHex(randomValues.subarray(0, 4)),\n        bytesToHex(randomValues.subarray(4, 6)),\n        bytesToHex(randomValues.subarray(6, 8)),\n        bytesToHex(randomValues.subarray(8, 10)),\n        bytesToHex(randomValues.subarray(10, 16)),\n    ].join('-');\n}\n//# sourceMappingURL=uuid.js.map","\"use strict\";\n/*\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ChannelProxy = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\n/**\n * Used to send messages from realm to BiDi user.\n */\nclass ChannelProxy {\n    #properties;\n    #id = (0, uuid_js_1.uuidv4)();\n    #logger;\n    constructor(channel, logger) {\n        this.#properties = channel;\n        this.#logger = logger;\n    }\n    /**\n     * Creates a channel proxy in the given realm, initialises listener and\n     * returns a handle to `sendMessage` delegate.\n     */\n    async init(realm, eventManager) {\n        const channelHandle = await ChannelProxy.#createAndGetHandleInRealm(realm);\n        const sendMessageHandle = await ChannelProxy.#createSendMessageHandle(realm, channelHandle);\n        void this.#startListener(realm, channelHandle, eventManager);\n        return sendMessageHandle;\n    }\n    /** Gets a ChannelProxy from window and returns its handle. */\n    async startListenerFromWindow(realm, eventManager) {\n        try {\n            const channelHandle = await this.#getHandleFromWindow(realm);\n            void this.#startListener(realm, channelHandle, eventManager);\n        }\n        catch (error) {\n            this.#logger?.(log_js_1.LogType.debugError, error);\n        }\n    }\n    /**\n     * Evaluation string which creates a ChannelProxy object on the client side.\n     */\n    static #createChannelProxyEvalStr() {\n        const functionStr = String(() => {\n            const queue = [];\n            let queueNonEmptyResolver = null;\n            return {\n                /**\n                 * Gets a promise, which is resolved as soon as a message occurs\n                 * in the queue.\n                 */\n                async getMessage() {\n                    const onMessage = queue.length > 0\n                        ? Promise.resolve()\n                        : new Promise((resolve) => {\n                            queueNonEmptyResolver = resolve;\n                        });\n                    await onMessage;\n                    return queue.shift();\n                },\n                /**\n                 * Adds a message to the queue.\n                 * Resolves the pending promise if needed.\n                 */\n                sendMessage(message) {\n                    queue.push(message);\n                    if (queueNonEmptyResolver !== null) {\n                        queueNonEmptyResolver();\n                        queueNonEmptyResolver = null;\n                    }\n                },\n            };\n        });\n        return `(${functionStr})()`;\n    }\n    /** Creates a ChannelProxy in the given realm. */\n    static async #createAndGetHandleInRealm(realm) {\n        const createChannelHandleResult = await realm.cdpClient.sendCommand('Runtime.evaluate', {\n            expression: this.#createChannelProxyEvalStr(),\n            contextId: realm.executionContextId,\n            serializationOptions: {\n                serialization: \"idOnly\" /* Protocol.Runtime.SerializationOptionsSerialization.IdOnly */,\n            },\n        });\n        if (createChannelHandleResult.exceptionDetails ||\n            createChannelHandleResult.result.objectId === undefined) {\n            throw new Error(`Cannot create channel`);\n        }\n        return createChannelHandleResult.result.objectId;\n    }\n    /** Gets a handle to `sendMessage` delegate from the ChannelProxy handle. */\n    static async #createSendMessageHandle(realm, channelHandle) {\n        const sendMessageArgResult = await realm.cdpClient.sendCommand('Runtime.callFunctionOn', {\n            functionDeclaration: String((channelHandle) => {\n                return channelHandle.sendMessage;\n            }),\n            arguments: [{ objectId: channelHandle }],\n            executionContextId: realm.executionContextId,\n            serializationOptions: {\n                serialization: \"idOnly\" /* Protocol.Runtime.SerializationOptionsSerialization.IdOnly */,\n            },\n        });\n        // TODO: check for exceptionDetails.\n        return sendMessageArgResult.result.objectId;\n    }\n    /** Starts listening for the channel events of the provided ChannelProxy. */\n    async #startListener(realm, channelHandle, eventManager) {\n        // noinspection InfiniteLoopJS\n        for (;;) {\n            try {\n                const message = await realm.cdpClient.sendCommand('Runtime.callFunctionOn', {\n                    functionDeclaration: String(async (channelHandle) => await channelHandle.getMessage()),\n                    arguments: [\n                        {\n                            objectId: channelHandle,\n                        },\n                    ],\n                    awaitPromise: true,\n                    executionContextId: realm.executionContextId,\n                    serializationOptions: {\n                        serialization: \"deep\" /* Protocol.Runtime.SerializationOptionsSerialization.Deep */,\n                        maxDepth: this.#properties.serializationOptions?.maxObjectDepth ??\n                            undefined,\n                    },\n                });\n                if (message.exceptionDetails) {\n                    throw new Error('Runtime.callFunctionOn in ChannelProxy', {\n                        cause: message.exceptionDetails,\n                    });\n                }\n                for (const browsingContext of realm.associatedBrowsingContexts) {\n                    eventManager.registerEvent({\n                        type: 'event',\n                        method: protocol_js_1.ChromiumBidi.Script.EventNames.Message,\n                        params: {\n                            channel: this.#properties.channel,\n                            data: realm.cdpToBidiValue(message, this.#properties.ownership ?? \"none\" /* Script.ResultOwnership.None */),\n                            source: realm.source,\n                        },\n                    }, browsingContext.id);\n                }\n            }\n            catch (error) {\n                // If an error is thrown, then the channel is permanently broken, so we\n                // exit the loop.\n                this.#logger?.(log_js_1.LogType.debugError, error);\n                break;\n            }\n        }\n    }\n    /**\n     * Returns a handle of ChannelProxy from window's property which was set there\n     * by `getEvalInWindowStr`. If window property is not set yet, sets a promise\n     * resolver to the window property, so that `getEvalInWindowStr` can resolve\n     * the promise later on with the channel.\n     * This is needed because `getEvalInWindowStr` can be called before or\n     * after this method.\n     */\n    async #getHandleFromWindow(realm) {\n        const channelHandleResult = await realm.cdpClient.sendCommand('Runtime.callFunctionOn', {\n            functionDeclaration: String((id) => {\n                const w = window;\n                if (w[id] === undefined) {\n                    // The channelProxy is not created yet. Create a promise, put the\n                    // resolver to window property and return the promise.\n                    // `getEvalInWindowStr` will resolve the promise later.\n                    return new Promise((resolve) => (w[id] = resolve));\n                }\n                // The channelProxy is already created by `getEvalInWindowStr` and\n                // is set into window property. Return it.\n                const channelProxy = w[id];\n                delete w[id];\n                return channelProxy;\n            }),\n            arguments: [{ value: this.#id }],\n            executionContextId: realm.executionContextId,\n            awaitPromise: true,\n            serializationOptions: {\n                serialization: \"idOnly\" /* Protocol.Runtime.SerializationOptionsSerialization.IdOnly */,\n            },\n        });\n        if (channelHandleResult.exceptionDetails !== undefined ||\n            channelHandleResult.result.objectId === undefined) {\n            throw new Error(`ChannelHandle not found in window[\"${this.#id}\"]`);\n        }\n        return channelHandleResult.result.objectId;\n    }\n    /**\n     * String to be evaluated to create a ProxyChannel and put it to window.\n     * Returns the delegate `sendMessage`. Used to provide an argument for preload\n     * script. Does the following:\n     * 1. Creates a ChannelProxy.\n     * 2. Puts the ChannelProxy to window['${this.#id}'] or resolves the promise\n     *    by calling delegate stored in window['${this.#id}'].\n     *    This is needed because `#getHandleFromWindow` can be called before or\n     *    after this method.\n     * 3. Returns the delegate `sendMessage` of the created ChannelProxy.\n     */\n    getEvalInWindowStr() {\n        const delegate = String((id, channelProxy) => {\n            const w = window;\n            if (w[id] === undefined) {\n                // `#getHandleFromWindow` is not initialized yet, and will get the\n                // channelProxy later.\n                w[id] = channelProxy;\n            }\n            else {\n                // `#getHandleFromWindow` is already set a delegate to window property\n                // and is waiting for it to be called with the channelProxy.\n                w[id](channelProxy);\n                delete w[id];\n            }\n            return channelProxy.sendMessage;\n        });\n        const channelProxyEval = ChannelProxy.#createChannelProxyEvalStr();\n        return `(${delegate})('${this.#id}',${channelProxyEval})`;\n    }\n}\nexports.ChannelProxy = ChannelProxy;\n//# sourceMappingURL=ChannelProxy.js.map","\"use strict\";\n/*\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PreloadScript = void 0;\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\nconst ChannelProxy_js_1 = require(\"./ChannelProxy.js\");\n/**\n * BiDi IDs are generated by the server and are unique within contexts.\n *\n * CDP preload script IDs are generated by the client and are unique\n * within sessions.\n *\n * The mapping between BiDi and CDP preload script IDs is 1:many.\n * BiDi IDs are needed by the mapper to keep track of potential multiple CDP IDs\n * in the client.\n */\nclass PreloadScript {\n    /** BiDi ID, an automatically generated UUID. */\n    #id = (0, uuid_js_1.uuidv4)();\n    /** CDP preload scripts. */\n    #cdpPreloadScripts = [];\n    /** The script itself, in a format expected by the spec i.e. a function. */\n    #functionDeclaration;\n    /** Targets, in which the preload script is initialized. */\n    #targetIds = new Set();\n    /** Channels to be added as arguments to functionDeclaration. */\n    #channels;\n    /** The script sandbox / world name. */\n    #sandbox;\n    /** The browsing contexts to execute the preload scripts in, if any. */\n    #contexts;\n    /** The browsing contexts to execute the preload scripts in, if any. */\n    #userContexts;\n    get id() {\n        return this.#id;\n    }\n    get targetIds() {\n        return this.#targetIds;\n    }\n    constructor(params, logger) {\n        this.#channels =\n            params.arguments?.map((a) => new ChannelProxy_js_1.ChannelProxy(a.value, logger)) ?? [];\n        this.#functionDeclaration = params.functionDeclaration;\n        this.#sandbox = params.sandbox;\n        this.#contexts = params.contexts;\n        this.#userContexts = params.userContexts;\n    }\n    /** Channels of the preload script. */\n    get channels() {\n        return this.#channels;\n    }\n    /** Contexts of the preload script, if any */\n    get contexts() {\n        return this.#contexts;\n    }\n    /** UserContexts of the preload script, if any */\n    get userContexts() {\n        return this.#userContexts;\n    }\n    /**\n     * String to be evaluated. Wraps user-provided function so that the following\n     * steps are run:\n     * 1. Create channels.\n     * 2. Store the created channels in window.\n     * 3. Call the user-provided function with channels as arguments.\n     */\n    #getEvaluateString() {\n        const channelsArgStr = `[${this.channels\n            .map((c) => c.getEvalInWindowStr())\n            .join(', ')}]`;\n        return `(()=>{(${this.#functionDeclaration})(...${channelsArgStr})})()`;\n    }\n    /**\n     * Adds the script to the given CDP targets by calling the\n     * `Page.addScriptToEvaluateOnNewDocument` command.\n     */\n    async initInTargets(cdpTargets, runImmediately) {\n        await Promise.all(Array.from(cdpTargets).map((cdpTarget) => this.initInTarget(cdpTarget, runImmediately)));\n    }\n    /**\n     * Adds the script to the given CDP target by calling the\n     * `Page.addScriptToEvaluateOnNewDocument` command.\n     */\n    async initInTarget(cdpTarget, runImmediately) {\n        const addCdpPreloadScriptResult = await cdpTarget.cdpClient.sendCommand('Page.addScriptToEvaluateOnNewDocument', {\n            source: this.#getEvaluateString(),\n            worldName: this.#sandbox,\n            runImmediately,\n        });\n        this.#cdpPreloadScripts.push({\n            target: cdpTarget,\n            preloadScriptId: addCdpPreloadScriptResult.identifier,\n        });\n        this.#targetIds.add(cdpTarget.id);\n    }\n    /**\n     * Removes this script from all CDP targets.\n     */\n    async remove() {\n        await Promise.all([\n            this.#cdpPreloadScripts.map(async (cdpPreloadScript) => {\n                const cdpTarget = cdpPreloadScript.target;\n                const cdpPreloadScriptId = cdpPreloadScript.preloadScriptId;\n                return await cdpTarget.cdpClient.sendCommand('Page.removeScriptToEvaluateOnNewDocument', {\n                    identifier: cdpPreloadScriptId,\n                });\n            }),\n        ]);\n    }\n    /** Removes the provided cdp target from the list of cdp preload scripts. */\n    dispose(cdpTargetId) {\n        this.#cdpPreloadScripts = this.#cdpPreloadScripts.filter((cdpPreloadScript) => cdpPreloadScript.target?.id !== cdpTargetId);\n        this.#targetIds.delete(cdpTargetId);\n    }\n}\nexports.PreloadScript = PreloadScript;\n//# sourceMappingURL=PreloadScript.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ScriptProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst PreloadScript_js_1 = require(\"./PreloadScript.js\");\nclass ScriptProcessor {\n    #eventManager;\n    #browsingContextStorage;\n    #realmStorage;\n    #preloadScriptStorage;\n    #userContextStorage;\n    #logger;\n    constructor(eventManager, browsingContextStorage, realmStorage, preloadScriptStorage, userContextStorage, logger) {\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#realmStorage = realmStorage;\n        this.#preloadScriptStorage = preloadScriptStorage;\n        this.#userContextStorage = userContextStorage;\n        this.#logger = logger;\n        this.#eventManager = eventManager;\n        this.#eventManager.addSubscribeHook(protocol_js_1.ChromiumBidi.Script.EventNames.RealmCreated, this.#onRealmCreatedSubscribeHook.bind(this));\n    }\n    #onRealmCreatedSubscribeHook(contextId) {\n        const context = this.#browsingContextStorage.getContext(contextId);\n        const contextsToReport = [\n            context,\n            ...this.#browsingContextStorage.getContext(contextId).allChildren,\n        ];\n        const realms = new Set();\n        for (const reportContext of contextsToReport) {\n            const realmsForContext = this.#realmStorage.findRealms({\n                browsingContextId: reportContext.id,\n            });\n            for (const realm of realmsForContext) {\n                realms.add(realm);\n            }\n        }\n        for (const realm of realms) {\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.Script.EventNames.RealmCreated,\n                params: realm.realmInfo,\n            }, context.id);\n        }\n        return Promise.resolve();\n    }\n    async addPreloadScript(params) {\n        if (params.userContexts?.length && params.contexts?.length) {\n            throw new protocol_js_1.InvalidArgumentException('Both userContexts and contexts cannot be specified.');\n        }\n        const userContexts = await this.#userContextStorage.verifyUserContextIdList(params.userContexts ?? []);\n        const browsingContexts = this.#browsingContextStorage.verifyTopLevelContextsList(params.contexts);\n        const preloadScript = new PreloadScript_js_1.PreloadScript(params, this.#logger);\n        this.#preloadScriptStorage.add(preloadScript);\n        let contextsToRunIn = [];\n        if (userContexts.size) {\n            contextsToRunIn = this.#browsingContextStorage\n                .getTopLevelContexts()\n                .filter((context) => {\n                return userContexts.has(context.userContext);\n            });\n        }\n        else if (browsingContexts.size) {\n            contextsToRunIn = [...browsingContexts.values()];\n        }\n        else {\n            contextsToRunIn = this.#browsingContextStorage.getTopLevelContexts();\n        }\n        const cdpTargets = new Set(contextsToRunIn.map((context) => context.cdpTarget));\n        await preloadScript.initInTargets(cdpTargets, false);\n        return {\n            script: preloadScript.id,\n        };\n    }\n    async removePreloadScript(params) {\n        const { script: id } = params;\n        const script = this.#preloadScriptStorage.getPreloadScript(id);\n        await script.remove();\n        this.#preloadScriptStorage.remove(id);\n        return {};\n    }\n    async callFunction(params) {\n        const realm = await this.#getRealm(params.target);\n        return await realm.callFunction(params.functionDeclaration, params.awaitPromise, params.this, params.arguments, params.resultOwnership, params.serializationOptions, params.userActivation);\n    }\n    async evaluate(params) {\n        const realm = await this.#getRealm(params.target);\n        return await realm.evaluate(params.expression, params.awaitPromise, params.resultOwnership, params.serializationOptions, params.userActivation);\n    }\n    async disown(params) {\n        const realm = await this.#getRealm(params.target);\n        await Promise.all(params.handles.map(async (handle) => await realm.disown(handle)));\n        return {};\n    }\n    getRealms(params) {\n        if (params.context !== undefined) {\n            // Make sure the context is known.\n            this.#browsingContextStorage.getContext(params.context);\n        }\n        const realms = this.#realmStorage\n            .findRealms({\n            browsingContextId: params.context,\n            type: params.type,\n            isHidden: false,\n        })\n            .map((realm) => realm.realmInfo);\n        return { realms };\n    }\n    async #getRealm(target) {\n        if ('context' in target) {\n            const context = this.#browsingContextStorage.getContext(target.context);\n            return await context.getOrCreateUserSandbox(target.sandbox);\n        }\n        return this.#realmStorage.getRealm({\n            realmId: target.realm,\n            isHidden: false,\n        });\n    }\n}\nexports.ScriptProcessor = ScriptProcessor;\n//# sourceMappingURL=ScriptProcessor.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SessionProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nclass SessionProcessor {\n    #eventManager;\n    #browserCdpClient;\n    #initConnection;\n    #created = false;\n    constructor(eventManager, browserCdpClient, initConnection) {\n        this.#eventManager = eventManager;\n        this.#browserCdpClient = browserCdpClient;\n        this.#initConnection = initConnection;\n    }\n    status() {\n        return { ready: false, message: 'already connected' };\n    }\n    #mergeCapabilities(capabilitiesRequest) {\n        // Roughly following https://www.w3.org/TR/webdriver2/#dfn-capabilities-processing.\n        // Validations should already be done by the parser.\n        const mergedCapabilities = [];\n        for (const first of capabilitiesRequest.firstMatch ?? [{}]) {\n            const result = {\n                ...capabilitiesRequest.alwaysMatch,\n            };\n            for (const key of Object.keys(first)) {\n                if (result[key] !== undefined) {\n                    throw new protocol_js_1.InvalidArgumentException(`Capability ${key} in firstMatch is already defined in alwaysMatch`);\n                }\n                result[key] = first[key];\n            }\n            mergedCapabilities.push(result);\n        }\n        const match = mergedCapabilities.find((c) => c.browserName === 'chrome') ??\n            mergedCapabilities[0] ??\n            {};\n        match.unhandledPromptBehavior = this.#getUnhandledPromptBehavior(match.unhandledPromptBehavior);\n        return match;\n    }\n    #getUnhandledPromptBehavior(capabilityValue) {\n        if (capabilityValue === undefined) {\n            return undefined;\n        }\n        if (typeof capabilityValue === 'object') {\n            // Do not validate capabilities. Incorrect ones will be ignored by Mapper.\n            return capabilityValue;\n        }\n        if (typeof capabilityValue !== 'string') {\n            throw new protocol_js_1.InvalidArgumentException(`Unexpected 'unhandledPromptBehavior' type: ${typeof capabilityValue}`);\n        }\n        switch (capabilityValue) {\n            // `beforeUnload: accept` has higher priority over string capability, as the latest\n            // one is set to \"fallbackDefault\".\n            // https://w3c.github.io/webdriver/#dfn-deserialize-as-an-unhandled-prompt-behavior\n            // https://w3c.github.io/webdriver/#dfn-get-the-prompt-handler\n            case 'accept':\n            case 'accept and notify':\n                return {\n                    default: \"accept\" /* Session.UserPromptHandlerType.Accept */,\n                    beforeUnload: \"accept\" /* Session.UserPromptHandlerType.Accept */,\n                };\n            case 'dismiss':\n            case 'dismiss and notify':\n                return {\n                    default: \"dismiss\" /* Session.UserPromptHandlerType.Dismiss */,\n                    beforeUnload: \"accept\" /* Session.UserPromptHandlerType.Accept */,\n                };\n            case 'ignore':\n                return {\n                    default: \"ignore\" /* Session.UserPromptHandlerType.Ignore */,\n                    beforeUnload: \"accept\" /* Session.UserPromptHandlerType.Accept */,\n                };\n            default:\n                throw new protocol_js_1.InvalidArgumentException(`Unexpected 'unhandledPromptBehavior' value: ${capabilityValue}`);\n        }\n    }\n    async new(params) {\n        if (this.#created) {\n            throw new Error('Session has been already created.');\n        }\n        this.#created = true;\n        const matchedCapabitlites = this.#mergeCapabilities(params.capabilities);\n        await this.#initConnection(matchedCapabitlites);\n        const version = await this.#browserCdpClient.sendCommand('Browser.getVersion');\n        return {\n            sessionId: 'unknown',\n            capabilities: {\n                ...matchedCapabitlites,\n                acceptInsecureCerts: matchedCapabitlites.acceptInsecureCerts ?? false,\n                browserName: version.product,\n                browserVersion: version.revision,\n                platformName: '',\n                setWindowRect: false,\n                webSocketUrl: '',\n                userAgent: version.userAgent,\n            },\n        };\n    }\n    async subscribe(params, googChannel = null) {\n        const subscription = await this.#eventManager.subscribe(params.events, params.contexts ?? [], params.userContexts ?? [], googChannel);\n        return {\n            subscription,\n        };\n    }\n    async unsubscribe(params, googChannel = null) {\n        if ('subscriptions' in params) {\n            await this.#eventManager.unsubscribeByIds(params.subscriptions);\n            return {};\n        }\n        await this.#eventManager.unsubscribe(params.events, googChannel);\n        return {};\n    }\n}\nexports.SessionProcessor = SessionProcessor;\n//# sourceMappingURL=SessionProcessor.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StorageProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst assert_js_1 = require(\"../../../utils/assert.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst NetworkProcessor_js_1 = require(\"../network/NetworkProcessor.js\");\nconst NetworkUtils_js_1 = require(\"../network/NetworkUtils.js\");\n/**\n * Responsible for handling the `storage` module.\n */\nclass StorageProcessor {\n    #browserCdpClient;\n    #browsingContextStorage;\n    #logger;\n    constructor(browserCdpClient, browsingContextStorage, logger) {\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#browserCdpClient = browserCdpClient;\n        this.#logger = logger;\n    }\n    async deleteCookies(params) {\n        const partitionKey = this.#expandStoragePartitionSpec(params.partition);\n        let cdpResponse;\n        try {\n            cdpResponse = await this.#browserCdpClient.sendCommand('Storage.getCookies', {\n                browserContextId: this.#getCdpBrowserContextId(partitionKey),\n            });\n        }\n        catch (err) {\n            if (this.#isNoSuchUserContextError(err)) {\n                // If the user context is not found, special error is thrown.\n                throw new protocol_js_1.NoSuchUserContextException(err.message);\n            }\n            throw err;\n        }\n        const cdpCookiesToDelete = cdpResponse.cookies\n            .filter(\n        // CDP's partition key is the source origin. If the request specifies the\n        // `sourceOrigin` partition key, only cookies with the requested source origin\n        // are returned.\n        (c) => partitionKey.sourceOrigin === undefined ||\n            c.partitionKey?.topLevelSite === partitionKey.sourceOrigin)\n            .filter((cdpCookie) => {\n            const bidiCookie = (0, NetworkUtils_js_1.cdpToBiDiCookie)(cdpCookie);\n            return this.#matchCookie(bidiCookie, params.filter);\n        })\n            .map((cookie) => ({\n            ...cookie,\n            // Set expiry to pass date to delete the cookie.\n            expires: 1,\n        }));\n        await this.#browserCdpClient.sendCommand('Storage.setCookies', {\n            cookies: cdpCookiesToDelete,\n            browserContextId: this.#getCdpBrowserContextId(partitionKey),\n        });\n        return {\n            partitionKey,\n        };\n    }\n    async getCookies(params) {\n        const partitionKey = this.#expandStoragePartitionSpec(params.partition);\n        let cdpResponse;\n        try {\n            cdpResponse = await this.#browserCdpClient.sendCommand('Storage.getCookies', {\n                browserContextId: this.#getCdpBrowserContextId(partitionKey),\n            });\n        }\n        catch (err) {\n            if (this.#isNoSuchUserContextError(err)) {\n                // If the user context is not found, special error is thrown.\n                throw new protocol_js_1.NoSuchUserContextException(err.message);\n            }\n            throw err;\n        }\n        const filteredBiDiCookies = cdpResponse.cookies\n            .filter(\n        // CDP's partition key is the source origin. If the request specifies the\n        // `sourceOrigin` partition key, only cookies with the requested source origin\n        // are returned.\n        (c) => partitionKey.sourceOrigin === undefined ||\n            c.partitionKey?.topLevelSite === partitionKey.sourceOrigin)\n            .map((c) => (0, NetworkUtils_js_1.cdpToBiDiCookie)(c))\n            .filter((c) => this.#matchCookie(c, params.filter));\n        return {\n            cookies: filteredBiDiCookies,\n            partitionKey,\n        };\n    }\n    async setCookie(params) {\n        const partitionKey = this.#expandStoragePartitionSpec(params.partition);\n        const cdpCookie = (0, NetworkUtils_js_1.bidiToCdpCookie)(params, partitionKey);\n        try {\n            await this.#browserCdpClient.sendCommand('Storage.setCookies', {\n                cookies: [cdpCookie],\n                browserContextId: this.#getCdpBrowserContextId(partitionKey),\n            });\n        }\n        catch (err) {\n            if (this.#isNoSuchUserContextError(err)) {\n                // If the user context is not found, special error is thrown.\n                throw new protocol_js_1.NoSuchUserContextException(err.message);\n            }\n            this.#logger?.(log_js_1.LogType.debugError, err);\n            throw new protocol_js_1.UnableToSetCookieException(err.toString());\n        }\n        return {\n            partitionKey,\n        };\n    }\n    #isNoSuchUserContextError(err) {\n        // Heuristic to detect if the user context is not found.\n        // See https://source.chromium.org/chromium/chromium/src/+/main:content/browser/devtools/protocol/browser_handler.cc;drc=a56154dd81e4679712422ac6eed2c9581cb51ab0;l=314\n        return err.message?.startsWith('Failed to find browser context for id');\n    }\n    #getCdpBrowserContextId(partitionKey) {\n        return partitionKey.userContext === 'default'\n            ? undefined\n            : partitionKey.userContext;\n    }\n    #expandStoragePartitionSpecByBrowsingContext(descriptor) {\n        const browsingContextId = descriptor.context;\n        const browsingContext = this.#browsingContextStorage.getContext(browsingContextId);\n        // https://w3c.github.io/webdriver-bidi/#associated-storage-partition.\n        // Each browsing context also has an associated storage partition, which is the\n        // storage partition it uses to persist data. In Chromium it's a `BrowserContext`\n        // which maps to BiDi `UserContext`.\n        return {\n            userContext: browsingContext.userContext,\n        };\n    }\n    #expandStoragePartitionSpecByStorageKey(descriptor) {\n        const unsupportedPartitionKeys = new Map();\n        let sourceOrigin = descriptor.sourceOrigin;\n        if (sourceOrigin !== undefined) {\n            const url = NetworkProcessor_js_1.NetworkProcessor.parseUrlString(sourceOrigin);\n            if (url.origin === 'null') {\n                // Origin `null` is a special case for local pages.\n                sourceOrigin = url.origin;\n            }\n            else {\n                // Port is not supported in CDP Cookie's `partitionKey`, so it should be stripped\n                // from the requested source origin.\n                sourceOrigin = `${url.protocol}//${url.hostname}`;\n            }\n        }\n        for (const [key, value] of Object.entries(descriptor)) {\n            if (key !== undefined &&\n                value !== undefined &&\n                !['type', 'sourceOrigin', 'userContext'].includes(key)) {\n                unsupportedPartitionKeys.set(key, value);\n            }\n        }\n        if (unsupportedPartitionKeys.size > 0) {\n            this.#logger?.(log_js_1.LogType.debugInfo, `Unsupported partition keys: ${JSON.stringify(Object.fromEntries(unsupportedPartitionKeys))}`);\n        }\n        // Set `userContext` to `default` if not provided, as it's required in Chromium.\n        const userContext = descriptor.userContext ?? 'default';\n        return {\n            userContext,\n            ...(sourceOrigin === undefined ? {} : { sourceOrigin }),\n        };\n    }\n    #expandStoragePartitionSpec(partitionSpec) {\n        if (partitionSpec === undefined) {\n            // `userContext` is required in Chromium.\n            return { userContext: 'default' };\n        }\n        if (partitionSpec.type === 'context') {\n            return this.#expandStoragePartitionSpecByBrowsingContext(partitionSpec);\n        }\n        (0, assert_js_1.assert)(partitionSpec.type === 'storageKey', 'Unknown partition type');\n        // Partition spec is a storage partition.\n        // Let partition key be partition spec.\n        return this.#expandStoragePartitionSpecByStorageKey(partitionSpec);\n    }\n    #matchCookie(cookie, filter) {\n        if (filter === undefined) {\n            return true;\n        }\n        return ((filter.domain === undefined || filter.domain === cookie.domain) &&\n            (filter.name === undefined || filter.name === cookie.name) &&\n            // `value` contains fields `type` and `value`.\n            (filter.value === undefined ||\n                (0, NetworkUtils_js_1.deserializeByteValue)(filter.value) ===\n                    (0, NetworkUtils_js_1.deserializeByteValue)(cookie.value)) &&\n            (filter.path === undefined || filter.path === cookie.path) &&\n            (filter.size === undefined || filter.size === cookie.size) &&\n            (filter.httpOnly === undefined || filter.httpOnly === cookie.httpOnly) &&\n            (filter.secure === undefined || filter.secure === cookie.secure) &&\n            (filter.sameSite === undefined || filter.sameSite === cookie.sameSite) &&\n            (filter.expiry === undefined || filter.expiry === cookie.expiry));\n    }\n}\nexports.StorageProcessor = StorageProcessor;\n//# sourceMappingURL=StorageProcessor.js.map","\"use strict\";\n/**\n * Copyright 2025 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebExtensionProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\n/**\n * Responsible for handling the `webModule` module.\n */\nclass WebExtensionProcessor {\n    #browserCdpClient;\n    constructor(browserCdpClient) {\n        this.#browserCdpClient = browserCdpClient;\n    }\n    async install(params) {\n        switch (params.extensionData.type) {\n            case 'archivePath':\n            case 'base64':\n                throw new protocol_js_1.UnsupportedOperationException('Archived and Base64 extensions are not supported');\n            case 'path':\n                break;\n        }\n        try {\n            const response = await this.#browserCdpClient.sendCommand('Extensions.loadUnpacked', {\n                path: params.extensionData.path,\n            });\n            return {\n                extension: response.id,\n            };\n        }\n        catch (err) {\n            if (err.message.startsWith('invalid web extension')) {\n                throw new protocol_js_1.InvalidWebExtensionException(err.message);\n            }\n            throw err;\n        }\n    }\n    async uninstall(params) {\n        try {\n            await this.#browserCdpClient.sendCommand('Extensions.uninstall', {\n                id: params.extension,\n            });\n            return {};\n        }\n        catch (err) {\n            if (err.message ===\n                'Uninstall failed. Reason: could not find extension.') {\n                throw new protocol_js_1.NoSuchWebExtensionException('no such web extension');\n            }\n            throw err;\n        }\n    }\n}\nexports.WebExtensionProcessor = WebExtensionProcessor;\n//# sourceMappingURL=WebExtensionProcessor.js.map","\"use strict\";\n/**\n * Copyright 2021 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.OutgoingMessage = void 0;\nclass OutgoingMessage {\n    #message;\n    #googChannel;\n    constructor(message, googChannel = null) {\n        this.#message = message;\n        this.#googChannel = googChannel;\n    }\n    static createFromPromise(messagePromise, googChannel) {\n        return messagePromise.then((message) => {\n            if (message.kind === 'success') {\n                return {\n                    kind: 'success',\n                    value: new OutgoingMessage(message.value, googChannel),\n                };\n            }\n            return message;\n        });\n    }\n    static createResolved(message, googChannel = null) {\n        return Promise.resolve({\n            kind: 'success',\n            value: new OutgoingMessage(message, googChannel),\n        });\n    }\n    get message() {\n        return this.#message;\n    }\n    get googChannel() {\n        return this.#googChannel;\n    }\n}\nexports.OutgoingMessage = OutgoingMessage;\n//# sourceMappingURL=OutgoingMessage.js.map","\"use strict\";\n/**\n * Copyright 2021 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CommandProcessor = void 0;\nconst protocol_js_1 = require(\"../protocol/protocol.js\");\nconst EventEmitter_js_1 = require(\"../utils/EventEmitter.js\");\nconst log_js_1 = require(\"../utils/log.js\");\nconst BidiNoOpParser_js_1 = require(\"./BidiNoOpParser.js\");\nconst BrowserProcessor_js_1 = require(\"./modules/browser/BrowserProcessor.js\");\nconst CdpProcessor_js_1 = require(\"./modules/cdp/CdpProcessor.js\");\nconst BrowsingContextProcessor_js_1 = require(\"./modules/context/BrowsingContextProcessor.js\");\nconst EmulationProcessor_js_1 = require(\"./modules/emulation/EmulationProcessor.js\");\nconst InputProcessor_js_1 = require(\"./modules/input/InputProcessor.js\");\nconst NetworkProcessor_js_1 = require(\"./modules/network/NetworkProcessor.js\");\nconst PermissionsProcessor_js_1 = require(\"./modules/permissions/PermissionsProcessor.js\");\nconst ScriptProcessor_js_1 = require(\"./modules/script/ScriptProcessor.js\");\nconst SessionProcessor_js_1 = require(\"./modules/session/SessionProcessor.js\");\nconst StorageProcessor_js_1 = require(\"./modules/storage/StorageProcessor.js\");\nconst WebExtensionProcessor_js_1 = require(\"./modules/webExtension/WebExtensionProcessor.js\");\nconst OutgoingMessage_js_1 = require(\"./OutgoingMessage.js\");\nclass CommandProcessor extends EventEmitter_js_1.EventEmitter {\n    // keep-sorted start\n    #bluetoothProcessor;\n    #browserCdpClient;\n    #browserProcessor;\n    #browsingContextProcessor;\n    #cdpProcessor;\n    #emulationProcessor;\n    #inputProcessor;\n    #networkProcessor;\n    #permissionsProcessor;\n    #scriptProcessor;\n    #sessionProcessor;\n    #storageProcessor;\n    #webExtensionProcessor;\n    // keep-sorted end\n    #parser;\n    #logger;\n    constructor(cdpConnection, browserCdpClient, eventManager, browsingContextStorage, realmStorage, preloadScriptStorage, networkStorage, contextConfigStorage, bluetoothProcessor, userContextStorage, parser = new BidiNoOpParser_js_1.BidiNoOpParser(), initConnection, logger) {\n        super();\n        this.#browserCdpClient = browserCdpClient;\n        this.#parser = parser;\n        this.#logger = logger;\n        this.#bluetoothProcessor = bluetoothProcessor;\n        // keep-sorted start block=yes\n        this.#browserProcessor = new BrowserProcessor_js_1.BrowserProcessor(browserCdpClient, browsingContextStorage, contextConfigStorage, userContextStorage);\n        this.#browsingContextProcessor = new BrowsingContextProcessor_js_1.BrowsingContextProcessor(browserCdpClient, browsingContextStorage, userContextStorage, contextConfigStorage, eventManager);\n        this.#cdpProcessor = new CdpProcessor_js_1.CdpProcessor(browsingContextStorage, realmStorage, cdpConnection, browserCdpClient);\n        this.#emulationProcessor = new EmulationProcessor_js_1.EmulationProcessor(browsingContextStorage, userContextStorage, contextConfigStorage);\n        this.#inputProcessor = new InputProcessor_js_1.InputProcessor(browsingContextStorage);\n        this.#networkProcessor = new NetworkProcessor_js_1.NetworkProcessor(browsingContextStorage, networkStorage, userContextStorage, contextConfigStorage);\n        this.#permissionsProcessor = new PermissionsProcessor_js_1.PermissionsProcessor(browserCdpClient);\n        this.#scriptProcessor = new ScriptProcessor_js_1.ScriptProcessor(eventManager, browsingContextStorage, realmStorage, preloadScriptStorage, userContextStorage, logger);\n        this.#sessionProcessor = new SessionProcessor_js_1.SessionProcessor(eventManager, browserCdpClient, initConnection);\n        this.#storageProcessor = new StorageProcessor_js_1.StorageProcessor(browserCdpClient, browsingContextStorage, logger);\n        this.#webExtensionProcessor = new WebExtensionProcessor_js_1.WebExtensionProcessor(browserCdpClient);\n        // keep-sorted end\n    }\n    async #processCommand(command) {\n        switch (command.method) {\n            // Bluetooth module\n            // keep-sorted start block=yes\n            case 'bluetooth.disableSimulation':\n                return await this.#bluetoothProcessor.disableSimulation(this.#parser.parseDisableSimulationParameters(command.params));\n            case 'bluetooth.handleRequestDevicePrompt':\n                return await this.#bluetoothProcessor.handleRequestDevicePrompt(this.#parser.parseHandleRequestDevicePromptParams(command.params));\n            case 'bluetooth.simulateAdapter':\n                return await this.#bluetoothProcessor.simulateAdapter(this.#parser.parseSimulateAdapterParameters(command.params));\n            case 'bluetooth.simulateAdvertisement':\n                return await this.#bluetoothProcessor.simulateAdvertisement(this.#parser.parseSimulateAdvertisementParameters(command.params));\n            case 'bluetooth.simulateCharacteristic':\n                return await this.#bluetoothProcessor.simulateCharacteristic(this.#parser.parseSimulateCharacteristicParameters(command.params));\n            case 'bluetooth.simulateCharacteristicResponse':\n                return await this.#bluetoothProcessor.simulateCharacteristicResponse(this.#parser.parseSimulateCharacteristicResponseParameters(command.params));\n            case 'bluetooth.simulateDescriptor':\n                return await this.#bluetoothProcessor.simulateDescriptor(this.#parser.parseSimulateDescriptorParameters(command.params));\n            case 'bluetooth.simulateDescriptorResponse':\n                return await this.#bluetoothProcessor.simulateDescriptorResponse(this.#parser.parseSimulateDescriptorResponseParameters(command.params));\n            case 'bluetooth.simulateGattConnectionResponse':\n                return await this.#bluetoothProcessor.simulateGattConnectionResponse(this.#parser.parseSimulateGattConnectionResponseParameters(command.params));\n            case 'bluetooth.simulateGattDisconnection':\n                return await this.#bluetoothProcessor.simulateGattDisconnection(this.#parser.parseSimulateGattDisconnectionParameters(command.params));\n            case 'bluetooth.simulatePreconnectedPeripheral':\n                return await this.#bluetoothProcessor.simulatePreconnectedPeripheral(this.#parser.parseSimulatePreconnectedPeripheralParameters(command.params));\n            case 'bluetooth.simulateService':\n                return await this.#bluetoothProcessor.simulateService(this.#parser.parseSimulateServiceParameters(command.params));\n            // keep-sorted end\n            // Browser module\n            // keep-sorted start block=yes\n            case 'browser.close':\n                return this.#browserProcessor.close();\n            case 'browser.createUserContext':\n                return await this.#browserProcessor.createUserContext(this.#parser.parseCreateUserContextParameters(command.params));\n            case 'browser.getClientWindows':\n                return await this.#browserProcessor.getClientWindows();\n            case 'browser.getUserContexts':\n                return await this.#browserProcessor.getUserContexts();\n            case 'browser.removeUserContext':\n                return await this.#browserProcessor.removeUserContext(this.#parser.parseRemoveUserContextParameters(command.params));\n            case 'browser.setClientWindowState':\n                this.#parser.parseSetClientWindowStateParameters(command.params);\n                throw new protocol_js_1.UnsupportedOperationException(`Method ${command.method} is not implemented.`);\n            case 'browser.setDownloadBehavior':\n                return await this.#browserProcessor.setDownloadBehavior(this.#parser.parseSetDownloadBehaviorParameters(command.params));\n            // keep-sorted end\n            // Browsing Context module\n            // keep-sorted start block=yes\n            case 'browsingContext.activate':\n                return await this.#browsingContextProcessor.activate(this.#parser.parseActivateParams(command.params));\n            case 'browsingContext.captureScreenshot':\n                return await this.#browsingContextProcessor.captureScreenshot(this.#parser.parseCaptureScreenshotParams(command.params));\n            case 'browsingContext.close':\n                return await this.#browsingContextProcessor.close(this.#parser.parseCloseParams(command.params));\n            case 'browsingContext.create':\n                return await this.#browsingContextProcessor.create(this.#parser.parseCreateParams(command.params));\n            case 'browsingContext.getTree':\n                return this.#browsingContextProcessor.getTree(this.#parser.parseGetTreeParams(command.params));\n            case 'browsingContext.handleUserPrompt':\n                return await this.#browsingContextProcessor.handleUserPrompt(this.#parser.parseHandleUserPromptParams(command.params));\n            case 'browsingContext.locateNodes':\n                return await this.#browsingContextProcessor.locateNodes(this.#parser.parseLocateNodesParams(command.params));\n            case 'browsingContext.navigate':\n                return await this.#browsingContextProcessor.navigate(this.#parser.parseNavigateParams(command.params));\n            case 'browsingContext.print':\n                return await this.#browsingContextProcessor.print(this.#parser.parsePrintParams(command.params));\n            case 'browsingContext.reload':\n                return await this.#browsingContextProcessor.reload(this.#parser.parseReloadParams(command.params));\n            case 'browsingContext.setViewport':\n                return await this.#browsingContextProcessor.setViewport(this.#parser.parseSetViewportParams(command.params));\n            case 'browsingContext.traverseHistory':\n                return await this.#browsingContextProcessor.traverseHistory(this.#parser.parseTraverseHistoryParams(command.params));\n            // keep-sorted end\n            // CDP module\n            // keep-sorted start block=yes\n            case 'goog:cdp.getSession':\n                return this.#cdpProcessor.getSession(this.#parser.parseGetSessionParams(command.params));\n            case 'goog:cdp.resolveRealm':\n                return this.#cdpProcessor.resolveRealm(this.#parser.parseResolveRealmParams(command.params));\n            case 'goog:cdp.sendCommand':\n                return await this.#cdpProcessor.sendCommand(this.#parser.parseSendCommandParams(command.params));\n            // keep-sorted end\n            // Emulation module\n            // keep-sorted start block=yes\n            case 'emulation.setForcedColorsModeThemeOverride':\n                this.#parser.parseSetForcedColorsModeThemeOverrideParams(command.params);\n                throw new protocol_js_1.UnsupportedOperationException(`Method ${command.method} is not implemented.`);\n            case 'emulation.setGeolocationOverride':\n                return await this.#emulationProcessor.setGeolocationOverride(this.#parser.parseSetGeolocationOverrideParams(command.params));\n            case 'emulation.setLocaleOverride':\n                return await this.#emulationProcessor.setLocaleOverride(this.#parser.parseSetLocaleOverrideParams(command.params));\n            case 'emulation.setNetworkConditions':\n                return await this.#emulationProcessor.setNetworkConditions(this.#parser.parseSetNetworkConditionsParams(command.params));\n            case 'emulation.setScreenOrientationOverride':\n                return await this.#emulationProcessor.setScreenOrientationOverride(this.#parser.parseSetScreenOrientationOverrideParams(command.params));\n            case 'emulation.setScriptingEnabled':\n                return await this.#emulationProcessor.setScriptingEnabled(this.#parser.parseSetScriptingEnabledParams(command.params));\n            case 'emulation.setTimezoneOverride':\n                return await this.#emulationProcessor.setTimezoneOverride(this.#parser.parseSetTimezoneOverrideParams(command.params));\n            case 'emulation.setUserAgentOverride':\n                return await this.#emulationProcessor.setUserAgentOverrideParams(this.#parser.parseSetUserAgentOverrideParams(command.params));\n            // keep-sorted end\n            // Input module\n            // keep-sorted start block=yes\n            case 'input.performActions':\n                return await this.#inputProcessor.performActions(this.#parser.parsePerformActionsParams(command.params));\n            case 'input.releaseActions':\n                return await this.#inputProcessor.releaseActions(this.#parser.parseReleaseActionsParams(command.params));\n            case 'input.setFiles':\n                return await this.#inputProcessor.setFiles(this.#parser.parseSetFilesParams(command.params));\n            // keep-sorted end\n            // Network module\n            // keep-sorted start block=yes\n            case 'network.addDataCollector':\n                return await this.#networkProcessor.addDataCollector(this.#parser.parseAddDataCollectorParams(command.params));\n            case 'network.addIntercept':\n                return await this.#networkProcessor.addIntercept(this.#parser.parseAddInterceptParams(command.params));\n            case 'network.continueRequest':\n                return await this.#networkProcessor.continueRequest(this.#parser.parseContinueRequestParams(command.params));\n            case 'network.continueResponse':\n                return await this.#networkProcessor.continueResponse(this.#parser.parseContinueResponseParams(command.params));\n            case 'network.continueWithAuth':\n                return await this.#networkProcessor.continueWithAuth(this.#parser.parseContinueWithAuthParams(command.params));\n            case 'network.disownData':\n                return this.#networkProcessor.disownData(this.#parser.parseDisownDataParams(command.params));\n            case 'network.failRequest':\n                return await this.#networkProcessor.failRequest(this.#parser.parseFailRequestParams(command.params));\n            case 'network.getData':\n                return await this.#networkProcessor.getData(this.#parser.parseGetDataParams(command.params));\n            case 'network.provideResponse':\n                return await this.#networkProcessor.provideResponse(this.#parser.parseProvideResponseParams(command.params));\n            case 'network.removeDataCollector':\n                return await this.#networkProcessor.removeDataCollector(this.#parser.parseRemoveDataCollectorParams(command.params));\n            case 'network.removeIntercept':\n                return await this.#networkProcessor.removeIntercept(this.#parser.parseRemoveInterceptParams(command.params));\n            case 'network.setCacheBehavior':\n                return await this.#networkProcessor.setCacheBehavior(this.#parser.parseSetCacheBehaviorParams(command.params));\n            case 'network.setExtraHeaders':\n                return await this.#networkProcessor.setExtraHeaders(this.#parser.parseSetExtraHeadersParams(command.params));\n            // keep-sorted end\n            // Permissions module\n            // keep-sorted start block=yes\n            case 'permissions.setPermission':\n                return await this.#permissionsProcessor.setPermissions(this.#parser.parseSetPermissionsParams(command.params));\n            // keep-sorted end\n            // Script module\n            // keep-sorted start block=yes\n            case 'script.addPreloadScript':\n                return await this.#scriptProcessor.addPreloadScript(this.#parser.parseAddPreloadScriptParams(command.params));\n            case 'script.callFunction':\n                return await this.#scriptProcessor.callFunction(this.#parser.parseCallFunctionParams(this.#processTargetParams(command.params)));\n            case 'script.disown':\n                return await this.#scriptProcessor.disown(this.#parser.parseDisownParams(this.#processTargetParams(command.params)));\n            case 'script.evaluate':\n                return await this.#scriptProcessor.evaluate(this.#parser.parseEvaluateParams(this.#processTargetParams(command.params)));\n            case 'script.getRealms':\n                return this.#scriptProcessor.getRealms(this.#parser.parseGetRealmsParams(command.params));\n            case 'script.removePreloadScript':\n                return await this.#scriptProcessor.removePreloadScript(this.#parser.parseRemovePreloadScriptParams(command.params));\n            // keep-sorted end\n            // Session module\n            // keep-sorted start block=yes\n            case 'session.end':\n                throw new protocol_js_1.UnsupportedOperationException(`Method ${command.method} is not implemented.`);\n            case 'session.new':\n                return await this.#sessionProcessor.new(command.params);\n            case 'session.status':\n                return this.#sessionProcessor.status();\n            case 'session.subscribe':\n                return await this.#sessionProcessor.subscribe(this.#parser.parseSubscribeParams(command.params), command['goog:channel']);\n            case 'session.unsubscribe':\n                return await this.#sessionProcessor.unsubscribe(this.#parser.parseUnsubscribeParams(command.params), command['goog:channel']);\n            // keep-sorted end\n            // Storage module\n            // keep-sorted start block=yes\n            case 'storage.deleteCookies':\n                return await this.#storageProcessor.deleteCookies(this.#parser.parseDeleteCookiesParams(command.params));\n            case 'storage.getCookies':\n                return await this.#storageProcessor.getCookies(this.#parser.parseGetCookiesParams(command.params));\n            case 'storage.setCookie':\n                return await this.#storageProcessor.setCookie(this.#parser.parseSetCookieParams(command.params));\n            // keep-sorted end\n            // WebExtension module\n            // keep-sorted start block=yes\n            case 'webExtension.install':\n                return await this.#webExtensionProcessor.install(this.#parser.parseInstallParams(command.params));\n            case 'webExtension.uninstall':\n                return await this.#webExtensionProcessor.uninstall(this.#parser.parseUninstallParams(command.params));\n            // keep-sorted end\n        }\n        // Intentionally kept outside the switch statement to ensure that\n        // ESLint @typescript-eslint/switch-exhaustiveness-check triggers if a new\n        // command is added.\n        throw new protocol_js_1.UnknownCommandException(`Unknown command '${command?.method}'.`);\n    }\n    // Workaround for as zod.union always take the first schema\n    // https://github.com/w3c/webdriver-bidi/issues/635\n    #processTargetParams(params) {\n        if (typeof params === 'object' &&\n            params &&\n            'target' in params &&\n            typeof params.target === 'object' &&\n            params.target &&\n            'context' in params.target) {\n            delete params.target['realm'];\n        }\n        return params;\n    }\n    async processCommand(command) {\n        try {\n            const result = await this.#processCommand(command);\n            const response = {\n                type: 'success',\n                id: command.id,\n                result,\n            };\n            this.emit(\"response\" /* CommandProcessorEvents.Response */, {\n                message: OutgoingMessage_js_1.OutgoingMessage.createResolved(response, command['goog:channel']),\n                event: command.method,\n            });\n        }\n        catch (e) {\n            if (e instanceof protocol_js_1.Exception) {\n                this.emit(\"response\" /* CommandProcessorEvents.Response */, {\n                    message: OutgoingMessage_js_1.OutgoingMessage.createResolved(e.toErrorResponse(command.id), command['goog:channel']),\n                    event: command.method,\n                });\n            }\n            else {\n                const error = e;\n                this.#logger?.(log_js_1.LogType.bidi, error);\n                // Heuristic required for processing cases when a browsing context is gone\n                // during the command processing, e.g. like in test\n                // `test_input_keyDown_closes_browsing_context`.\n                const errorException = this.#browserCdpClient.isCloseError(e)\n                    ? new protocol_js_1.NoSuchFrameException(`Browsing context is gone`)\n                    : new protocol_js_1.UnknownErrorException(error.message, error.stack);\n                this.emit(\"response\" /* CommandProcessorEvents.Response */, {\n                    message: OutgoingMessage_js_1.OutgoingMessage.createResolved(errorException.toErrorResponse(command.id), command['goog:channel']),\n                    event: command.method,\n                });\n            }\n        }\n    }\n}\nexports.CommandProcessor = CommandProcessor;\n//# sourceMappingURL=CommandProcessor.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BluetoothProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\n/** Represents a base Bluetooth GATT item. */\nclass BluetoothGattItem {\n    id;\n    uuid;\n    constructor(id, uuid) {\n        this.id = id;\n        this.uuid = uuid;\n    }\n}\n/** Represents a Bluetooth descriptor. */\nclass BluetoothDescriptor extends BluetoothGattItem {\n    characteristic;\n    constructor(id, uuid, characteristic) {\n        super(id, uuid);\n        this.characteristic = characteristic;\n    }\n}\n/** Represents a Bluetooth characteristic. */\nclass BluetoothCharacteristic extends BluetoothGattItem {\n    descriptors = new Map();\n    service;\n    constructor(id, uuid, service) {\n        super(id, uuid);\n        this.service = service;\n    }\n}\n/** Represents a Bluetooth service. */\nclass BluetoothService extends BluetoothGattItem {\n    characteristics = new Map();\n    device;\n    constructor(id, uuid, device) {\n        super(id, uuid);\n        this.device = device;\n    }\n}\n/** Represents a Bluetooth device. */\nclass BluetoothDevice {\n    address;\n    services = new Map();\n    constructor(address) {\n        this.address = address;\n    }\n}\nclass BluetoothProcessor {\n    #eventManager;\n    #browsingContextStorage;\n    #bluetoothDevices = new Map();\n    // A map from a characteristic id from CDP to its BluetoothCharacteristic object.\n    #bluetoothCharacteristics = new Map();\n    // A map from a descriptor id from CDP to its BluetoothDescriptor object.\n    #bluetoothDescriptors = new Map();\n    constructor(eventManager, browsingContextStorage) {\n        this.#eventManager = eventManager;\n        this.#browsingContextStorage = browsingContextStorage;\n    }\n    #getDevice(address) {\n        const device = this.#bluetoothDevices.get(address);\n        if (!device) {\n            throw new protocol_js_1.InvalidArgumentException(`Bluetooth device with address ${address} does not exist`);\n        }\n        return device;\n    }\n    #getService(device, serviceUuid) {\n        const service = device.services.get(serviceUuid);\n        if (!service) {\n            throw new protocol_js_1.InvalidArgumentException(`Service with UUID ${serviceUuid} on device ${device.address} does not exist`);\n        }\n        return service;\n    }\n    #getCharacteristic(service, characteristicUuid) {\n        const characteristic = service.characteristics.get(characteristicUuid);\n        if (!characteristic) {\n            throw new protocol_js_1.InvalidArgumentException(`Characteristic with UUID ${characteristicUuid} does not exist for service ${service.uuid} on device ${service.device.address}`);\n        }\n        return characteristic;\n    }\n    #getDescriptor(characteristic, descriptorUuid) {\n        const descriptor = characteristic.descriptors.get(descriptorUuid);\n        if (!descriptor) {\n            throw new protocol_js_1.InvalidArgumentException(`Descriptor with UUID ${descriptorUuid} does not exist for characteristic ${characteristic.uuid} on service ${characteristic.service.uuid} on device ${characteristic.service.device.address}`);\n        }\n        return descriptor;\n    }\n    async simulateAdapter(params) {\n        if (params.state === undefined) {\n            // The bluetooth.simulateAdapter Command\n            // Step 4.2. If params[\"state\"] does not exist, return error with error code invalid argument.\n            // https://webbluetoothcg.github.io/web-bluetooth/#bluetooth-simulateAdapter-command\n            throw new protocol_js_1.InvalidArgumentException(`Parameter \"state\" is required for creating a Bluetooth adapter`);\n        }\n        const context = this.#browsingContextStorage.getContext(params.context);\n        // Bluetooth spec requires overriding the existing adapter (step 6). From the CDP\n        // perspective, we need to disable the emulation first.\n        // https://webbluetoothcg.github.io/web-bluetooth/#bluetooth-simulateAdapter-command\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.disable');\n        this.#bluetoothDevices.clear();\n        this.#bluetoothCharacteristics.clear();\n        this.#bluetoothDescriptors.clear();\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.enable', {\n            state: params.state,\n            leSupported: params.leSupported ?? true,\n        });\n        return {};\n    }\n    async disableSimulation(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.disable');\n        this.#bluetoothDevices.clear();\n        this.#bluetoothCharacteristics.clear();\n        this.#bluetoothDescriptors.clear();\n        return {};\n    }\n    async simulatePreconnectedPeripheral(params) {\n        if (this.#bluetoothDevices.has(params.address)) {\n            throw new protocol_js_1.InvalidArgumentException(`Bluetooth device with address ${params.address} already exists`);\n        }\n        const context = this.#browsingContextStorage.getContext(params.context);\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.simulatePreconnectedPeripheral', {\n            address: params.address,\n            name: params.name,\n            knownServiceUuids: params.knownServiceUuids,\n            manufacturerData: params.manufacturerData,\n        });\n        this.#bluetoothDevices.set(params.address, new BluetoothDevice(params.address));\n        return {};\n    }\n    async simulateAdvertisement(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.simulateAdvertisement', {\n            entry: params.scanEntry,\n        });\n        return {};\n    }\n    async simulateCharacteristic(params) {\n        const device = this.#getDevice(params.address);\n        const service = this.#getService(device, params.serviceUuid);\n        const context = this.#browsingContextStorage.getContext(params.context);\n        switch (params.type) {\n            case 'add': {\n                if (params.characteristicProperties === undefined) {\n                    throw new protocol_js_1.InvalidArgumentException(`Parameter \"characteristicProperties\" is required for adding a Bluetooth characteristic`);\n                }\n                if (service.characteristics.has(params.characteristicUuid)) {\n                    throw new protocol_js_1.InvalidArgumentException(`Characteristic with UUID ${params.characteristicUuid} already exists`);\n                }\n                const response = await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.addCharacteristic', {\n                    serviceId: service.id,\n                    characteristicUuid: params.characteristicUuid,\n                    properties: params.characteristicProperties,\n                });\n                const characteristic = new BluetoothCharacteristic(response.characteristicId, params.characteristicUuid, service);\n                service.characteristics.set(params.characteristicUuid, characteristic);\n                this.#bluetoothCharacteristics.set(characteristic.id, characteristic);\n                return {};\n            }\n            case 'remove': {\n                if (params.characteristicProperties !== undefined) {\n                    throw new protocol_js_1.InvalidArgumentException(`Parameter \"characteristicProperties\" should not be provided for removing a Bluetooth characteristic`);\n                }\n                const characteristic = this.#getCharacteristic(service, params.characteristicUuid);\n                await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.removeCharacteristic', {\n                    characteristicId: characteristic.id,\n                });\n                service.characteristics.delete(params.characteristicUuid);\n                this.#bluetoothCharacteristics.delete(characteristic.id);\n                return {};\n            }\n            default:\n                throw new protocol_js_1.InvalidArgumentException(`Parameter \"type\" of ${params.type} is not supported`);\n        }\n    }\n    async simulateCharacteristicResponse(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        const device = this.#getDevice(params.address);\n        const service = this.#getService(device, params.serviceUuid);\n        const characteristic = this.#getCharacteristic(service, params.characteristicUuid);\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.simulateCharacteristicOperationResponse', {\n            characteristicId: characteristic.id,\n            type: params.type,\n            code: params.code,\n            ...(params.data && {\n                data: btoa(String.fromCharCode(...params.data)),\n            }),\n        });\n        return {};\n    }\n    async simulateDescriptor(params) {\n        const device = this.#getDevice(params.address);\n        const service = this.#getService(device, params.serviceUuid);\n        const characteristic = this.#getCharacteristic(service, params.characteristicUuid);\n        const context = this.#browsingContextStorage.getContext(params.context);\n        switch (params.type) {\n            case 'add': {\n                if (characteristic.descriptors.has(params.descriptorUuid)) {\n                    throw new protocol_js_1.InvalidArgumentException(`Descriptor with UUID ${params.descriptorUuid} already exists`);\n                }\n                const response = await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.addDescriptor', {\n                    characteristicId: characteristic.id,\n                    descriptorUuid: params.descriptorUuid,\n                });\n                const descriptor = new BluetoothDescriptor(response.descriptorId, params.descriptorUuid, characteristic);\n                characteristic.descriptors.set(params.descriptorUuid, descriptor);\n                this.#bluetoothDescriptors.set(descriptor.id, descriptor);\n                return {};\n            }\n            case 'remove': {\n                const descriptor = this.#getDescriptor(characteristic, params.descriptorUuid);\n                await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.removeDescriptor', {\n                    descriptorId: descriptor.id,\n                });\n                characteristic.descriptors.delete(params.descriptorUuid);\n                this.#bluetoothDescriptors.delete(descriptor.id);\n                return {};\n            }\n            default:\n                throw new protocol_js_1.InvalidArgumentException(`Parameter \"type\" of ${params.type} is not supported`);\n        }\n    }\n    async simulateDescriptorResponse(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        const device = this.#getDevice(params.address);\n        const service = this.#getService(device, params.serviceUuid);\n        const characteristic = this.#getCharacteristic(service, params.characteristicUuid);\n        const descriptor = this.#getDescriptor(characteristic, params.descriptorUuid);\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.simulateDescriptorOperationResponse', {\n            descriptorId: descriptor.id,\n            type: params.type,\n            code: params.code,\n            ...(params.data && {\n                data: btoa(String.fromCharCode(...params.data)),\n            }),\n        });\n        return {};\n    }\n    async simulateGattConnectionResponse(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.simulateGATTOperationResponse', {\n            address: params.address,\n            type: 'connection',\n            code: params.code,\n        });\n        return {};\n    }\n    async simulateGattDisconnection(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.simulateGATTDisconnection', {\n            address: params.address,\n        });\n        return {};\n    }\n    async simulateService(params) {\n        const device = this.#getDevice(params.address);\n        const context = this.#browsingContextStorage.getContext(params.context);\n        switch (params.type) {\n            case 'add': {\n                if (device.services.has(params.uuid)) {\n                    throw new protocol_js_1.InvalidArgumentException(`Service with UUID ${params.uuid} already exists`);\n                }\n                const response = await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.addService', {\n                    address: params.address,\n                    serviceUuid: params.uuid,\n                });\n                device.services.set(params.uuid, new BluetoothService(response.serviceId, params.uuid, device));\n                return {};\n            }\n            case 'remove': {\n                const service = this.#getService(device, params.uuid);\n                await context.cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.removeService', {\n                    serviceId: service.id,\n                });\n                device.services.delete(params.uuid);\n                return {};\n            }\n            default:\n                throw new protocol_js_1.InvalidArgumentException(`Parameter \"type\" of ${params.type} is not supported`);\n        }\n    }\n    onCdpTargetCreated(cdpTarget) {\n        cdpTarget.cdpClient.on('DeviceAccess.deviceRequestPrompted', (event) => {\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: 'bluetooth.requestDevicePromptUpdated',\n                params: {\n                    context: cdpTarget.id,\n                    prompt: event.id,\n                    devices: event.devices,\n                },\n            }, cdpTarget.id);\n        });\n        cdpTarget.browserCdpClient.on('BluetoothEmulation.gattOperationReceived', async (event) => {\n            switch (event.type) {\n                case 'connection':\n                    this.#eventManager.registerEvent({\n                        type: 'event',\n                        method: 'bluetooth.gattConnectionAttempted',\n                        params: {\n                            context: cdpTarget.id,\n                            address: event.address,\n                        },\n                    }, cdpTarget.id);\n                    return;\n                case 'discovery':\n                    // Chromium Web Bluetooth simulation generates this GATT discovery event when\n                    // a page attempts to get services for a given Bluetooth device for the first time.\n                    // This 'get services' operation is put on hold until a GATT discovery response\n                    // is sent to the simulation.\n                    // Note: Web Bluetooth automation (see https://webbluetoothcg.github.io/web-bluetooth/#automated-testing)\n                    // does not support simulating a GATT discovery response. This is because simulated services, characteristics,\n                    // or descriptors are immediately visible to the simulation, meaning it doesn't have a distinct\n                    // DISCOVERY state. Therefore, this code simulates a successful GATT discovery\n                    // response upon receiving this event.\n                    await cdpTarget.browserCdpClient.sendCommand('BluetoothEmulation.simulateGATTOperationResponse', {\n                        address: event.address,\n                        type: 'discovery',\n                        code: 0x0,\n                    });\n            }\n        });\n        cdpTarget.browserCdpClient.on('BluetoothEmulation.characteristicOperationReceived', (event) => {\n            if (!this.#bluetoothCharacteristics.has(event.characteristicId)) {\n                return;\n            }\n            let type;\n            if (event.type === 'write') {\n                // write-default-deprecated comes from\n                // https://webbluetoothcg.github.io/web-bluetooth/#dom-bluetoothremotegattcharacteristic-writevalue,\n                // which is deprecated so not supported.\n                if (event.writeType === 'write-default-deprecated') {\n                    return;\n                }\n                type = event.writeType;\n            }\n            else {\n                type = event.type;\n            }\n            const characteristic = this.#bluetoothCharacteristics.get(event.characteristicId);\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: 'bluetooth.characteristicEventGenerated',\n                params: {\n                    context: cdpTarget.id,\n                    address: characteristic.service.device.address,\n                    serviceUuid: characteristic.service.uuid,\n                    characteristicUuid: characteristic.uuid,\n                    type,\n                    ...(event.data && {\n                        data: Array.from(atob(event.data), (c) => c.charCodeAt(0)),\n                    }),\n                },\n            }, cdpTarget.id);\n        });\n        cdpTarget.browserCdpClient.on('BluetoothEmulation.descriptorOperationReceived', (event) => {\n            if (!this.#bluetoothDescriptors.has(event.descriptorId)) {\n                return;\n            }\n            const descriptor = this.#bluetoothDescriptors.get(event.descriptorId);\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: 'bluetooth.descriptorEventGenerated',\n                params: {\n                    context: cdpTarget.id,\n                    address: descriptor.characteristic.service.device.address,\n                    serviceUuid: descriptor.characteristic.service.uuid,\n                    characteristicUuid: descriptor.characteristic.uuid,\n                    descriptorUuid: descriptor.uuid,\n                    type: event.type,\n                    ...(event.data && {\n                        data: Array.from(atob(event.data), (c) => c.charCodeAt(0)),\n                    }),\n                },\n            }, cdpTarget.id);\n        });\n    }\n    async handleRequestDevicePrompt(params) {\n        const context = this.#browsingContextStorage.getContext(params.context);\n        if (params.accept) {\n            await context.cdpTarget.cdpClient.sendCommand('DeviceAccess.selectPrompt', {\n                id: params.prompt,\n                deviceId: params.device,\n            });\n        }\n        else {\n            await context.cdpTarget.cdpClient.sendCommand('DeviceAccess.cancelPrompt', {\n                id: params.prompt,\n            });\n        }\n        return {};\n    }\n}\nexports.BluetoothProcessor = BluetoothProcessor;\n//# sourceMappingURL=BluetoothProcessor.js.map","\"use strict\";\n/**\n * Copyright 2025 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ContextConfig = void 0;\n/**\n * Represents a context configurations. It can be global, per User Context, or per\n * Browsing Context. The undefined value means the config will be taken from the upstream\n * config. `null` values means the value should be default regardless of the upstream.\n */\nclass ContextConfig {\n    // keep-sorted start block=yes\n    acceptInsecureCerts;\n    devicePixelRatio;\n    disableNetworkDurableMessages;\n    downloadBehavior;\n    emulatedNetworkConditions;\n    // Extra headers are kept in CDP format.\n    extraHeaders;\n    geolocation;\n    locale;\n    prerenderingDisabled;\n    screenOrientation;\n    scriptingEnabled;\n    // Timezone is kept in CDP format with GMT prefix for offset values.\n    timezone;\n    userAgent;\n    userPromptHandler;\n    viewport;\n    // keep-sorted end\n    /**\n     * Merges multiple `ContextConfig` objects. The configs are merged in the order they are\n     * provided. For each property, the value from the last config that defines it will be\n     * used. The final result will not contain any `undefined` or `null` properties.\n     * `undefined` values are ignored. `null` values remove the already set value.\n     */\n    static merge(...configs) {\n        const result = new ContextConfig();\n        for (const config of configs) {\n            if (!config) {\n                continue;\n            }\n            for (const key in config) {\n                const value = config[key];\n                if (value === null) {\n                    delete result[key];\n                }\n                else if (value !== undefined) {\n                    result[key] = value;\n                }\n            }\n        }\n        return result;\n    }\n}\nexports.ContextConfig = ContextConfig;\n//# sourceMappingURL=ContextConfig.js.map","\"use strict\";\n/*\n * Copyright 2025 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ContextConfigStorage = void 0;\nconst ContextConfig_js_1 = require(\"./ContextConfig.js\");\n/**\n * Manages context-specific configurations. This class allows setting\n * configurations at three levels: global, user context, and browsing context.\n *\n * When `getActiveConfig` is called, it merges the configurations in a specific\n * order of precedence: `global -> user context -> browsing context`. For each\n * configuration property, the value from the highest-precedence level that has a\n * non-`undefined` value is used.\n *\n * The `update` methods (`updateGlobalConfig`, `updateUserContextConfig`,\n * `updateBrowsingContextConfig`) merge the provided configuration with the\n * existing one at the corresponding level. Properties with `undefined` values in\n * the provided configuration are ignored, preserving the existing value.\n */\nclass ContextConfigStorage {\n    #global = new ContextConfig_js_1.ContextConfig();\n    #userContextConfigs = new Map();\n    #browsingContextConfigs = new Map();\n    /**\n     * Updates the global configuration. Properties with `undefined` values in the\n     * provided `config` are ignored.\n     */\n    updateGlobalConfig(config) {\n        this.#global = ContextConfig_js_1.ContextConfig.merge(this.#global, config);\n    }\n    /**\n     * Updates the configuration for a specific browsing context. Properties with\n     * `undefined` values in the provided `config` are ignored.\n     */\n    updateBrowsingContextConfig(browsingContextId, config) {\n        this.#browsingContextConfigs.set(browsingContextId, ContextConfig_js_1.ContextConfig.merge(this.#browsingContextConfigs.get(browsingContextId), config));\n    }\n    /**\n     * Updates the configuration for a specific user context. Properties with\n     * `undefined` values in the provided `config` are ignored.\n     */\n    updateUserContextConfig(userContext, config) {\n        this.#userContextConfigs.set(userContext, ContextConfig_js_1.ContextConfig.merge(this.#userContextConfigs.get(userContext), config));\n    }\n    /**\n     * Returns the current global configuration.\n     */\n    getGlobalConfig() {\n        return this.#global;\n    }\n    /**\n     * Extra headers is a special case. The headers from the different levels have to be\n     * merged instead of being overridden.\n     */\n    #getExtraHeaders(topLevelBrowsingContextId, userContext) {\n        const globalHeaders = this.#global.extraHeaders ?? {};\n        const userContextHeaders = this.#userContextConfigs.get(userContext)?.extraHeaders ?? {};\n        const browsingContextHeaders = topLevelBrowsingContextId === undefined\n            ? {}\n            : (this.#browsingContextConfigs.get(topLevelBrowsingContextId)\n                ?.extraHeaders ?? {});\n        return { ...globalHeaders, ...userContextHeaders, ...browsingContextHeaders };\n    }\n    /**\n     * Calculates the active configuration by merging global, user context, and\n     * browsing context settings.\n     */\n    getActiveConfig(topLevelBrowsingContextId, userContext) {\n        let result = ContextConfig_js_1.ContextConfig.merge(this.#global, this.#userContextConfigs.get(userContext));\n        if (topLevelBrowsingContextId !== undefined) {\n            result = ContextConfig_js_1.ContextConfig.merge(result, this.#browsingContextConfigs.get(topLevelBrowsingContextId));\n        }\n        // Extra headers is a special case which have to be treated in a special way.\n        const extraHeaders = this.#getExtraHeaders(topLevelBrowsingContextId, userContext);\n        result.extraHeaders =\n            Object.keys(extraHeaders).length > 0 ? extraHeaders : undefined;\n        return result;\n    }\n}\nexports.ContextConfigStorage = ContextConfigStorage;\n//# sourceMappingURL=ContextConfigStorage.js.map","\"use strict\";\n/**\n * Copyright 2025 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UserContextStorage = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nclass UserContextStorage {\n    #browserClient;\n    constructor(browserClient) {\n        this.#browserClient = browserClient;\n    }\n    async getUserContexts() {\n        const result = await this.#browserClient.sendCommand('Target.getBrowserContexts');\n        return [\n            {\n                userContext: 'default',\n            },\n            ...result.browserContextIds.map((id) => {\n                return {\n                    userContext: id,\n                };\n            }),\n        ];\n    }\n    async verifyUserContextIdList(userContextIds) {\n        const foundContexts = new Set();\n        if (!userContextIds.length) {\n            return foundContexts;\n        }\n        const userContexts = await this.getUserContexts();\n        const knownUserContextIds = new Set(userContexts.map((userContext) => userContext.userContext));\n        for (const userContextId of userContextIds) {\n            if (!knownUserContextIds.has(userContextId)) {\n                throw new protocol_js_1.NoSuchUserContextException(`User context ${userContextId} not found`);\n            }\n            foundContexts.add(userContextId);\n        }\n        return foundContexts;\n    }\n}\nexports.UserContextStorage = UserContextStorage;\n//# sourceMappingURL=UserContextStorage.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Deferred = void 0;\nclass Deferred {\n    #isFinished = false;\n    #promise;\n    #result;\n    #resolve;\n    #reject;\n    get isFinished() {\n        return this.#isFinished;\n    }\n    get result() {\n        if (!this.#isFinished) {\n            throw new Error('Deferred is not finished yet');\n        }\n        return this.#result;\n    }\n    constructor() {\n        this.#promise = new Promise((resolve, reject) => {\n            this.#resolve = resolve;\n            this.#reject = reject;\n        });\n        // Needed to avoid `Uncaught (in promise)`. The promises returned by `then`\n        // and `catch` will be rejected anyway.\n        this.#promise.catch((_error) => {\n            // Intentionally empty.\n        });\n    }\n    then(onFulfilled, onRejected) {\n        return this.#promise.then(onFulfilled, onRejected);\n    }\n    catch(onRejected) {\n        return this.#promise.catch(onRejected);\n    }\n    resolve(value) {\n        this.#result = value;\n        if (!this.#isFinished) {\n            this.#isFinished = true;\n            this.#resolve(value);\n        }\n    }\n    reject(reason) {\n        if (!this.#isFinished) {\n            this.#isFinished = true;\n            this.#reject(reason);\n        }\n    }\n    finally(onFinally) {\n        return this.#promise.finally(onFinally);\n    }\n    [Symbol.toStringTag] = 'Promise';\n}\nexports.Deferred = Deferred;\n//# sourceMappingURL=Deferred.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTimestamp = getTimestamp;\nfunction getTimestamp() {\n    // `timestamp` from the event is MonotonicTime, not real time, so\n    // the best Mapper can do is to set the timestamp to the epoch time\n    // of the event arrived.\n    // https://chromedevtools.github.io/devtools-protocol/tot/Network/#type-MonotonicTime\n    return new Date().getTime();\n}\n//# sourceMappingURL=time.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.inchesFromCm = inchesFromCm;\n/** @return Given an input in cm, convert it to inches. */\nfunction inchesFromCm(cm) {\n    return cm / 2.54;\n}\n//# sourceMappingURL=unitConversions.js.map","\"use strict\";\n/*\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getSharedId = getSharedId;\nexports.parseSharedId = parseSharedId;\nconst SHARED_ID_DIVIDER = '_element_';\nfunction getSharedId(frameId, documentId, backendNodeId) {\n    return `f.${frameId}.d.${documentId}.e.${backendNodeId}`;\n}\nfunction parseLegacySharedId(sharedId) {\n    const match = sharedId.match(new RegExp(`(.*)${SHARED_ID_DIVIDER}(.*)`));\n    if (!match) {\n        // SharedId is incorrectly formatted.\n        return null;\n    }\n    const documentId = match[1];\n    const elementId = match[2];\n    if (documentId === undefined || elementId === undefined) {\n        return null;\n    }\n    const backendNodeId = parseInt(elementId ?? '');\n    if (isNaN(backendNodeId)) {\n        return null;\n    }\n    return {\n        documentId,\n        backendNodeId,\n    };\n}\nfunction parseSharedId(sharedId) {\n    // TODO: remove legacy check once ChromeDriver provides sharedId in the new format.\n    const legacyFormattedSharedId = parseLegacySharedId(sharedId);\n    if (legacyFormattedSharedId !== null) {\n        return { ...legacyFormattedSharedId, frameId: undefined };\n    }\n    const match = sharedId.match(/f\\.(.*)\\.d\\.(.*)\\.e\\.([0-9]*)/);\n    if (!match) {\n        // SharedId is incorrectly formatted.\n        return null;\n    }\n    const frameId = match[1];\n    const documentId = match[2];\n    const elementId = match[3];\n    if (frameId === undefined ||\n        documentId === undefined ||\n        elementId === undefined) {\n        return null;\n    }\n    const backendNodeId = parseInt(elementId ?? '');\n    if (isNaN(backendNodeId)) {\n        return null;\n    }\n    return {\n        frameId,\n        documentId,\n        backendNodeId,\n    };\n}\n//# sourceMappingURL=SharedId.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Realm = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\nconst ChannelProxy_js_1 = require(\"./ChannelProxy.js\");\nclass Realm {\n    #cdpClient;\n    #eventManager;\n    #executionContextId;\n    #logger;\n    #origin;\n    #realmId;\n    realmStorage;\n    constructor(cdpClient, eventManager, executionContextId, logger, origin, realmId, realmStorage) {\n        this.#cdpClient = cdpClient;\n        this.#eventManager = eventManager;\n        this.#executionContextId = executionContextId;\n        this.#logger = logger;\n        this.#origin = origin;\n        this.#realmId = realmId;\n        this.realmStorage = realmStorage;\n        this.realmStorage.addRealm(this);\n    }\n    cdpToBidiValue(cdpValue, resultOwnership) {\n        const bidiValue = this.serializeForBiDi(cdpValue.result.deepSerializedValue, new Map());\n        if (cdpValue.result.objectId) {\n            const objectId = cdpValue.result.objectId;\n            if (resultOwnership === \"root\" /* Script.ResultOwnership.Root */) {\n                // Extend BiDi value with `handle` based on required `resultOwnership`\n                // and  CDP response but not on the actual BiDi type.\n                bidiValue.handle = objectId;\n                // Remember all the handles sent to client.\n                this.realmStorage.knownHandlesToRealmMap.set(objectId, this.realmId);\n            }\n            else {\n                // No need to await for the object to be released.\n                void this.#releaseObject(objectId).catch((error) => this.#logger?.(log_js_1.LogType.debugError, error));\n            }\n        }\n        return bidiValue;\n    }\n    isHidden() {\n        return false;\n    }\n    /**\n     * Relies on the CDP to implement proper BiDi serialization, except:\n     * * CDP integer property `backendNodeId` is replaced with `sharedId` of\n     * `{documentId}_element_{backendNodeId}`;\n     * * CDP integer property `weakLocalObjectReference` is replaced with UUID `internalId`\n     * using unique-per serialization `internalIdMap`.\n     * * CDP type `platformobject` is replaced with `object`.\n     * @param deepSerializedValue - CDP value to be converted to BiDi.\n     * @param internalIdMap - Map from CDP integer `weakLocalObjectReference` to BiDi UUID\n     * `internalId`.\n     */\n    serializeForBiDi(deepSerializedValue, internalIdMap) {\n        if (Object.hasOwn(deepSerializedValue, 'weakLocalObjectReference')) {\n            const weakLocalObjectReference = deepSerializedValue.weakLocalObjectReference;\n            if (!internalIdMap.has(weakLocalObjectReference)) {\n                internalIdMap.set(weakLocalObjectReference, (0, uuid_js_1.uuidv4)());\n            }\n            deepSerializedValue.internalId = internalIdMap.get(weakLocalObjectReference);\n            delete deepSerializedValue['weakLocalObjectReference'];\n        }\n        if (deepSerializedValue.type === 'node' &&\n            deepSerializedValue.value &&\n            Object.hasOwn(deepSerializedValue.value, 'frameId')) {\n            // `frameId` is not needed in BiDi as it is not yet specified.\n            delete deepSerializedValue.value['frameId'];\n        }\n        // Platform object is a special case. It should have only `{type: object}`\n        // without `value` field.\n        if (deepSerializedValue.type === 'platformobject') {\n            return { type: 'object' };\n        }\n        const bidiValue = deepSerializedValue.value;\n        if (bidiValue === undefined) {\n            return deepSerializedValue;\n        }\n        // Recursively update the nested values.\n        if (['array', 'set', 'htmlcollection', 'nodelist'].includes(deepSerializedValue.type)) {\n            for (const i in bidiValue) {\n                bidiValue[i] = this.serializeForBiDi(bidiValue[i], internalIdMap);\n            }\n        }\n        if (['object', 'map'].includes(deepSerializedValue.type)) {\n            for (const i in bidiValue) {\n                bidiValue[i] = [\n                    this.serializeForBiDi(bidiValue[i][0], internalIdMap),\n                    this.serializeForBiDi(bidiValue[i][1], internalIdMap),\n                ];\n            }\n        }\n        return deepSerializedValue;\n    }\n    get realmId() {\n        return this.#realmId;\n    }\n    get executionContextId() {\n        return this.#executionContextId;\n    }\n    get origin() {\n        return this.#origin;\n    }\n    get source() {\n        return {\n            realm: this.realmId,\n        };\n    }\n    get cdpClient() {\n        return this.#cdpClient;\n    }\n    get baseInfo() {\n        return {\n            realm: this.realmId,\n            origin: this.origin,\n        };\n    }\n    async evaluate(expression, awaitPromise, resultOwnership = \"none\" /* Script.ResultOwnership.None */, serializationOptions = {}, userActivation = false, includeCommandLineApi = false) {\n        const cdpEvaluateResult = await this.cdpClient.sendCommand('Runtime.evaluate', {\n            contextId: this.executionContextId,\n            expression,\n            awaitPromise,\n            serializationOptions: Realm.#getSerializationOptions(\"deep\" /* Protocol.Runtime.SerializationOptionsSerialization.Deep */, serializationOptions),\n            userGesture: userActivation,\n            includeCommandLineAPI: includeCommandLineApi,\n        });\n        if (cdpEvaluateResult.exceptionDetails) {\n            return await this.#getExceptionResult(cdpEvaluateResult.exceptionDetails, 0, resultOwnership);\n        }\n        return {\n            realm: this.realmId,\n            result: this.cdpToBidiValue(cdpEvaluateResult, resultOwnership),\n            type: 'success',\n        };\n    }\n    #registerEvent(event) {\n        if (this.associatedBrowsingContexts.length === 0) {\n            this.#eventManager.registerGlobalEvent(event);\n        }\n        else {\n            for (const browsingContext of this.associatedBrowsingContexts) {\n                this.#eventManager.registerEvent(event, browsingContext.id);\n            }\n        }\n    }\n    initialize() {\n        if (!this.isHidden()) {\n            // Report only not-hidden realms.\n            this.#registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.Script.EventNames.RealmCreated,\n                params: this.realmInfo,\n            });\n        }\n    }\n    /**\n     * Serializes a given CDP object into BiDi, keeping references in the\n     * target's `globalThis`.\n     */\n    async serializeCdpObject(cdpRemoteObject, resultOwnership) {\n        // TODO: if the object is a primitive, return it directly without CDP roundtrip.\n        const argument = Realm.#cdpRemoteObjectToCallArgument(cdpRemoteObject);\n        const cdpValue = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n            functionDeclaration: String((remoteObject) => remoteObject),\n            awaitPromise: false,\n            arguments: [argument],\n            serializationOptions: {\n                serialization: \"deep\" /* Protocol.Runtime.SerializationOptionsSerialization.Deep */,\n            },\n            executionContextId: this.executionContextId,\n        });\n        return this.cdpToBidiValue(cdpValue, resultOwnership);\n    }\n    static #cdpRemoteObjectToCallArgument(cdpRemoteObject) {\n        if (cdpRemoteObject.objectId !== undefined) {\n            return { objectId: cdpRemoteObject.objectId };\n        }\n        if (cdpRemoteObject.unserializableValue !== undefined) {\n            return { unserializableValue: cdpRemoteObject.unserializableValue };\n        }\n        return { value: cdpRemoteObject.value };\n    }\n    /**\n     * Gets the string representation of an object. This is equivalent to\n     * calling `toString()` on the object value.\n     */\n    async stringifyObject(cdpRemoteObject) {\n        const { result } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n            functionDeclaration: String((remoteObject) => String(remoteObject)),\n            awaitPromise: false,\n            arguments: [cdpRemoteObject],\n            returnByValue: true,\n            executionContextId: this.executionContextId,\n        });\n        return result.value;\n    }\n    async #flattenKeyValuePairs(mappingLocalValue) {\n        const keyValueArray = await Promise.all(mappingLocalValue.map(async ([key, value]) => {\n            let keyArg;\n            if (typeof key === 'string') {\n                // Key is a string.\n                keyArg = { value: key };\n            }\n            else {\n                // Key is a serialized value.\n                keyArg = await this.deserializeForCdp(key);\n            }\n            const valueArg = await this.deserializeForCdp(value);\n            return [keyArg, valueArg];\n        }));\n        return keyValueArray.flat();\n    }\n    async #flattenValueList(listLocalValue) {\n        return await Promise.all(listLocalValue.map((localValue) => this.deserializeForCdp(localValue)));\n    }\n    async #serializeCdpExceptionDetails(cdpExceptionDetails, lineOffset, resultOwnership) {\n        const callFrames = cdpExceptionDetails.stackTrace?.callFrames.map((frame) => ({\n            url: frame.url,\n            functionName: frame.functionName,\n            lineNumber: frame.lineNumber - lineOffset,\n            columnNumber: frame.columnNumber,\n        })) ?? [];\n        // Exception should always be there.\n        const exception = cdpExceptionDetails.exception;\n        return {\n            exception: await this.serializeCdpObject(exception, resultOwnership),\n            columnNumber: cdpExceptionDetails.columnNumber,\n            lineNumber: cdpExceptionDetails.lineNumber - lineOffset,\n            stackTrace: {\n                callFrames,\n            },\n            text: (await this.stringifyObject(exception)) || cdpExceptionDetails.text,\n        };\n    }\n    async callFunction(functionDeclaration, awaitPromise, thisLocalValue = {\n        type: 'undefined',\n    }, argumentsLocalValues = [], resultOwnership = \"none\" /* Script.ResultOwnership.None */, serializationOptions = {}, userActivation = false) {\n        const callFunctionAndSerializeScript = `(...args) => {\n      function callFunction(f, args) {\n        const deserializedThis = args.shift();\n        const deserializedArgs = args;\n        return f.apply(deserializedThis, deserializedArgs);\n      }\n      return callFunction((\n        ${functionDeclaration}\n      ), args);\n    }`;\n        const thisAndArgumentsList = [\n            await this.deserializeForCdp(thisLocalValue),\n            ...(await Promise.all(argumentsLocalValues.map(async (argumentLocalValue) => await this.deserializeForCdp(argumentLocalValue)))),\n        ];\n        let cdpCallFunctionResult;\n        try {\n            cdpCallFunctionResult = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n                functionDeclaration: callFunctionAndSerializeScript,\n                awaitPromise,\n                arguments: thisAndArgumentsList,\n                serializationOptions: Realm.#getSerializationOptions(\"deep\" /* Protocol.Runtime.SerializationOptionsSerialization.Deep */, serializationOptions),\n                executionContextId: this.executionContextId,\n                userGesture: userActivation,\n            });\n        }\n        catch (error) {\n            // Heuristic to determine if the problem is in the argument.\n            // The check can be done on the `deserialization` step, but this approach\n            // helps to save round-trips.\n            if (error.code === -32000 /* CdpErrorConstants.GENERIC_ERROR */ &&\n                [\n                    'Could not find object with given id',\n                    'Argument should belong to the same JavaScript world as target object',\n                    'Invalid remote object id',\n                ].includes(error.message)) {\n                throw new protocol_js_1.NoSuchHandleException('Handle was not found.');\n            }\n            throw error;\n        }\n        if (cdpCallFunctionResult.exceptionDetails) {\n            return await this.#getExceptionResult(cdpCallFunctionResult.exceptionDetails, 1, resultOwnership);\n        }\n        return {\n            type: 'success',\n            result: this.cdpToBidiValue(cdpCallFunctionResult, resultOwnership),\n            realm: this.realmId,\n        };\n    }\n    async deserializeForCdp(localValue) {\n        if ('handle' in localValue && localValue.handle) {\n            return { objectId: localValue.handle };\n            // We tried to find a handle value but failed\n            // This allows us to have exhaustive switch on `localValue.type`\n        }\n        else if ('handle' in localValue || 'sharedId' in localValue) {\n            throw new protocol_js_1.NoSuchHandleException('Handle was not found.');\n        }\n        switch (localValue.type) {\n            case 'undefined':\n                return { unserializableValue: 'undefined' };\n            case 'null':\n                return { unserializableValue: 'null' };\n            case 'string':\n                return { value: localValue.value };\n            case 'number':\n                if (localValue.value === 'NaN') {\n                    return { unserializableValue: 'NaN' };\n                }\n                else if (localValue.value === '-0') {\n                    return { unserializableValue: '-0' };\n                }\n                else if (localValue.value === 'Infinity') {\n                    return { unserializableValue: 'Infinity' };\n                }\n                else if (localValue.value === '-Infinity') {\n                    return { unserializableValue: '-Infinity' };\n                }\n                return {\n                    value: localValue.value,\n                };\n            case 'boolean':\n                return { value: Boolean(localValue.value) };\n            case 'bigint':\n                return {\n                    unserializableValue: `BigInt(${JSON.stringify(localValue.value)})`,\n                };\n            case 'date':\n                return {\n                    unserializableValue: `new Date(Date.parse(${JSON.stringify(localValue.value)}))`,\n                };\n            case 'regexp':\n                return {\n                    unserializableValue: `new RegExp(${JSON.stringify(localValue.value.pattern)}, ${JSON.stringify(localValue.value.flags)})`,\n                };\n            case 'map': {\n                // TODO: If none of the nested keys and values has a remote\n                // reference, serialize to `unserializableValue` without CDP roundtrip.\n                const keyValueArray = await this.#flattenKeyValuePairs(localValue.value);\n                const { result } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n                    functionDeclaration: String((...args) => {\n                        const result = new Map();\n                        for (let i = 0; i < args.length; i += 2) {\n                            result.set(args[i], args[i + 1]);\n                        }\n                        return result;\n                    }),\n                    awaitPromise: false,\n                    arguments: keyValueArray,\n                    returnByValue: false,\n                    executionContextId: this.executionContextId,\n                });\n                // TODO(#375): Release `result.objectId` after using.\n                return { objectId: result.objectId };\n            }\n            case 'object': {\n                // TODO: If none of the nested keys and values has a remote\n                // reference, serialize to `unserializableValue` without CDP roundtrip.\n                const keyValueArray = await this.#flattenKeyValuePairs(localValue.value);\n                const { result } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n                    functionDeclaration: String((...args) => {\n                        const result = {};\n                        for (let i = 0; i < args.length; i += 2) {\n                            // Key should be either `string`, `number`, or `symbol`.\n                            const key = args[i];\n                            result[key] = args[i + 1];\n                        }\n                        return result;\n                    }),\n                    awaitPromise: false,\n                    arguments: keyValueArray,\n                    returnByValue: false,\n                    executionContextId: this.executionContextId,\n                });\n                // TODO(#375): Release `result.objectId` after using.\n                return { objectId: result.objectId };\n            }\n            case 'array': {\n                // TODO: If none of the nested items has a remote reference,\n                // serialize to `unserializableValue` without CDP roundtrip.\n                const args = await this.#flattenValueList(localValue.value);\n                const { result } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n                    functionDeclaration: String((...args) => args),\n                    awaitPromise: false,\n                    arguments: args,\n                    returnByValue: false,\n                    executionContextId: this.executionContextId,\n                });\n                // TODO(#375): Release `result.objectId` after using.\n                return { objectId: result.objectId };\n            }\n            case 'set': {\n                // TODO: if none of the nested items has a remote reference,\n                // serialize to `unserializableValue` without CDP roundtrip.\n                const args = await this.#flattenValueList(localValue.value);\n                const { result } = await this.cdpClient.sendCommand('Runtime.callFunctionOn', {\n                    functionDeclaration: String((...args) => new Set(args)),\n                    awaitPromise: false,\n                    arguments: args,\n                    returnByValue: false,\n                    executionContextId: this.executionContextId,\n                });\n                // TODO(#375): Release `result.objectId` after using.\n                return { objectId: result.objectId };\n            }\n            case 'channel': {\n                const channelProxy = new ChannelProxy_js_1.ChannelProxy(localValue.value, this.#logger);\n                const channelProxySendMessageHandle = await channelProxy.init(this, this.#eventManager);\n                return { objectId: channelProxySendMessageHandle };\n            }\n            // TODO(#375): Dispose of nested objects.\n        }\n        // Intentionally outside to handle unknown types\n        throw new Error(`Value ${JSON.stringify(localValue)} is not deserializable.`);\n    }\n    async #getExceptionResult(exceptionDetails, lineOffset, resultOwnership) {\n        return {\n            exceptionDetails: await this.#serializeCdpExceptionDetails(exceptionDetails, lineOffset, resultOwnership),\n            realm: this.realmId,\n            type: 'exception',\n        };\n    }\n    static #getSerializationOptions(serialization, serializationOptions) {\n        return {\n            serialization,\n            additionalParameters: Realm.#getAdditionalSerializationParameters(serializationOptions),\n            ...Realm.#getMaxObjectDepth(serializationOptions),\n        };\n    }\n    static #getAdditionalSerializationParameters(serializationOptions) {\n        const additionalParameters = {};\n        if (serializationOptions.maxDomDepth !== undefined) {\n            additionalParameters['maxNodeDepth'] =\n                serializationOptions.maxDomDepth === null\n                    ? 1000\n                    : serializationOptions.maxDomDepth;\n        }\n        if (serializationOptions.includeShadowTree !== undefined) {\n            additionalParameters['includeShadowTree'] =\n                serializationOptions.includeShadowTree;\n        }\n        return additionalParameters;\n    }\n    static #getMaxObjectDepth(serializationOptions) {\n        return serializationOptions.maxObjectDepth === undefined ||\n            serializationOptions.maxObjectDepth === null\n            ? {}\n            : { maxDepth: serializationOptions.maxObjectDepth };\n    }\n    async #releaseObject(handle) {\n        try {\n            await this.cdpClient.sendCommand('Runtime.releaseObject', {\n                objectId: handle,\n            });\n        }\n        catch (error) {\n            // Heuristic to determine if the problem is in the unknown handler.\n            // Ignore the error if so.\n            if (!(error.code === -32000 /* CdpErrorConstants.GENERIC_ERROR */ &&\n                error.message === 'Invalid remote object id')) {\n                throw error;\n            }\n        }\n    }\n    async disown(handle) {\n        // Disowning an object from different realm does nothing.\n        if (this.realmStorage.knownHandlesToRealmMap.get(handle) !== this.realmId) {\n            return;\n        }\n        await this.#releaseObject(handle);\n        this.realmStorage.knownHandlesToRealmMap.delete(handle);\n    }\n    dispose() {\n        this.#registerEvent({\n            type: 'event',\n            method: protocol_js_1.ChromiumBidi.Script.EventNames.RealmDestroyed,\n            params: {\n                realm: this.realmId,\n            },\n        });\n    }\n}\nexports.Realm = Realm;\n//# sourceMappingURL=Realm.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WindowRealm = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst Realm_js_1 = require(\"./Realm.js\");\nconst SharedId_js_1 = require(\"./SharedId.js\");\nclass WindowRealm extends Realm_js_1.Realm {\n    #browsingContextId;\n    #browsingContextStorage;\n    sandbox;\n    constructor(browsingContextId, browsingContextStorage, cdpClient, eventManager, executionContextId, logger, origin, realmId, realmStorage, sandbox) {\n        super(cdpClient, eventManager, executionContextId, logger, origin, realmId, realmStorage);\n        this.#browsingContextId = browsingContextId;\n        this.#browsingContextStorage = browsingContextStorage;\n        this.sandbox = sandbox;\n        this.initialize();\n    }\n    #getBrowsingContextId(navigableId) {\n        const maybeBrowsingContext = this.#browsingContextStorage\n            .getAllContexts()\n            .find((context) => context.navigableId === navigableId);\n        return maybeBrowsingContext?.id ?? 'UNKNOWN';\n    }\n    get browsingContext() {\n        return this.#browsingContextStorage.getContext(this.#browsingContextId);\n    }\n    /**\n     * Do not expose to user hidden realms.\n     */\n    isHidden() {\n        return this.realmStorage.hiddenSandboxes.has(this.sandbox);\n    }\n    get associatedBrowsingContexts() {\n        return [this.browsingContext];\n    }\n    get realmType() {\n        return 'window';\n    }\n    get realmInfo() {\n        return {\n            ...this.baseInfo,\n            type: this.realmType,\n            context: this.#browsingContextId,\n            sandbox: this.sandbox,\n        };\n    }\n    get source() {\n        return {\n            realm: this.realmId,\n            context: this.browsingContext.id,\n        };\n    }\n    serializeForBiDi(deepSerializedValue, internalIdMap) {\n        const bidiValue = deepSerializedValue.value;\n        if (deepSerializedValue.type === 'node' && bidiValue !== undefined) {\n            if (Object.hasOwn(bidiValue, 'backendNodeId')) {\n                let navigableId = this.browsingContext.navigableId ?? 'UNKNOWN';\n                if (Object.hasOwn(bidiValue, 'loaderId')) {\n                    // `loaderId` should be always there after ~2024-03-05, when\n                    // https://crrev.com/c/5116240 reaches stable.\n                    // TODO: remove the check after the date.\n                    navigableId = bidiValue.loaderId;\n                    delete bidiValue['loaderId'];\n                }\n                deepSerializedValue.sharedId =\n                    (0, SharedId_js_1.getSharedId)(this.#getBrowsingContextId(navigableId), navigableId, bidiValue.backendNodeId);\n                delete bidiValue['backendNodeId'];\n            }\n            if (Object.hasOwn(bidiValue, 'children')) {\n                for (const i in bidiValue.children) {\n                    bidiValue.children[i] = this.serializeForBiDi(bidiValue.children[i], internalIdMap);\n                }\n            }\n            if (Object.hasOwn(bidiValue, 'shadowRoot') &&\n                bidiValue.shadowRoot !== null) {\n                bidiValue.shadowRoot = this.serializeForBiDi(bidiValue.shadowRoot, internalIdMap);\n            }\n            // `namespaceURI` can be is either `null` or non-empty string.\n            if (bidiValue.namespaceURI === '') {\n                bidiValue.namespaceURI = null;\n            }\n        }\n        return super.serializeForBiDi(deepSerializedValue, internalIdMap);\n    }\n    async deserializeForCdp(localValue) {\n        if ('sharedId' in localValue && localValue.sharedId) {\n            const parsedSharedId = (0, SharedId_js_1.parseSharedId)(localValue.sharedId);\n            if (parsedSharedId === null) {\n                throw new protocol_js_1.NoSuchNodeException(`SharedId \"${localValue.sharedId}\" was not found.`);\n            }\n            const { documentId, backendNodeId } = parsedSharedId;\n            // TODO: add proper validation if the element is accessible from the current realm.\n            if (this.browsingContext.navigableId !== documentId) {\n                throw new protocol_js_1.NoSuchNodeException(`SharedId \"${localValue.sharedId}\" belongs to different document. Current document is ${this.browsingContext.navigableId}.`);\n            }\n            try {\n                const { object } = await this.cdpClient.sendCommand('DOM.resolveNode', {\n                    backendNodeId,\n                    executionContextId: this.executionContextId,\n                });\n                // TODO(#375): Release `obj.object.objectId` after using.\n                return { objectId: object.objectId };\n            }\n            catch (error) {\n                // Heuristic to detect \"no such node\" exception. Based on the  specific\n                // CDP implementation.\n                if (error.code === -32000 /* CdpErrorConstants.GENERIC_ERROR */ &&\n                    error.message === 'No node with given id found') {\n                    throw new protocol_js_1.NoSuchNodeException(`SharedId \"${localValue.sharedId}\" was not found.`);\n                }\n                throw new protocol_js_1.UnknownErrorException(error.message, error.stack);\n            }\n        }\n        return await super.deserializeForCdp(localValue);\n    }\n    async evaluate(expression, awaitPromise, resultOwnership, serializationOptions, userActivation, includeCommandLineApi) {\n        await this.#browsingContextStorage\n            .getContext(this.#browsingContextId)\n            .targetUnblockedOrThrow();\n        return await super.evaluate(expression, awaitPromise, resultOwnership, serializationOptions, userActivation, includeCommandLineApi);\n    }\n    async callFunction(functionDeclaration, awaitPromise, thisLocalValue, argumentsLocalValues, resultOwnership, serializationOptions, userActivation) {\n        await this.#browsingContextStorage\n            .getContext(this.#browsingContextId)\n            .targetUnblockedOrThrow();\n        return await super.callFunction(functionDeclaration, awaitPromise, thisLocalValue, argumentsLocalValues, resultOwnership, serializationOptions, userActivation);\n    }\n}\nexports.WindowRealm = WindowRealm;\n//# sourceMappingURL=WindowRealm.js.map","\"use strict\";\n/*\n *  Copyright 2024 Google LLC.\n *  Copyright (c) Microsoft Corporation.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.urlMatchesAboutBlank = urlMatchesAboutBlank;\n/**\n * A URL matches about:blank if its scheme is \"about\", its path contains a single string\n * \"blank\", its username and password are the empty string, and its host is null.\n * https://html.spec.whatwg.org/multipage/urls-and-fetching.html#matches-about:blank\n * @param {string} url\n * @return {boolean}\n */\nfunction urlMatchesAboutBlank(url) {\n    // An empty string is a special case, and considered to be about:blank.\n    // https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-open-steps\n    if (url === '') {\n        return true;\n    }\n    try {\n        const parsedUrl = new URL(url);\n        const schema = parsedUrl.protocol.replace(/:$/, '');\n        return (schema.toLowerCase() === 'about' &&\n            parsedUrl.pathname.toLowerCase() === 'blank' &&\n            parsedUrl.username === '' &&\n            parsedUrl.password === '' &&\n            parsedUrl.host === '');\n    }\n    catch (err) {\n        // Wrong URL considered do not match about:blank.\n        if (err instanceof TypeError) {\n            return false;\n        }\n        // Re-throw other unexpected errors.\n        throw err;\n    }\n}\n//# sourceMappingURL=urlHelpers.js.map","\"use strict\";\n/*\n *  Copyright 2024 Google LLC.\n *  Copyright (c) Microsoft Corporation.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NavigationTracker = exports.NavigationState = exports.NavigationResult = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst Deferred_js_1 = require(\"../../../utils/Deferred.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst time_js_1 = require(\"../../../utils/time.js\");\nconst urlHelpers_js_1 = require(\"../../../utils/urlHelpers.js\");\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\nclass NavigationResult {\n    eventName;\n    message;\n    constructor(eventName, message) {\n        this.eventName = eventName;\n        this.message = message;\n    }\n}\nexports.NavigationResult = NavigationResult;\nclass NavigationState {\n    navigationId = (0, uuid_js_1.uuidv4)();\n    #browsingContextId;\n    #started = false;\n    #finished = new Deferred_js_1.Deferred();\n    url;\n    loaderId;\n    #isInitial;\n    #eventManager;\n    committed = new Deferred_js_1.Deferred();\n    isFragmentNavigation;\n    get finished() {\n        return this.#finished;\n    }\n    constructor(url, browsingContextId, isInitial, eventManager) {\n        this.#browsingContextId = browsingContextId;\n        this.url = url;\n        this.#isInitial = isInitial;\n        this.#eventManager = eventManager;\n    }\n    navigationInfo() {\n        return {\n            context: this.#browsingContextId,\n            navigation: this.navigationId,\n            timestamp: (0, time_js_1.getTimestamp)(),\n            url: this.url,\n        };\n    }\n    start() {\n        if (\n        // Initial navigation should not be reported.\n        !this.#isInitial &&\n            // No need in reporting started navigation twice.\n            !this.#started &&\n            // No need for reporting fragment navigations. Step 13 vs step 16 of the spec:\n            // https://html.spec.whatwg.org/#beginning-navigation:webdriver-bidi-navigation-started\n            !this.isFragmentNavigation) {\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.NavigationStarted,\n                params: this.navigationInfo(),\n            }, this.#browsingContextId);\n        }\n        this.#started = true;\n    }\n    #finish(navigationResult) {\n        this.#started = true;\n        if (!this.#isInitial &&\n            !this.#finished.isFinished &&\n            navigationResult.eventName !== \"browsingContext.load\" /* NavigationEventName.Load */) {\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: navigationResult.eventName,\n                params: this.navigationInfo(),\n            }, this.#browsingContextId);\n        }\n        this.#finished.resolve(navigationResult);\n    }\n    frameNavigated() {\n        this.committed.resolve();\n        if (!this.#isInitial) {\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.NavigationCommitted,\n                params: this.navigationInfo(),\n            }, this.#browsingContextId);\n        }\n    }\n    fragmentNavigated() {\n        this.committed.resolve();\n        this.#finish(new NavigationResult(\"browsingContext.fragmentNavigated\" /* NavigationEventName.FragmentNavigated */));\n    }\n    load() {\n        this.#finish(new NavigationResult(\"browsingContext.load\" /* NavigationEventName.Load */));\n    }\n    fail(message) {\n        this.#finish(new NavigationResult(this.committed.isFinished\n            ? \"browsingContext.navigationAborted\" /* NavigationEventName.NavigationAborted */\n            : \"browsingContext.navigationFailed\" /* NavigationEventName.NavigationFailed */, message));\n    }\n}\nexports.NavigationState = NavigationState;\n/**\n * Keeps track of navigations. Details: http://go/webdriver:bidi-navigation\n */\nclass NavigationTracker {\n    #eventManager;\n    #logger;\n    #loaderIdToNavigationsMap = new Map();\n    #browsingContextId;\n    /**\n     * Last committed navigation is committed, but is not guaranteed to be finished, as it\n     * can still wait for `load` or `DOMContentLoaded` events.\n     */\n    #lastCommittedNavigation;\n    /**\n     * Pending navigation is a navigation that is started but not yet committed.\n     */\n    #pendingNavigation;\n    // Flags if the initial navigation to `about:blank` is in progress.\n    #isInitialNavigation = true;\n    constructor(url, browsingContextId, eventManager, logger) {\n        this.#browsingContextId = browsingContextId;\n        this.#eventManager = eventManager;\n        this.#logger = logger;\n        this.#isInitialNavigation = true;\n        // The initial navigation is always committed.\n        this.#lastCommittedNavigation = new NavigationState(url, browsingContextId, (0, urlHelpers_js_1.urlMatchesAboutBlank)(url), this.#eventManager);\n    }\n    /**\n     * Returns current started ongoing navigation. It can be either a started pending\n     * navigation, or one is already navigated.\n     */\n    get currentNavigationId() {\n        if (this.#pendingNavigation?.isFragmentNavigation === false) {\n            // Use pending navigation if it is started and it is not a fragment navigation.\n            return this.#pendingNavigation.navigationId;\n        }\n        // If the pending navigation is a fragment one, or if it is not exists, the last\n        // committed navigation should be used.\n        return this.#lastCommittedNavigation.navigationId;\n    }\n    /**\n     * Flags if the current navigation relates to the initial to `about:blank` navigation.\n     */\n    get isInitialNavigation() {\n        return this.#isInitialNavigation;\n    }\n    /**\n     * Url of the last navigated navigation.\n     */\n    get url() {\n        return this.#lastCommittedNavigation.url;\n    }\n    /**\n     * Creates a pending navigation e.g. when navigation command is called. Required to\n     * provide navigation id before the actual navigation is started. It will be used when\n     * navigation started. Can be aborted, failed, fragment navigated, or became a current\n     * navigation.\n     */\n    createPendingNavigation(url, canBeInitialNavigation = false) {\n        this.#logger?.(log_js_1.LogType.debug, 'createCommandNavigation');\n        this.#isInitialNavigation =\n            canBeInitialNavigation &&\n                this.#isInitialNavigation &&\n                (0, urlHelpers_js_1.urlMatchesAboutBlank)(url);\n        this.#pendingNavigation?.fail('navigation canceled by concurrent navigation');\n        const navigation = new NavigationState(url, this.#browsingContextId, this.#isInitialNavigation, this.#eventManager);\n        this.#pendingNavigation = navigation;\n        return navigation;\n    }\n    dispose() {\n        this.#pendingNavigation?.fail('navigation canceled by context disposal');\n        this.#lastCommittedNavigation.fail('navigation canceled by context disposal');\n    }\n    // Update the current url.\n    onTargetInfoChanged(url) {\n        this.#logger?.(log_js_1.LogType.debug, `onTargetInfoChanged ${url}`);\n        this.#lastCommittedNavigation.url = url;\n    }\n    #getNavigationForFrameNavigated(url, loaderId) {\n        if (this.#loaderIdToNavigationsMap.has(loaderId)) {\n            return this.#loaderIdToNavigationsMap.get(loaderId);\n        }\n        if (this.#pendingNavigation !== undefined &&\n            this.#pendingNavigation.loaderId === undefined) {\n            // This can be a pending navigation to `about:blank` created by a command. Use the\n            // pending navigation in this case.\n            return this.#pendingNavigation;\n        }\n        // Create a new pending navigation.\n        return this.createPendingNavigation(url, true);\n    }\n    /**\n     * @param {string} unreachableUrl indicated the navigation is actually failed.\n     */\n    frameNavigated(url, loaderId, unreachableUrl) {\n        this.#logger?.(log_js_1.LogType.debug, `frameNavigated ${url}`);\n        if (unreachableUrl !== undefined) {\n            // The navigation failed.\n            const navigation = this.#loaderIdToNavigationsMap.get(loaderId) ??\n                this.#pendingNavigation ??\n                this.createPendingNavigation(unreachableUrl, true);\n            navigation.url = unreachableUrl;\n            navigation.start();\n            navigation.fail('the requested url is unreachable');\n            return;\n        }\n        const navigation = this.#getNavigationForFrameNavigated(url, loaderId);\n        if (navigation !== this.#lastCommittedNavigation) {\n            // Even though the `lastCommittedNavigation` is navigated, it still can be waiting\n            // for `load` or `DOMContentLoaded` events.\n            this.#lastCommittedNavigation.fail('navigation canceled by concurrent navigation');\n        }\n        navigation.url = url;\n        navigation.loaderId = loaderId;\n        this.#loaderIdToNavigationsMap.set(loaderId, navigation);\n        navigation.start();\n        navigation.frameNavigated();\n        this.#lastCommittedNavigation = navigation;\n        if (this.#pendingNavigation === navigation) {\n            this.#pendingNavigation = undefined;\n        }\n    }\n    navigatedWithinDocument(url, navigationType) {\n        this.#logger?.(log_js_1.LogType.debug, `navigatedWithinDocument ${url}, ${navigationType}`);\n        // Current navigation URL should be updated.\n        this.#lastCommittedNavigation.url = url;\n        if (navigationType !== 'fragment') {\n            // TODO: check for other navigation types, like `javascript`.\n            return;\n        }\n        // There is no way to map `navigatedWithinDocument` to a specific navigation. Consider\n        // it is the pending navigation, if it is a fragment one.\n        const fragmentNavigation = this.#pendingNavigation?.isFragmentNavigation === true\n            ? this.#pendingNavigation\n            : new NavigationState(url, this.#browsingContextId, false, this.#eventManager);\n        // Finish ongoing navigation.\n        fragmentNavigation.fragmentNavigated();\n        if (fragmentNavigation === this.#pendingNavigation) {\n            this.#pendingNavigation = undefined;\n        }\n    }\n    /**\n     * Required to mark navigation as fully complete.\n     * TODO: navigation should be complete when it became the current one on\n     * `Page.frameNavigated` or on navigating command finished with a new loader Id.\n     */\n    loadPageEvent(loaderId) {\n        this.#logger?.(log_js_1.LogType.debug, 'loadPageEvent');\n        // Even if it was an initial navigation, it is finished.\n        this.#isInitialNavigation = false;\n        this.#loaderIdToNavigationsMap.get(loaderId)?.load();\n    }\n    /**\n     * Fail navigation due to navigation command failed.\n     */\n    failNavigation(navigation, errorText) {\n        this.#logger?.(log_js_1.LogType.debug, 'failCommandNavigation');\n        navigation.fail(errorText);\n    }\n    /**\n     * Updates the navigation's `loaderId` and sets it as current one, if it is a\n     * cross-document navigation.\n     */\n    navigationCommandFinished(navigation, loaderId) {\n        this.#logger?.(log_js_1.LogType.debug, `finishCommandNavigation ${navigation.navigationId}, ${loaderId}`);\n        if (loaderId !== undefined) {\n            navigation.loaderId = loaderId;\n            this.#loaderIdToNavigationsMap.set(loaderId, navigation);\n        }\n        navigation.isFragmentNavigation = loaderId === undefined;\n    }\n    frameStartedNavigating(url, loaderId, navigationType) {\n        this.#logger?.(log_js_1.LogType.debug, `frameStartedNavigating ${url}, ${loaderId}`);\n        if (this.#pendingNavigation &&\n            this.#pendingNavigation?.loaderId !== undefined &&\n            this.#pendingNavigation?.loaderId !== loaderId) {\n            // If there is a pending navigation with loader id set, but not equal to the new\n            // loader id, cancel pending navigation.\n            this.#pendingNavigation?.fail('navigation canceled by concurrent navigation');\n            this.#pendingNavigation = undefined;\n        }\n        if (this.#loaderIdToNavigationsMap.has(loaderId)) {\n            const existingNavigation = this.#loaderIdToNavigationsMap.get(loaderId);\n            // Navigation can be changed from `sameDocument` to `differentDocument`.\n            existingNavigation.isFragmentNavigation =\n                NavigationTracker.#isFragmentNavigation(navigationType);\n            this.#pendingNavigation = existingNavigation;\n            return;\n        }\n        const pendingNavigation = this.#pendingNavigation ?? this.createPendingNavigation(url, true);\n        this.#loaderIdToNavigationsMap.set(loaderId, pendingNavigation);\n        pendingNavigation.isFragmentNavigation =\n            NavigationTracker.#isFragmentNavigation(navigationType);\n        pendingNavigation.url = url;\n        pendingNavigation.loaderId = loaderId;\n        pendingNavigation.start();\n    }\n    static #isFragmentNavigation(navigationType) {\n        // Page.frameStartedNavigating.navigationType can be one of the following values:\n        // reload, reloadBypassingCache, restore, restoreWithPost, historySameDocument,\n        // historyDifferentDocument, sameDocument, differentDocument.\n        // https://chromedevtools.github.io/devtools-protocol/tot/Page/#event-frameStartedNavigating\n        return ['historySameDocument', 'sameDocument'].includes(navigationType);\n    }\n    /**\n     * If there is a navigation with the loaderId equals to the network request id, it means\n     * that the navigation failed.\n     */\n    networkLoadingFailed(loaderId, errorText) {\n        this.#loaderIdToNavigationsMap.get(loaderId)?.fail(errorText);\n    }\n}\nexports.NavigationTracker = NavigationTracker;\n//# sourceMappingURL=NavigationTracker.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BrowsingContextImpl = void 0;\nexports.serializeOrigin = serializeOrigin;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst assert_js_1 = require(\"../../../utils/assert.js\");\nconst Deferred_js_1 = require(\"../../../utils/Deferred.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst time_js_1 = require(\"../../../utils/time.js\");\nconst unitConversions_js_1 = require(\"../../../utils/unitConversions.js\");\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\nconst SharedId_js_1 = require(\"../script/SharedId.js\");\nconst WindowRealm_js_1 = require(\"../script/WindowRealm.js\");\nconst NavigationTracker_js_1 = require(\"./NavigationTracker.js\");\nclass BrowsingContextImpl {\n    static LOGGER_PREFIX = `${log_js_1.LogType.debug}:browsingContext`;\n    /** Direct children browsing contexts. */\n    #children = new Set();\n    /** The ID of this browsing context. */\n    #id;\n    userContext;\n    // Used for running helper scripts.\n    #hiddenSandbox = (0, uuid_js_1.uuidv4)();\n    #downloadIdToUrlMap = new Map();\n    /**\n     * The ID of the parent browsing context.\n     * If null, this is a top-level context.\n     */\n    #loaderId;\n    #parentId = null;\n    #originalOpener;\n    #lifecycle = {\n        DOMContentLoaded: new Deferred_js_1.Deferred(),\n        load: new Deferred_js_1.Deferred(),\n    };\n    #cdpTarget;\n    #defaultRealmDeferred = new Deferred_js_1.Deferred();\n    #browsingContextStorage;\n    #eventManager;\n    #logger;\n    #navigationTracker;\n    #realmStorage;\n    #configStorage;\n    // Set when the user prompt is opened. Required to provide the type in closing event.\n    #lastUserPromptType;\n    constructor(id, parentId, userContext, cdpTarget, eventManager, browsingContextStorage, realmStorage, configStorage, url, originalOpener, logger) {\n        this.#cdpTarget = cdpTarget;\n        this.#id = id;\n        this.#parentId = parentId;\n        this.userContext = userContext;\n        this.#eventManager = eventManager;\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#realmStorage = realmStorage;\n        this.#configStorage = configStorage;\n        this.#logger = logger;\n        this.#originalOpener = originalOpener;\n        // Register helper realm as hidden, so that it will not be reported to the user.\n        this.#realmStorage.hiddenSandboxes.add(this.#hiddenSandbox);\n        this.#navigationTracker = new NavigationTracker_js_1.NavigationTracker(url, id, eventManager, logger);\n    }\n    static create(id, parentId, userContext, cdpTarget, eventManager, browsingContextStorage, realmStorage, configStorage, url, originalOpener, logger) {\n        const context = new _a(id, parentId, userContext, cdpTarget, eventManager, browsingContextStorage, realmStorage, configStorage, url, originalOpener, logger);\n        context.#initListeners();\n        browsingContextStorage.addContext(context);\n        if (!context.isTopLevelContext()) {\n            context.parent.addChild(context.id);\n        }\n        // Hold on the `contextCreated` event until the target is unblocked. This is required,\n        // as the parent of the context can be set later in case of reconnecting to an\n        // existing browser instance + OOPiF.\n        eventManager.registerPromiseEvent(context.targetUnblockedOrThrow().then(() => {\n            return {\n                kind: 'success',\n                value: {\n                    type: 'event',\n                    method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.ContextCreated,\n                    params: {\n                        ...context.serializeToBidiValue(),\n                        // Hack to provide the initial URL of the context, as it can be changed\n                        // between the page target is attached and unblocked, as the page is not\n                        // fully paused in MPArch session (https://crbug.com/372842894).\n                        // TODO: remove once https://crbug.com/372842894 is addressed.\n                        url,\n                    },\n                },\n            };\n        }, (error) => {\n            return {\n                kind: 'error',\n                error,\n            };\n        }), context.id, protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.ContextCreated);\n        return context;\n    }\n    /**\n     * @see https://html.spec.whatwg.org/multipage/document-sequences.html#navigable\n     */\n    get navigableId() {\n        return this.#loaderId;\n    }\n    get navigationId() {\n        return this.#navigationTracker.currentNavigationId;\n    }\n    dispose(emitContextDestroyed) {\n        this.#navigationTracker.dispose();\n        this.#realmStorage.deleteRealms({\n            browsingContextId: this.id,\n        });\n        // Delete context from the parent.\n        if (!this.isTopLevelContext()) {\n            this.parent.#children.delete(this.id);\n        }\n        // Fail all ongoing navigations.\n        this.#failLifecycleIfNotFinished();\n        if (emitContextDestroyed) {\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.ContextDestroyed,\n                params: this.serializeToBidiValue(null),\n            }, this.id);\n        }\n        // Dispose children after the events are emitted.\n        this.#deleteAllChildren();\n        this.#eventManager.clearBufferedEvents(this.id);\n        this.#browsingContextStorage.deleteContextById(this.id);\n    }\n    /** Returns the ID of this context. */\n    get id() {\n        return this.#id;\n    }\n    /** Returns the parent context ID. */\n    get parentId() {\n        return this.#parentId;\n    }\n    /** Sets the parent context ID and updates parent's children. */\n    set parentId(parentId) {\n        if (this.#parentId !== null) {\n            this.#logger?.(log_js_1.LogType.debugError, 'Parent context already set');\n            // Cannot do anything except logging, as throwing will stop event processing. So\n            // just return,\n            return;\n        }\n        this.#parentId = parentId;\n        if (!this.isTopLevelContext()) {\n            this.parent.addChild(this.id);\n        }\n    }\n    /** Returns the parent context. */\n    get parent() {\n        if (this.parentId === null) {\n            return null;\n        }\n        return this.#browsingContextStorage.getContext(this.parentId);\n    }\n    /** Returns all direct children contexts. */\n    get directChildren() {\n        return [...this.#children].map((id) => this.#browsingContextStorage.getContext(id));\n    }\n    /** Returns all children contexts, flattened. */\n    get allChildren() {\n        const children = this.directChildren;\n        return children.concat(...children.map((child) => child.allChildren));\n    }\n    /**\n     * Returns true if this is a top-level context.\n     * This is the case whenever the parent context ID is null.\n     */\n    isTopLevelContext() {\n        return this.#parentId === null;\n    }\n    get top() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        let topContext = this;\n        let parent = topContext.parent;\n        while (parent) {\n            topContext = parent;\n            parent = topContext.parent;\n        }\n        return topContext;\n    }\n    addChild(childId) {\n        this.#children.add(childId);\n    }\n    #deleteAllChildren(emitContextDestroyed = false) {\n        this.directChildren.map((child) => child.dispose(emitContextDestroyed));\n    }\n    get cdpTarget() {\n        return this.#cdpTarget;\n    }\n    updateCdpTarget(cdpTarget) {\n        this.#cdpTarget = cdpTarget;\n        this.#initListeners();\n    }\n    get url() {\n        return this.#navigationTracker.url;\n    }\n    async lifecycleLoaded() {\n        await this.#lifecycle.load;\n    }\n    async targetUnblockedOrThrow() {\n        const result = await this.#cdpTarget.unblocked;\n        if (result.kind === 'error') {\n            throw result.error;\n        }\n    }\n    /** Returns a sandbox for internal helper scripts which is not exposed to the user.*/\n    async getOrCreateHiddenSandbox() {\n        return await this.#getOrCreateSandboxInternal(this.#hiddenSandbox);\n    }\n    /** Returns a sandbox which is exposed to user. */\n    async getOrCreateUserSandbox(sandbox) {\n        const realm = await this.#getOrCreateSandboxInternal(sandbox);\n        if (realm.isHidden()) {\n            throw new protocol_js_1.NoSuchFrameException(`Realm \"${sandbox}\" not found`);\n        }\n        return realm;\n    }\n    async #getOrCreateSandboxInternal(sandbox) {\n        if (sandbox === undefined || sandbox === '') {\n            // Default realm is not guaranteed to be created at this point, so return a deferred.\n            return await this.#defaultRealmDeferred;\n        }\n        let maybeSandboxes = this.#realmStorage.findRealms({\n            browsingContextId: this.id,\n            sandbox,\n        });\n        if (maybeSandboxes.length === 0) {\n            await this.#cdpTarget.cdpClient.sendCommand('Page.createIsolatedWorld', {\n                frameId: this.id,\n                worldName: sandbox,\n            });\n            // `Runtime.executionContextCreated` should be emitted by the time the\n            // previous command is done.\n            maybeSandboxes = this.#realmStorage.findRealms({\n                browsingContextId: this.id,\n                sandbox,\n            });\n            (0, assert_js_1.assert)(maybeSandboxes.length !== 0);\n        }\n        // It's possible for more than one sandbox to be created due to provisional\n        // frames. In this case, it's always the first one (i.e. the oldest one)\n        // that is more relevant since the user may have set that one up already\n        // through evaluation.\n        return maybeSandboxes[0];\n    }\n    /**\n     * Implements https://w3c.github.io/webdriver-bidi/#get-the-navigable-info.\n     */\n    serializeToBidiValue(maxDepth = 0, addParentField = true) {\n        return {\n            context: this.#id,\n            url: this.url,\n            userContext: this.userContext,\n            originalOpener: this.#originalOpener ?? null,\n            clientWindow: `${this.cdpTarget.windowId}`,\n            children: maxDepth === null || maxDepth > 0\n                ? this.directChildren.map((c) => c.serializeToBidiValue(maxDepth === null ? maxDepth : maxDepth - 1, false))\n                : null,\n            ...(addParentField ? { parent: this.#parentId } : {}),\n        };\n    }\n    onTargetInfoChanged(params) {\n        this.#navigationTracker.onTargetInfoChanged(params.targetInfo.url);\n    }\n    #initListeners() {\n        this.#cdpTarget.cdpClient.on('Network.loadingFailed', (params) => {\n            // Detect navigation errors like `net::ERR_BLOCKED_BY_RESPONSE`.\n            // Network related to navigation has request id equals to navigation's loader id.\n            this.#navigationTracker.networkLoadingFailed(params.requestId, params.errorText);\n        });\n        this.#cdpTarget.cdpClient.on('Page.fileChooserOpened', (params) => {\n            if (this.id !== params.frameId) {\n                return;\n            }\n            if (this.#loaderId === undefined) {\n                this.#logger?.(log_js_1.LogType.debugError, 'LoaderId should be defined when file upload is shown', params);\n                return;\n            }\n            const element = params.backendNodeId === undefined\n                ? undefined\n                : {\n                    sharedId: (0, SharedId_js_1.getSharedId)(this.id, this.#loaderId, params.backendNodeId),\n                };\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.Input.EventNames.FileDialogOpened,\n                params: {\n                    context: this.id,\n                    multiple: params.mode === 'selectMultiple',\n                    element,\n                },\n            }, this.id);\n        });\n        this.#cdpTarget.cdpClient.on('Page.frameNavigated', (params) => {\n            if (this.id !== params.frame.id) {\n                return;\n            }\n            this.#navigationTracker.frameNavigated(params.frame.url + (params.frame.urlFragment ?? ''), params.frame.loaderId, \n            // `unreachableUrl` indicates if the navigation failed.\n            params.frame.unreachableUrl);\n            // At the point the page is initialized, all the nested iframes from the\n            // previous page are detached and realms are destroyed.\n            // Delete children from context.\n            this.#deleteAllChildren();\n            this.#documentChanged(params.frame.loaderId);\n        });\n        this.#cdpTarget.cdpClient.on('Page.frameStartedNavigating', (params) => {\n            if (this.id !== params.frameId) {\n                return;\n            }\n            this.#navigationTracker.frameStartedNavigating(params.url, params.loaderId, params.navigationType);\n        });\n        this.#cdpTarget.cdpClient.on('Page.navigatedWithinDocument', (params) => {\n            if (this.id !== params.frameId) {\n                return;\n            }\n            this.#navigationTracker.navigatedWithinDocument(params.url, params.navigationType);\n            if (params.navigationType === 'historyApi') {\n                this.#eventManager.registerEvent({\n                    type: 'event',\n                    method: 'browsingContext.historyUpdated',\n                    params: {\n                        context: this.id,\n                        timestamp: (0, time_js_1.getTimestamp)(),\n                        url: this.#navigationTracker.url,\n                    },\n                }, this.id);\n                return;\n            }\n        });\n        this.#cdpTarget.cdpClient.on('Page.lifecycleEvent', (params) => {\n            if (this.id !== params.frameId) {\n                return;\n            }\n            if (params.name === 'init') {\n                this.#documentChanged(params.loaderId);\n                return;\n            }\n            if (params.name === 'commit') {\n                this.#loaderId = params.loaderId;\n                return;\n            }\n            // If mapper attached to the page late, it might miss init and\n            // commit events. In that case, save the first loaderId for this\n            // frameId.\n            if (!this.#loaderId) {\n                this.#loaderId = params.loaderId;\n            }\n            // Ignore event from not current navigation.\n            if (params.loaderId !== this.#loaderId) {\n                return;\n            }\n            switch (params.name) {\n                case 'DOMContentLoaded':\n                    if (!this.#navigationTracker.isInitialNavigation) {\n                        // Do not emit for the initial navigation.\n                        this.#eventManager.registerEvent({\n                            type: 'event',\n                            method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.DomContentLoaded,\n                            params: {\n                                context: this.id,\n                                navigation: this.#navigationTracker.currentNavigationId,\n                                timestamp: (0, time_js_1.getTimestamp)(),\n                                url: this.#navigationTracker.url,\n                            },\n                        }, this.id);\n                    }\n                    this.#lifecycle.DOMContentLoaded.resolve();\n                    break;\n                case 'load':\n                    if (!this.#navigationTracker.isInitialNavigation) {\n                        // Do not emit for the initial navigation.\n                        this.#eventManager.registerEvent({\n                            type: 'event',\n                            method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.Load,\n                            params: {\n                                context: this.id,\n                                navigation: this.#navigationTracker.currentNavigationId,\n                                timestamp: (0, time_js_1.getTimestamp)(),\n                                url: this.#navigationTracker.url,\n                            },\n                        }, this.id);\n                    }\n                    // The initial navigation is finished.\n                    this.#navigationTracker.loadPageEvent(params.loaderId);\n                    this.#lifecycle.load.resolve();\n                    break;\n            }\n        });\n        this.#cdpTarget.cdpClient.on('Runtime.executionContextCreated', (params) => {\n            const { auxData, name, uniqueId, id } = params.context;\n            if (!auxData || auxData.frameId !== this.id) {\n                return;\n            }\n            let origin;\n            let sandbox;\n            // Only these execution contexts are supported for now.\n            switch (auxData.type) {\n                case 'isolated':\n                    sandbox = name;\n                    // Sandbox should have the same origin as the context itself, but in CDP\n                    // it has an empty one.\n                    if (!this.#defaultRealmDeferred.isFinished) {\n                        this.#logger?.(log_js_1.LogType.debugError, 'Unexpectedly, isolated realm created before the default one');\n                    }\n                    origin = this.#defaultRealmDeferred.isFinished\n                        ? this.#defaultRealmDeferred.result.origin\n                        : // This fallback is not expected to be ever reached.\n                            '';\n                    break;\n                case 'default':\n                    origin = serializeOrigin(params.context.origin);\n                    break;\n                default:\n                    return;\n            }\n            const realm = new WindowRealm_js_1.WindowRealm(this.id, this.#browsingContextStorage, this.#cdpTarget.cdpClient, this.#eventManager, id, this.#logger, origin, uniqueId, this.#realmStorage, sandbox);\n            if (auxData.isDefault) {\n                this.#defaultRealmDeferred.resolve(realm);\n                // Initialize ChannelProxy listeners for all the channels of all the\n                // preload scripts related to this BrowsingContext.\n                // TODO: extend for not default realms by the sandbox name.\n                void Promise.all(this.#cdpTarget\n                    .getChannels()\n                    .map((channel) => channel.startListenerFromWindow(realm, this.#eventManager)));\n            }\n        });\n        this.#cdpTarget.cdpClient.on('Runtime.executionContextDestroyed', (params) => {\n            if (this.#defaultRealmDeferred.isFinished &&\n                this.#defaultRealmDeferred.result.executionContextId ===\n                    params.executionContextId) {\n                this.#defaultRealmDeferred = new Deferred_js_1.Deferred();\n            }\n            this.#realmStorage.deleteRealms({\n                cdpSessionId: this.#cdpTarget.cdpSessionId,\n                executionContextId: params.executionContextId,\n            });\n        });\n        this.#cdpTarget.cdpClient.on('Runtime.executionContextsCleared', () => {\n            if (!this.#defaultRealmDeferred.isFinished) {\n                this.#defaultRealmDeferred.reject(new protocol_js_1.UnknownErrorException('execution contexts cleared'));\n            }\n            this.#defaultRealmDeferred = new Deferred_js_1.Deferred();\n            this.#realmStorage.deleteRealms({\n                cdpSessionId: this.#cdpTarget.cdpSessionId,\n            });\n        });\n        this.#cdpTarget.cdpClient.on('Page.javascriptDialogClosed', (params) => {\n            // Checking for `params.frameId` for comptaibility with Chrome\n            // versions that do not have a frameId. TODO: remove once\n            // https://crrev.com/c/6487891 is in stable.\n            if (params.frameId && this.id !== params.frameId) {\n                return;\n            }\n            if (!params.frameId &&\n                this.#parentId &&\n                this.#cdpTarget.cdpClient !==\n                    this.#browsingContextStorage.getContext(this.#parentId)?.cdpTarget\n                        .cdpClient) {\n                // If CDP event `Page.javascriptDialogClosed` does not have a frameId, this\n                // heuristic emits the event only for top-level per-cdp target context, ignoring\n                // the event for same-process iframes. So the event will be emitted only once per\n                // CDP target. TODO: remove once https://crrev.com/c/6487891 is in stable.\n                return;\n            }\n            const accepted = params.result;\n            if (this.#lastUserPromptType === undefined) {\n                this.#logger?.(log_js_1.LogType.debugError, 'Unexpectedly no opening prompt event before closing one');\n            }\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.UserPromptClosed,\n                params: {\n                    context: this.id,\n                    accepted,\n                    // `lastUserPromptType` should never be undefined here, so fallback to\n                    // `UNKNOWN`. The fallback is required to prevent tests from hanging while\n                    // waiting for the closing event. The cast is required, as the `UNKNOWN` value\n                    // is not standard.\n                    type: this.#lastUserPromptType ??\n                        'UNKNOWN',\n                    userText: accepted && params.userInput ? params.userInput : undefined,\n                },\n            }, this.id);\n            this.#lastUserPromptType = undefined;\n        });\n        this.#cdpTarget.cdpClient.on('Page.javascriptDialogOpening', (params) => {\n            // Checking for `params.frameId` for comptaibility with Chrome\n            // versions that do not have a frameId. TODO: remove once\n            // https://crrev.com/c/6487891 is in stable.\n            if (params.frameId && this.id !== params.frameId) {\n                return;\n            }\n            if (!params.frameId &&\n                this.#parentId &&\n                this.#cdpTarget.cdpClient !==\n                    this.#browsingContextStorage.getContext(this.#parentId)?.cdpTarget\n                        .cdpClient) {\n                // If CDP event `Page.javascriptDialogClosed` does not have a frameId, this\n                // heuristic emits the event only for top-level per-cdp target context, ignoring\n                // the event for same-process iframes. So the event will be emitted only once per\n                // CDP target. TODO: remove once https://crrev.com/c/6487891 is in stable.\n                return;\n            }\n            const promptType = _a.#getPromptType(params.type);\n            // Set the last prompt type to provide it in closing event.\n            this.#lastUserPromptType = promptType;\n            const promptHandler = this.#getPromptHandler(promptType);\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.UserPromptOpened,\n                params: {\n                    context: this.id,\n                    handler: promptHandler,\n                    type: promptType,\n                    message: params.message,\n                    ...(params.type === 'prompt'\n                        ? { defaultValue: params.defaultPrompt }\n                        : {}),\n                },\n            }, this.id);\n            switch (promptHandler) {\n                // Based on `unhandledPromptBehavior`, check if the prompt should be handled\n                // automatically (`accept`, `dismiss`) or wait for the user to do it.\n                case \"accept\" /* Session.UserPromptHandlerType.Accept */:\n                    void this.handleUserPrompt(true);\n                    break;\n                case \"dismiss\" /* Session.UserPromptHandlerType.Dismiss */:\n                    void this.handleUserPrompt(false);\n                    break;\n                case \"ignore\" /* Session.UserPromptHandlerType.Ignore */:\n                    break;\n            }\n        });\n        this.#cdpTarget.browserCdpClient.on('Browser.downloadWillBegin', (params) => {\n            if (this.id !== params.frameId) {\n                return;\n            }\n            this.#downloadIdToUrlMap.set(params.guid, params.url);\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.DownloadWillBegin,\n                params: {\n                    context: this.id,\n                    suggestedFilename: params.suggestedFilename,\n                    navigation: params.guid,\n                    timestamp: (0, time_js_1.getTimestamp)(),\n                    url: params.url,\n                },\n            }, this.id);\n        });\n        this.#cdpTarget.browserCdpClient.on('Browser.downloadProgress', (params) => {\n            if (!this.#downloadIdToUrlMap.has(params.guid)) {\n                // The event is not related to this browsing context.\n                return;\n            }\n            if (params.state === 'inProgress') {\n                // No need in reporting progress.\n                return;\n            }\n            const url = this.#downloadIdToUrlMap.get(params.guid);\n            switch (params.state) {\n                case 'canceled':\n                    this.#eventManager.registerEvent({\n                        type: 'event',\n                        method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.DownloadEnd,\n                        params: {\n                            status: 'canceled',\n                            context: this.id,\n                            navigation: params.guid,\n                            timestamp: (0, time_js_1.getTimestamp)(),\n                            url,\n                        },\n                    }, this.id);\n                    break;\n                case 'completed':\n                    this.#eventManager.registerEvent({\n                        type: 'event',\n                        method: protocol_js_1.ChromiumBidi.BrowsingContext.EventNames.DownloadEnd,\n                        params: {\n                            filepath: params.filePath ?? null,\n                            status: 'complete',\n                            context: this.id,\n                            navigation: params.guid,\n                            timestamp: (0, time_js_1.getTimestamp)(),\n                            url,\n                        },\n                    }, this.id);\n                    break;\n                default:\n                    // Unreachable.\n                    throw new protocol_js_1.UnknownErrorException(`Unknown download state: ${params.state}`);\n            }\n        });\n    }\n    static #getPromptType(cdpType) {\n        switch (cdpType) {\n            case 'alert':\n                return \"alert\" /* BrowsingContext.UserPromptType.Alert */;\n            case 'beforeunload':\n                return \"beforeunload\" /* BrowsingContext.UserPromptType.Beforeunload */;\n            case 'confirm':\n                return \"confirm\" /* BrowsingContext.UserPromptType.Confirm */;\n            case 'prompt':\n                return \"prompt\" /* BrowsingContext.UserPromptType.Prompt */;\n        }\n    }\n    /**\n     * Returns either custom UserContext's prompt handler, global or default one.\n     */\n    #getPromptHandler(promptType) {\n        const defaultPromptHandler = \"dismiss\" /* Session.UserPromptHandlerType.Dismiss */;\n        const contextConfig = this.#configStorage.getActiveConfig(this.top.id, this.userContext);\n        switch (promptType) {\n            case \"alert\" /* BrowsingContext.UserPromptType.Alert */:\n                return (contextConfig.userPromptHandler?.alert ??\n                    contextConfig.userPromptHandler?.default ??\n                    defaultPromptHandler);\n            case \"beforeunload\" /* BrowsingContext.UserPromptType.Beforeunload */:\n                return (contextConfig.userPromptHandler?.beforeUnload ??\n                    contextConfig.userPromptHandler?.default ??\n                    \"accept\" /* Session.UserPromptHandlerType.Accept */);\n            case \"confirm\" /* BrowsingContext.UserPromptType.Confirm */:\n                return (contextConfig.userPromptHandler?.confirm ??\n                    contextConfig.userPromptHandler?.default ??\n                    defaultPromptHandler);\n            case \"prompt\" /* BrowsingContext.UserPromptType.Prompt */:\n                return (contextConfig.userPromptHandler?.prompt ??\n                    contextConfig.userPromptHandler?.default ??\n                    defaultPromptHandler);\n        }\n    }\n    #documentChanged(loaderId) {\n        if (loaderId === undefined || this.#loaderId === loaderId) {\n            return;\n        }\n        // Document changed.\n        this.#resetLifecycleIfFinished();\n        this.#loaderId = loaderId;\n        // Delete all child iframes and notify about top level destruction.\n        this.#deleteAllChildren(true);\n    }\n    #resetLifecycleIfFinished() {\n        if (this.#lifecycle.DOMContentLoaded.isFinished) {\n            this.#lifecycle.DOMContentLoaded = new Deferred_js_1.Deferred();\n        }\n        else {\n            this.#logger?.(_a.LOGGER_PREFIX, 'Document changed (DOMContentLoaded)');\n        }\n        if (this.#lifecycle.load.isFinished) {\n            this.#lifecycle.load = new Deferred_js_1.Deferred();\n        }\n        else {\n            this.#logger?.(_a.LOGGER_PREFIX, 'Document changed (load)');\n        }\n    }\n    #failLifecycleIfNotFinished() {\n        if (!this.#lifecycle.DOMContentLoaded.isFinished) {\n            this.#lifecycle.DOMContentLoaded.reject(new protocol_js_1.UnknownErrorException('navigation canceled'));\n        }\n        if (!this.#lifecycle.load.isFinished) {\n            this.#lifecycle.load.reject(new protocol_js_1.UnknownErrorException('navigation canceled'));\n        }\n    }\n    async navigate(url, wait) {\n        try {\n            new URL(url);\n        }\n        catch {\n            throw new protocol_js_1.InvalidArgumentException(`Invalid URL: ${url}`);\n        }\n        const navigationState = this.#navigationTracker.createPendingNavigation(url);\n        // Navigate and wait for the result. If the navigation fails, the error event is\n        // emitted and the promise is rejected.\n        const cdpNavigatePromise = (async () => {\n            const cdpNavigateResult = await this.#cdpTarget.cdpClient.sendCommand('Page.navigate', {\n                url,\n                frameId: this.id,\n            });\n            if (cdpNavigateResult.errorText) {\n                // If navigation failed, no pending navigation is left.\n                this.#navigationTracker.failNavigation(navigationState, cdpNavigateResult.errorText);\n                throw new protocol_js_1.UnknownErrorException(cdpNavigateResult.errorText);\n            }\n            this.#navigationTracker.navigationCommandFinished(navigationState, cdpNavigateResult.loaderId);\n            this.#documentChanged(cdpNavigateResult.loaderId);\n        })();\n        // Wait for either the navigation is finished or canceled by another navigation.\n        const result = await Promise.race([\n            // No `loaderId` means same-document navigation.\n            this.#waitNavigation(wait, cdpNavigatePromise, navigationState),\n            // Throw an error if the navigation is canceled.\n            navigationState.finished,\n        ]);\n        if (result instanceof NavigationTracker_js_1.NavigationResult) {\n            if (\n            // TODO: check after decision on the spec is done:\n            //  https://github.com/w3c/webdriver-bidi/issues/799.\n            result.eventName === \"browsingContext.navigationAborted\" /* NavigationEventName.NavigationAborted */ ||\n                result.eventName === \"browsingContext.navigationFailed\" /* NavigationEventName.NavigationFailed */) {\n                throw new protocol_js_1.UnknownErrorException(result.message ?? 'unknown exception');\n            }\n        }\n        return {\n            navigation: navigationState.navigationId,\n            // Url can change due to redirects. Get the one from commandNavigation.\n            url: navigationState.url,\n        };\n    }\n    async #waitNavigation(wait, cdpCommandPromise, navigationState) {\n        await Promise.all([navigationState.committed, cdpCommandPromise]);\n        if (wait === \"none\" /* BrowsingContext.ReadinessState.None */) {\n            return;\n        }\n        if (navigationState.isFragmentNavigation === true) {\n            // After the cdp command is finished, the `fragmentNavigation` should be already\n            // settled. If it's the fragment navigation, wait for the `navigationStatus` to be\n            // finished, which happens after the fragment navigation happened. No need to wait for\n            // DOM events.\n            await navigationState.finished;\n            return;\n        }\n        if (wait === \"interactive\" /* BrowsingContext.ReadinessState.Interactive */) {\n            await this.#lifecycle.DOMContentLoaded;\n            return;\n        }\n        if (wait === \"complete\" /* BrowsingContext.ReadinessState.Complete */) {\n            await this.#lifecycle.load;\n            return;\n        }\n        throw new protocol_js_1.InvalidArgumentException(`Wait condition ${wait} is not supported`);\n    }\n    // TODO: support concurrent navigations analogous to `navigate`.\n    async reload(ignoreCache, wait) {\n        await this.targetUnblockedOrThrow();\n        this.#resetLifecycleIfFinished();\n        const navigationState = this.#navigationTracker.createPendingNavigation(this.#navigationTracker.url);\n        const cdpReloadPromise = this.#cdpTarget.cdpClient.sendCommand('Page.reload', {\n            ignoreCache,\n        });\n        // Wait for either the navigation is finished or canceled by another navigation.\n        const result = await Promise.race([\n            // No `loaderId` means same-document navigation.\n            this.#waitNavigation(wait, cdpReloadPromise, navigationState),\n            // Throw an error if the navigation is canceled.\n            navigationState.finished,\n        ]);\n        if (result instanceof NavigationTracker_js_1.NavigationResult) {\n            if (result.eventName === \"browsingContext.navigationAborted\" /* NavigationEventName.NavigationAborted */ ||\n                result.eventName === \"browsingContext.navigationFailed\" /* NavigationEventName.NavigationFailed */) {\n                throw new protocol_js_1.UnknownErrorException(result.message ?? 'unknown exception');\n            }\n        }\n        return {\n            navigation: navigationState.navigationId,\n            // Url can change due to redirects. Get the one from commandNavigation.\n            url: navigationState.url,\n        };\n    }\n    async setViewport(viewport, devicePixelRatio, screenOrientation) {\n        // Set the target's viewport.\n        await this.cdpTarget.setDeviceMetricsOverride(viewport, devicePixelRatio, screenOrientation);\n    }\n    async handleUserPrompt(accept, userText) {\n        await this.top.#cdpTarget.cdpClient.sendCommand('Page.handleJavaScriptDialog', {\n            accept: accept ?? true,\n            promptText: userText,\n        });\n    }\n    async activate() {\n        await this.#cdpTarget.cdpClient.sendCommand('Page.bringToFront');\n    }\n    async captureScreenshot(params) {\n        if (!this.isTopLevelContext()) {\n            throw new protocol_js_1.UnsupportedOperationException(`Non-top-level 'context' (${params.context}) is currently not supported`);\n        }\n        const formatParameters = getImageFormatParameters(params);\n        let captureBeyondViewport = false;\n        let script;\n        params.origin ??= 'viewport';\n        switch (params.origin) {\n            case 'document': {\n                script = String(() => {\n                    const element = document.documentElement;\n                    return {\n                        x: 0,\n                        y: 0,\n                        width: element.scrollWidth,\n                        height: element.scrollHeight,\n                    };\n                });\n                captureBeyondViewport = true;\n                break;\n            }\n            case 'viewport': {\n                script = String(() => {\n                    const viewport = window.visualViewport;\n                    return {\n                        x: viewport.pageLeft,\n                        y: viewport.pageTop,\n                        width: viewport.width,\n                        height: viewport.height,\n                    };\n                });\n                break;\n            }\n        }\n        const hiddenSandboxRealm = await this.getOrCreateHiddenSandbox();\n        const originResult = await hiddenSandboxRealm.callFunction(script, false);\n        (0, assert_js_1.assert)(originResult.type === 'success');\n        const origin = deserializeDOMRect(originResult.result);\n        (0, assert_js_1.assert)(origin);\n        let rect = origin;\n        if (params.clip) {\n            const clip = params.clip;\n            if (params.origin === 'viewport' && clip.type === 'box') {\n                // For viewport origin, the clip is relative to the viewport, while the CDP\n                // screenshot is relative to the document. So correction for the viewport position\n                // is required.\n                clip.x += origin.x;\n                clip.y += origin.y;\n            }\n            rect = getIntersectionRect(await this.#parseRect(clip), origin);\n        }\n        if (rect.width === 0 || rect.height === 0) {\n            throw new protocol_js_1.UnableToCaptureScreenException(`Unable to capture screenshot with zero dimensions: width=${rect.width}, height=${rect.height}`);\n        }\n        return await this.#cdpTarget.cdpClient.sendCommand('Page.captureScreenshot', {\n            clip: { ...rect, scale: 1.0 },\n            ...formatParameters,\n            captureBeyondViewport,\n        });\n    }\n    async print(params) {\n        if (!this.isTopLevelContext()) {\n            throw new protocol_js_1.UnsupportedOperationException('Printing of non-top level contexts is not supported');\n        }\n        const cdpParams = {};\n        if (params.background !== undefined) {\n            cdpParams.printBackground = params.background;\n        }\n        if (params.margin?.bottom !== undefined) {\n            cdpParams.marginBottom = (0, unitConversions_js_1.inchesFromCm)(params.margin.bottom);\n        }\n        if (params.margin?.left !== undefined) {\n            cdpParams.marginLeft = (0, unitConversions_js_1.inchesFromCm)(params.margin.left);\n        }\n        if (params.margin?.right !== undefined) {\n            cdpParams.marginRight = (0, unitConversions_js_1.inchesFromCm)(params.margin.right);\n        }\n        if (params.margin?.top !== undefined) {\n            cdpParams.marginTop = (0, unitConversions_js_1.inchesFromCm)(params.margin.top);\n        }\n        if (params.orientation !== undefined) {\n            cdpParams.landscape = params.orientation === 'landscape';\n        }\n        if (params.page?.height !== undefined) {\n            cdpParams.paperHeight = (0, unitConversions_js_1.inchesFromCm)(params.page.height);\n        }\n        if (params.page?.width !== undefined) {\n            cdpParams.paperWidth = (0, unitConversions_js_1.inchesFromCm)(params.page.width);\n        }\n        if (params.pageRanges !== undefined) {\n            for (const range of params.pageRanges) {\n                if (typeof range === 'number') {\n                    continue;\n                }\n                const rangeParts = range.split('-');\n                if (rangeParts.length < 1 || rangeParts.length > 2) {\n                    throw new protocol_js_1.InvalidArgumentException(`Invalid page range: ${range} is not a valid integer range.`);\n                }\n                if (rangeParts.length === 1) {\n                    void parseInteger(rangeParts[0] ?? '');\n                    continue;\n                }\n                let lowerBound;\n                let upperBound;\n                const [rangeLowerPart = '', rangeUpperPart = ''] = rangeParts;\n                if (rangeLowerPart === '') {\n                    lowerBound = 1;\n                }\n                else {\n                    lowerBound = parseInteger(rangeLowerPart);\n                }\n                if (rangeUpperPart === '') {\n                    upperBound = Number.MAX_SAFE_INTEGER;\n                }\n                else {\n                    upperBound = parseInteger(rangeUpperPart);\n                }\n                if (lowerBound > upperBound) {\n                    throw new protocol_js_1.InvalidArgumentException(`Invalid page range: ${rangeLowerPart} > ${rangeUpperPart}`);\n                }\n            }\n            cdpParams.pageRanges = params.pageRanges.join(',');\n        }\n        if (params.scale !== undefined) {\n            cdpParams.scale = params.scale;\n        }\n        if (params.shrinkToFit !== undefined) {\n            cdpParams.preferCSSPageSize = !params.shrinkToFit;\n        }\n        try {\n            const result = await this.#cdpTarget.cdpClient.sendCommand('Page.printToPDF', cdpParams);\n            return {\n                data: result.data,\n            };\n        }\n        catch (error) {\n            // Effectively zero dimensions.\n            if (error.message ===\n                'invalid print parameters: content area is empty') {\n                throw new protocol_js_1.UnsupportedOperationException(error.message);\n            }\n            throw error;\n        }\n    }\n    /**\n     * See\n     * https://w3c.github.io/webdriver-bidi/#:~:text=If%20command%20parameters%20contains%20%22clip%22%3A\n     */\n    async #parseRect(clip) {\n        switch (clip.type) {\n            case 'box':\n                return { x: clip.x, y: clip.y, width: clip.width, height: clip.height };\n            case 'element': {\n                const hiddenSandboxRealm = await this.getOrCreateHiddenSandbox();\n                const result = await hiddenSandboxRealm.callFunction(String((element) => {\n                    return element instanceof Element;\n                }), false, { type: 'undefined' }, [clip.element]);\n                if (result.type === 'exception') {\n                    throw new protocol_js_1.NoSuchElementException(`Element '${clip.element.sharedId}' was not found`);\n                }\n                (0, assert_js_1.assert)(result.result.type === 'boolean');\n                if (!result.result.value) {\n                    throw new protocol_js_1.NoSuchElementException(`Node '${clip.element.sharedId}' is not an Element`);\n                }\n                {\n                    const result = await hiddenSandboxRealm.callFunction(String((element) => {\n                        const rect = element.getBoundingClientRect();\n                        return {\n                            x: rect.x,\n                            y: rect.y,\n                            height: rect.height,\n                            width: rect.width,\n                        };\n                    }), false, { type: 'undefined' }, [clip.element]);\n                    (0, assert_js_1.assert)(result.type === 'success');\n                    const rect = deserializeDOMRect(result.result);\n                    if (!rect) {\n                        throw new protocol_js_1.UnableToCaptureScreenException(`Could not get bounding box for Element '${clip.element.sharedId}'`);\n                    }\n                    return rect;\n                }\n            }\n        }\n    }\n    async close() {\n        await this.#cdpTarget.cdpClient.sendCommand('Page.close');\n    }\n    async traverseHistory(delta) {\n        if (delta === 0) {\n            return;\n        }\n        const history = await this.#cdpTarget.cdpClient.sendCommand('Page.getNavigationHistory');\n        const entry = history.entries[history.currentIndex + delta];\n        if (!entry) {\n            throw new protocol_js_1.NoSuchHistoryEntryException(`No history entry at delta ${delta}`);\n        }\n        await this.#cdpTarget.cdpClient.sendCommand('Page.navigateToHistoryEntry', {\n            entryId: entry.id,\n        });\n    }\n    async toggleModulesIfNeeded() {\n        await Promise.all([\n            this.#cdpTarget.toggleNetworkIfNeeded(),\n            this.#cdpTarget.toggleDeviceAccessIfNeeded(),\n            this.#cdpTarget.togglePreloadIfNeeded(),\n        ]);\n    }\n    async locateNodes(params) {\n        // TODO: create a dedicated sandbox instead of `#defaultRealm`.\n        return await this.#locateNodesByLocator(await this.#defaultRealmDeferred, params.locator, params.startNodes ?? [], params.maxNodeCount, params.serializationOptions);\n    }\n    async #getLocatorDelegate(realm, locator, maxNodeCount, startNodes) {\n        switch (locator.type) {\n            case 'context':\n                throw new Error('Unreachable');\n            case 'css':\n                return {\n                    functionDeclaration: String((cssSelector, maxNodeCount, ...startNodes) => {\n                        const locateNodesUsingCss = (element) => {\n                            if (!(element instanceof HTMLElement ||\n                                element instanceof Document ||\n                                element instanceof DocumentFragment ||\n                                element instanceof SVGElement)) {\n                                throw new Error('startNodes in css selector should be HTMLElement, SVGElement or Document or DocumentFragment');\n                            }\n                            return [...element.querySelectorAll(cssSelector)];\n                        };\n                        startNodes = startNodes.length > 0 ? startNodes : [document];\n                        const returnedNodes = startNodes\n                            .map((startNode) => \n                        // TODO: stop search early if `maxNodeCount` is reached.\n                        locateNodesUsingCss(startNode))\n                            .flat(1);\n                        return maxNodeCount === 0\n                            ? returnedNodes\n                            : returnedNodes.slice(0, maxNodeCount);\n                    }),\n                    argumentsLocalValues: [\n                        // `cssSelector`\n                        { type: 'string', value: locator.value },\n                        // `maxNodeCount` with `0` means no limit.\n                        { type: 'number', value: maxNodeCount ?? 0 },\n                        // `startNodes`\n                        ...startNodes,\n                    ],\n                };\n            case 'xpath':\n                return {\n                    functionDeclaration: String((xPathSelector, maxNodeCount, ...startNodes) => {\n                        // https://w3c.github.io/webdriver-bidi/#locate-nodes-using-xpath\n                        const evaluator = new XPathEvaluator();\n                        const expression = evaluator.createExpression(xPathSelector);\n                        const locateNodesUsingXpath = (element) => {\n                            const xPathResult = expression.evaluate(element, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE);\n                            const returnedNodes = [];\n                            for (let i = 0; i < xPathResult.snapshotLength; i++) {\n                                returnedNodes.push(xPathResult.snapshotItem(i));\n                            }\n                            return returnedNodes;\n                        };\n                        startNodes = startNodes.length > 0 ? startNodes : [document];\n                        const returnedNodes = startNodes\n                            .map((startNode) => \n                        // TODO: stop search early if `maxNodeCount` is reached.\n                        locateNodesUsingXpath(startNode))\n                            .flat(1);\n                        return maxNodeCount === 0\n                            ? returnedNodes\n                            : returnedNodes.slice(0, maxNodeCount);\n                    }),\n                    argumentsLocalValues: [\n                        // `xPathSelector`\n                        { type: 'string', value: locator.value },\n                        // `maxNodeCount` with `0` means no limit.\n                        { type: 'number', value: maxNodeCount ?? 0 },\n                        // `startNodes`\n                        ...startNodes,\n                    ],\n                };\n            case 'innerText':\n                // https://w3c.github.io/webdriver-bidi/#locate-nodes-using-inner-text\n                if (locator.value === '') {\n                    throw new protocol_js_1.InvalidSelectorException('innerText locator cannot be empty');\n                }\n                return {\n                    functionDeclaration: String((innerTextSelector, fullMatch, ignoreCase, maxNodeCount, maxDepth, ...startNodes) => {\n                        const searchText = ignoreCase\n                            ? innerTextSelector.toUpperCase()\n                            : innerTextSelector;\n                        const locateNodesUsingInnerText = (node, currentMaxDepth) => {\n                            const returnedNodes = [];\n                            if (node instanceof DocumentFragment ||\n                                node instanceof Document) {\n                                const children = [...node.children];\n                                children.forEach((child) => \n                                // `currentMaxDepth` is not decremented intentionally according to\n                                // https://github.com/w3c/webdriver-bidi/pull/713.\n                                returnedNodes.push(...locateNodesUsingInnerText(child, currentMaxDepth)));\n                                return returnedNodes;\n                            }\n                            if (!(node instanceof HTMLElement)) {\n                                return [];\n                            }\n                            const element = node;\n                            const nodeInnerText = ignoreCase\n                                ? element.innerText?.toUpperCase()\n                                : element.innerText;\n                            if (!nodeInnerText.includes(searchText)) {\n                                return [];\n                            }\n                            const childNodes = [];\n                            for (const child of element.children) {\n                                if (child instanceof HTMLElement) {\n                                    childNodes.push(child);\n                                }\n                            }\n                            if (childNodes.length === 0) {\n                                if (fullMatch && nodeInnerText === searchText) {\n                                    returnedNodes.push(element);\n                                }\n                                else {\n                                    if (!fullMatch) {\n                                        // Note: `nodeInnerText.includes(searchText)` is already checked\n                                        returnedNodes.push(element);\n                                    }\n                                }\n                            }\n                            else {\n                                const childNodeMatches = \n                                // Don't search deeper if `maxDepth` is reached.\n                                currentMaxDepth <= 0\n                                    ? []\n                                    : childNodes\n                                        .map((child) => locateNodesUsingInnerText(child, currentMaxDepth - 1))\n                                        .flat(1);\n                                if (childNodeMatches.length === 0) {\n                                    // Note: `nodeInnerText.includes(searchText)` is already checked\n                                    if (!fullMatch || nodeInnerText === searchText) {\n                                        returnedNodes.push(element);\n                                    }\n                                }\n                                else {\n                                    returnedNodes.push(...childNodeMatches);\n                                }\n                            }\n                            // TODO: stop search early if `maxNodeCount` is reached.\n                            return returnedNodes;\n                        };\n                        // TODO: stop search early if `maxNodeCount` is reached.\n                        startNodes = startNodes.length > 0 ? startNodes : [document];\n                        const returnedNodes = startNodes\n                            .map((startNode) => \n                        // TODO: stop search early if `maxNodeCount` is reached.\n                        locateNodesUsingInnerText(startNode, maxDepth))\n                            .flat(1);\n                        return maxNodeCount === 0\n                            ? returnedNodes\n                            : returnedNodes.slice(0, maxNodeCount);\n                    }),\n                    argumentsLocalValues: [\n                        // `innerTextSelector`\n                        { type: 'string', value: locator.value },\n                        // `fullMatch` with default `true`.\n                        { type: 'boolean', value: locator.matchType !== 'partial' },\n                        // `ignoreCase` with default `false`.\n                        { type: 'boolean', value: locator.ignoreCase === true },\n                        // `maxNodeCount` with `0` means no limit.\n                        { type: 'number', value: maxNodeCount ?? 0 },\n                        // `maxDepth` with default `1000` (same as default full serialization depth).\n                        { type: 'number', value: locator.maxDepth ?? 1000 },\n                        // `startNodes`\n                        ...startNodes,\n                    ],\n                };\n            case 'accessibility': {\n                // https://w3c.github.io/webdriver-bidi/#locate-nodes-using-accessibility-attributes\n                if (!locator.value.name && !locator.value.role) {\n                    throw new protocol_js_1.InvalidSelectorException('Either name or role has to be specified');\n                }\n                // The next two commands cause a11y caches for the target to be\n                // preserved. We probably do not need to disable them if the\n                // client is using a11y features, but we could by calling\n                // Accessibility.disable.\n                await Promise.all([\n                    this.#cdpTarget.cdpClient.sendCommand('Accessibility.enable'),\n                    this.#cdpTarget.cdpClient.sendCommand('Accessibility.getRootAXNode'),\n                ]);\n                const bindings = await realm.evaluate(\n                /* expression=*/ '({getAccessibleName, getAccessibleRole})', \n                /* awaitPromise=*/ false, \"root\" /* Script.ResultOwnership.Root */, \n                /* serializationOptions= */ undefined, \n                /* userActivation=*/ false, \n                /* includeCommandLineApi=*/ true);\n                if (bindings.type !== 'success') {\n                    throw new Error('Could not get bindings');\n                }\n                if (bindings.result.type !== 'object') {\n                    throw new Error('Could not get bindings');\n                }\n                return {\n                    functionDeclaration: String((name, role, bindings, maxNodeCount, ...startNodes) => {\n                        const returnedNodes = [];\n                        let aborted = false;\n                        function collect(contextNodes, selector) {\n                            if (aborted) {\n                                return;\n                            }\n                            for (const contextNode of contextNodes) {\n                                let match = true;\n                                if (selector.role) {\n                                    const role = bindings.getAccessibleRole(contextNode);\n                                    if (selector.role !== role) {\n                                        match = false;\n                                    }\n                                }\n                                if (selector.name) {\n                                    const name = bindings.getAccessibleName(contextNode);\n                                    if (selector.name !== name) {\n                                        match = false;\n                                    }\n                                }\n                                if (match) {\n                                    if (maxNodeCount !== 0 &&\n                                        returnedNodes.length === maxNodeCount) {\n                                        aborted = true;\n                                        break;\n                                    }\n                                    returnedNodes.push(contextNode);\n                                }\n                                const childNodes = [];\n                                for (const child of contextNode.children) {\n                                    if (child instanceof HTMLElement) {\n                                        childNodes.push(child);\n                                    }\n                                }\n                                collect(childNodes, selector);\n                            }\n                        }\n                        startNodes =\n                            startNodes.length > 0\n                                ? startNodes\n                                : Array.from(document.documentElement.children).filter((c) => c instanceof HTMLElement);\n                        collect(startNodes, {\n                            role,\n                            name,\n                        });\n                        return returnedNodes;\n                    }),\n                    argumentsLocalValues: [\n                        // `name`\n                        { type: 'string', value: locator.value.name || '' },\n                        // `role`\n                        { type: 'string', value: locator.value.role || '' },\n                        // `bindings`.\n                        { handle: bindings.result.handle },\n                        // `maxNodeCount` with `0` means no limit.\n                        { type: 'number', value: maxNodeCount ?? 0 },\n                        // `startNodes`\n                        ...startNodes,\n                    ],\n                };\n            }\n        }\n    }\n    async #locateNodesByLocator(realm, locator, startNodes, maxNodeCount, serializationOptions) {\n        if (locator.type === 'context') {\n            if (startNodes.length !== 0) {\n                throw new protocol_js_1.InvalidArgumentException('Start nodes are not supported');\n            }\n            const contextId = locator.value.context;\n            if (!contextId) {\n                throw new protocol_js_1.InvalidSelectorException('Invalid context');\n            }\n            const context = this.#browsingContextStorage.getContext(contextId);\n            const parent = context.parent;\n            if (!parent) {\n                throw new protocol_js_1.InvalidArgumentException('This context has no container');\n            }\n            try {\n                const { backendNodeId } = await parent.#cdpTarget.cdpClient.sendCommand('DOM.getFrameOwner', {\n                    frameId: contextId,\n                });\n                const { object } = await parent.#cdpTarget.cdpClient.sendCommand('DOM.resolveNode', {\n                    backendNodeId,\n                });\n                const locatorResult = await realm.callFunction(`function () { return this; }`, false, { handle: object.objectId }, [], \"none\" /* Script.ResultOwnership.None */, serializationOptions);\n                if (locatorResult.type === 'exception') {\n                    throw new Error('Unknown exception');\n                }\n                return { nodes: [locatorResult.result] };\n            }\n            catch {\n                throw new protocol_js_1.InvalidArgumentException('Context does not exist');\n            }\n        }\n        const locatorDelegate = await this.#getLocatorDelegate(realm, locator, maxNodeCount, startNodes);\n        serializationOptions = {\n            ...serializationOptions,\n            // The returned object is an array of nodes, so no need in deeper JS serialization.\n            maxObjectDepth: 1,\n        };\n        const locatorResult = await realm.callFunction(locatorDelegate.functionDeclaration, false, { type: 'undefined' }, locatorDelegate.argumentsLocalValues, \"none\" /* Script.ResultOwnership.None */, serializationOptions);\n        if (locatorResult.type !== 'success') {\n            this.#logger?.(_a.LOGGER_PREFIX, 'Failed locateNodesByLocator', locatorResult);\n            // Heuristic to detect invalid selector for different types of selectors.\n            if (\n            // CSS selector.\n            locatorResult.exceptionDetails.text?.endsWith('is not a valid selector.') ||\n                // XPath selector.\n                locatorResult.exceptionDetails.text?.endsWith('is not a valid XPath expression.')) {\n                throw new protocol_js_1.InvalidSelectorException(`Not valid selector ${typeof locator.value === 'string' ? locator.value : JSON.stringify(locator.value)}`);\n            }\n            // Heuristic to detect if the `startNode` is not an `HTMLElement` in css selector.\n            if (locatorResult.exceptionDetails.text ===\n                'Error: startNodes in css selector should be HTMLElement, SVGElement or Document or DocumentFragment') {\n                throw new protocol_js_1.InvalidArgumentException('startNodes in css selector should be HTMLElement, SVGElement or Document or DocumentFragment');\n            }\n            throw new protocol_js_1.UnknownErrorException(`Unexpected error in selector script: ${locatorResult.exceptionDetails.text}`);\n        }\n        if (locatorResult.result.type !== 'array') {\n            throw new protocol_js_1.UnknownErrorException(`Unexpected selector script result type: ${locatorResult.result.type}`);\n        }\n        // Check there are no non-node elements in the result.\n        const nodes = locatorResult.result.value.map((value) => {\n            if (value.type !== 'node') {\n                throw new protocol_js_1.UnknownErrorException(`Unexpected selector script result element: ${value.type}`);\n            }\n            return value;\n        });\n        return { nodes };\n    }\n    #getAllRelatedCdpTargets() {\n        const targets = new Set();\n        targets.add(this.cdpTarget);\n        this.allChildren.forEach((c) => targets.add(c.cdpTarget));\n        return Array.from(targets);\n    }\n    async setTimezoneOverride(timezone) {\n        await Promise.all(this.#getAllRelatedCdpTargets().map(async (cdpTarget) => await cdpTarget.setTimezoneOverride(timezone)));\n    }\n    async setLocaleOverride(locale) {\n        await Promise.all(this.#getAllRelatedCdpTargets().map(async (cdpTarget) => await cdpTarget.setLocaleOverride(locale)));\n    }\n    async setGeolocationOverride(geolocation) {\n        await Promise.all(this.#getAllRelatedCdpTargets().map(async (cdpTarget) => await cdpTarget.setGeolocationOverride(geolocation)));\n    }\n    async setScriptingEnabled(scriptingEnabled) {\n        await Promise.all(this.#getAllRelatedCdpTargets().map(async (cdpTarget) => await cdpTarget.setScriptingEnabled(scriptingEnabled)));\n    }\n    async setUserAgentAndAcceptLanguage(userAgent, acceptLanguage) {\n        await Promise.all(this.#getAllRelatedCdpTargets().map(async (cdpTarget) => await cdpTarget.setUserAgentAndAcceptLanguage(userAgent, acceptLanguage)));\n    }\n    async setEmulatedNetworkConditions(networkConditions) {\n        await Promise.all(this.#getAllRelatedCdpTargets().map(async (cdpTarget) => await cdpTarget.setEmulatedNetworkConditions(networkConditions)));\n    }\n    async setExtraHeaders(cdpExtraHeaders) {\n        await Promise.all(this.#getAllRelatedCdpTargets().map(async (cdpTarget) => await cdpTarget.setExtraHeaders(cdpExtraHeaders)));\n    }\n}\nexports.BrowsingContextImpl = BrowsingContextImpl;\n_a = BrowsingContextImpl;\nfunction serializeOrigin(origin) {\n    // https://html.spec.whatwg.org/multipage/origin.html#ascii-serialisation-of-an-origin\n    if (['://', ''].includes(origin)) {\n        origin = 'null';\n    }\n    return origin;\n}\nfunction getImageFormatParameters(params) {\n    const { quality, type } = params.format ?? {\n        type: 'image/png',\n    };\n    switch (type) {\n        case 'image/png': {\n            return { format: 'png' };\n        }\n        case 'image/jpeg': {\n            return {\n                format: 'jpeg',\n                ...(quality === undefined ? {} : { quality: Math.round(quality * 100) }),\n            };\n        }\n        case 'image/webp': {\n            return {\n                format: 'webp',\n                ...(quality === undefined ? {} : { quality: Math.round(quality * 100) }),\n            };\n        }\n    }\n    throw new protocol_js_1.InvalidArgumentException(`Image format '${type}' is not a supported format`);\n}\nfunction deserializeDOMRect(result) {\n    if (result.type !== 'object' || result.value === undefined) {\n        return;\n    }\n    const x = result.value.find(([key]) => {\n        return key === 'x';\n    })?.[1];\n    const y = result.value.find(([key]) => {\n        return key === 'y';\n    })?.[1];\n    const height = result.value.find(([key]) => {\n        return key === 'height';\n    })?.[1];\n    const width = result.value.find(([key]) => {\n        return key === 'width';\n    })?.[1];\n    if (x?.type !== 'number' ||\n        y?.type !== 'number' ||\n        height?.type !== 'number' ||\n        width?.type !== 'number') {\n        return;\n    }\n    return {\n        x: x.value,\n        y: y.value,\n        width: width.value,\n        height: height.value,\n    };\n}\n/** @see https://w3c.github.io/webdriver-bidi/#normalize-rect */\nfunction normalizeRect(box) {\n    return {\n        ...(box.width < 0\n            ? {\n                x: box.x + box.width,\n                width: -box.width,\n            }\n            : {\n                x: box.x,\n                width: box.width,\n            }),\n        ...(box.height < 0\n            ? {\n                y: box.y + box.height,\n                height: -box.height,\n            }\n            : {\n                y: box.y,\n                height: box.height,\n            }),\n    };\n}\n/** @see https://w3c.github.io/webdriver-bidi/#rectangle-intersection */\nfunction getIntersectionRect(first, second) {\n    first = normalizeRect(first);\n    second = normalizeRect(second);\n    const x = Math.max(first.x, second.x);\n    const y = Math.max(first.y, second.y);\n    return {\n        x,\n        y,\n        width: Math.max(Math.min(first.x + first.width, second.x + second.width) - x, 0),\n        height: Math.max(Math.min(first.y + first.height, second.y + second.height) - y, 0),\n    };\n}\nfunction parseInteger(value) {\n    value = value.trim();\n    if (!/^[0-9]+$/.test(value)) {\n        throw new protocol_js_1.InvalidArgumentException(`Invalid integer: ${value}`);\n    }\n    return parseInt(value);\n}\n//# sourceMappingURL=BrowsingContextImpl.js.map","\"use strict\";\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WorkerRealm = void 0;\nconst Realm_js_1 = require(\"./Realm.js\");\nclass WorkerRealm extends Realm_js_1.Realm {\n    #realmType;\n    #ownerRealms;\n    constructor(cdpClient, eventManager, executionContextId, logger, origin, ownerRealms, realmId, realmStorage, realmType) {\n        super(cdpClient, eventManager, executionContextId, logger, origin, realmId, realmStorage);\n        this.#ownerRealms = ownerRealms;\n        this.#realmType = realmType;\n        this.initialize();\n    }\n    get associatedBrowsingContexts() {\n        return this.#ownerRealms.flatMap((realm) => realm.associatedBrowsingContexts);\n    }\n    get realmType() {\n        return this.#realmType;\n    }\n    get source() {\n        return {\n            realm: this.realmId,\n            // This is a hack to make Puppeteer able to track workers.\n            // TODO: remove after Puppeteer tracks workers by owners and use the base version.\n            context: this.associatedBrowsingContexts[0]?.id,\n        };\n    }\n    get realmInfo() {\n        const owners = this.#ownerRealms.map((realm) => realm.realmId);\n        const { realmType } = this;\n        switch (realmType) {\n            case 'dedicated-worker': {\n                const owner = owners[0];\n                if (owner === undefined || owners.length !== 1) {\n                    throw new Error('Dedicated worker must have exactly one owner');\n                }\n                return {\n                    ...this.baseInfo,\n                    type: realmType,\n                    owners: [owner],\n                };\n            }\n            case 'service-worker':\n            case 'shared-worker': {\n                return {\n                    ...this.baseInfo,\n                    type: realmType,\n                };\n            }\n        }\n    }\n}\nexports.WorkerRealm = WorkerRealm;\n//# sourceMappingURL=WorkerRealm.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.logMessageFormatter = logMessageFormatter;\nexports.getRemoteValuesText = getRemoteValuesText;\nconst assert_js_1 = require(\"../../../utils/assert.js\");\nconst specifiers = ['%s', '%d', '%i', '%f', '%o', '%O', '%c'];\nfunction isFormatSpecifier(str) {\n    return specifiers.some((spec) => str.includes(spec));\n}\n/**\n * @param args input remote values to be format printed\n * @return parsed text of the remote values in specific format\n */\nfunction logMessageFormatter(args) {\n    let output = '';\n    const argFormat = args[0].value.toString();\n    const argValues = args.slice(1, undefined);\n    const tokens = argFormat.split(new RegExp(specifiers.map((spec) => `(${spec})`).join('|'), 'g'));\n    for (const token of tokens) {\n        if (token === undefined || token === '') {\n            continue;\n        }\n        if (isFormatSpecifier(token)) {\n            const arg = argValues.shift();\n            // raise an exception when less value is provided\n            (0, assert_js_1.assert)(arg, `Less value is provided: \"${getRemoteValuesText(args, false)}\"`);\n            if (token === '%s') {\n                output += stringFromArg(arg);\n            }\n            else if (token === '%d' || token === '%i') {\n                if (arg.type === 'bigint' ||\n                    arg.type === 'number' ||\n                    arg.type === 'string') {\n                    output += parseInt(arg.value.toString(), 10);\n                }\n                else {\n                    output += 'NaN';\n                }\n            }\n            else if (token === '%f') {\n                if (arg.type === 'bigint' ||\n                    arg.type === 'number' ||\n                    arg.type === 'string') {\n                    output += parseFloat(arg.value.toString());\n                }\n                else {\n                    output += 'NaN';\n                }\n            }\n            else {\n                // %o, %O, %c\n                output += toJson(arg);\n            }\n        }\n        else {\n            output += token;\n        }\n    }\n    // raise an exception when more value is provided\n    if (argValues.length > 0) {\n        throw new Error(`More value is provided: \"${getRemoteValuesText(args, false)}\"`);\n    }\n    return output;\n}\n/**\n * @param arg input remote value to be parsed\n * @return parsed text of the remote value\n *\n * input: {\"type\": \"number\", \"value\": 1}\n * output: 1\n *\n * input: {\"type\": \"string\", \"value\": \"abc\"}\n * output: \"abc\"\n *\n * input: {\"type\": \"object\",  \"value\": [[\"id\", {\"type\": \"number\", \"value\": 1}]]}\n * output: '{\"id\": 1}'\n *\n * input: {\"type\": \"object\", \"value\": [[\"font-size\", {\"type\": \"string\", \"value\": \"20px\"}]]}\n * output: '{\"font-size\": \"20px\"}'\n */\nfunction toJson(arg) {\n    // arg type validation\n    if (arg.type !== 'array' &&\n        arg.type !== 'bigint' &&\n        arg.type !== 'date' &&\n        arg.type !== 'number' &&\n        arg.type !== 'object' &&\n        arg.type !== 'string') {\n        return stringFromArg(arg);\n    }\n    if (arg.type === 'bigint') {\n        return `${arg.value.toString()}n`;\n    }\n    if (arg.type === 'number') {\n        return arg.value.toString();\n    }\n    if (['date', 'string'].includes(arg.type)) {\n        return JSON.stringify(arg.value);\n    }\n    if (arg.type === 'object') {\n        return `{${arg.value\n            .map((pair) => {\n            return `${JSON.stringify(pair[0])}:${toJson(pair[1])}`;\n        })\n            .join(',')}}`;\n    }\n    if (arg.type === 'array') {\n        return `[${arg.value?.map((val) => toJson(val)).join(',') ?? ''}]`;\n    }\n    throw Error(`Invalid value type: ${arg}`);\n}\nfunction stringFromArg(arg) {\n    if (!Object.hasOwn(arg, 'value')) {\n        return arg.type;\n    }\n    switch (arg.type) {\n        case 'string':\n        case 'number':\n        case 'boolean':\n        case 'bigint':\n            return String(arg.value);\n        case 'regexp':\n            return `/${arg.value.pattern}/${arg.value.flags ?? ''}`;\n        case 'date':\n            return new Date(arg.value).toString();\n        case 'object':\n            return `Object(${arg.value?.length ?? ''})`;\n        case 'array':\n            return `Array(${arg.value?.length ?? ''})`;\n        case 'map':\n            return `Map(${arg.value?.length})`;\n        case 'set':\n            return `Set(${arg.value?.length})`;\n        default:\n            return arg.type;\n    }\n}\nfunction getRemoteValuesText(args, formatText) {\n    const arg = args[0];\n    if (!arg) {\n        return '';\n    }\n    // if args[0] is a format specifier, format the args as output\n    if (arg.type === 'string' &&\n        isFormatSpecifier(arg.value.toString()) &&\n        formatText) {\n        return logMessageFormatter(args);\n    }\n    // if args[0] is not a format specifier, just join the args with \\u0020 (unicode 'SPACE')\n    return args\n        .map((arg) => {\n        return stringFromArg(arg);\n    })\n        .join('\\u0020');\n}\n//# sourceMappingURL=logHelper.js.map","\"use strict\";\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LogManager = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst logHelper_js_1 = require(\"./logHelper.js\");\n/** Converts CDP StackTrace object to BiDi StackTrace object. */\nfunction getBidiStackTrace(cdpStackTrace) {\n    const stackFrames = cdpStackTrace?.callFrames.map((callFrame) => {\n        return {\n            columnNumber: callFrame.columnNumber,\n            functionName: callFrame.functionName,\n            lineNumber: callFrame.lineNumber,\n            url: callFrame.url,\n        };\n    });\n    return stackFrames ? { callFrames: stackFrames } : undefined;\n}\nfunction getLogLevel(consoleApiType) {\n    if ([\"error\" /* Log.Level.Error */, 'assert'].includes(consoleApiType)) {\n        return \"error\" /* Log.Level.Error */;\n    }\n    if ([\"debug\" /* Log.Level.Debug */, 'trace'].includes(consoleApiType)) {\n        return \"debug\" /* Log.Level.Debug */;\n    }\n    if ([\"warn\" /* Log.Level.Warn */, 'warning'].includes(consoleApiType)) {\n        return \"warn\" /* Log.Level.Warn */;\n    }\n    return \"info\" /* Log.Level.Info */;\n}\nfunction getLogMethod(consoleApiType) {\n    switch (consoleApiType) {\n        case 'warning':\n            return 'warn';\n        case 'startGroup':\n            return 'group';\n        case 'startGroupCollapsed':\n            return 'groupCollapsed';\n        case 'endGroup':\n            return 'groupEnd';\n    }\n    return consoleApiType;\n}\nclass LogManager {\n    #eventManager;\n    #realmStorage;\n    #cdpTarget;\n    #logger;\n    constructor(cdpTarget, realmStorage, eventManager, logger) {\n        this.#cdpTarget = cdpTarget;\n        this.#realmStorage = realmStorage;\n        this.#eventManager = eventManager;\n        this.#logger = logger;\n    }\n    static create(cdpTarget, realmStorage, eventManager, logger) {\n        const logManager = new _a(cdpTarget, realmStorage, eventManager, logger);\n        logManager.#initializeEntryAddedEventListener();\n        return logManager;\n    }\n    /**\n     * Heuristic serialization of CDP remote object. If possible, return the BiDi value\n     * without deep serialization.\n     */\n    async #heuristicSerializeArg(arg, realm) {\n        switch (arg.type) {\n            // TODO: Implement regexp, array, object, map and set heuristics base on\n            //  preview.\n            case 'undefined':\n                return { type: 'undefined' };\n            case 'boolean':\n                return { type: 'boolean', value: arg.value };\n            case 'string':\n                return { type: 'string', value: arg.value };\n            case 'number':\n                // The value can be either a number or a string like `Infinity` or `-0`.\n                return { type: 'number', value: arg.unserializableValue ?? arg.value };\n            case 'bigint':\n                if (arg.unserializableValue !== undefined &&\n                    arg.unserializableValue[arg.unserializableValue.length - 1] === 'n') {\n                    return {\n                        type: arg.type,\n                        value: arg.unserializableValue.slice(0, -1),\n                    };\n                }\n                // Unexpected bigint value, fall back to CDP deep serialization.\n                break;\n            case 'object':\n                if (arg.subtype === 'null') {\n                    return { type: 'null' };\n                }\n                // Fall back to CDP deep serialization.\n                break;\n            default:\n                // Fall back to CDP deep serialization.\n                break;\n        }\n        // Fall back to CDP deep serialization.\n        return await realm.serializeCdpObject(arg, \"none\" /* Script.ResultOwnership.None */);\n    }\n    #initializeEntryAddedEventListener() {\n        this.#cdpTarget.cdpClient.on('Runtime.consoleAPICalled', (params) => {\n            // Try to find realm by `cdpSessionId` and `executionContextId`,\n            // if provided.\n            const realm = this.#realmStorage.findRealm({\n                cdpSessionId: this.#cdpTarget.cdpSessionId,\n                executionContextId: params.executionContextId,\n            });\n            if (realm === undefined) {\n                // Ignore exceptions not attached to any realm.\n                this.#logger?.(log_js_1.LogType.cdp, params);\n                return;\n            }\n            const argsPromise = Promise.all(params.args.map((arg) => this.#heuristicSerializeArg(arg, realm)));\n            for (const browsingContext of realm.associatedBrowsingContexts) {\n                this.#eventManager.registerPromiseEvent(argsPromise.then((args) => ({\n                    kind: 'success',\n                    value: {\n                        type: 'event',\n                        method: protocol_js_1.ChromiumBidi.Log.EventNames.LogEntryAdded,\n                        params: {\n                            level: getLogLevel(params.type),\n                            source: realm.source,\n                            text: (0, logHelper_js_1.getRemoteValuesText)(args, true),\n                            timestamp: Math.round(params.timestamp),\n                            stackTrace: getBidiStackTrace(params.stackTrace),\n                            type: 'console',\n                            method: getLogMethod(params.type),\n                            args,\n                        },\n                    },\n                }), (error) => ({\n                    kind: 'error',\n                    error,\n                })), browsingContext.id, protocol_js_1.ChromiumBidi.Log.EventNames.LogEntryAdded);\n            }\n        });\n        this.#cdpTarget.cdpClient.on('Runtime.exceptionThrown', (params) => {\n            // Try to find realm by `cdpSessionId` and `executionContextId`,\n            // if provided.\n            const realm = this.#realmStorage.findRealm({\n                cdpSessionId: this.#cdpTarget.cdpSessionId,\n                executionContextId: params.exceptionDetails.executionContextId,\n            });\n            if (realm === undefined) {\n                // Ignore exceptions not attached to any realm.\n                this.#logger?.(log_js_1.LogType.cdp, params);\n                return;\n            }\n            for (const browsingContext of realm.associatedBrowsingContexts) {\n                this.#eventManager.registerPromiseEvent(_a.#getExceptionText(params, realm).then((text) => ({\n                    kind: 'success',\n                    value: {\n                        type: 'event',\n                        method: protocol_js_1.ChromiumBidi.Log.EventNames.LogEntryAdded,\n                        params: {\n                            level: \"error\" /* Log.Level.Error */,\n                            source: realm.source,\n                            text,\n                            timestamp: Math.round(params.timestamp),\n                            stackTrace: getBidiStackTrace(params.exceptionDetails.stackTrace),\n                            type: 'javascript',\n                        },\n                    },\n                }), (error) => ({\n                    kind: 'error',\n                    error,\n                })), browsingContext.id, protocol_js_1.ChromiumBidi.Log.EventNames.LogEntryAdded);\n            }\n        });\n    }\n    /**\n     * Try the best to get the exception text.\n     */\n    static async #getExceptionText(params, realm) {\n        if (!params.exceptionDetails.exception) {\n            return params.exceptionDetails.text;\n        }\n        if (realm === undefined) {\n            return JSON.stringify(params.exceptionDetails.exception);\n        }\n        return await realm.stringifyObject(params.exceptionDetails.exception);\n    }\n}\nexports.LogManager = LogManager;\n_a = LogManager;\n//# sourceMappingURL=LogManager.js.map","\"use strict\";\n/*\n * Copyright 2025 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CollectorsStorage = void 0;\nconst ErrorResponse_js_1 = require(\"../../../protocol/ErrorResponse.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\nclass CollectorsStorage {\n    #collectors = new Map();\n    #responseCollectors = new Map();\n    #requestBodyCollectors = new Map();\n    #maxEncodedDataSize;\n    #logger;\n    constructor(maxEncodedDataSize, logger) {\n        this.#maxEncodedDataSize = maxEncodedDataSize;\n        this.#logger = logger;\n    }\n    addDataCollector(params) {\n        if (params.maxEncodedDataSize < 1 ||\n            params.maxEncodedDataSize > this.#maxEncodedDataSize) {\n            // 200 MB is the default limit in CDP:\n            // https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/inspector/inspector_network_agent.cc;drc=da1f749634c9a401cc756f36c2e6ce233e1c9b4d;l=133\n            throw new ErrorResponse_js_1.InvalidArgumentException(`Max encoded data size should be between 1 and ${this.#maxEncodedDataSize}`);\n        }\n        const collectorId = (0, uuid_js_1.uuidv4)();\n        this.#collectors.set(collectorId, params);\n        return collectorId;\n    }\n    isCollected(requestId, dataType, collectorId) {\n        if (collectorId !== undefined && !this.#collectors.has(collectorId)) {\n            throw new ErrorResponse_js_1.NoSuchNetworkCollectorException(`Unknown collector ${collectorId}`);\n        }\n        if (dataType === undefined) {\n            return (this.isCollected(requestId, \"response\" /* Network.DataType.Response */, collectorId) ||\n                this.isCollected(requestId, \"request\" /* Network.DataType.Request */, collectorId));\n        }\n        const requestToCollectorsMap = this.#getRequestToCollectorMap(dataType).get(requestId);\n        if (requestToCollectorsMap === undefined ||\n            requestToCollectorsMap.size === 0) {\n            return false;\n        }\n        if (collectorId === undefined) {\n            // There is at least 1 collector for the data.\n            return true;\n        }\n        if (!requestToCollectorsMap.has(collectorId)) {\n            return false;\n        }\n        return true;\n    }\n    #getRequestToCollectorMap(dataType) {\n        switch (dataType) {\n            case \"response\" /* Network.DataType.Response */:\n                return this.#responseCollectors;\n            case \"request\" /* Network.DataType.Request */:\n                return this.#requestBodyCollectors;\n            default:\n                throw new ErrorResponse_js_1.UnsupportedOperationException(`Unsupported data type ${dataType}`);\n        }\n    }\n    disownData(requestId, dataType, collectorId) {\n        const requestToCollectorsMap = this.#getRequestToCollectorMap(dataType);\n        if (collectorId !== undefined) {\n            requestToCollectorsMap.get(requestId)?.delete(collectorId);\n        }\n        if (collectorId === undefined ||\n            requestToCollectorsMap.get(requestId)?.size === 0) {\n            requestToCollectorsMap.delete(requestId);\n        }\n    }\n    #shouldCollectRequest(collectorId, request, dataType, topLevelBrowsingContext, userContext) {\n        const collector = this.#collectors.get(collectorId);\n        if (collector === undefined) {\n            throw new ErrorResponse_js_1.NoSuchNetworkCollectorException(`Unknown collector ${collectorId}`);\n        }\n        if (collector.userContexts &&\n            !collector.userContexts.includes(userContext)) {\n            // Collector is aimed for a different user context.\n            return false;\n        }\n        if (collector.contexts &&\n            !collector.contexts.includes(topLevelBrowsingContext)) {\n            // Collector is aimed for a different top-level browsing context.\n            return false;\n        }\n        if (!collector.dataTypes.includes(dataType)) {\n            // Collector is aimed for a different data type.\n            return false;\n        }\n        if (dataType === \"request\" /* Network.DataType.Request */ &&\n            request.bodySize > collector.maxEncodedDataSize) {\n            this.#logger?.(log_js_1.LogType.debug, `Request's ${request.id} body size is too big for the collector ${collectorId}`);\n            return false;\n        }\n        if (dataType === \"response\" /* Network.DataType.Response */ &&\n            request.bytesReceived > collector.maxEncodedDataSize) {\n            this.#logger?.(log_js_1.LogType.debug, `Request's ${request.id} response is too big for the collector ${collectorId}`);\n            return false;\n        }\n        this.#logger?.(log_js_1.LogType.debug, `Collector ${collectorId} collected ${dataType} of ${request.id}`);\n        return true;\n    }\n    collectIfNeeded(request, dataType, topLevelBrowsingContext, userContext) {\n        const collectorIds = [...this.#collectors.keys()].filter((collectorId) => this.#shouldCollectRequest(collectorId, request, dataType, topLevelBrowsingContext, userContext));\n        if (collectorIds.length > 0) {\n            this.#getRequestToCollectorMap(dataType).set(request.id, new Set(collectorIds));\n        }\n    }\n    removeDataCollector(collectorId) {\n        if (!this.#collectors.has(collectorId)) {\n            throw new ErrorResponse_js_1.NoSuchNetworkCollectorException(`Collector ${collectorId} does not exist`);\n        }\n        this.#collectors.delete(collectorId);\n        const affectedRequests = [];\n        // Clean up collected responses.\n        for (const [requestId, collectorIds] of this.#responseCollectors) {\n            if (collectorIds.has(collectorId)) {\n                collectorIds.delete(collectorId);\n                if (collectorIds.size === 0) {\n                    this.#responseCollectors.delete(requestId);\n                    affectedRequests.push(requestId);\n                }\n            }\n        }\n        for (const [requestId, collectorIds] of this.#requestBodyCollectors) {\n            if (collectorIds.has(collectorId)) {\n                collectorIds.delete(collectorId);\n                if (collectorIds.size === 0) {\n                    this.#requestBodyCollectors.delete(requestId);\n                    affectedRequests.push(requestId);\n                }\n            }\n        }\n        return affectedRequests;\n    }\n}\nexports.CollectorsStorage = CollectorsStorage;\n//# sourceMappingURL=CollectorsStorage.js.map","\"use strict\";\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DefaultMap = void 0;\n/**\n * A subclass of Map whose functionality is almost the same as its parent\n * except for the fact that DefaultMap never returns undefined. It provides a\n * default value for keys that do not exist.\n */\nclass DefaultMap extends Map {\n    /** The default value to return whenever a key is not present in the map. */\n    #getDefaultValue;\n    constructor(getDefaultValue, entries) {\n        super(entries);\n        this.#getDefaultValue = getDefaultValue;\n    }\n    get(key) {\n        if (!this.has(key)) {\n            this.set(key, this.#getDefaultValue(key));\n        }\n        return super.get(key);\n    }\n}\nexports.DefaultMap = DefaultMap;\n//# sourceMappingURL=DefaultMap.js.map","\"use strict\";\n/*\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NetworkRequest = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst assert_js_1 = require(\"../../../utils/assert.js\");\nconst DefaultMap_js_1 = require(\"../../../utils/DefaultMap.js\");\nconst Deferred_js_1 = require(\"../../../utils/Deferred.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst NetworkUtils_js_1 = require(\"./NetworkUtils.js\");\nconst REALM_REGEX = /(?<=realm=\").*(?=\")/;\n/** Abstracts one individual network request. */\nclass NetworkRequest {\n    static unknownParameter = 'UNKNOWN';\n    /**\n     * Each network request has an associated request id, which is a string\n     * uniquely identifying that request.\n     *\n     * The identifier for a request resulting from a redirect matches that of the\n     * request that initiated it.\n     */\n    #id;\n    #fetchId;\n    /**\n     * Indicates the network intercept phase, if the request is currently blocked.\n     * Undefined necessarily implies that the request is not blocked.\n     */\n    #interceptPhase;\n    #servedFromCache = false;\n    #redirectCount;\n    #request = {};\n    #requestOverrides;\n    #responseOverrides;\n    #response = {};\n    #eventManager;\n    #networkStorage;\n    #cdpTarget;\n    #logger;\n    #emittedEvents = {\n        [protocol_js_1.ChromiumBidi.Network.EventNames.AuthRequired]: false,\n        [protocol_js_1.ChromiumBidi.Network.EventNames.BeforeRequestSent]: false,\n        [protocol_js_1.ChromiumBidi.Network.EventNames.FetchError]: false,\n        [protocol_js_1.ChromiumBidi.Network.EventNames.ResponseCompleted]: false,\n        [protocol_js_1.ChromiumBidi.Network.EventNames.ResponseStarted]: false,\n    };\n    waitNextPhase = new Deferred_js_1.Deferred();\n    constructor(id, eventManager, networkStorage, cdpTarget, redirectCount = 0, logger) {\n        this.#id = id;\n        this.#eventManager = eventManager;\n        this.#networkStorage = networkStorage;\n        this.#cdpTarget = cdpTarget;\n        this.#redirectCount = redirectCount;\n        this.#logger = logger;\n    }\n    get id() {\n        return this.#id;\n    }\n    get fetchId() {\n        return this.#fetchId;\n    }\n    /**\n     * When blocked returns the phase for it\n     */\n    get interceptPhase() {\n        return this.#interceptPhase;\n    }\n    get url() {\n        const fragment = this.#request.info?.request.urlFragment ??\n            this.#request.paused?.request.urlFragment ??\n            '';\n        const url = this.#response.paused?.request.url ??\n            this.#requestOverrides?.url ??\n            this.#response.info?.url ??\n            this.#request.auth?.request.url ??\n            this.#request.info?.request.url ??\n            this.#request.paused?.request.url ??\n            _a.unknownParameter;\n        return `${url}${fragment}`;\n    }\n    get redirectCount() {\n        return this.#redirectCount;\n    }\n    get cdpTarget() {\n        return this.#cdpTarget;\n    }\n    /** CdpTarget can be changed when frame is moving out of process. */\n    updateCdpTarget(cdpTarget) {\n        if (cdpTarget !== this.#cdpTarget) {\n            this.#logger?.(log_js_1.LogType.debugInfo, `Request ${this.id} was moved from ${this.#cdpTarget.id} to ${cdpTarget.id}`);\n            this.#cdpTarget = cdpTarget;\n        }\n    }\n    get cdpClient() {\n        return this.#cdpTarget.cdpClient;\n    }\n    isRedirecting() {\n        return Boolean(this.#request.info);\n    }\n    #isDataUrl() {\n        return this.url.startsWith('data:');\n    }\n    #isNonInterceptable() {\n        return (\n        // We can't intercept data urls from CDP\n        this.#isDataUrl() ||\n            // Cached requests never hit the network\n            this.#servedFromCache);\n    }\n    get #method() {\n        return (this.#requestOverrides?.method ??\n            this.#request.info?.request.method ??\n            this.#request.paused?.request.method ??\n            this.#request.auth?.request.method ??\n            this.#response.paused?.request.method);\n    }\n    get #navigationId() {\n        // Heuristic to determine if this is a navigation request, and if not return null.\n        if (!this.#request.info ||\n            !this.#request.info.loaderId ||\n            // When we navigate all CDP network events have `loaderId`\n            // CDP's `loaderId` and `requestId` match when\n            // that request triggered the loading\n            this.#request.info.loaderId !== this.#request.info.requestId) {\n            return null;\n        }\n        // Get virtual navigation ID from the browsing context.\n        return this.#networkStorage.getNavigationId(this.#context ?? undefined);\n    }\n    get #cookies() {\n        let cookies = [];\n        if (this.#request.extraInfo) {\n            cookies = this.#request.extraInfo.associatedCookies\n                .filter(({ blockedReasons }) => {\n                return !Array.isArray(blockedReasons) || blockedReasons.length === 0;\n            })\n                .map(({ cookie }) => (0, NetworkUtils_js_1.cdpToBiDiCookie)(cookie));\n        }\n        return cookies;\n    }\n    #getBodySizeFromHeaders(headers) {\n        if (headers === undefined) {\n            return undefined;\n        }\n        if (headers['Content-Length'] !== undefined) {\n            const bodySize = Number.parseInt(headers['Content-Length']);\n            if (Number.isInteger(bodySize)) {\n                return bodySize;\n            }\n            this.#logger?.(log_js_1.LogType.debugError, \"Unexpected non-integer 'Content-Length' header\");\n        }\n        // TODO: process `Transfer-Encoding: chunked` case properly.\n        return undefined;\n    }\n    get bodySize() {\n        if (typeof this.#requestOverrides?.bodySize === 'number') {\n            return this.#requestOverrides.bodySize;\n        }\n        if (this.#request.info?.request.postDataEntries !== undefined) {\n            return (0, NetworkUtils_js_1.bidiBodySizeFromCdpPostDataEntries)(this.#request.info?.request.postDataEntries);\n        }\n        // Try to guess the body size based on the `Content-Length` header.\n        return (this.#getBodySizeFromHeaders(this.#request.info?.request.headers) ??\n            this.#getBodySizeFromHeaders(this.#request.extraInfo?.headers) ??\n            0);\n    }\n    get #context() {\n        const result = this.#response.paused?.frameId ??\n            this.#request.info?.frameId ??\n            this.#request.paused?.frameId ??\n            this.#request.auth?.frameId;\n        if (result !== undefined) {\n            return result;\n        }\n        // Heuristic for associating a preflight request with context via it's initiator\n        // request. Useful for preflight requests.\n        // https://github.com/GoogleChromeLabs/chromium-bidi/issues/3570\n        if (this.#request?.info?.initiator.type === 'preflight' &&\n            this.#request?.info?.initiator.requestId !== undefined) {\n            const maybeInitiator = this.#networkStorage.getRequestById(this.#request?.info?.initiator.requestId);\n            if (maybeInitiator !== undefined) {\n                return maybeInitiator.#request.info?.frameId ?? null;\n            }\n        }\n        return null;\n    }\n    /** Returns the HTTP status code associated with this request if any. */\n    get #statusCode() {\n        return (this.#responseOverrides?.statusCode ??\n            this.#response.paused?.responseStatusCode ??\n            this.#response.extraInfo?.statusCode ??\n            this.#response.info?.status);\n    }\n    get #requestHeaders() {\n        let headers = [];\n        if (this.#requestOverrides?.headers) {\n            const headerMap = new DefaultMap_js_1.DefaultMap(() => []);\n            for (const header of this.#requestOverrides.headers) {\n                headerMap.get(header.name).push(header.value.value);\n            }\n            for (const [name, value] of headerMap.entries()) {\n                headers.push({\n                    name,\n                    value: {\n                        type: 'string',\n                        value: value.join('\\n').trimEnd(),\n                    },\n                });\n            }\n        }\n        else {\n            headers = [\n                ...(0, NetworkUtils_js_1.bidiNetworkHeadersFromCdpNetworkHeaders)(this.#request.info?.request.headers),\n                ...(0, NetworkUtils_js_1.bidiNetworkHeadersFromCdpNetworkHeaders)(this.#request.extraInfo?.headers),\n            ];\n        }\n        return headers;\n    }\n    get #authChallenges() {\n        // TODO: get headers from Fetch.requestPaused\n        if (!this.#response.info) {\n            return;\n        }\n        if (!(this.#statusCode === 401 || this.#statusCode === 407)) {\n            return undefined;\n        }\n        const headerName = this.#statusCode === 401 ? 'WWW-Authenticate' : 'Proxy-Authenticate';\n        const authChallenges = [];\n        for (const [header, value] of Object.entries(this.#response.info.headers)) {\n            // TODO: Do a proper match based on https://httpwg.org/specs/rfc9110.html#credentials\n            // Or verify this works\n            if (header.localeCompare(headerName, undefined, { sensitivity: 'base' }) === 0) {\n                authChallenges.push({\n                    scheme: value.split(' ').at(0) ?? '',\n                    realm: value.match(REALM_REGEX)?.at(0) ?? '',\n                });\n            }\n        }\n        return authChallenges;\n    }\n    get #timings() {\n        // The timing in the CDP events are provided relative to the event's baseline.\n        // However, the baseline can be different for different events, and the events have to\n        // be normalized throughout resource events. Normalize events timestamps  by the\n        // request.\n        // TODO: Verify this is correct.\n        const responseTimeOffset = (0, NetworkUtils_js_1.getTiming)((0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.requestTime) -\n            (0, NetworkUtils_js_1.getTiming)(this.#request.info?.timestamp));\n        return {\n            // TODO: Verify this is correct\n            timeOrigin: Math.round((0, NetworkUtils_js_1.getTiming)(this.#request.info?.wallTime) * 1000),\n            // Timing baseline.\n            // TODO: Verify this is correct.\n            requestTime: 0,\n            // TODO: set if redirect detected.\n            redirectStart: 0,\n            // TODO: set if redirect detected.\n            redirectEnd: 0,\n            // TODO: Verify this is correct\n            // https://source.chromium.org/chromium/chromium/src/+/main:net/base/load_timing_info.h;l=145\n            fetchStart: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.workerFetchStart, responseTimeOffset),\n            // fetchStart: 0,\n            dnsStart: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.dnsStart, responseTimeOffset),\n            dnsEnd: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.dnsEnd, responseTimeOffset),\n            connectStart: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.connectStart, responseTimeOffset),\n            connectEnd: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.connectEnd, responseTimeOffset),\n            tlsStart: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.sslStart, responseTimeOffset),\n            requestStart: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.sendStart, responseTimeOffset),\n            // https://source.chromium.org/chromium/chromium/src/+/main:net/base/load_timing_info.h;l=196\n            responseStart: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.receiveHeadersStart, responseTimeOffset),\n            responseEnd: (0, NetworkUtils_js_1.getTiming)(this.#response.info?.timing?.receiveHeadersEnd, responseTimeOffset),\n        };\n    }\n    #phaseChanged() {\n        this.waitNextPhase.resolve();\n        this.waitNextPhase = new Deferred_js_1.Deferred();\n    }\n    #interceptsInPhase(phase) {\n        if (this.#isNonInterceptable() ||\n            !this.#cdpTarget.isSubscribedTo(`network.${phase}`)) {\n            return new Set();\n        }\n        return this.#networkStorage.getInterceptsForPhase(this, phase);\n    }\n    #isBlockedInPhase(phase) {\n        return this.#interceptsInPhase(phase).size > 0;\n    }\n    handleRedirect(event) {\n        // TODO: use event.redirectResponse;\n        // Temporary workaround to emit ResponseCompleted event for redirects\n        this.#response.hasExtraInfo = false;\n        this.#response.info = event.redirectResponse;\n        this.#emitEventsIfReady({\n            wasRedirected: true,\n        });\n    }\n    #emitEventsIfReady(options = {}) {\n        const requestExtraInfoCompleted = \n        // Flush redirects\n        options.wasRedirected ||\n            options.hasFailed ||\n            this.#isDataUrl() ||\n            Boolean(this.#request.extraInfo) ||\n            // Requests from cache don't have extra info\n            this.#servedFromCache ||\n            // Sometimes there is no extra info and the response\n            // is the only place we can find out\n            Boolean(this.#response.info && !this.#response.hasExtraInfo);\n        const noInterceptionExpected = this.#isNonInterceptable();\n        const requestInterceptionExpected = !noInterceptionExpected &&\n            this.#isBlockedInPhase(\"beforeRequestSent\" /* Network.InterceptPhase.BeforeRequestSent */);\n        const requestInterceptionCompleted = !requestInterceptionExpected ||\n            (requestInterceptionExpected && Boolean(this.#request.paused));\n        if (Boolean(this.#request.info) &&\n            (requestInterceptionExpected\n                ? requestInterceptionCompleted\n                : requestExtraInfoCompleted)) {\n            this.#emitEvent(this.#getBeforeRequestEvent.bind(this));\n        }\n        const responseExtraInfoCompleted = Boolean(this.#response.extraInfo) ||\n            // Response from cache don't have extra info\n            this.#servedFromCache ||\n            // Don't expect extra info if the flag is false\n            Boolean(this.#response.info && !this.#response.hasExtraInfo);\n        const responseInterceptionExpected = !noInterceptionExpected &&\n            this.#isBlockedInPhase(\"responseStarted\" /* Network.InterceptPhase.ResponseStarted */);\n        if (this.#response.info ||\n            (responseInterceptionExpected && Boolean(this.#response.paused))) {\n            this.#emitEvent(this.#getResponseStartedEvent.bind(this));\n        }\n        const responseInterceptionCompleted = !responseInterceptionExpected ||\n            (responseInterceptionExpected && Boolean(this.#response.paused));\n        if (Boolean(this.#response.info) &&\n            responseExtraInfoCompleted &&\n            responseInterceptionCompleted) {\n            this.#emitEvent(this.#getResponseReceivedEvent.bind(this));\n            this.#networkStorage.disposeRequest(this.id);\n        }\n    }\n    onRequestWillBeSentEvent(event) {\n        this.#request.info = event;\n        this.#networkStorage.collectIfNeeded(this, \"request\" /* Network.DataType.Request */);\n        this.#emitEventsIfReady();\n    }\n    onRequestWillBeSentExtraInfoEvent(event) {\n        this.#request.extraInfo = event;\n        this.#emitEventsIfReady();\n    }\n    onResponseReceivedExtraInfoEvent(event) {\n        if (event.statusCode >= 300 &&\n            event.statusCode <= 399 &&\n            this.#request.info &&\n            event.headers['location'] === this.#request.info.request.url) {\n            // We received the Response Extra info for the redirect\n            // Too late so we need to skip it as it will\n            // fire wrongly for the last one\n            return;\n        }\n        this.#response.extraInfo = event;\n        this.#emitEventsIfReady();\n    }\n    onResponseReceivedEvent(event) {\n        this.#response.hasExtraInfo = event.hasExtraInfo;\n        this.#response.info = event.response;\n        this.#networkStorage.collectIfNeeded(this, \"response\" /* Network.DataType.Response */);\n        this.#emitEventsIfReady();\n    }\n    onServedFromCache() {\n        this.#servedFromCache = true;\n        this.#emitEventsIfReady();\n    }\n    onLoadingFailedEvent(event) {\n        this.#emitEventsIfReady({\n            hasFailed: true,\n        });\n        this.#emitEvent(() => {\n            return {\n                method: protocol_js_1.ChromiumBidi.Network.EventNames.FetchError,\n                params: {\n                    ...this.#getBaseEventParams(),\n                    errorText: event.errorText,\n                },\n            };\n        });\n    }\n    /** @see https://chromedevtools.github.io/devtools-protocol/tot/Fetch/#method-failRequest */\n    async failRequest(errorReason) {\n        (0, assert_js_1.assert)(this.#fetchId, 'Network Interception not set-up.');\n        await this.cdpClient.sendCommand('Fetch.failRequest', {\n            requestId: this.#fetchId,\n            errorReason,\n        });\n        this.#interceptPhase = undefined;\n    }\n    onRequestPaused(event) {\n        this.#fetchId = event.requestId;\n        // CDP https://chromedevtools.github.io/devtools-protocol/tot/Fetch/#event-requestPaused\n        if (event.responseStatusCode || event.responseErrorReason) {\n            this.#response.paused = event;\n            if (this.#isBlockedInPhase(\"responseStarted\" /* Network.InterceptPhase.ResponseStarted */) &&\n                // CDP may emit multiple events for a single request\n                !this.#emittedEvents[protocol_js_1.ChromiumBidi.Network.EventNames.ResponseStarted] &&\n                // Continue all response that have not enabled Network domain\n                this.#fetchId !== this.id) {\n                this.#interceptPhase = \"responseStarted\" /* Network.InterceptPhase.ResponseStarted */;\n            }\n            else {\n                void this.#continueResponse();\n            }\n        }\n        else {\n            this.#request.paused = event;\n            if (this.#isBlockedInPhase(\"beforeRequestSent\" /* Network.InterceptPhase.BeforeRequestSent */) &&\n                // CDP may emit multiple events for a single request\n                !this.#emittedEvents[protocol_js_1.ChromiumBidi.Network.EventNames.BeforeRequestSent] &&\n                // Continue all requests that have not enabled Network domain\n                this.#fetchId !== this.id) {\n                this.#interceptPhase = \"beforeRequestSent\" /* Network.InterceptPhase.BeforeRequestSent */;\n            }\n            else {\n                void this.#continueRequest();\n            }\n        }\n        this.#emitEventsIfReady();\n    }\n    onAuthRequired(event) {\n        this.#fetchId = event.requestId;\n        this.#request.auth = event;\n        if (this.#isBlockedInPhase(\"authRequired\" /* Network.InterceptPhase.AuthRequired */) &&\n            // Continue all auth requests that have not enabled Network domain\n            this.#fetchId !== this.id) {\n            this.#interceptPhase = \"authRequired\" /* Network.InterceptPhase.AuthRequired */;\n        }\n        else {\n            void this.#continueWithAuth({\n                response: 'Default',\n            });\n        }\n        this.#emitEvent(() => {\n            return {\n                method: protocol_js_1.ChromiumBidi.Network.EventNames.AuthRequired,\n                params: {\n                    ...this.#getBaseEventParams(\"authRequired\" /* Network.InterceptPhase.AuthRequired */),\n                    response: this.#getResponseEventParams(),\n                },\n            };\n        });\n    }\n    /** @see https://chromedevtools.github.io/devtools-protocol/tot/Fetch/#method-continueRequest */\n    async continueRequest(overrides = {}) {\n        const overrideHeaders = this.#getOverrideHeader(overrides.headers, overrides.cookies);\n        const headers = (0, NetworkUtils_js_1.cdpFetchHeadersFromBidiNetworkHeaders)(overrideHeaders);\n        const postData = getCdpBodyFromBiDiBytesValue(overrides.body);\n        await this.#continueRequest({\n            url: overrides.url,\n            method: overrides.method,\n            headers,\n            postData,\n        });\n        this.#requestOverrides = {\n            url: overrides.url,\n            method: overrides.method,\n            headers: overrides.headers,\n            cookies: overrides.cookies,\n            bodySize: getSizeFromBiDiBytesValue(overrides.body),\n        };\n    }\n    async #continueRequest(overrides = {}) {\n        (0, assert_js_1.assert)(this.#fetchId, 'Network Interception not set-up.');\n        await this.cdpClient.sendCommand('Fetch.continueRequest', {\n            requestId: this.#fetchId,\n            url: overrides.url,\n            method: overrides.method,\n            headers: overrides.headers,\n            postData: overrides.postData,\n        });\n        this.#interceptPhase = undefined;\n    }\n    /** @see https://chromedevtools.github.io/devtools-protocol/tot/Fetch/#method-continueResponse */\n    async continueResponse(overrides = {}) {\n        if (this.interceptPhase === \"authRequired\" /* Network.InterceptPhase.AuthRequired */) {\n            if (overrides.credentials) {\n                await Promise.all([\n                    this.waitNextPhase,\n                    await this.#continueWithAuth({\n                        response: 'ProvideCredentials',\n                        username: overrides.credentials.username,\n                        password: overrides.credentials.password,\n                    }),\n                ]);\n            }\n            else {\n                // We need to use `ProvideCredentials`\n                // As `Default` may cancel the request\n                return await this.#continueWithAuth({\n                    response: 'ProvideCredentials',\n                });\n            }\n        }\n        if (this.#interceptPhase === \"responseStarted\" /* Network.InterceptPhase.ResponseStarted */) {\n            const overrideHeaders = this.#getOverrideHeader(overrides.headers, overrides.cookies);\n            const responseHeaders = (0, NetworkUtils_js_1.cdpFetchHeadersFromBidiNetworkHeaders)(overrideHeaders);\n            await this.#continueResponse({\n                responseCode: overrides.statusCode ?? this.#response.paused?.responseStatusCode,\n                responsePhrase: overrides.reasonPhrase ?? this.#response.paused?.responseStatusText,\n                responseHeaders: responseHeaders ?? this.#response.paused?.responseHeaders,\n            });\n            this.#responseOverrides = {\n                statusCode: overrides.statusCode,\n                headers: overrideHeaders,\n            };\n        }\n    }\n    async #continueResponse({ responseCode, responsePhrase, responseHeaders, } = {}) {\n        (0, assert_js_1.assert)(this.#fetchId, 'Network Interception not set-up.');\n        await this.cdpClient.sendCommand('Fetch.continueResponse', {\n            requestId: this.#fetchId,\n            responseCode,\n            responsePhrase,\n            responseHeaders,\n        });\n        this.#interceptPhase = undefined;\n    }\n    /** @see https://chromedevtools.github.io/devtools-protocol/tot/Fetch/#method-continueWithAuth */\n    async continueWithAuth(authChallenge) {\n        let username;\n        let password;\n        if (authChallenge.action === 'provideCredentials') {\n            const { credentials } = authChallenge;\n            username = credentials.username;\n            password = credentials.password;\n        }\n        const response = (0, NetworkUtils_js_1.cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction)(authChallenge.action);\n        await this.#continueWithAuth({\n            response,\n            username,\n            password,\n        });\n    }\n    /** @see https://chromedevtools.github.io/devtools-protocol/tot/Fetch/#method-provideResponse */\n    async provideResponse(overrides) {\n        (0, assert_js_1.assert)(this.#fetchId, 'Network Interception not set-up.');\n        // We need to pass through if the request is already in\n        // AuthRequired phase\n        if (this.interceptPhase === \"authRequired\" /* Network.InterceptPhase.AuthRequired */) {\n            // We need to use `ProvideCredentials`\n            // As `Default` may cancel the request\n            return await this.#continueWithAuth({\n                response: 'ProvideCredentials',\n            });\n        }\n        // If we don't modify the response\n        // just continue the request\n        if (!overrides.body && !overrides.headers) {\n            return await this.#continueRequest();\n        }\n        const overrideHeaders = this.#getOverrideHeader(overrides.headers, overrides.cookies);\n        const responseHeaders = (0, NetworkUtils_js_1.cdpFetchHeadersFromBidiNetworkHeaders)(overrideHeaders);\n        const responseCode = overrides.statusCode ?? this.#statusCode ?? 200;\n        await this.cdpClient.sendCommand('Fetch.fulfillRequest', {\n            requestId: this.#fetchId,\n            responseCode,\n            responsePhrase: overrides.reasonPhrase,\n            responseHeaders,\n            body: getCdpBodyFromBiDiBytesValue(overrides.body),\n        });\n        this.#interceptPhase = undefined;\n    }\n    dispose() {\n        this.waitNextPhase.reject(new Error('waitNextPhase disposed'));\n    }\n    async #continueWithAuth(authChallengeResponse) {\n        (0, assert_js_1.assert)(this.#fetchId, 'Network Interception not set-up.');\n        await this.cdpClient.sendCommand('Fetch.continueWithAuth', {\n            requestId: this.#fetchId,\n            authChallengeResponse,\n        });\n        this.#interceptPhase = undefined;\n    }\n    #emitEvent(getEvent) {\n        let event;\n        try {\n            event = getEvent();\n        }\n        catch (error) {\n            this.#logger?.(log_js_1.LogType.debugError, error);\n            return;\n        }\n        if (this.#isIgnoredEvent() ||\n            (this.#emittedEvents[event.method] &&\n                // Special case this event can be emitted multiple times\n                event.method !== protocol_js_1.ChromiumBidi.Network.EventNames.AuthRequired)) {\n            return;\n        }\n        this.#phaseChanged();\n        this.#emittedEvents[event.method] = true;\n        if (this.#context) {\n            this.#eventManager.registerEvent(Object.assign(event, {\n                type: 'event',\n            }), this.#context);\n        }\n        else {\n            this.#eventManager.registerGlobalEvent(Object.assign(event, {\n                type: 'event',\n            }));\n        }\n    }\n    #getBaseEventParams(phase) {\n        const interceptProps = {\n            isBlocked: false,\n        };\n        if (phase) {\n            const blockedBy = this.#interceptsInPhase(phase);\n            interceptProps.isBlocked = blockedBy.size > 0;\n            if (interceptProps.isBlocked) {\n                interceptProps.intercepts = [...blockedBy];\n            }\n        }\n        return {\n            context: this.#context,\n            navigation: this.#navigationId,\n            redirectCount: this.#redirectCount,\n            request: this.#getRequestData(),\n            // Timestamp should be in milliseconds, while CDP provides it in seconds.\n            timestamp: Math.round((0, NetworkUtils_js_1.getTiming)(this.#request.info?.wallTime) * 1000),\n            // Contains isBlocked and intercepts\n            ...interceptProps,\n        };\n    }\n    #getResponseEventParams() {\n        // Chromium sends wrong extraInfo events for responses served from cache.\n        // See https://github.com/puppeteer/puppeteer/issues/9965 and\n        // https://crbug.com/1340398.\n        if (this.#response.info?.fromDiskCache) {\n            this.#response.extraInfo = undefined;\n        }\n        // TODO: Also this.#response.paused?.responseHeaders have to be merged here.\n        const cdpHeaders = this.#response.info?.headers ?? {};\n        const cdpRawHeaders = this.#response.extraInfo?.headers ?? {};\n        for (const [key, value] of Object.entries(cdpRawHeaders)) {\n            cdpHeaders[key] = value;\n        }\n        const headers = (0, NetworkUtils_js_1.bidiNetworkHeadersFromCdpNetworkHeaders)(cdpHeaders);\n        const authChallenges = this.#authChallenges;\n        const response = {\n            url: this.url,\n            protocol: this.#response.info?.protocol ?? '',\n            status: this.#statusCode ?? -1, // TODO: Throw an exception or use some other status code?\n            statusText: this.#response.info?.statusText ||\n                this.#response.paused?.responseStatusText ||\n                '',\n            fromCache: this.#response.info?.fromDiskCache ||\n                this.#response.info?.fromPrefetchCache ||\n                this.#servedFromCache,\n            headers: this.#responseOverrides?.headers ?? headers,\n            mimeType: this.#response.info?.mimeType || '',\n            bytesReceived: this.bytesReceived,\n            headersSize: (0, NetworkUtils_js_1.computeHeadersSize)(headers),\n            // TODO: consider removing from spec.\n            bodySize: 0,\n            content: {\n                // TODO: consider removing from spec.\n                size: 0,\n            },\n            ...(authChallenges ? { authChallenges } : {}),\n        };\n        return {\n            ...response,\n            'goog:securityDetails': this.#response.info?.securityDetails,\n        };\n    }\n    get bytesReceived() {\n        return this.#response.info?.encodedDataLength || 0;\n    }\n    #getRequestData() {\n        const headers = this.#requestHeaders;\n        const request = {\n            request: this.#id,\n            url: this.url,\n            method: this.#method ?? _a.unknownParameter,\n            headers,\n            cookies: this.#cookies,\n            headersSize: (0, NetworkUtils_js_1.computeHeadersSize)(headers),\n            bodySize: this.bodySize,\n            // TODO: populate\n            destination: this.#getDestination(),\n            // TODO: populate\n            initiatorType: this.#getInitiatorType(),\n            timings: this.#timings,\n        };\n        return {\n            ...request,\n            'goog:postData': this.#request.info?.request?.postData,\n            'goog:hasPostData': this.#request.info?.request?.hasPostData,\n            'goog:resourceType': this.#request.info?.type,\n            'goog:resourceInitiator': this.#request.info?.initiator,\n        };\n    }\n    /**\n     * Heuristic trying to guess the destination.\n     * Specification: https://fetch.spec.whatwg.org/#concept-request-destination.\n     * Specified values: \"audio\", \"audioworklet\", \"document\", \"embed\", \"font\", \"frame\",\n     * \"iframe\", \"image\", \"json\", \"manifest\", \"object\", \"paintworklet\", \"report\", \"script\",\n     * \"serviceworker\", \"sharedworker\", \"style\", \"track\", \"video\", \"webidentity\", \"worker\",\n     * \"xslt\".\n     */\n    #getDestination() {\n        switch (this.#request.info?.type) {\n            case 'Script':\n                return 'script';\n            case 'Stylesheet':\n                return 'style';\n            case 'Image':\n                return 'image';\n            case 'Document':\n                // If request to document is initiated by parser, assume it is expected to\n                // arrive in an iframe. Otherwise, consider it is a navigation and the request\n                // result will end up in the document.\n                return this.#request.info?.initiator.type === 'parser'\n                    ? 'iframe'\n                    : 'document';\n            default:\n                return '';\n        }\n    }\n    /**\n     * Heuristic trying to guess the initiator type.\n     * Specification: https://fetch.spec.whatwg.org/#request-initiator-type.\n     * Specified values: \"audio\", \"beacon\", \"body\", \"css\", \"early-hints\", \"embed\", \"fetch\",\n     * \"font\", \"frame\", \"iframe\", \"image\", \"img\", \"input\", \"link\", \"object\", \"ping\",\n     * \"script\", \"track\", \"video\", \"xmlhttprequest\", \"other\".\n     */\n    #getInitiatorType() {\n        if (this.#request.info?.initiator.type === 'parser') {\n            switch (this.#request.info?.type) {\n                case 'Document':\n                    // The request to document is initiated by the parser. Assuming it's an iframe.\n                    return 'iframe';\n                case 'Font':\n                    // If the document's url is not the parser's url, assume the resource is loaded\n                    // from css. Otherwise, it's a `font` element.\n                    return this.#request.info?.initiator?.url ===\n                        this.#request.info?.documentURL\n                        ? 'font'\n                        : 'css';\n                case 'Image':\n                    // If the document's url is not the parser's url, assume the resource is loaded\n                    // from css. Otherwise, it's a `img` element.\n                    return this.#request.info?.initiator?.url ===\n                        this.#request.info?.documentURL\n                        ? 'img'\n                        : 'css';\n                case 'Script':\n                    return 'script';\n                case 'Stylesheet':\n                    return 'link';\n                default:\n                    return null;\n            }\n        }\n        if (this.#request?.info?.type === 'Fetch') {\n            return 'fetch';\n        }\n        return null;\n    }\n    #getBeforeRequestEvent() {\n        (0, assert_js_1.assert)(this.#request.info, 'RequestWillBeSentEvent is not set');\n        return {\n            method: protocol_js_1.ChromiumBidi.Network.EventNames.BeforeRequestSent,\n            params: {\n                ...this.#getBaseEventParams(\"beforeRequestSent\" /* Network.InterceptPhase.BeforeRequestSent */),\n                initiator: {\n                    type: _a.#getInitiator(this.#request.info.initiator.type),\n                    columnNumber: this.#request.info.initiator.columnNumber,\n                    lineNumber: this.#request.info.initiator.lineNumber,\n                    stackTrace: this.#request.info.initiator.stack,\n                    request: this.#request.info.initiator.requestId,\n                },\n            },\n        };\n    }\n    #getResponseStartedEvent() {\n        return {\n            method: protocol_js_1.ChromiumBidi.Network.EventNames.ResponseStarted,\n            params: {\n                ...this.#getBaseEventParams(\"responseStarted\" /* Network.InterceptPhase.ResponseStarted */),\n                response: this.#getResponseEventParams(),\n            },\n        };\n    }\n    #getResponseReceivedEvent() {\n        return {\n            method: protocol_js_1.ChromiumBidi.Network.EventNames.ResponseCompleted,\n            params: {\n                ...this.#getBaseEventParams(),\n                response: this.#getResponseEventParams(),\n            },\n        };\n    }\n    #isIgnoredEvent() {\n        const faviconUrl = '/favicon.ico';\n        return (this.#request.paused?.request.url.endsWith(faviconUrl) ??\n            this.#request.info?.request.url.endsWith(faviconUrl) ??\n            false);\n    }\n    #getOverrideHeader(headers, cookies) {\n        if (!headers && !cookies) {\n            return undefined;\n        }\n        let overrideHeaders = headers;\n        const cookieHeader = (0, NetworkUtils_js_1.networkHeaderFromCookieHeaders)(cookies);\n        if (cookieHeader && !overrideHeaders) {\n            overrideHeaders = this.#requestHeaders;\n        }\n        if (cookieHeader && overrideHeaders) {\n            overrideHeaders.filter((header) => header.name.localeCompare('cookie', undefined, {\n                sensitivity: 'base',\n            }) !== 0);\n            overrideHeaders.push(cookieHeader);\n        }\n        return overrideHeaders;\n    }\n    static #getInitiator(initiatorType) {\n        switch (initiatorType) {\n            case 'parser':\n            case 'script':\n            case 'preflight':\n                return initiatorType;\n            default:\n                return 'other';\n        }\n    }\n}\nexports.NetworkRequest = NetworkRequest;\n_a = NetworkRequest;\nfunction getCdpBodyFromBiDiBytesValue(body) {\n    let parsedBody;\n    if (body?.type === 'string') {\n        parsedBody = (0, NetworkUtils_js_1.stringToBase64)(body.value);\n    }\n    else if (body?.type === 'base64') {\n        parsedBody = body.value;\n    }\n    return parsedBody;\n}\nfunction getSizeFromBiDiBytesValue(body) {\n    if (body?.type === 'string') {\n        return body.value.length;\n    }\n    else if (body?.type === 'base64') {\n        return atob(body.value).length;\n    }\n    return 0;\n}\n//# sourceMappingURL=NetworkRequest.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NetworkStorage = exports.MAX_TOTAL_COLLECTED_SIZE = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\nconst CollectorsStorage_js_1 = require(\"./CollectorsStorage.js\");\nconst NetworkRequest_js_1 = require(\"./NetworkRequest.js\");\nconst NetworkUtils_js_1 = require(\"./NetworkUtils.js\");\n// The default total data size limit in CDP.\n// https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/inspector/inspector_network_agent.cc;drc=da1f749634c9a401cc756f36c2e6ce233e1c9b4d;l=133\nexports.MAX_TOTAL_COLLECTED_SIZE = 200_000_000;\n/** Stores network and intercept maps. */\nclass NetworkStorage {\n    #browsingContextStorage;\n    #eventManager;\n    #collectorsStorage;\n    #logger;\n    /**\n     * A map from network request ID to Network Request objects.\n     * Needed as long as information about requests comes from different events.\n     */\n    #requests = new Map();\n    /** A map from intercept ID to track active network intercepts. */\n    #intercepts = new Map();\n    #defaultCacheBehavior = 'default';\n    constructor(eventManager, browsingContextStorage, browserClient, logger) {\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#eventManager = eventManager;\n        this.#collectorsStorage = new CollectorsStorage_js_1.CollectorsStorage(exports.MAX_TOTAL_COLLECTED_SIZE, logger);\n        browserClient.on('Target.detachedFromTarget', ({ sessionId }) => {\n            this.disposeRequestMap(sessionId);\n        });\n        this.#logger = logger;\n    }\n    /**\n     * Gets the network request with the given ID, if any.\n     * Otherwise, creates a new network request with the given ID and cdp target.\n     */\n    #getOrCreateNetworkRequest(id, cdpTarget, redirectCount) {\n        let request = this.getRequestById(id);\n        if (redirectCount === undefined && request) {\n            // Force re-creating requests for redirects.\n            return request;\n        }\n        request = new NetworkRequest_js_1.NetworkRequest(id, this.#eventManager, this, cdpTarget, redirectCount, this.#logger);\n        this.addRequest(request);\n        return request;\n    }\n    onCdpTargetCreated(cdpTarget) {\n        const cdpClient = cdpTarget.cdpClient;\n        // TODO: Wrap into object\n        const listeners = [\n            [\n                'Network.requestWillBeSent',\n                (params) => {\n                    const request = this.getRequestById(params.requestId);\n                    request?.updateCdpTarget(cdpTarget);\n                    if (request && request.isRedirecting()) {\n                        request.handleRedirect(params);\n                        this.disposeRequest(params.requestId);\n                        this.#getOrCreateNetworkRequest(params.requestId, cdpTarget, request.redirectCount + 1).onRequestWillBeSentEvent(params);\n                    }\n                    else {\n                        this.#getOrCreateNetworkRequest(params.requestId, cdpTarget).onRequestWillBeSentEvent(params);\n                    }\n                },\n            ],\n            [\n                'Network.requestWillBeSentExtraInfo',\n                (params) => {\n                    const request = this.#getOrCreateNetworkRequest(params.requestId, cdpTarget);\n                    request.updateCdpTarget(cdpTarget);\n                    request.onRequestWillBeSentExtraInfoEvent(params);\n                },\n            ],\n            [\n                'Network.responseReceived',\n                (params) => {\n                    const request = this.#getOrCreateNetworkRequest(params.requestId, cdpTarget);\n                    request.updateCdpTarget(cdpTarget);\n                    request.onResponseReceivedEvent(params);\n                },\n            ],\n            [\n                'Network.responseReceivedExtraInfo',\n                (params) => {\n                    const request = this.#getOrCreateNetworkRequest(params.requestId, cdpTarget);\n                    request.updateCdpTarget(cdpTarget);\n                    request.onResponseReceivedExtraInfoEvent(params);\n                },\n            ],\n            [\n                'Network.requestServedFromCache',\n                (params) => {\n                    const request = this.#getOrCreateNetworkRequest(params.requestId, cdpTarget);\n                    request.updateCdpTarget(cdpTarget);\n                    request.onServedFromCache();\n                },\n            ],\n            [\n                'Network.loadingFailed',\n                (params) => {\n                    const request = this.#getOrCreateNetworkRequest(params.requestId, cdpTarget);\n                    request.updateCdpTarget(cdpTarget);\n                    request.onLoadingFailedEvent(params);\n                },\n            ],\n            [\n                'Fetch.requestPaused',\n                (event) => {\n                    const request = this.#getOrCreateNetworkRequest(\n                    // CDP quirk if the Network domain is not present this is undefined\n                    event.networkId ?? event.requestId, cdpTarget);\n                    request.updateCdpTarget(cdpTarget);\n                    request.onRequestPaused(event);\n                },\n            ],\n            [\n                'Fetch.authRequired',\n                (event) => {\n                    let request = this.getRequestByFetchId(event.requestId);\n                    if (!request) {\n                        request = this.#getOrCreateNetworkRequest(event.requestId, cdpTarget);\n                    }\n                    request.updateCdpTarget(cdpTarget);\n                    request.onAuthRequired(event);\n                },\n            ],\n            [\n                'Network.dataReceived',\n                (params) => {\n                    this.getRequestById(params.requestId)?.updateCdpTarget(cdpTarget);\n                },\n            ],\n            [\n                'Network.loadingFinished',\n                (params) => {\n                    this.getRequestById(params.requestId)?.updateCdpTarget(cdpTarget);\n                },\n            ],\n        ];\n        for (const [event, listener] of listeners) {\n            cdpClient.on(event, listener);\n        }\n    }\n    async getCollectedData(params) {\n        if (!this.#collectorsStorage.isCollected(params.request, params.dataType, params.collector)) {\n            throw new protocol_js_1.NoSuchNetworkDataException(params.collector === undefined\n                ? `No collected ${params.dataType} data`\n                : `Collector ${params.collector} didn't collect ${params.dataType} data`);\n        }\n        if (params.disown && params.collector === undefined) {\n            throw new protocol_js_1.InvalidArgumentException('Cannot disown collected data without collector ID');\n        }\n        const request = this.getRequestById(params.request);\n        if (request === undefined) {\n            throw new protocol_js_1.NoSuchNetworkDataException(`No data for ${params.request}`);\n        }\n        let result = undefined;\n        switch (params.dataType) {\n            case \"response\" /* Network.DataType.Response */:\n                result = await this.#getCollectedResponseData(request);\n                break;\n            case \"request\" /* Network.DataType.Request */:\n                result = await this.#getCollectedRequestData(request);\n                break;\n            default:\n                throw new protocol_js_1.UnsupportedOperationException(`Unsupported data type ${params.dataType}`);\n        }\n        if (params.disown && params.collector !== undefined) {\n            this.#collectorsStorage.disownData(request.id, params.dataType, params.collector);\n            // `disposeRequest` disposes request only if no other collectors for it are left.\n            this.disposeRequest(request.id);\n        }\n        return result;\n    }\n    async #getCollectedResponseData(request) {\n        try {\n            const responseBody = await request.cdpClient.sendCommand('Network.getResponseBody', { requestId: request.id });\n            return {\n                bytes: {\n                    type: responseBody.base64Encoded ? 'base64' : 'string',\n                    value: responseBody.body,\n                },\n            };\n        }\n        catch (error) {\n            if (error.code === -32000 /* CdpErrorConstants.GENERIC_ERROR */ &&\n                error.message === 'No resource with given identifier found') {\n                // The data has be gone for whatever reason.\n                throw new protocol_js_1.NoSuchNetworkDataException(`Response data was disposed`);\n            }\n            if (error.code === -32001 /* CdpErrorConstants.CONNECTION_CLOSED */) {\n                // The request's CDP session is gone. http://b/450771615.\n                throw new protocol_js_1.NoSuchNetworkDataException(`Response data is disposed after the related page`);\n            }\n            throw error;\n        }\n    }\n    async #getCollectedRequestData(request) {\n        // TODO: handle CDP error in case of the renderer is gone.\n        const requestPostData = await request.cdpClient.sendCommand('Network.getRequestPostData', { requestId: request.id });\n        return {\n            bytes: {\n                type: 'string',\n                value: requestPostData.postData,\n            },\n        };\n    }\n    collectIfNeeded(request, dataType) {\n        this.#collectorsStorage.collectIfNeeded(request, dataType, request.cdpTarget.topLevelId, request.cdpTarget.userContext);\n    }\n    getInterceptionStages(browsingContextId) {\n        const stages = {\n            request: false,\n            response: false,\n            auth: false,\n        };\n        for (const intercept of this.#intercepts.values()) {\n            if (intercept.contexts &&\n                !intercept.contexts.includes(browsingContextId)) {\n                continue;\n            }\n            stages.request ||= intercept.phases.includes(\"beforeRequestSent\" /* Network.InterceptPhase.BeforeRequestSent */);\n            stages.response ||= intercept.phases.includes(\"responseStarted\" /* Network.InterceptPhase.ResponseStarted */);\n            stages.auth ||= intercept.phases.includes(\"authRequired\" /* Network.InterceptPhase.AuthRequired */);\n        }\n        return stages;\n    }\n    getInterceptsForPhase(request, phase) {\n        if (request.url === NetworkRequest_js_1.NetworkRequest.unknownParameter) {\n            return new Set();\n        }\n        const intercepts = new Set();\n        for (const [interceptId, intercept] of this.#intercepts.entries()) {\n            if (!intercept.phases.includes(phase) ||\n                (intercept.contexts &&\n                    !intercept.contexts.includes(request.cdpTarget.topLevelId))) {\n                continue;\n            }\n            if (intercept.urlPatterns.length === 0) {\n                intercepts.add(interceptId);\n                continue;\n            }\n            for (const pattern of intercept.urlPatterns) {\n                if ((0, NetworkUtils_js_1.matchUrlPattern)(pattern, request.url)) {\n                    intercepts.add(interceptId);\n                    break;\n                }\n            }\n        }\n        return intercepts;\n    }\n    disposeRequestMap(sessionId) {\n        for (const request of this.#requests.values()) {\n            if (request.cdpClient.sessionId === sessionId) {\n                this.#requests.delete(request.id);\n                request.dispose();\n            }\n        }\n    }\n    /**\n     * Adds the given entry to the intercept map.\n     * URL patterns are assumed to be parsed.\n     *\n     * @return The intercept ID.\n     */\n    addIntercept(value) {\n        const interceptId = (0, uuid_js_1.uuidv4)();\n        this.#intercepts.set(interceptId, value);\n        return interceptId;\n    }\n    /**\n     * Removes the given intercept from the intercept map.\n     * Throws NoSuchInterceptException if the intercept does not exist.\n     */\n    removeIntercept(intercept) {\n        if (!this.#intercepts.has(intercept)) {\n            throw new protocol_js_1.NoSuchInterceptException(`Intercept '${intercept}' does not exist.`);\n        }\n        this.#intercepts.delete(intercept);\n    }\n    getRequestsByTarget(target) {\n        const requests = [];\n        for (const request of this.#requests.values()) {\n            if (request.cdpTarget === target) {\n                requests.push(request);\n            }\n        }\n        return requests;\n    }\n    getRequestById(id) {\n        return this.#requests.get(id);\n    }\n    getRequestByFetchId(fetchId) {\n        for (const request of this.#requests.values()) {\n            if (request.fetchId === fetchId) {\n                return request;\n            }\n        }\n        return;\n    }\n    addRequest(request) {\n        this.#requests.set(request.id, request);\n    }\n    /**\n     * Disposes the given request, if no collectors targeting it are left.\n     */\n    disposeRequest(id) {\n        if (this.#collectorsStorage.isCollected(id)) {\n            // Keep request, as it's data can be accessed later.\n            return;\n        }\n        // TODO: dispose Network data from Chromium once there is a CDP command for that.\n        this.#requests.delete(id);\n    }\n    /**\n     * Gets the virtual navigation ID for the given navigable ID.\n     */\n    getNavigationId(contextId) {\n        if (contextId === undefined) {\n            return null;\n        }\n        return (this.#browsingContextStorage.findContext(contextId)?.navigationId ?? null);\n    }\n    set defaultCacheBehavior(behavior) {\n        this.#defaultCacheBehavior = behavior;\n    }\n    get defaultCacheBehavior() {\n        return this.#defaultCacheBehavior;\n    }\n    addDataCollector(params) {\n        return this.#collectorsStorage.addDataCollector(params);\n    }\n    removeDataCollector(params) {\n        const releasedRequests = this.#collectorsStorage.removeDataCollector(params.collector);\n        releasedRequests.map((request) => this.disposeRequest(request));\n    }\n    disownData(params) {\n        if (!this.#collectorsStorage.isCollected(params.request, params.dataType, params.collector)) {\n            throw new protocol_js_1.NoSuchNetworkDataException(`Collector ${params.collector} didn't collect ${params.dataType} data`);\n        }\n        this.#collectorsStorage.disownData(params.request, params.dataType, params.collector);\n        // `disposeRequest` disposes request only if no other collectors for it are left.\n        this.disposeRequest(params.request);\n    }\n}\nexports.NetworkStorage = NetworkStorage;\n//# sourceMappingURL=NetworkStorage.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CdpTarget = void 0;\nconst chromium_bidi_js_1 = require(\"../../../protocol/chromium-bidi.js\");\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst Deferred_js_1 = require(\"../../../utils/Deferred.js\");\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst BrowsingContextImpl_js_1 = require(\"../context/BrowsingContextImpl.js\");\nconst LogManager_js_1 = require(\"../log/LogManager.js\");\nconst NetworkStorage_js_1 = require(\"../network/NetworkStorage.js\");\nclass CdpTarget {\n    #id;\n    userContext;\n    #cdpClient;\n    #browserCdpClient;\n    #parentCdpClient;\n    #realmStorage;\n    #eventManager;\n    #preloadScriptStorage;\n    #browsingContextStorage;\n    #networkStorage;\n    contextConfigStorage;\n    #unblocked = new Deferred_js_1.Deferred();\n    #logger;\n    /**\n     * Target's window id. Is filled when the CDP target is created and do not reflect\n     * moving targets from one window to another. The actual values\n     * will be set during `#unblock`.\n     * */\n    #windowId;\n    #deviceAccessEnabled = false;\n    #cacheDisableState = false;\n    #preloadEnabled = false;\n    #fetchDomainStages = {\n        request: false,\n        response: false,\n        auth: false,\n    };\n    static create(targetId, cdpClient, browserCdpClient, parentCdpClient, realmStorage, eventManager, preloadScriptStorage, browsingContextStorage, networkStorage, configStorage, userContext, logger) {\n        const cdpTarget = new CdpTarget(targetId, cdpClient, browserCdpClient, parentCdpClient, eventManager, realmStorage, preloadScriptStorage, browsingContextStorage, configStorage, networkStorage, userContext, logger);\n        LogManager_js_1.LogManager.create(cdpTarget, realmStorage, eventManager, logger);\n        cdpTarget.#setEventListeners();\n        // No need to await.\n        // Deferred will be resolved when the target is unblocked.\n        void cdpTarget.#unblock();\n        return cdpTarget;\n    }\n    constructor(targetId, cdpClient, browserCdpClient, parentCdpClient, eventManager, realmStorage, preloadScriptStorage, browsingContextStorage, configStorage, networkStorage, userContext, logger) {\n        this.userContext = userContext;\n        this.#id = targetId;\n        this.#cdpClient = cdpClient;\n        this.#browserCdpClient = browserCdpClient;\n        this.#parentCdpClient = parentCdpClient;\n        this.#eventManager = eventManager;\n        this.#realmStorage = realmStorage;\n        this.#preloadScriptStorage = preloadScriptStorage;\n        this.#networkStorage = networkStorage;\n        this.#browsingContextStorage = browsingContextStorage;\n        this.contextConfigStorage = configStorage;\n        this.#logger = logger;\n    }\n    /** Returns a deferred that resolves when the target is unblocked. */\n    get unblocked() {\n        return this.#unblocked;\n    }\n    get id() {\n        return this.#id;\n    }\n    get cdpClient() {\n        return this.#cdpClient;\n    }\n    get parentCdpClient() {\n        return this.#parentCdpClient;\n    }\n    get browserCdpClient() {\n        return this.#browserCdpClient;\n    }\n    /** Needed for CDP escape path. */\n    get cdpSessionId() {\n        // SAFETY we got the client by it's id for creating\n        return this.#cdpClient.sessionId;\n    }\n    /**\n     * Window id the target belongs to. If not known, returns 0.\n     */\n    get windowId() {\n        if (this.#windowId === undefined) {\n            this.#logger?.(log_js_1.LogType.debugError, 'Getting windowId before it was set, returning 0');\n        }\n        return this.#windowId ?? 0;\n    }\n    /**\n     * Enables all the required CDP domains and unblocks the target.\n     */\n    async #unblock() {\n        const config = this.contextConfigStorage.getActiveConfig(this.topLevelId, this.userContext);\n        const results = await Promise.allSettled([\n            this.#cdpClient.sendCommand('Page.enable', {\n                enableFileChooserOpenedEvent: true,\n            }),\n            ...(this.#ignoreFileDialog()\n                ? []\n                : [\n                    this.#cdpClient.sendCommand('Page.setInterceptFileChooserDialog', {\n                        enabled: true,\n                        // The intercepted dialog should be canceled.\n                        cancel: true,\n                    }),\n                ]),\n            // There can be some existing frames in the target, if reconnecting to an\n            // existing browser instance, e.g. via Puppeteer. Need to restore the browsing\n            // contexts for the frames to correctly handle further events, like\n            // `Runtime.executionContextCreated`.\n            // It's important to schedule this task together with enabling domains commands to\n            // prepare the tree before the events (e.g. Runtime.executionContextCreated) start\n            // coming.\n            // https://github.com/GoogleChromeLabs/chromium-bidi/issues/2282\n            this.#cdpClient\n                .sendCommand('Page.getFrameTree')\n                .then((frameTree) => this.#restoreFrameTreeState(frameTree.frameTree)),\n            this.#cdpClient.sendCommand('Runtime.enable'),\n            this.#cdpClient.sendCommand('Page.setLifecycleEventsEnabled', {\n                enabled: true,\n            }),\n            // Enabling CDP Network domain is required for navigation detection:\n            // https://github.com/GoogleChromeLabs/chromium-bidi/issues/2856.\n            this.#cdpClient\n                .sendCommand('Network.enable', {\n                // If `googDisableNetworkDurableMessages` flag is set, do not enable durable\n                // messages.\n                enableDurableMessages: config.disableNetworkDurableMessages !== true,\n                maxTotalBufferSize: NetworkStorage_js_1.MAX_TOTAL_COLLECTED_SIZE,\n            })\n                .then(() => this.toggleNetworkIfNeeded()),\n            this.#cdpClient.sendCommand('Target.setAutoAttach', {\n                autoAttach: true,\n                waitForDebuggerOnStart: true,\n                flatten: true,\n            }),\n            this.#updateWindowId(),\n            this.#setUserContextConfig(config),\n            this.#initAndEvaluatePreloadScripts(),\n            this.#cdpClient.sendCommand('Runtime.runIfWaitingForDebugger'),\n            // Resume tab execution as well if it was paused by the debugger.\n            this.#parentCdpClient.sendCommand('Runtime.runIfWaitingForDebugger'),\n            this.toggleDeviceAccessIfNeeded(),\n            this.togglePreloadIfNeeded(),\n        ]);\n        for (const result of results) {\n            if (result instanceof Error) {\n                // Ignore errors during configuring targets, just log them.\n                this.#logger?.(log_js_1.LogType.debugError, 'Error happened when configuring a new target', result);\n            }\n        }\n        this.#unblocked.resolve({\n            kind: 'success',\n            value: undefined,\n        });\n    }\n    #restoreFrameTreeState(frameTree) {\n        const frame = frameTree.frame;\n        const maybeContext = this.#browsingContextStorage.findContext(frame.id);\n        if (maybeContext !== undefined) {\n            // Restoring parent of already known browsing context. This means the target is\n            // OOPiF and the BiDi session was connected to already existing browser instance.\n            if (maybeContext.parentId === null &&\n                frame.parentId !== null &&\n                frame.parentId !== undefined) {\n                maybeContext.parentId = frame.parentId;\n            }\n        }\n        if (maybeContext === undefined && frame.parentId !== undefined) {\n            // Restore not yet known nested frames. The top-level frame is created when the\n            // target is attached.\n            const parentBrowsingContext = this.#browsingContextStorage.getContext(frame.parentId);\n            BrowsingContextImpl_js_1.BrowsingContextImpl.create(frame.id, frame.parentId, this.userContext, parentBrowsingContext.cdpTarget, this.#eventManager, this.#browsingContextStorage, this.#realmStorage, this.contextConfigStorage, frame.url, undefined, this.#logger);\n        }\n        frameTree.childFrames?.map((frameTree) => this.#restoreFrameTreeState(frameTree));\n    }\n    async toggleFetchIfNeeded() {\n        const stages = this.#networkStorage.getInterceptionStages(this.topLevelId);\n        if (this.#fetchDomainStages.request === stages.request &&\n            this.#fetchDomainStages.response === stages.response &&\n            this.#fetchDomainStages.auth === stages.auth) {\n            return;\n        }\n        const patterns = [];\n        this.#fetchDomainStages = stages;\n        if (stages.request || stages.auth) {\n            // CDP quirk we need request interception when we intercept auth\n            patterns.push({\n                urlPattern: '*',\n                requestStage: 'Request',\n            });\n        }\n        if (stages.response) {\n            patterns.push({\n                urlPattern: '*',\n                requestStage: 'Response',\n            });\n        }\n        if (patterns.length) {\n            await this.#cdpClient.sendCommand('Fetch.enable', {\n                patterns,\n                handleAuthRequests: stages.auth,\n            });\n        }\n        else {\n            const blockedRequest = this.#networkStorage\n                .getRequestsByTarget(this)\n                .filter((request) => request.interceptPhase);\n            void Promise.allSettled(blockedRequest.map((request) => request.waitNextPhase))\n                .then(async () => {\n                const blockedRequest = this.#networkStorage\n                    .getRequestsByTarget(this)\n                    .filter((request) => request.interceptPhase);\n                if (blockedRequest.length) {\n                    return await this.toggleFetchIfNeeded();\n                }\n                return await this.#cdpClient.sendCommand('Fetch.disable');\n            })\n                .catch((error) => {\n                this.#logger?.(log_js_1.LogType.bidi, 'Disable failed', error);\n            });\n        }\n    }\n    /**\n     * Toggles CDP \"Fetch\" domain and enable/disable network cache.\n     */\n    async toggleNetworkIfNeeded() {\n        // Although the Network domain remains active, Fetch domain activation and caching\n        // settings should be managed dynamically.\n        try {\n            await Promise.all([\n                this.toggleSetCacheDisabled(),\n                this.toggleFetchIfNeeded(),\n            ]);\n        }\n        catch (err) {\n            this.#logger?.(log_js_1.LogType.debugError, err);\n            if (!this.#isExpectedError(err)) {\n                throw err;\n            }\n        }\n    }\n    async toggleSetCacheDisabled(disable) {\n        const defaultCacheDisabled = this.#networkStorage.defaultCacheBehavior === 'bypass';\n        const cacheDisabled = disable ?? defaultCacheDisabled;\n        if (this.#cacheDisableState === cacheDisabled) {\n            return;\n        }\n        this.#cacheDisableState = cacheDisabled;\n        try {\n            await this.#cdpClient.sendCommand('Network.setCacheDisabled', {\n                cacheDisabled,\n            });\n        }\n        catch (err) {\n            this.#logger?.(log_js_1.LogType.debugError, err);\n            this.#cacheDisableState = !cacheDisabled;\n            if (!this.#isExpectedError(err)) {\n                throw err;\n            }\n        }\n    }\n    async toggleDeviceAccessIfNeeded() {\n        const enabled = this.isSubscribedTo(chromium_bidi_js_1.Bluetooth.EventNames.RequestDevicePromptUpdated);\n        if (this.#deviceAccessEnabled === enabled) {\n            return;\n        }\n        this.#deviceAccessEnabled = enabled;\n        try {\n            await this.#cdpClient.sendCommand(enabled ? 'DeviceAccess.enable' : 'DeviceAccess.disable');\n        }\n        catch (err) {\n            this.#logger?.(log_js_1.LogType.debugError, err);\n            this.#deviceAccessEnabled = !enabled;\n            if (!this.#isExpectedError(err)) {\n                throw err;\n            }\n        }\n    }\n    async togglePreloadIfNeeded() {\n        const enabled = this.isSubscribedTo(chromium_bidi_js_1.Speculation.EventNames.PrefetchStatusUpdated);\n        if (this.#preloadEnabled === enabled) {\n            return;\n        }\n        this.#preloadEnabled = enabled;\n        try {\n            await this.#cdpClient.sendCommand(enabled ? 'Preload.enable' : 'Preload.disable');\n        }\n        catch (err) {\n            this.#logger?.(log_js_1.LogType.debugError, err);\n            this.#preloadEnabled = !enabled;\n            if (!this.#isExpectedError(err)) {\n                throw err;\n            }\n        }\n    }\n    /**\n     * Heuristic checking if the error is due to the session being closed. If so, ignore the\n     * error.\n     */\n    #isExpectedError(err) {\n        const error = err;\n        return ((error.code === -32001 &&\n            error.message === 'Session with given id not found.') ||\n            this.#cdpClient.isCloseError(err));\n    }\n    #setEventListeners() {\n        this.#cdpClient.on('*', (event, params) => {\n            // We may encounter uses for EventEmitter other than CDP events,\n            // which we want to skip.\n            if (typeof event !== 'string') {\n                return;\n            }\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: `goog:cdp.${event}`,\n                params: {\n                    event,\n                    params,\n                    session: this.cdpSessionId,\n                },\n            }, this.id);\n        });\n    }\n    async #enableFetch(stages) {\n        const patterns = [];\n        if (stages.request || stages.auth) {\n            // CDP quirk we need request interception when we intercept auth\n            patterns.push({\n                urlPattern: '*',\n                requestStage: 'Request',\n            });\n        }\n        if (stages.response) {\n            patterns.push({\n                urlPattern: '*',\n                requestStage: 'Response',\n            });\n        }\n        if (patterns.length) {\n            const oldStages = this.#fetchDomainStages;\n            this.#fetchDomainStages = stages;\n            try {\n                await this.#cdpClient.sendCommand('Fetch.enable', {\n                    patterns,\n                    handleAuthRequests: stages.auth,\n                });\n            }\n            catch {\n                this.#fetchDomainStages = oldStages;\n            }\n        }\n    }\n    async #disableFetch() {\n        const blockedRequest = this.#networkStorage\n            .getRequestsByTarget(this)\n            .filter((request) => request.interceptPhase);\n        if (blockedRequest.length === 0) {\n            this.#fetchDomainStages = {\n                request: false,\n                response: false,\n                auth: false,\n            };\n            await this.#cdpClient.sendCommand('Fetch.disable');\n        }\n    }\n    async toggleNetwork() {\n        // TODO: respect the data collectors once CDP Network domain is enabled on-demand:\n        // const networkEnable = this.#networkStorage.getCollectorsForBrowsingContext(this.topLevelId).length > 0;\n        const stages = this.#networkStorage.getInterceptionStages(this.topLevelId);\n        const fetchEnable = Object.values(stages).some((value) => value);\n        const fetchChanged = this.#fetchDomainStages.request !== stages.request ||\n            this.#fetchDomainStages.response !== stages.response ||\n            this.#fetchDomainStages.auth !== stages.auth;\n        this.#logger?.(log_js_1.LogType.debugInfo, 'Toggle Network', `Fetch (${fetchEnable}) ${fetchChanged}`);\n        if (fetchEnable && fetchChanged) {\n            await this.#enableFetch(stages);\n        }\n        if (!fetchEnable && fetchChanged) {\n            await this.#disableFetch();\n        }\n    }\n    /**\n     * All the ProxyChannels from all the preload scripts of the given\n     * BrowsingContext.\n     */\n    getChannels() {\n        return this.#preloadScriptStorage\n            .find()\n            .flatMap((script) => script.channels);\n    }\n    async #updateWindowId() {\n        const { windowId } = await this.#browserCdpClient.sendCommand('Browser.getWindowForTarget', { targetId: this.id });\n        this.#windowId = windowId;\n    }\n    /** Loads all top-level preload scripts. */\n    async #initAndEvaluatePreloadScripts() {\n        await Promise.all(this.#preloadScriptStorage\n            .find({\n            // Needed for OOPIF\n            targetId: this.topLevelId,\n        })\n            .map((script) => {\n            return script.initInTarget(this, true);\n        }));\n    }\n    async setDeviceMetricsOverride(viewport, devicePixelRatio, screenOrientation) {\n        if (viewport === null &&\n            devicePixelRatio === null &&\n            screenOrientation === null) {\n            await this.cdpClient.sendCommand('Emulation.clearDeviceMetricsOverride');\n            return;\n        }\n        const metricsOverride = {\n            width: viewport?.width ?? 0,\n            height: viewport?.height ?? 0,\n            deviceScaleFactor: devicePixelRatio ?? 0,\n            screenOrientation: this.#toCdpScreenOrientationAngle(screenOrientation) ?? undefined,\n            mobile: false,\n        };\n        await this.cdpClient.sendCommand('Emulation.setDeviceMetricsOverride', metricsOverride);\n    }\n    /**\n     * Immediately schedules all the required commands to configure user context\n     * configuration and waits for them to finish. It's important to schedule them\n     * in parallel, so that they are enqueued before any page's scripts.\n     */\n    async #setUserContextConfig(config) {\n        const promises = [];\n        promises.push(this.#cdpClient\n            .sendCommand('Page.setPrerenderingAllowed', {\n            isAllowed: !config.prerenderingDisabled,\n        })\n            .catch(() => {\n            // Ignore CDP errors, as the command is not supported by iframe targets or\n            // prerendered pages. Generic catch, as the error can vary between CdpClient\n            // implementations: Tab vs Puppeteer.\n        }));\n        if (config.viewport !== undefined ||\n            config.devicePixelRatio !== undefined ||\n            config.screenOrientation !== undefined) {\n            promises.push(this.setDeviceMetricsOverride(config.viewport ?? null, config.devicePixelRatio ?? null, config.screenOrientation ?? null).catch(() => {\n                // Ignore CDP errors, as the command is not supported by iframe targets. Generic\n                // catch, as the error can vary between CdpClient implementations: Tab vs\n                // Puppeteer.\n            }));\n        }\n        if (config.geolocation !== undefined && config.geolocation !== null) {\n            promises.push(this.setGeolocationOverride(config.geolocation));\n        }\n        if (config.locale !== undefined) {\n            promises.push(this.setLocaleOverride(config.locale));\n        }\n        if (config.timezone !== undefined) {\n            promises.push(this.setTimezoneOverride(config.timezone));\n        }\n        if (config.extraHeaders !== undefined) {\n            promises.push(this.setExtraHeaders(config.extraHeaders));\n        }\n        if (config.userAgent !== undefined || config.locale !== undefined) {\n            promises.push(this.setUserAgentAndAcceptLanguage(config.userAgent, config.locale));\n        }\n        if (config.scriptingEnabled !== undefined) {\n            promises.push(this.setScriptingEnabled(config.scriptingEnabled));\n        }\n        if (config.acceptInsecureCerts !== undefined) {\n            promises.push(this.cdpClient.sendCommand('Security.setIgnoreCertificateErrors', {\n                ignore: config.acceptInsecureCerts,\n            }));\n        }\n        if (config.emulatedNetworkConditions !== undefined) {\n            promises.push(this.setEmulatedNetworkConditions(config.emulatedNetworkConditions));\n        }\n        await Promise.all(promises);\n    }\n    get topLevelId() {\n        return (this.#browsingContextStorage.findTopLevelContextId(this.id) ?? this.id);\n    }\n    isSubscribedTo(moduleOrEvent) {\n        return this.#eventManager.subscriptionManager.isSubscribedTo(moduleOrEvent, this.topLevelId);\n    }\n    #ignoreFileDialog() {\n        const config = this.contextConfigStorage.getActiveConfig(this.topLevelId, this.userContext);\n        return ((config.userPromptHandler?.file ??\n            config.userPromptHandler?.default ??\n            \"ignore\" /* Session.UserPromptHandlerType.Ignore */) ===\n            \"ignore\" /* Session.UserPromptHandlerType.Ignore */);\n    }\n    async setGeolocationOverride(geolocation) {\n        if (geolocation === null) {\n            await this.cdpClient.sendCommand('Emulation.clearGeolocationOverride');\n        }\n        else if ('type' in geolocation) {\n            if (geolocation.type !== 'positionUnavailable') {\n                // Unreachable. Handled by params parser.\n                throw new protocol_js_1.UnknownErrorException(`Unknown geolocation error ${geolocation.type}`);\n            }\n            // Omitting latitude, longitude or accuracy emulates position unavailable.\n            await this.cdpClient.sendCommand('Emulation.setGeolocationOverride', {});\n        }\n        else if ('latitude' in geolocation) {\n            await this.cdpClient.sendCommand('Emulation.setGeolocationOverride', {\n                latitude: geolocation.latitude,\n                longitude: geolocation.longitude,\n                accuracy: geolocation.accuracy ?? 1,\n                // `null` value is treated as \"missing\".\n                altitude: geolocation.altitude ?? undefined,\n                altitudeAccuracy: geolocation.altitudeAccuracy ?? undefined,\n                heading: geolocation.heading ?? undefined,\n                speed: geolocation.speed ?? undefined,\n            });\n        }\n        else {\n            // Unreachable. Handled by params parser.\n            throw new protocol_js_1.UnknownErrorException('Unexpected geolocation coordinates value');\n        }\n    }\n    #toCdpScreenOrientationAngle(orientation) {\n        if (orientation === null) {\n            return null;\n        }\n        // https://w3c.github.io/screen-orientation/#the-current-screen-orientation-type-and-angle\n        if (orientation.natural === \"portrait\" /* Emulation.ScreenOrientationNatural.Portrait */) {\n            switch (orientation.type) {\n                case 'portrait-primary':\n                    return {\n                        angle: 0,\n                        type: 'portraitPrimary',\n                    };\n                case 'landscape-primary':\n                    return {\n                        angle: 90,\n                        type: 'landscapePrimary',\n                    };\n                case 'portrait-secondary':\n                    return {\n                        angle: 180,\n                        type: 'portraitSecondary',\n                    };\n                case 'landscape-secondary':\n                    return {\n                        angle: 270,\n                        type: 'landscapeSecondary',\n                    };\n                default:\n                    // Unreachable.\n                    throw new protocol_js_1.UnknownErrorException(`Unexpected screen orientation type ${orientation.type}`);\n            }\n        }\n        if (orientation.natural === \"landscape\" /* Emulation.ScreenOrientationNatural.Landscape */) {\n            switch (orientation.type) {\n                case 'landscape-primary':\n                    return {\n                        angle: 0,\n                        type: 'landscapePrimary',\n                    };\n                case 'portrait-primary':\n                    return {\n                        angle: 90,\n                        type: 'portraitPrimary',\n                    };\n                case 'landscape-secondary':\n                    return {\n                        angle: 180,\n                        type: 'landscapeSecondary',\n                    };\n                case 'portrait-secondary':\n                    return {\n                        angle: 270,\n                        type: 'portraitSecondary',\n                    };\n                default:\n                    // Unreachable.\n                    throw new protocol_js_1.UnknownErrorException(`Unexpected screen orientation type ${orientation.type}`);\n            }\n        }\n        // Unreachable.\n        throw new protocol_js_1.UnknownErrorException(`Unexpected orientation natural ${orientation.natural}`);\n    }\n    async setLocaleOverride(locale) {\n        if (locale === null) {\n            await this.cdpClient.sendCommand('Emulation.setLocaleOverride', {});\n        }\n        else {\n            await this.cdpClient.sendCommand('Emulation.setLocaleOverride', {\n                locale,\n            });\n        }\n    }\n    async setScriptingEnabled(scriptingEnabled) {\n        await this.cdpClient.sendCommand('Emulation.setScriptExecutionDisabled', {\n            value: scriptingEnabled === false,\n        });\n    }\n    async setTimezoneOverride(timezone) {\n        if (timezone === null) {\n            await this.cdpClient.sendCommand('Emulation.setTimezoneOverride', {\n                // If empty, disables the override and restores default host system timezone.\n                timezoneId: '',\n            });\n        }\n        else {\n            await this.cdpClient.sendCommand('Emulation.setTimezoneOverride', {\n                timezoneId: timezone,\n            });\n        }\n    }\n    async setExtraHeaders(headers) {\n        await this.cdpClient.sendCommand('Network.setExtraHTTPHeaders', {\n            headers,\n        });\n    }\n    async setUserAgentAndAcceptLanguage(userAgent, acceptLanguage) {\n        await this.cdpClient.sendCommand('Emulation.setUserAgentOverride', {\n            userAgent: userAgent ?? '',\n            acceptLanguage: acceptLanguage ?? undefined,\n        });\n    }\n    async setEmulatedNetworkConditions(networkConditions) {\n        if (networkConditions !== null && networkConditions.type !== 'offline') {\n            throw new protocol_js_1.UnsupportedOperationException(`Unsupported network conditions ${networkConditions.type}`);\n        }\n        await Promise.all([\n            this.cdpClient.sendCommand('Network.emulateNetworkConditionsByRule', {\n                offline: networkConditions?.type === 'offline',\n                matchedNetworkConditions: [\n                    {\n                        urlPattern: '',\n                        latency: 0,\n                        downloadThroughput: -1,\n                        uploadThroughput: -1,\n                    },\n                ],\n            }),\n            this.cdpClient.sendCommand('Network.overrideNetworkState', {\n                offline: networkConditions?.type === 'offline',\n                // TODO: restore the original `latency` value when emulation is removed.\n                latency: 0,\n                downloadThroughput: -1,\n                uploadThroughput: -1,\n            }),\n        ]);\n    }\n}\nexports.CdpTarget = CdpTarget;\n//# sourceMappingURL=CdpTarget.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CdpTargetManager = void 0;\nconst log_js_1 = require(\"../../../utils/log.js\");\nconst BrowsingContextImpl_js_1 = require(\"../context/BrowsingContextImpl.js\");\nconst WorkerRealm_js_1 = require(\"../script/WorkerRealm.js\");\nconst CdpTarget_js_1 = require(\"./CdpTarget.js\");\nconst cdpToBidiTargetTypes = {\n    service_worker: 'service-worker',\n    shared_worker: 'shared-worker',\n    worker: 'dedicated-worker',\n};\nclass CdpTargetManager {\n    #browserCdpClient;\n    #cdpConnection;\n    #targetKeysToBeIgnoredByAutoAttach = new Set();\n    #selfTargetId;\n    #eventManager;\n    #browsingContextStorage;\n    #networkStorage;\n    #bluetoothProcessor;\n    #preloadScriptStorage;\n    #realmStorage;\n    #configStorage;\n    #speculationProcessor;\n    #defaultUserContextId;\n    #logger;\n    constructor(cdpConnection, browserCdpClient, selfTargetId, eventManager, browsingContextStorage, realmStorage, networkStorage, configStorage, bluetoothProcessor, speculationProcessor, preloadScriptStorage, defaultUserContextId, logger) {\n        this.#cdpConnection = cdpConnection;\n        this.#browserCdpClient = browserCdpClient;\n        this.#targetKeysToBeIgnoredByAutoAttach.add(selfTargetId);\n        this.#selfTargetId = selfTargetId;\n        this.#eventManager = eventManager;\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#preloadScriptStorage = preloadScriptStorage;\n        this.#networkStorage = networkStorage;\n        this.#configStorage = configStorage;\n        this.#bluetoothProcessor = bluetoothProcessor;\n        this.#speculationProcessor = speculationProcessor;\n        this.#realmStorage = realmStorage;\n        this.#defaultUserContextId = defaultUserContextId;\n        this.#logger = logger;\n        this.#setEventListeners(browserCdpClient);\n    }\n    /**\n     * This method is called for each CDP session, since this class is responsible\n     * for creating and destroying all targets and browsing contexts.\n     */\n    #setEventListeners(cdpClient) {\n        cdpClient.on('Target.attachedToTarget', (params) => {\n            this.#handleAttachedToTargetEvent(params, cdpClient);\n        });\n        cdpClient.on('Target.detachedFromTarget', this.#handleDetachedFromTargetEvent.bind(this));\n        cdpClient.on('Target.targetInfoChanged', this.#handleTargetInfoChangedEvent.bind(this));\n        cdpClient.on('Inspector.targetCrashed', () => {\n            this.#handleTargetCrashedEvent(cdpClient);\n        });\n        cdpClient.on('Page.frameAttached', this.#handleFrameAttachedEvent.bind(this));\n        cdpClient.on('Page.frameSubtreeWillBeDetached', this.#handleFrameSubtreeWillBeDetached.bind(this));\n    }\n    #handleFrameAttachedEvent(params) {\n        const parentBrowsingContext = this.#browsingContextStorage.findContext(params.parentFrameId);\n        if (parentBrowsingContext !== undefined) {\n            BrowsingContextImpl_js_1.BrowsingContextImpl.create(params.frameId, params.parentFrameId, parentBrowsingContext.userContext, parentBrowsingContext.cdpTarget, this.#eventManager, this.#browsingContextStorage, this.#realmStorage, this.#configStorage, \n            // At this point, we don't know the URL of the frame yet, so it will be updated\n            // later.\n            'about:blank', undefined, this.#logger);\n        }\n    }\n    #handleFrameSubtreeWillBeDetached(params) {\n        this.#browsingContextStorage.findContext(params.frameId)?.dispose(true);\n    }\n    #handleAttachedToTargetEvent(params, parentSessionCdpClient) {\n        const { sessionId, targetInfo } = params;\n        const targetCdpClient = this.#cdpConnection.getCdpClient(sessionId);\n        const detach = async () => {\n            // Detaches and resumes the target suppressing errors.\n            await targetCdpClient\n                .sendCommand('Runtime.runIfWaitingForDebugger')\n                .then(() => parentSessionCdpClient.sendCommand('Target.detachFromTarget', params))\n                .catch((error) => this.#logger?.(log_js_1.LogType.debugError, error));\n        };\n        // Do not attach to the Mapper target.\n        if (this.#selfTargetId === targetInfo.targetId) {\n            void detach();\n            return;\n        }\n        // Service workers are special case because they attach to the\n        // browser target and the page target (so twice per worker) during\n        // the regular auto-attach and might hang if the CDP session on\n        // the browser level is not detached. The logic to detach the\n        // right session is handled in the switch below.\n        const targetKey = targetInfo.type === 'service_worker'\n            ? `${parentSessionCdpClient.sessionId}_${targetInfo.targetId}`\n            : targetInfo.targetId;\n        // Mapper generally only needs one session per target. If we\n        // receive additional auto-attached sessions, that is very likely\n        // coming from custom CDP sessions.\n        if (this.#targetKeysToBeIgnoredByAutoAttach.has(targetKey)) {\n            // Return to leave the session untouched.\n            return;\n        }\n        this.#targetKeysToBeIgnoredByAutoAttach.add(targetKey);\n        const userContext = targetInfo.browserContextId &&\n            targetInfo.browserContextId !== this.#defaultUserContextId\n            ? targetInfo.browserContextId\n            : 'default';\n        switch (targetInfo.type) {\n            case 'tab': {\n                // Tab targets are required only to handle page targets beneath them.\n                this.#setEventListeners(targetCdpClient);\n                // Auto-attach to the page target. No need in resuming tab target debugger, as it\n                // should preserve the page target debugger state, and will be resumed by the page\n                // target.\n                void (async () => {\n                    await targetCdpClient.sendCommand('Target.setAutoAttach', {\n                        autoAttach: true,\n                        waitForDebuggerOnStart: true,\n                        flatten: true,\n                    });\n                })();\n                return;\n            }\n            case 'page':\n            case 'iframe': {\n                const cdpTarget = this.#createCdpTarget(targetCdpClient, parentSessionCdpClient, targetInfo, userContext);\n                const maybeContext = this.#browsingContextStorage.findContext(targetInfo.targetId);\n                if (maybeContext && targetInfo.type === 'iframe') {\n                    // OOPiF.\n                    maybeContext.updateCdpTarget(cdpTarget);\n                }\n                else {\n                    // If attaching to existing browser instance, there could be OOPiF targets. This\n                    // case is handled by the `findFrameParentId` method.\n                    const parentId = this.#findFrameParentId(targetInfo, parentSessionCdpClient.sessionId);\n                    // New context.\n                    BrowsingContextImpl_js_1.BrowsingContextImpl.create(targetInfo.targetId, parentId, userContext, cdpTarget, this.#eventManager, this.#browsingContextStorage, this.#realmStorage, this.#configStorage, \n                    // Hack: when a new target created, CDP emits targetInfoChanged with an empty\n                    // url, and navigates it to about:blank later. When the event is emitted for\n                    // an existing target (reconnect), the url is already known, and navigation\n                    // events will not be emitted anymore. Replacing empty url with `about:blank`\n                    // allows to handle both cases in the same way.\n                    // \"7.3.2.1 Creating browsing contexts\".\n                    // https://html.spec.whatwg.org/multipage/document-sequences.html#creating-browsing-contexts\n                    // TODO: check who to deal with non-null creator and its `creatorOrigin`.\n                    targetInfo.url === '' ? 'about:blank' : targetInfo.url, targetInfo.openerFrameId ?? targetInfo.openerId, this.#logger);\n                }\n                return;\n            }\n            case 'service_worker':\n            case 'worker': {\n                const realm = this.#realmStorage.findRealm({\n                    cdpSessionId: parentSessionCdpClient.sessionId,\n                    sandbox: null, // Non-sandboxed realms.\n                });\n                // If there is no browsing context, this worker is already terminated.\n                if (!realm) {\n                    void detach();\n                    return;\n                }\n                const cdpTarget = this.#createCdpTarget(targetCdpClient, parentSessionCdpClient, targetInfo, userContext);\n                this.#handleWorkerTarget(cdpToBidiTargetTypes[targetInfo.type], cdpTarget, realm);\n                return;\n            }\n            // In CDP, we only emit shared workers on the browser and not the set of\n            // frames that use the shared worker. If we change this in the future to\n            // behave like service workers (emits on both browser and frame targets),\n            // we can remove this block and merge service workers with the above one.\n            case 'shared_worker': {\n                const cdpTarget = this.#createCdpTarget(targetCdpClient, parentSessionCdpClient, targetInfo, userContext);\n                this.#handleWorkerTarget(cdpToBidiTargetTypes[targetInfo.type], cdpTarget);\n                return;\n            }\n        }\n        // DevTools or some other not supported by BiDi target. Just release\n        // debugger and ignore them.\n        void detach();\n    }\n    /** Try to find the parent browsing context ID for the given attached target. */\n    #findFrameParentId(targetInfo, parentSessionId) {\n        if (targetInfo.type !== 'iframe') {\n            return null;\n        }\n        const parentId = targetInfo.openerFrameId ?? targetInfo.openerId;\n        if (parentId !== undefined) {\n            return parentId;\n        }\n        if (parentSessionId !== undefined) {\n            return (this.#browsingContextStorage.findContextBySession(parentSessionId)\n                ?.id ?? null);\n        }\n        return null;\n    }\n    #createCdpTarget(targetCdpClient, parentCdpClient, targetInfo, userContext) {\n        this.#setEventListeners(targetCdpClient);\n        this.#preloadScriptStorage.onCdpTargetCreated(targetInfo.targetId, userContext);\n        const target = CdpTarget_js_1.CdpTarget.create(targetInfo.targetId, targetCdpClient, this.#browserCdpClient, parentCdpClient, this.#realmStorage, this.#eventManager, this.#preloadScriptStorage, this.#browsingContextStorage, this.#networkStorage, this.#configStorage, userContext, this.#logger);\n        this.#networkStorage.onCdpTargetCreated(target);\n        this.#bluetoothProcessor.onCdpTargetCreated(target);\n        this.#speculationProcessor.onCdpTargetCreated(target);\n        return target;\n    }\n    #workers = new Map();\n    #handleWorkerTarget(realmType, cdpTarget, ownerRealm) {\n        cdpTarget.cdpClient.on('Runtime.executionContextCreated', (params) => {\n            const { uniqueId, id, origin } = params.context;\n            const workerRealm = new WorkerRealm_js_1.WorkerRealm(cdpTarget.cdpClient, this.#eventManager, id, this.#logger, (0, BrowsingContextImpl_js_1.serializeOrigin)(origin), ownerRealm ? [ownerRealm] : [], uniqueId, this.#realmStorage, realmType);\n            this.#workers.set(cdpTarget.cdpSessionId, workerRealm);\n        });\n    }\n    #handleDetachedFromTargetEvent({ sessionId, targetId, }) {\n        if (targetId) {\n            this.#preloadScriptStorage.find({ targetId }).map((preloadScript) => {\n                preloadScript.dispose(targetId);\n            });\n        }\n        const context = this.#browsingContextStorage.findContextBySession(sessionId);\n        if (context) {\n            context.dispose(true);\n            return;\n        }\n        const worker = this.#workers.get(sessionId);\n        if (worker) {\n            this.#realmStorage.deleteRealms({\n                cdpSessionId: worker.cdpClient.sessionId,\n            });\n        }\n    }\n    #handleTargetInfoChangedEvent(params) {\n        const context = this.#browsingContextStorage.findContext(params.targetInfo.targetId);\n        if (context) {\n            context.onTargetInfoChanged(params);\n        }\n    }\n    #handleTargetCrashedEvent(cdpClient) {\n        // This is primarily used for service and shared workers. CDP tends to not\n        // signal they closed gracefully and instead says they crashed to signal\n        // they are closed.\n        const realms = this.#realmStorage.findRealms({\n            cdpSessionId: cdpClient.sessionId,\n        });\n        for (const realm of realms) {\n            realm.dispose();\n        }\n    }\n}\nexports.CdpTargetManager = CdpTargetManager;\n//# sourceMappingURL=CdpTargetManager.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BrowsingContextStorage = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst EventEmitter_js_1 = require(\"../../../utils/EventEmitter.js\");\n/** Container class for browsing contexts. */\nclass BrowsingContextStorage {\n    /** Map from context ID to context implementation. */\n    #contexts = new Map();\n    /** Event emitter for browsing context storage eventsis not expected to be exposed to\n     * the outside world. */\n    #eventEmitter = new EventEmitter_js_1.EventEmitter();\n    /** Gets all top-level contexts, i.e. those with no parent. */\n    getTopLevelContexts() {\n        return this.getAllContexts().filter((context) => context.isTopLevelContext());\n    }\n    /** Gets all contexts. */\n    getAllContexts() {\n        return Array.from(this.#contexts.values());\n    }\n    /** Deletes the context with the given ID. */\n    deleteContextById(id) {\n        this.#contexts.delete(id);\n    }\n    /** Deletes the given context. */\n    deleteContext(context) {\n        this.#contexts.delete(context.id);\n    }\n    /** Tracks the given context. */\n    addContext(context) {\n        this.#contexts.set(context.id, context);\n        this.#eventEmitter.emit(\"added\" /* BrowsingContextStorageEvents.Added */, {\n            browsingContext: context,\n        });\n    }\n    /**\n     * Waits for a context with the given ID to be added and returns it.\n     */\n    waitForContext(browsingContextId) {\n        if (this.#contexts.has(browsingContextId)) {\n            return Promise.resolve(this.getContext(browsingContextId));\n        }\n        return new Promise((resolve) => {\n            const listener = (event) => {\n                if (event.browsingContext.id === browsingContextId) {\n                    this.#eventEmitter.off(\"added\" /* BrowsingContextStorageEvents.Added */, listener);\n                    resolve(event.browsingContext);\n                }\n            };\n            this.#eventEmitter.on(\"added\" /* BrowsingContextStorageEvents.Added */, listener);\n        });\n    }\n    /** Returns true whether there is an existing context with the given ID. */\n    hasContext(id) {\n        return this.#contexts.has(id);\n    }\n    /** Gets the context with the given ID, if any. */\n    findContext(id) {\n        return this.#contexts.get(id);\n    }\n    /** Returns the top-level context ID of the given context, if any. */\n    findTopLevelContextId(id) {\n        if (id === null) {\n            return null;\n        }\n        const maybeContext = this.findContext(id);\n        if (!maybeContext) {\n            return null;\n        }\n        const parentId = maybeContext.parentId ?? null;\n        if (parentId === null) {\n            return id;\n        }\n        return this.findTopLevelContextId(parentId);\n    }\n    findContextBySession(sessionId) {\n        for (const context of this.#contexts.values()) {\n            if (context.cdpTarget.cdpSessionId === sessionId) {\n                return context;\n            }\n        }\n        return;\n    }\n    /** Gets the context with the given ID, if any, otherwise throws. */\n    getContext(id) {\n        const result = this.findContext(id);\n        if (result === undefined) {\n            throw new protocol_js_1.NoSuchFrameException(`Context ${id} not found`);\n        }\n        return result;\n    }\n    verifyTopLevelContextsList(contexts) {\n        const foundContexts = new Set();\n        if (!contexts) {\n            return foundContexts;\n        }\n        for (const contextId of contexts) {\n            const context = this.getContext(contextId);\n            if (context.isTopLevelContext()) {\n                foundContexts.add(context);\n            }\n            else {\n                throw new protocol_js_1.InvalidArgumentException(`Non top-level context '${contextId}' given.`);\n            }\n        }\n        return foundContexts;\n    }\n    verifyContextsList(contexts) {\n        if (!contexts.length) {\n            return;\n        }\n        for (const contextId of contexts) {\n            this.getContext(contextId);\n        }\n    }\n}\nexports.BrowsingContextStorage = BrowsingContextStorage;\n//# sourceMappingURL=BrowsingContextStorage.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PreloadScriptStorage = void 0;\n/*\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst ErrorResponse_js_1 = require(\"../../../protocol/ErrorResponse.js\");\n/**\n * Container class for preload scripts.\n */\nclass PreloadScriptStorage {\n    /** Tracks all BiDi preload scripts.  */\n    #scripts = new Set();\n    /**\n     * Finds all entries that match the given filter (OR logic).\n     */\n    find(filter) {\n        if (!filter) {\n            return [...this.#scripts];\n        }\n        return [...this.#scripts].filter((script) => {\n            // Global scripts have no contexts or userContext\n            if (script.contexts === undefined && script.userContexts === undefined) {\n                return true;\n            }\n            if (filter.targetId !== undefined &&\n                script.targetIds.has(filter.targetId)) {\n                return true;\n            }\n            return false;\n        });\n    }\n    add(preloadScript) {\n        this.#scripts.add(preloadScript);\n    }\n    /** Deletes all BiDi preload script entries that match the given filter. */\n    remove(id) {\n        const script = [...this.#scripts].find((script) => script.id === id);\n        if (script === undefined) {\n            throw new ErrorResponse_js_1.NoSuchScriptException(`No preload script with id '${id}'`);\n        }\n        this.#scripts.delete(script);\n    }\n    /** Gets the preload script with the given ID, if any, otherwise throws. */\n    getPreloadScript(id) {\n        const script = [...this.#scripts].find((script) => script.id === id);\n        if (script === undefined) {\n            throw new ErrorResponse_js_1.NoSuchScriptException(`No preload script with id '${id}'`);\n        }\n        return script;\n    }\n    onCdpTargetCreated(targetId, userContext) {\n        const scriptInUserContext = [...this.#scripts].filter((script) => {\n            // Global scripts\n            if (!script.userContexts && !script.contexts) {\n                return true;\n            }\n            return script.userContexts?.includes(userContext);\n        });\n        for (const script of scriptInUserContext) {\n            script.targetIds.add(targetId);\n        }\n    }\n}\nexports.PreloadScriptStorage = PreloadScriptStorage;\n//# sourceMappingURL=PreloadScriptStorage.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RealmStorage = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst WindowRealm_js_1 = require(\"./WindowRealm.js\");\n/** Container class for browsing realms. */\nclass RealmStorage {\n    /** Tracks handles and their realms sent to the client. */\n    #knownHandlesToRealmMap = new Map();\n    /** Map from realm ID to Realm. */\n    #realmMap = new Map();\n    /** List of the internal sandboxed realms which should not be reported to the user. */\n    hiddenSandboxes = new Set();\n    get knownHandlesToRealmMap() {\n        return this.#knownHandlesToRealmMap;\n    }\n    addRealm(realm) {\n        this.#realmMap.set(realm.realmId, realm);\n    }\n    /** Finds all realms that match the given filter. */\n    findRealms(filter) {\n        const sandboxFilterValue = filter.sandbox === null ? undefined : filter.sandbox;\n        return Array.from(this.#realmMap.values()).filter((realm) => {\n            if (filter.realmId !== undefined && filter.realmId !== realm.realmId) {\n                return false;\n            }\n            if (filter.browsingContextId !== undefined &&\n                !realm.associatedBrowsingContexts\n                    .map((browsingContext) => browsingContext.id)\n                    .includes(filter.browsingContextId)) {\n                return false;\n            }\n            if (filter.sandbox !== undefined &&\n                (!(realm instanceof WindowRealm_js_1.WindowRealm) ||\n                    sandboxFilterValue !== realm.sandbox)) {\n                return false;\n            }\n            if (filter.executionContextId !== undefined &&\n                filter.executionContextId !== realm.executionContextId) {\n                return false;\n            }\n            if (filter.origin !== undefined && filter.origin !== realm.origin) {\n                return false;\n            }\n            if (filter.type !== undefined && filter.type !== realm.realmType) {\n                return false;\n            }\n            if (filter.cdpSessionId !== undefined &&\n                filter.cdpSessionId !== realm.cdpClient.sessionId) {\n                return false;\n            }\n            if (filter.isHidden !== undefined &&\n                filter.isHidden !== realm.isHidden()) {\n                return false;\n            }\n            return true;\n        });\n    }\n    findRealm(filter) {\n        return this.findRealms(filter)[0];\n    }\n    /** Gets the only realm that matches the given filter, if any, otherwise throws. */\n    getRealm(filter) {\n        const maybeRealm = this.findRealm(filter);\n        if (maybeRealm === undefined) {\n            throw new protocol_js_1.NoSuchFrameException(`Realm ${JSON.stringify(filter)} not found`);\n        }\n        return maybeRealm;\n    }\n    /** Deletes all realms that match the given filter. */\n    deleteRealms(filter) {\n        this.findRealms(filter).map((realm) => {\n            realm.dispose();\n            this.#realmMap.delete(realm.realmId);\n            Array.from(this.knownHandlesToRealmMap.entries())\n                .filter(([, r]) => r === realm.realmId)\n                .map(([handle]) => this.knownHandlesToRealmMap.delete(handle));\n        });\n    }\n}\nexports.RealmStorage = RealmStorage;\n//# sourceMappingURL=RealmStorage.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Buffer = void 0;\n/** Implements a FIFO buffer with a fixed size. */\nclass Buffer {\n    #capacity;\n    #entries = [];\n    #onItemRemoved;\n    /**\n     * @param capacity The buffer capacity.\n     * @param onItemRemoved Delegate called for each removed element.\n     */\n    constructor(capacity, onItemRemoved) {\n        this.#capacity = capacity;\n        this.#onItemRemoved = onItemRemoved;\n    }\n    get() {\n        return this.#entries;\n    }\n    add(value) {\n        this.#entries.push(value);\n        while (this.#entries.length > this.#capacity) {\n            const item = this.#entries.shift();\n            if (item !== undefined) {\n                this.#onItemRemoved?.(item);\n            }\n        }\n    }\n}\nexports.Buffer = Buffer;\n//# sourceMappingURL=Buffer.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IdWrapper = void 0;\n/**\n * Creates an object with a positive unique incrementing id.\n */\nclass IdWrapper {\n    static #counter = 0;\n    #id;\n    constructor() {\n        this.#id = ++IdWrapper.#counter;\n    }\n    get id() {\n        return this.#id;\n    }\n}\nexports.IdWrapper = IdWrapper;\n//# sourceMappingURL=IdWrapper.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isCdpEvent = isCdpEvent;\nexports.assertSupportedEvent = assertSupportedEvent;\n/**\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\n/**\n * Returns true if the given event is a CDP event.\n * @see https://chromedevtools.github.io/devtools-protocol/\n */\nfunction isCdpEvent(name) {\n    return (name.split('.').at(0)?.startsWith(protocol_js_1.ChromiumBidi.BiDiModule.Cdp) ?? false);\n}\n/**\n * Asserts that the given event is known to BiDi or BiDi+, or throws otherwise.\n */\nfunction assertSupportedEvent(name) {\n    if (!protocol_js_1.ChromiumBidi.EVENT_NAMES.has(name) && !isCdpEvent(name)) {\n        throw new protocol_js_1.InvalidArgumentException(`Unknown event: ${name}`);\n    }\n}\n//# sourceMappingURL=events.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SubscriptionManager = void 0;\nexports.cartesianProduct = cartesianProduct;\nexports.unrollEvents = unrollEvents;\nexports.difference = difference;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst uuid_js_1 = require(\"../../../utils/uuid.js\");\n/**\n * Returns the cartesian product of the given arrays.\n *\n * Example:\n *   cartesian([1, 2], ['a', 'b']); => [[1, 'a'], [1, 'b'], [2, 'a'], [2, 'b']]\n */\nfunction cartesianProduct(...a) {\n    return a.reduce((a, b) => a.flatMap((d) => b.map((e) => [d, e].flat())));\n}\n/** Expands \"AllEvents\" events into atomic events. */\nfunction unrollEvents(events) {\n    const allEvents = new Set();\n    function addEvents(events) {\n        for (const event of events) {\n            allEvents.add(event);\n        }\n    }\n    for (const event of events) {\n        switch (event) {\n            case protocol_js_1.ChromiumBidi.BiDiModule.Bluetooth:\n                addEvents(Object.values(protocol_js_1.ChromiumBidi.Bluetooth.EventNames));\n                break;\n            case protocol_js_1.ChromiumBidi.BiDiModule.BrowsingContext:\n                addEvents(Object.values(protocol_js_1.ChromiumBidi.BrowsingContext.EventNames));\n                break;\n            case protocol_js_1.ChromiumBidi.BiDiModule.Input:\n                addEvents(Object.values(protocol_js_1.ChromiumBidi.Input.EventNames));\n                break;\n            case protocol_js_1.ChromiumBidi.BiDiModule.Log:\n                addEvents(Object.values(protocol_js_1.ChromiumBidi.Log.EventNames));\n                break;\n            case protocol_js_1.ChromiumBidi.BiDiModule.Network:\n                addEvents(Object.values(protocol_js_1.ChromiumBidi.Network.EventNames));\n                break;\n            case protocol_js_1.ChromiumBidi.BiDiModule.Script:\n                addEvents(Object.values(protocol_js_1.ChromiumBidi.Script.EventNames));\n                break;\n            case protocol_js_1.ChromiumBidi.BiDiModule.Speculation:\n                addEvents(Object.values(protocol_js_1.ChromiumBidi.Speculation.EventNames));\n                break;\n            default:\n                allEvents.add(event);\n        }\n    }\n    return allEvents.values();\n}\nclass SubscriptionManager {\n    #subscriptions = [];\n    #knownSubscriptionIds = new Set();\n    #browsingContextStorage;\n    constructor(browsingContextStorage) {\n        this.#browsingContextStorage = browsingContextStorage;\n    }\n    getGoogChannelsSubscribedToEvent(eventName, contextId) {\n        const googChannels = new Set();\n        for (const subscription of this.#subscriptions) {\n            if (this.#isSubscribedTo(subscription, eventName, contextId)) {\n                googChannels.add(subscription.googChannel);\n            }\n        }\n        return Array.from(googChannels);\n    }\n    getGoogChannelsSubscribedToEventGlobally(eventName) {\n        const googChannels = new Set();\n        for (const subscription of this.#subscriptions) {\n            if (this.#isSubscribedTo(subscription, eventName)) {\n                googChannels.add(subscription.googChannel);\n            }\n        }\n        return Array.from(googChannels);\n    }\n    #isSubscribedTo(subscription, moduleOrEvent, browsingContextId) {\n        let includesEvent = false;\n        for (const eventName of subscription.eventNames) {\n            // This also covers the `goog:cdp` case where\n            // we don't unroll the event names\n            if (\n            // Event explicitly subscribed\n            eventName === moduleOrEvent ||\n                // Event subscribed via module\n                eventName === moduleOrEvent.split('.').at(0) ||\n                // Event explicitly subscribed compared to module\n                eventName.split('.').at(0) === moduleOrEvent) {\n                includesEvent = true;\n                break;\n            }\n        }\n        if (!includesEvent) {\n            return false;\n        }\n        // user context subscription.\n        if (subscription.userContextIds.size !== 0) {\n            if (!browsingContextId) {\n                return false;\n            }\n            const context = this.#browsingContextStorage.findContext(browsingContextId);\n            if (!context) {\n                return false;\n            }\n            return subscription.userContextIds.has(context.userContext);\n        }\n        // context subscription.\n        if (subscription.topLevelTraversableIds.size !== 0) {\n            if (!browsingContextId) {\n                return false;\n            }\n            const topLevelContext = this.#browsingContextStorage.findTopLevelContextId(browsingContextId);\n            return (topLevelContext !== null &&\n                subscription.topLevelTraversableIds.has(topLevelContext));\n        }\n        // global subscription.\n        return true;\n    }\n    isSubscribedTo(moduleOrEvent, contextId) {\n        for (const subscription of this.#subscriptions) {\n            if (this.#isSubscribedTo(subscription, moduleOrEvent, contextId)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    /**\n     * Subscribes to event in the given context and goog:channel.\n     * @return {SubscriptionItem[]} List of\n     * subscriptions. If the event is a whole module, it will return all the specific\n     * events. If the contextId is null, it will return all the top-level contexts which were\n     * not subscribed before the command.\n     */\n    subscribe(eventNames, contextIds, userContextIds, googChannel) {\n        // All the subscriptions are handled on the top-level contexts.\n        const subscription = {\n            id: (0, uuid_js_1.uuidv4)(),\n            eventNames: new Set(unrollEvents(eventNames)),\n            topLevelTraversableIds: new Set(contextIds.map((contextId) => {\n                const topLevelContext = this.#browsingContextStorage.findTopLevelContextId(contextId);\n                if (!topLevelContext) {\n                    throw new protocol_js_1.NoSuchFrameException(`Top-level navigable not found for context id ${contextId}`);\n                }\n                return topLevelContext;\n            })),\n            userContextIds: new Set(userContextIds),\n            googChannel,\n        };\n        this.#subscriptions.push(subscription);\n        this.#knownSubscriptionIds.add(subscription.id);\n        return subscription;\n    }\n    /**\n     * Unsubscribes atomically from all events in the given contexts and channel.\n     *\n     * This is a legacy spec branch to unsubscribe by attributes.\n     */\n    unsubscribe(inputEventNames, googChannel) {\n        const eventNames = new Set(unrollEvents(inputEventNames));\n        const newSubscriptions = [];\n        const eventsMatched = new Set();\n        for (const subscription of this.#subscriptions) {\n            if (subscription.googChannel !== googChannel) {\n                newSubscriptions.push(subscription);\n                continue;\n            }\n            // Skip user context subscriptions.\n            if (subscription.userContextIds.size !== 0) {\n                newSubscriptions.push(subscription);\n                continue;\n            }\n            // Skip subscriptions when none of the event names match.\n            if (intersection(subscription.eventNames, eventNames).size === 0) {\n                newSubscriptions.push(subscription);\n                continue;\n            }\n            // Skip non-global subscriptions.\n            if (subscription.topLevelTraversableIds.size !== 0) {\n                newSubscriptions.push(subscription);\n                continue;\n            }\n            const subscriptionEventNames = new Set(subscription.eventNames);\n            for (const eventName of eventNames) {\n                if (subscriptionEventNames.has(eventName)) {\n                    eventsMatched.add(eventName);\n                    subscriptionEventNames.delete(eventName);\n                }\n            }\n            if (subscriptionEventNames.size !== 0) {\n                newSubscriptions.push({\n                    ...subscription,\n                    eventNames: subscriptionEventNames,\n                });\n            }\n        }\n        // If some events did not match, it is an invalid request.\n        if (!equal(eventsMatched, eventNames)) {\n            throw new protocol_js_1.InvalidArgumentException('No subscription found');\n        }\n        // Committing the new subscriptions.\n        this.#subscriptions = newSubscriptions;\n    }\n    /**\n     * Unsubscribes by subscriptionId.\n     */\n    unsubscribeById(subscriptionIds) {\n        const subscriptionIdsSet = new Set(subscriptionIds);\n        const unknownIds = difference(subscriptionIdsSet, this.#knownSubscriptionIds);\n        if (unknownIds.size !== 0) {\n            throw new protocol_js_1.InvalidArgumentException('No subscription found');\n        }\n        this.#subscriptions = this.#subscriptions.filter((subscription) => {\n            return !subscriptionIdsSet.has(subscription.id);\n        });\n        this.#knownSubscriptionIds = difference(this.#knownSubscriptionIds, subscriptionIdsSet);\n    }\n}\nexports.SubscriptionManager = SubscriptionManager;\n/**\n * Replace with Set.prototype.intersection once Node 20 is dropped.\n */\nfunction intersection(setA, setB) {\n    const result = new Set();\n    for (const a of setA) {\n        if (setB.has(a)) {\n            result.add(a);\n        }\n    }\n    return result;\n}\n/**\n * Replace with Set.prototype.difference once Node 20 is dropped.\n */\nfunction difference(setA, setB) {\n    const result = new Set();\n    for (const a of setA) {\n        if (!setB.has(a)) {\n            result.add(a);\n        }\n    }\n    return result;\n}\nfunction equal(setA, setB) {\n    if (setA.size !== setB.size) {\n        return false;\n    }\n    for (const a of setA) {\n        if (!setB.has(a)) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=SubscriptionManager.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EventManager = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nconst Buffer_js_1 = require(\"../../../utils/Buffer.js\");\nconst DefaultMap_js_1 = require(\"../../../utils/DefaultMap.js\");\nconst EventEmitter_js_1 = require(\"../../../utils/EventEmitter.js\");\nconst IdWrapper_js_1 = require(\"../../../utils/IdWrapper.js\");\nconst OutgoingMessage_js_1 = require(\"../../OutgoingMessage.js\");\nconst events_js_1 = require(\"./events.js\");\nconst SubscriptionManager_js_1 = require(\"./SubscriptionManager.js\");\nclass EventWrapper {\n    #idWrapper = new IdWrapper_js_1.IdWrapper();\n    #contextId;\n    #event;\n    constructor(event, contextId) {\n        this.#event = event;\n        this.#contextId = contextId;\n    }\n    get id() {\n        return this.#idWrapper.id;\n    }\n    get contextId() {\n        return this.#contextId;\n    }\n    get event() {\n        return this.#event;\n    }\n}\n/**\n * Maps event name to a desired buffer length.\n */\nconst eventBufferLength = new Map([[protocol_js_1.ChromiumBidi.Log.EventNames.LogEntryAdded, 100]]);\nclass EventManager extends EventEmitter_js_1.EventEmitter {\n    /**\n     * Maps event name to a set of contexts where this event already happened.\n     * Needed for getting buffered events from all the contexts in case of\n     * subscripting to all contexts.\n     */\n    #eventToContextsMap = new DefaultMap_js_1.DefaultMap(() => new Set());\n    /**\n     * Maps `eventName` + `browsingContext` to buffer. Used to get buffered events\n     * during subscription. Channel-agnostic.\n     */\n    #eventBuffers = new Map();\n    /**\n     * Maps `eventName` + `browsingContext` to  Map of goog:channel to last id.\n     * Used to avoid sending duplicated events when user\n     * subscribes -> unsubscribes -> subscribes.\n     */\n    #lastMessageSent = new Map();\n    #subscriptionManager;\n    #browsingContextStorage;\n    /**\n     * Map of event name to hooks to be called when client is subscribed to the event.\n     */\n    #subscribeHooks;\n    #userContextStorage;\n    constructor(browsingContextStorage, userContextStorage) {\n        super();\n        this.#browsingContextStorage = browsingContextStorage;\n        this.#userContextStorage = userContextStorage;\n        this.#subscriptionManager = new SubscriptionManager_js_1.SubscriptionManager(browsingContextStorage);\n        this.#subscribeHooks = new DefaultMap_js_1.DefaultMap(() => []);\n    }\n    get subscriptionManager() {\n        return this.#subscriptionManager;\n    }\n    /**\n     * Returns consistent key to be used to access value maps.\n     */\n    static #getMapKey(eventName, browsingContext) {\n        return JSON.stringify({ eventName, browsingContext });\n    }\n    addSubscribeHook(event, hook) {\n        this.#subscribeHooks.get(event).push(hook);\n    }\n    registerEvent(event, contextId) {\n        this.registerPromiseEvent(Promise.resolve({\n            kind: 'success',\n            value: event,\n        }), contextId, event.method);\n    }\n    registerGlobalEvent(event) {\n        this.registerGlobalPromiseEvent(Promise.resolve({\n            kind: 'success',\n            value: event,\n        }), event.method);\n    }\n    registerPromiseEvent(event, contextId, eventName) {\n        const eventWrapper = new EventWrapper(event, contextId);\n        const sortedGoogChannels = this.#subscriptionManager.getGoogChannelsSubscribedToEvent(eventName, contextId);\n        this.#bufferEvent(eventWrapper, eventName);\n        // Send events to channels in the subscription priority.\n        for (const googChannel of sortedGoogChannels) {\n            this.emit(\"event\" /* EventManagerEvents.Event */, {\n                message: OutgoingMessage_js_1.OutgoingMessage.createFromPromise(event, googChannel),\n                event: eventName,\n            });\n            this.#markEventSent(eventWrapper, googChannel, eventName);\n        }\n    }\n    registerGlobalPromiseEvent(event, eventName) {\n        const eventWrapper = new EventWrapper(event, null);\n        const sortedGoogChannels = this.#subscriptionManager.getGoogChannelsSubscribedToEventGlobally(eventName);\n        this.#bufferEvent(eventWrapper, eventName);\n        // Send events to goog:channels in the subscription priority.\n        for (const googChannel of sortedGoogChannels) {\n            this.emit(\"event\" /* EventManagerEvents.Event */, {\n                message: OutgoingMessage_js_1.OutgoingMessage.createFromPromise(event, googChannel),\n                event: eventName,\n            });\n            this.#markEventSent(eventWrapper, googChannel, eventName);\n        }\n    }\n    async subscribe(eventNames, contextIds, userContextIds, googChannel) {\n        for (const name of eventNames) {\n            (0, events_js_1.assertSupportedEvent)(name);\n        }\n        if (userContextIds.length && contextIds.length) {\n            throw new protocol_js_1.InvalidArgumentException('Both userContexts and contexts cannot be specified.');\n        }\n        // First check if all the contexts are known.\n        this.#browsingContextStorage.verifyContextsList(contextIds);\n        // Validate user contexts.\n        await this.#userContextStorage.verifyUserContextIdList(userContextIds);\n        const unrolledEventNames = new Set((0, SubscriptionManager_js_1.unrollEvents)(eventNames));\n        const subscribeStepEvents = new Map();\n        const subscriptionNavigableIds = new Set(contextIds.length\n            ? contextIds.map((contextId) => {\n                const id = this.#browsingContextStorage.findTopLevelContextId(contextId);\n                if (!id) {\n                    throw new protocol_js_1.InvalidArgumentException('Invalid context id');\n                }\n                return id;\n            })\n            : this.#browsingContextStorage.getTopLevelContexts().map((c) => c.id));\n        for (const eventName of unrolledEventNames) {\n            const subscribedNavigableIds = new Set(this.#browsingContextStorage\n                .getTopLevelContexts()\n                .map((c) => c.id)\n                .filter((id) => {\n                return this.#subscriptionManager.isSubscribedTo(eventName, id);\n            }));\n            subscribeStepEvents.set(eventName, (0, SubscriptionManager_js_1.difference)(subscriptionNavigableIds, subscribedNavigableIds));\n        }\n        const subscription = this.#subscriptionManager.subscribe(eventNames, contextIds, userContextIds, googChannel);\n        for (const eventName of subscription.eventNames) {\n            for (const contextId of subscriptionNavigableIds) {\n                for (const eventWrapper of this.#getBufferedEvents(eventName, contextId, googChannel)) {\n                    // The order of the events is important.\n                    this.emit(\"event\" /* EventManagerEvents.Event */, {\n                        message: OutgoingMessage_js_1.OutgoingMessage.createFromPromise(eventWrapper.event, googChannel),\n                        event: eventName,\n                    });\n                    this.#markEventSent(eventWrapper, googChannel, eventName);\n                }\n            }\n        }\n        for (const [eventName, contextIds] of subscribeStepEvents) {\n            for (const contextId of contextIds) {\n                this.#subscribeHooks.get(eventName).forEach((hook) => hook(contextId));\n            }\n        }\n        await this.toggleModulesIfNeeded();\n        return subscription.id;\n    }\n    async unsubscribe(eventNames, googChannel) {\n        for (const name of eventNames) {\n            (0, events_js_1.assertSupportedEvent)(name);\n        }\n        this.#subscriptionManager.unsubscribe(eventNames, googChannel);\n        await this.toggleModulesIfNeeded();\n    }\n    async unsubscribeByIds(subscriptionIds) {\n        this.#subscriptionManager.unsubscribeById(subscriptionIds);\n        await this.toggleModulesIfNeeded();\n    }\n    async toggleModulesIfNeeded() {\n        // TODO(1): Only update changed subscribers\n        // TODO(2): Enable for Worker Targets\n        await Promise.all(this.#browsingContextStorage.getAllContexts().map(async (context) => {\n            return await context.toggleModulesIfNeeded();\n        }));\n    }\n    clearBufferedEvents(contextId) {\n        for (const eventName of eventBufferLength.keys()) {\n            const bufferMapKey = _a.#getMapKey(eventName, contextId);\n            this.#eventBuffers.delete(bufferMapKey);\n        }\n    }\n    /**\n     * If the event is buffer-able, put it in the buffer.\n     */\n    #bufferEvent(eventWrapper, eventName) {\n        if (!eventBufferLength.has(eventName)) {\n            // Do nothing if the event is no buffer-able.\n            return;\n        }\n        const bufferMapKey = _a.#getMapKey(eventName, eventWrapper.contextId);\n        if (!this.#eventBuffers.has(bufferMapKey)) {\n            this.#eventBuffers.set(bufferMapKey, new Buffer_js_1.Buffer(eventBufferLength.get(eventName)));\n        }\n        this.#eventBuffers.get(bufferMapKey).add(eventWrapper);\n        // Add the context to the list of contexts having `eventName` events.\n        this.#eventToContextsMap.get(eventName).add(eventWrapper.contextId);\n    }\n    /**\n     * If the event is buffer-able, mark it as sent to the given contextId and goog:channel.\n     */\n    #markEventSent(eventWrapper, googChannel, eventName) {\n        if (!eventBufferLength.has(eventName)) {\n            // Do nothing if the event is no buffer-able.\n            return;\n        }\n        const lastSentMapKey = _a.#getMapKey(eventName, eventWrapper.contextId);\n        const lastId = Math.max(this.#lastMessageSent.get(lastSentMapKey)?.get(googChannel) ?? 0, eventWrapper.id);\n        const googChannelMap = this.#lastMessageSent.get(lastSentMapKey);\n        if (googChannelMap) {\n            googChannelMap.set(googChannel, lastId);\n        }\n        else {\n            this.#lastMessageSent.set(lastSentMapKey, new Map([[googChannel, lastId]]));\n        }\n    }\n    /**\n     * Returns events which are buffered and not yet sent to the given goog:channel events.\n     */\n    #getBufferedEvents(eventName, contextId, googChannel) {\n        const bufferMapKey = _a.#getMapKey(eventName, contextId);\n        const lastSentMessageId = this.#lastMessageSent.get(bufferMapKey)?.get(googChannel) ?? -Infinity;\n        const result = this.#eventBuffers\n            .get(bufferMapKey)\n            ?.get()\n            .filter((wrapper) => wrapper.id > lastSentMessageId) ?? [];\n        if (contextId === null) {\n            // For global subscriptions, events buffered in each context should be sent back.\n            Array.from(this.#eventToContextsMap.get(eventName).keys())\n                .filter((_contextId) => \n            // Events without context are already in the result.\n            _contextId !== null &&\n                // Events from deleted contexts should not be sent.\n                this.#browsingContextStorage.hasContext(_contextId))\n                .map((_contextId) => this.#getBufferedEvents(eventName, _contextId, googChannel))\n                .forEach((events) => result.push(...events));\n        }\n        return result.sort((e1, e2) => e1.id - e2.id);\n    }\n}\nexports.EventManager = EventManager;\n_a = EventManager;\n//# sourceMappingURL=EventManager.js.map","\"use strict\";\n/**\n * Copyright 2025 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SpeculationProcessor = void 0;\nconst log_js_1 = require(\"../../../utils/log.js\");\nclass SpeculationProcessor {\n    #eventManager;\n    #logger;\n    constructor(eventManager, logger) {\n        this.#eventManager = eventManager;\n        this.#logger = logger;\n    }\n    onCdpTargetCreated(cdpTarget) {\n        cdpTarget.cdpClient.on('Preload.prefetchStatusUpdated', (event) => {\n            let prefetchStatus;\n            switch (event.status) {\n                case 'Running':\n                    prefetchStatus = \"pending\" /* Speculation.PreloadingStatus.Pending */;\n                    break;\n                case 'Ready':\n                    prefetchStatus = \"ready\" /* Speculation.PreloadingStatus.Ready */;\n                    break;\n                case 'Success':\n                    prefetchStatus = \"success\" /* Speculation.PreloadingStatus.Success */;\n                    break;\n                case 'Failure':\n                    prefetchStatus = \"failure\" /* Speculation.PreloadingStatus.Failure */;\n                    break;\n                default:\n                    // If status is not recognized, skip the event\n                    this.#logger?.(log_js_1.LogType.debugWarn, `Unknown prefetch status: ${event.status}`);\n                    return;\n            }\n            this.#eventManager.registerEvent({\n                type: 'event',\n                method: 'speculation.prefetchStatusUpdated',\n                params: {\n                    context: event.initiatingFrameId,\n                    url: event.prefetchUrl,\n                    status: prefetchStatus,\n                },\n            }, cdpTarget.id);\n        });\n    }\n}\nexports.SpeculationProcessor = SpeculationProcessor;\n//# sourceMappingURL=SpeculationProcessor.js.map","\"use strict\";\n/**\n * Copyright 2021 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BidiServer = void 0;\nconst EventEmitter_js_1 = require(\"../utils/EventEmitter.js\");\nconst log_js_1 = require(\"../utils/log.js\");\nconst ProcessingQueue_js_1 = require(\"../utils/ProcessingQueue.js\");\nconst CommandProcessor_js_1 = require(\"./CommandProcessor.js\");\nconst BluetoothProcessor_js_1 = require(\"./modules/bluetooth/BluetoothProcessor.js\");\nconst ContextConfigStorage_js_1 = require(\"./modules/browser/ContextConfigStorage.js\");\nconst UserContextStorage_js_1 = require(\"./modules/browser/UserContextStorage.js\");\nconst CdpTargetManager_js_1 = require(\"./modules/cdp/CdpTargetManager.js\");\nconst BrowsingContextStorage_js_1 = require(\"./modules/context/BrowsingContextStorage.js\");\nconst NetworkStorage_js_1 = require(\"./modules/network/NetworkStorage.js\");\nconst PreloadScriptStorage_js_1 = require(\"./modules/script/PreloadScriptStorage.js\");\nconst RealmStorage_js_1 = require(\"./modules/script/RealmStorage.js\");\nconst EventManager_js_1 = require(\"./modules/session/EventManager.js\");\nconst SpeculationProcessor_js_1 = require(\"./modules/speculation/SpeculationProcessor.js\");\nclass BidiServer extends EventEmitter_js_1.EventEmitter {\n    #messageQueue;\n    #transport;\n    #commandProcessor;\n    #eventManager;\n    #browsingContextStorage = new BrowsingContextStorage_js_1.BrowsingContextStorage();\n    #realmStorage = new RealmStorage_js_1.RealmStorage();\n    #preloadScriptStorage = new PreloadScriptStorage_js_1.PreloadScriptStorage();\n    #bluetoothProcessor;\n    #speculationProcessor;\n    #logger;\n    #handleIncomingMessage = (message) => {\n        void this.#commandProcessor.processCommand(message).catch((error) => {\n            this.#logger?.(log_js_1.LogType.debugError, error);\n        });\n    };\n    #processOutgoingMessage = async (messageEntry) => {\n        const message = messageEntry.message;\n        if (messageEntry.googChannel !== null) {\n            message['goog:channel'] = messageEntry.googChannel;\n        }\n        await this.#transport.sendMessage(message);\n    };\n    constructor(bidiTransport, cdpConnection, browserCdpClient, selfTargetId, defaultUserContextId, parser, logger) {\n        super();\n        this.#logger = logger;\n        this.#messageQueue = new ProcessingQueue_js_1.ProcessingQueue(this.#processOutgoingMessage, this.#logger);\n        this.#transport = bidiTransport;\n        this.#transport.setOnMessage(this.#handleIncomingMessage);\n        const contextConfigStorage = new ContextConfigStorage_js_1.ContextConfigStorage();\n        const userContextStorage = new UserContextStorage_js_1.UserContextStorage(browserCdpClient);\n        this.#eventManager = new EventManager_js_1.EventManager(this.#browsingContextStorage, userContextStorage);\n        const networkStorage = new NetworkStorage_js_1.NetworkStorage(this.#eventManager, this.#browsingContextStorage, browserCdpClient, logger);\n        this.#bluetoothProcessor = new BluetoothProcessor_js_1.BluetoothProcessor(this.#eventManager, this.#browsingContextStorage);\n        this.#speculationProcessor = new SpeculationProcessor_js_1.SpeculationProcessor(this.#eventManager, this.#logger);\n        this.#commandProcessor = new CommandProcessor_js_1.CommandProcessor(cdpConnection, browserCdpClient, this.#eventManager, this.#browsingContextStorage, this.#realmStorage, this.#preloadScriptStorage, networkStorage, contextConfigStorage, this.#bluetoothProcessor, userContextStorage, parser, async (options) => {\n            // This is required to ignore certificate errors when service worker is fetched.\n            await browserCdpClient.sendCommand('Security.setIgnoreCertificateErrors', {\n                ignore: options.acceptInsecureCerts ?? false,\n            });\n            contextConfigStorage.updateGlobalConfig({\n                acceptInsecureCerts: options.acceptInsecureCerts ?? false,\n                userPromptHandler: options.unhandledPromptBehavior,\n                prerenderingDisabled: options?.['goog:prerenderingDisabled'] ?? false,\n                disableNetworkDurableMessages: options?.['goog:disableNetworkDurableMessages'],\n            });\n            new CdpTargetManager_js_1.CdpTargetManager(cdpConnection, browserCdpClient, selfTargetId, this.#eventManager, this.#browsingContextStorage, this.#realmStorage, networkStorage, contextConfigStorage, this.#bluetoothProcessor, this.#speculationProcessor, this.#preloadScriptStorage, defaultUserContextId, logger);\n            // Needed to get events about new targets.\n            await browserCdpClient.sendCommand('Target.setDiscoverTargets', {\n                discover: true,\n            });\n            // Needed to automatically attach to new targets.\n            await browserCdpClient.sendCommand('Target.setAutoAttach', {\n                autoAttach: true,\n                waitForDebuggerOnStart: true,\n                flatten: true,\n                // Browser session should attach to tab instead of the page, so that\n                // prerendering is not blocked.\n                filter: [\n                    {\n                        type: 'page',\n                        exclude: true,\n                    },\n                    {},\n                ],\n            });\n            await this.#topLevelContextsLoaded();\n        }, this.#logger);\n        this.#eventManager.on(\"event\" /* EventManagerEvents.Event */, ({ message, event }) => {\n            this.emitOutgoingMessage(message, event);\n        });\n        this.#commandProcessor.on(\"response\" /* CommandProcessorEvents.Response */, ({ message, event }) => {\n            this.emitOutgoingMessage(message, event);\n        });\n    }\n    /**\n     * Creates and starts BiDi Mapper instance.\n     */\n    static async createAndStart(bidiTransport, cdpConnection, browserCdpClient, selfTargetId, parser, logger) {\n        // The default context is not exposed in Target.getBrowserContexts but can\n        // be observed via Target.getTargets. To determine the default browser\n        // context, we check which one is mentioned in Target.getTargets and not in\n        // Target.getBrowserContexts.\n        const [{ browserContextIds }, { targetInfos }] = await Promise.all([\n            browserCdpClient.sendCommand('Target.getBrowserContexts'),\n            browserCdpClient.sendCommand('Target.getTargets'),\n            // Required for `Browser.downloadWillBegin` events.\n            browserCdpClient.sendCommand('Browser.setDownloadBehavior', {\n                behavior: 'default',\n                eventsEnabled: true,\n            }),\n        ]);\n        let defaultUserContextId = 'default';\n        for (const info of targetInfos) {\n            if (info.browserContextId &&\n                !browserContextIds.includes(info.browserContextId)) {\n                defaultUserContextId = info.browserContextId;\n                break;\n            }\n        }\n        const server = new BidiServer(bidiTransport, cdpConnection, browserCdpClient, selfTargetId, defaultUserContextId, parser, logger);\n        return server;\n    }\n    /**\n     * Sends BiDi message.\n     */\n    emitOutgoingMessage(messageEntry, event) {\n        this.#messageQueue.add(messageEntry, event);\n    }\n    close() {\n        this.#transport.close();\n    }\n    async #topLevelContextsLoaded() {\n        await Promise.all(this.#browsingContextStorage\n            .getTopLevelContexts()\n            .map((c) => c.lifecycleLoaded()));\n    }\n}\nexports.BidiServer = BidiServer;\n//# sourceMappingURL=BidiServer.js.map","\"use strict\";\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.OutgoingMessage = exports.EventEmitter = exports.BidiServer = void 0;\n/**\n * @fileoverview The entry point to the BiDi Mapper namespace.\n * Other modules should only access exports defined in this file.\n * XXX: Add ESlint rule for this (https://github.com/import-js/eslint-plugin-import/blob/main/docs/rules/no-restricted-paths.md)\n */\nvar BidiServer_js_1 = require(\"./BidiServer.js\");\nObject.defineProperty(exports, \"BidiServer\", { enumerable: true, get: function () { return BidiServer_js_1.BidiServer; } });\nvar EventEmitter_js_1 = require(\"../utils/EventEmitter.js\");\nObject.defineProperty(exports, \"EventEmitter\", { enumerable: true, get: function () { return EventEmitter_js_1.EventEmitter; } });\nvar OutgoingMessage_js_1 = require(\"./OutgoingMessage.js\");\nObject.defineProperty(exports, \"OutgoingMessage\", { enumerable: true, get: function () { return OutgoingMessage_js_1.OutgoingMessage; } });\n//# sourceMappingURL=BidiMapper.js.map","import { CDPSession } from '../api/CDPSession.js';\nimport { TargetCloseError, UnsupportedOperation } from '../common/Errors.js';\nimport { Deferred } from '../util/Deferred.js';\n/**\n * @internal\n */\nexport class BidiCdpSession extends CDPSession {\n    static sessions = new Map();\n    #detached = false;\n    #connection;\n    #sessionId = Deferred.create();\n    frame;\n    constructor(frame, sessionId) {\n        super();\n        this.frame = frame;\n        if (!this.frame.page().browser().cdpSupported) {\n            return;\n        }\n        const connection = this.frame.page().browser().connection;\n        this.#connection = connection;\n        if (sessionId) {\n            this.#sessionId.resolve(sessionId);\n            BidiCdpSession.sessions.set(sessionId, this);\n        }\n        else {\n            (async () => {\n                try {\n                    const { result } = await connection.send('goog:cdp.getSession', {\n                        context: frame._id,\n                    });\n                    this.#sessionId.resolve(result.session);\n                    BidiCdpSession.sessions.set(result.session, this);\n                }\n                catch (error) {\n                    this.#sessionId.reject(error);\n                }\n            })();\n        }\n        // SAFETY: We never throw #sessionId.\n        BidiCdpSession.sessions.set(this.#sessionId.value(), this);\n    }\n    connection() {\n        return undefined;\n    }\n    get detached() {\n        return this.#detached;\n    }\n    async send(method, params, options) {\n        if (this.#connection === undefined) {\n            throw new UnsupportedOperation('CDP support is required for this feature. The current browser does not support CDP.');\n        }\n        if (this.#detached) {\n            throw new TargetCloseError(`Protocol error (${method}): Session closed. Most likely the page has been closed.`);\n        }\n        const session = await this.#sessionId.valueOrThrow();\n        const { result } = await this.#connection.send('goog:cdp.sendCommand', {\n            method: method,\n            params: params,\n            session,\n        }, options?.timeout);\n        return result.result;\n    }\n    async detach() {\n        if (this.#connection === undefined ||\n            this.#connection.closed ||\n            this.#detached) {\n            return;\n        }\n        try {\n            await this.frame.client.send('Target.detachFromTarget', {\n                sessionId: this.id(),\n            });\n        }\n        finally {\n            this.onClose();\n        }\n    }\n    /**\n     * @internal\n     */\n    onClose = () => {\n        BidiCdpSession.sessions.delete(this.id());\n        this.#detached = true;\n    };\n    id() {\n        const value = this.#sessionId.value();\n        return typeof value === 'string' ? value : '';\n    }\n}\n//# sourceMappingURL=CDPSession.js.map","/**\n * @license\n * Copyright 2017 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { CallbackRegistry } from '../common/CallbackRegistry.js';\nimport { debug } from '../common/Debug.js';\nimport { ConnectionClosedError } from '../common/Errors.js';\nimport { EventEmitter } from '../common/EventEmitter.js';\nimport { debugError } from '../common/util.js';\nimport { BidiCdpSession } from './CDPSession.js';\nconst debugProtocolSend = debug('puppeteer:webDriverBiDi:SEND ');\nconst debugProtocolReceive = debug('puppeteer:webDriverBiDi:RECV ');\n/**\n * @internal\n */\nexport class BidiConnection extends EventEmitter {\n    #url;\n    #transport;\n    #delay;\n    #timeout = 0;\n    #closed = false;\n    #callbacks;\n    #emitters = [];\n    constructor(url, transport, idGenerator, delay = 0, timeout) {\n        super();\n        this.#url = url;\n        this.#delay = delay;\n        this.#timeout = timeout ?? 180_000;\n        this.#callbacks = new CallbackRegistry(idGenerator);\n        this.#transport = transport;\n        this.#transport.onmessage = this.onMessage.bind(this);\n        this.#transport.onclose = this.unbind.bind(this);\n    }\n    get closed() {\n        return this.#closed;\n    }\n    get url() {\n        return this.#url;\n    }\n    pipeTo(emitter) {\n        this.#emitters.push(emitter);\n    }\n    #toWebDriverOnlyEvent(event) {\n        for (const key in event) {\n            if (key.startsWith('goog:')) {\n                delete event[key];\n            }\n            else {\n                if (typeof event[key] === 'object' && event[key] !== null) {\n                    this.#toWebDriverOnlyEvent(event[key]);\n                }\n            }\n        }\n    }\n    emit(type, event) {\n        if (process.env['PUPPETEER_WEBDRIVER_BIDI_ONLY'] === 'true') {\n            // Required for WebDriver-only testing.\n            this.#toWebDriverOnlyEvent(event);\n        }\n        for (const emitter of this.#emitters) {\n            emitter.emit(type, event);\n        }\n        return super.emit(type, event);\n    }\n    send(method, params, timeout) {\n        if (this.#closed) {\n            return Promise.reject(new ConnectionClosedError('Connection closed.'));\n        }\n        return this.#callbacks.create(method, timeout ?? this.#timeout, id => {\n            const stringifiedMessage = JSON.stringify({\n                id,\n                method,\n                params,\n            });\n            debugProtocolSend(stringifiedMessage);\n            this.#transport.send(stringifiedMessage);\n        });\n    }\n    /**\n     * @internal\n     */\n    async onMessage(message) {\n        if (this.#delay) {\n            await new Promise(f => {\n                return setTimeout(f, this.#delay);\n            });\n        }\n        debugProtocolReceive(message);\n        const object = JSON.parse(message);\n        if ('type' in object) {\n            switch (object.type) {\n                case 'success':\n                    this.#callbacks.resolve(object.id, object);\n                    return;\n                case 'error':\n                    if (object.id === null) {\n                        break;\n                    }\n                    this.#callbacks.reject(object.id, createProtocolError(object), `${object.error}: ${object.message}`);\n                    return;\n                case 'event':\n                    if (isCdpEvent(object)) {\n                        BidiCdpSession.sessions\n                            .get(object.params.session)\n                            ?.emit(object.params.event, object.params.params);\n                        return;\n                    }\n                    // SAFETY: We know the method and parameter still match here.\n                    this.emit(object.method, object.params);\n                    return;\n            }\n        }\n        // Even if the response in not in BiDi protocol format but `id` is provided, reject\n        // the callback. This can happen if the endpoint supports CDP instead of BiDi.\n        if ('id' in object) {\n            this.#callbacks.reject(object.id, `Protocol Error. Message is not in BiDi protocol format: '${message}'`, object.message);\n        }\n        debugError(object);\n    }\n    /**\n     * Unbinds the connection, but keeps the transport open. Useful when the transport will\n     * be reused by other connection e.g. with different protocol.\n     * @internal\n     */\n    unbind() {\n        if (this.#closed) {\n            return;\n        }\n        this.#closed = true;\n        // Both may still be invoked and produce errors\n        this.#transport.onmessage = () => { };\n        this.#transport.onclose = () => { };\n        this.#callbacks.clear();\n    }\n    /**\n     * Unbinds the connection and closes the transport.\n     */\n    dispose() {\n        this.unbind();\n        this.#transport.close();\n    }\n    getPendingProtocolErrors() {\n        return this.#callbacks.getPendingProtocolErrors();\n    }\n}\n/**\n * @internal\n */\nfunction createProtocolError(object) {\n    let message = `${object.error} ${object.message}`;\n    if (object.stacktrace) {\n        message += ` ${object.stacktrace}`;\n    }\n    return message;\n}\nfunction isCdpEvent(event) {\n    return event.method.startsWith('goog:cdp.');\n}\n//# sourceMappingURL=Connection.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport * as BidiMapper from 'chromium-bidi/lib/cjs/bidiMapper/BidiMapper.js';\nimport { debug } from '../common/Debug.js';\nimport { TargetCloseError } from '../common/Errors.js';\nimport { BidiConnection } from './Connection.js';\nconst bidiServerLogger = (prefix, ...args) => {\n    debug(`bidi:${prefix}`)(args);\n};\n/**\n * @internal\n */\nexport async function connectBidiOverCdp(cdp) {\n    const transportBiDi = new NoOpTransport();\n    const cdpConnectionAdapter = new CdpConnectionAdapter(cdp);\n    const pptrTransport = {\n        send(message) {\n            // Forwards a BiDi command sent by Puppeteer to the input of the BidiServer.\n            transportBiDi.emitMessage(JSON.parse(message));\n        },\n        close() {\n            bidiServer.close();\n            cdpConnectionAdapter.close();\n            cdp.dispose();\n        },\n        onmessage(_message) {\n            // The method is overridden by the Connection.\n        },\n    };\n    transportBiDi.on('bidiResponse', (message) => {\n        // Forwards a BiDi event sent by BidiServer to Puppeteer.\n        pptrTransport.onmessage(JSON.stringify(message));\n    });\n    const pptrBiDiConnection = new BidiConnection(cdp.url(), pptrTransport, cdp._idGenerator, cdp.delay, cdp.timeout);\n    const bidiServer = await BidiMapper.BidiServer.createAndStart(transportBiDi, cdpConnectionAdapter, cdpConnectionAdapter.browserClient(), \n    /* selfTargetId= */ '', undefined, bidiServerLogger);\n    return pptrBiDiConnection;\n}\n/**\n * Manages CDPSessions for BidiServer.\n * @internal\n */\nclass CdpConnectionAdapter {\n    #cdp;\n    #adapters = new Map();\n    #browserCdpConnection;\n    constructor(cdp) {\n        this.#cdp = cdp;\n        this.#browserCdpConnection = new CDPClientAdapter(cdp);\n    }\n    browserClient() {\n        return this.#browserCdpConnection;\n    }\n    getCdpClient(id) {\n        const session = this.#cdp.session(id);\n        if (!session) {\n            throw new Error(`Unknown CDP session with id ${id}`);\n        }\n        if (!this.#adapters.has(session)) {\n            const adapter = new CDPClientAdapter(session, id, this.#browserCdpConnection);\n            this.#adapters.set(session, adapter);\n            return adapter;\n        }\n        return this.#adapters.get(session);\n    }\n    close() {\n        this.#browserCdpConnection.close();\n        for (const adapter of this.#adapters.values()) {\n            adapter.close();\n        }\n    }\n}\n/**\n * Wrapper on top of CDPSession/CDPConnection to satisfy CDP interface that\n * BidiServer needs.\n *\n * @internal\n */\nclass CDPClientAdapter extends BidiMapper.EventEmitter {\n    #closed = false;\n    #client;\n    sessionId = undefined;\n    #browserClient;\n    constructor(client, sessionId, browserClient) {\n        super();\n        this.#client = client;\n        this.sessionId = sessionId;\n        this.#browserClient = browserClient;\n        this.#client.on('*', this.#forwardMessage);\n    }\n    browserClient() {\n        return this.#browserClient;\n    }\n    #forwardMessage = (method, event) => {\n        this.emit(method, event);\n    };\n    async sendCommand(method, ...params) {\n        if (this.#closed) {\n            return;\n        }\n        try {\n            return await this.#client.send(method, ...params);\n        }\n        catch (err) {\n            if (this.#closed) {\n                return;\n            }\n            throw err;\n        }\n    }\n    close() {\n        this.#client.off('*', this.#forwardMessage);\n        this.#closed = true;\n    }\n    isCloseError(error) {\n        return error instanceof TargetCloseError;\n    }\n}\n/**\n * This transport is given to the BiDi server instance and allows Puppeteer\n * to send and receive commands to the BiDiServer.\n * @internal\n */\nclass NoOpTransport extends BidiMapper.EventEmitter {\n    #onMessage = async (_m) => {\n        return;\n    };\n    emitMessage(message) {\n        void this.#onMessage(message);\n    }\n    setOnMessage(onMessage) {\n        this.#onMessage = onMessage;\n    }\n    async sendMessage(message) {\n        this.emit('bidiResponse', message);\n    }\n    close() {\n        this.#onMessage = async (_m) => {\n            return;\n        };\n    }\n}\n//# sourceMappingURL=BidiOverCdp.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nimport { EventEmitter } from '../../common/EventEmitter.js';\nimport { inertIfDisposed } from '../../util/decorators.js';\nimport { DisposableStack, disposeSymbol } from '../../util/disposable.js';\n/**\n * @internal\n */\nlet Navigation = (() => {\n    var _a;\n    let _classSuper = EventEmitter;\n    let _instanceExtraInitializers = [];\n    let _dispose_decorators;\n    return class Navigation extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            __esDecorate(this, null, _dispose_decorators, { kind: \"method\", name: \"dispose\", static: false, private: false, access: { has: obj => \"dispose\" in obj, get: obj => obj.dispose }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static from(context) {\n            const navigation = new Navigation(context);\n            navigation.#initialize();\n            return navigation;\n        }\n        #request = __runInitializers(this, _instanceExtraInitializers);\n        #navigation;\n        #browsingContext;\n        #disposables = new DisposableStack();\n        #id;\n        constructor(context) {\n            super();\n            this.#browsingContext = context;\n        }\n        #initialize() {\n            const browsingContextEmitter = this.#disposables.use(new EventEmitter(this.#browsingContext));\n            browsingContextEmitter.once('closed', () => {\n                this.emit('failed', {\n                    url: this.#browsingContext.url,\n                    timestamp: new Date(),\n                });\n                this.dispose();\n            });\n            browsingContextEmitter.on('request', ({ request }) => {\n                if (request.navigation === undefined ||\n                    // If a request with a navigation ID comes in, then the navigation ID is\n                    // for this navigation.\n                    !this.#matches(request.navigation)) {\n                    return;\n                }\n                this.#request = request;\n                this.emit('request', request);\n                const requestEmitter = this.#disposables.use(new EventEmitter(this.#request));\n                requestEmitter.on('redirect', request => {\n                    this.#request = request;\n                });\n            });\n            const sessionEmitter = this.#disposables.use(new EventEmitter(this.#session));\n            sessionEmitter.on('browsingContext.navigationStarted', info => {\n                if (info.context !== this.#browsingContext.id ||\n                    this.#navigation !== undefined) {\n                    return;\n                }\n                this.#navigation = Navigation.from(this.#browsingContext);\n            });\n            for (const eventName of [\n                'browsingContext.domContentLoaded',\n                'browsingContext.load',\n            ]) {\n                sessionEmitter.on(eventName, info => {\n                    if (info.context !== this.#browsingContext.id ||\n                        info.navigation === null ||\n                        !this.#matches(info.navigation)) {\n                        return;\n                    }\n                    this.dispose();\n                });\n            }\n            for (const [eventName, event] of [\n                ['browsingContext.fragmentNavigated', 'fragment'],\n                ['browsingContext.navigationFailed', 'failed'],\n                ['browsingContext.navigationAborted', 'aborted'],\n            ]) {\n                sessionEmitter.on(eventName, info => {\n                    if (info.context !== this.#browsingContext.id ||\n                        // Note we don't check if `navigation` is null since `null` means the\n                        // fragment navigated.\n                        !this.#matches(info.navigation)) {\n                        return;\n                    }\n                    this.emit(event, {\n                        url: info.url,\n                        timestamp: new Date(info.timestamp),\n                    });\n                    this.dispose();\n                });\n            }\n        }\n        #matches(navigation) {\n            if (this.#navigation !== undefined && !this.#navigation.disposed) {\n                return false;\n            }\n            if (this.#id === undefined) {\n                this.#id = navigation;\n                return true;\n            }\n            return this.#id === navigation;\n        }\n        get #session() {\n            return this.#browsingContext.userContext.browser.session;\n        }\n        get disposed() {\n            return this.#disposables.disposed;\n        }\n        get request() {\n            return this.#request;\n        }\n        get navigation() {\n            return this.#navigation;\n        }\n        dispose() {\n            this[disposeSymbol]();\n        }\n        [(_dispose_decorators = [inertIfDisposed], disposeSymbol)]() {\n            this.#disposables.dispose();\n            super[disposeSymbol]();\n        }\n    };\n})();\nexport { Navigation };\n//# sourceMappingURL=Navigation.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nvar _a;\nimport { EventEmitter } from '../../common/EventEmitter.js';\nimport { inertIfDisposed, throwIfDisposed } from '../../util/decorators.js';\nimport { DisposableStack, disposeSymbol } from '../../util/disposable.js';\n/**\n * @internal\n */\nlet Realm = (() => {\n    let _classSuper = EventEmitter;\n    let _instanceExtraInitializers = [];\n    let _dispose_decorators;\n    let _disown_decorators;\n    let _callFunction_decorators;\n    let _evaluate_decorators;\n    let _resolveExecutionContextId_decorators;\n    return class Realm extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            __esDecorate(this, null, _dispose_decorators, { kind: \"method\", name: \"dispose\", static: false, private: false, access: { has: obj => \"dispose\" in obj, get: obj => obj.dispose }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _disown_decorators, { kind: \"method\", name: \"disown\", static: false, private: false, access: { has: obj => \"disown\" in obj, get: obj => obj.disown }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _callFunction_decorators, { kind: \"method\", name: \"callFunction\", static: false, private: false, access: { has: obj => \"callFunction\" in obj, get: obj => obj.callFunction }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _evaluate_decorators, { kind: \"method\", name: \"evaluate\", static: false, private: false, access: { has: obj => \"evaluate\" in obj, get: obj => obj.evaluate }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _resolveExecutionContextId_decorators, { kind: \"method\", name: \"resolveExecutionContextId\", static: false, private: false, access: { has: obj => \"resolveExecutionContextId\" in obj, get: obj => obj.resolveExecutionContextId }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        #reason = __runInitializers(this, _instanceExtraInitializers);\n        disposables = new DisposableStack();\n        id;\n        origin;\n        executionContextId;\n        constructor(id, origin) {\n            super();\n            this.id = id;\n            this.origin = origin;\n        }\n        get disposed() {\n            return this.#reason !== undefined;\n        }\n        get target() {\n            return { realm: this.id };\n        }\n        dispose(reason) {\n            this.#reason = reason;\n            this[disposeSymbol]();\n        }\n        async disown(handles) {\n            await this.session.send('script.disown', {\n                target: this.target,\n                handles,\n            });\n        }\n        async callFunction(functionDeclaration, awaitPromise, options = {}) {\n            const { result } = await this.session.send('script.callFunction', {\n                functionDeclaration,\n                awaitPromise,\n                target: this.target,\n                ...options,\n            });\n            return result;\n        }\n        async evaluate(expression, awaitPromise, options = {}) {\n            const { result } = await this.session.send('script.evaluate', {\n                expression,\n                awaitPromise,\n                target: this.target,\n                ...options,\n            });\n            return result;\n        }\n        async resolveExecutionContextId() {\n            if (!this.executionContextId) {\n                const { result } = await this.session.connection.send('goog:cdp.resolveRealm', { realm: this.id });\n                this.executionContextId = result.executionContextId;\n            }\n            return this.executionContextId;\n        }\n        [(_dispose_decorators = [inertIfDisposed], _disown_decorators = [throwIfDisposed(realm => {\n                // SAFETY: Disposal implies this exists.\n                return realm.#reason;\n            })], _callFunction_decorators = [throwIfDisposed(realm => {\n                // SAFETY: Disposal implies this exists.\n                return realm.#reason;\n            })], _evaluate_decorators = [throwIfDisposed(realm => {\n                // SAFETY: Disposal implies this exists.\n                return realm.#reason;\n            })], _resolveExecutionContextId_decorators = [throwIfDisposed(realm => {\n                // SAFETY: Disposal implies this exists.\n                return realm.#reason;\n            })], disposeSymbol)]() {\n            this.#reason ??=\n                'Realm already destroyed, probably because all associated browsing contexts closed.';\n            this.emit('destroyed', { reason: this.#reason });\n            this.disposables.dispose();\n            super[disposeSymbol]();\n        }\n    };\n})();\nexport { Realm };\n/**\n * @internal\n */\nexport class WindowRealm extends Realm {\n    static from(context, sandbox) {\n        const realm = new WindowRealm(context, sandbox);\n        realm.#initialize();\n        return realm;\n    }\n    browsingContext;\n    sandbox;\n    #workers = new Map();\n    constructor(context, sandbox) {\n        super('', '');\n        this.browsingContext = context;\n        this.sandbox = sandbox;\n    }\n    #initialize() {\n        const browsingContextEmitter = this.disposables.use(new EventEmitter(this.browsingContext));\n        browsingContextEmitter.on('closed', ({ reason }) => {\n            this.dispose(reason);\n        });\n        const sessionEmitter = this.disposables.use(new EventEmitter(this.session));\n        sessionEmitter.on('script.realmCreated', info => {\n            if (info.type !== 'window' ||\n                info.context !== this.browsingContext.id ||\n                info.sandbox !== this.sandbox) {\n                return;\n            }\n            this.id = info.realm;\n            this.origin = info.origin;\n            this.executionContextId = undefined;\n            this.emit('updated', this);\n        });\n        sessionEmitter.on('script.realmCreated', info => {\n            if (info.type !== 'dedicated-worker') {\n                return;\n            }\n            if (!info.owners.includes(this.id)) {\n                return;\n            }\n            const realm = DedicatedWorkerRealm.from(this, info.realm, info.origin);\n            this.#workers.set(realm.id, realm);\n            const realmEmitter = this.disposables.use(new EventEmitter(realm));\n            realmEmitter.once('destroyed', () => {\n                realmEmitter.removeAllListeners();\n                this.#workers.delete(realm.id);\n            });\n            this.emit('worker', realm);\n        });\n    }\n    get session() {\n        return this.browsingContext.userContext.browser.session;\n    }\n    get target() {\n        return { context: this.browsingContext.id, sandbox: this.sandbox };\n    }\n}\n/**\n * @internal\n */\nexport class DedicatedWorkerRealm extends Realm {\n    static from(owner, id, origin) {\n        const realm = new _a(owner, id, origin);\n        realm.#initialize();\n        return realm;\n    }\n    #workers = new Map();\n    owners;\n    constructor(owner, id, origin) {\n        super(id, origin);\n        this.owners = new Set([owner]);\n    }\n    #initialize() {\n        const sessionEmitter = this.disposables.use(new EventEmitter(this.session));\n        sessionEmitter.on('script.realmDestroyed', info => {\n            if (info.realm !== this.id) {\n                return;\n            }\n            this.dispose('Realm already destroyed.');\n        });\n        sessionEmitter.on('script.realmCreated', info => {\n            if (info.type !== 'dedicated-worker') {\n                return;\n            }\n            if (!info.owners.includes(this.id)) {\n                return;\n            }\n            const realm = _a.from(this, info.realm, info.origin);\n            this.#workers.set(realm.id, realm);\n            const realmEmitter = this.disposables.use(new EventEmitter(realm));\n            realmEmitter.once('destroyed', () => {\n                this.#workers.delete(realm.id);\n            });\n            this.emit('worker', realm);\n        });\n    }\n    get session() {\n        // SAFETY: At least one owner will exist.\n        return this.owners.values().next().value.session;\n    }\n}\n_a = DedicatedWorkerRealm;\n/**\n * @internal\n */\nexport class SharedWorkerRealm extends Realm {\n    static from(browser, id, origin) {\n        const realm = new SharedWorkerRealm(browser, id, origin);\n        realm.#initialize();\n        return realm;\n    }\n    #workers = new Map();\n    browser;\n    constructor(browser, id, origin) {\n        super(id, origin);\n        this.browser = browser;\n    }\n    #initialize() {\n        const sessionEmitter = this.disposables.use(new EventEmitter(this.session));\n        sessionEmitter.on('script.realmDestroyed', info => {\n            if (info.realm !== this.id) {\n                return;\n            }\n            this.dispose('Realm already destroyed.');\n        });\n        sessionEmitter.on('script.realmCreated', info => {\n            if (info.type !== 'dedicated-worker') {\n                return;\n            }\n            if (!info.owners.includes(this.id)) {\n                return;\n            }\n            const realm = DedicatedWorkerRealm.from(this, info.realm, info.origin);\n            this.#workers.set(realm.id, realm);\n            const realmEmitter = this.disposables.use(new EventEmitter(realm));\n            realmEmitter.once('destroyed', () => {\n                this.#workers.delete(realm.id);\n            });\n            this.emit('worker', realm);\n        });\n    }\n    get session() {\n        return this.browser.session;\n    }\n}\n//# sourceMappingURL=Realm.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nimport { ProtocolError, UnsupportedOperation } from '../../common/Errors.js';\nimport { EventEmitter } from '../../common/EventEmitter.js';\nimport { inertIfDisposed } from '../../util/decorators.js';\nimport { DisposableStack, disposeSymbol } from '../../util/disposable.js';\nimport { stringToTypedArray } from '../../util/encoding.js';\n/**\n * @internal\n */\nlet Request = (() => {\n    var _a;\n    let _classSuper = EventEmitter;\n    let _instanceExtraInitializers = [];\n    let _dispose_decorators;\n    return class Request extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            __esDecorate(this, null, _dispose_decorators, { kind: \"method\", name: \"dispose\", static: false, private: false, access: { has: obj => \"dispose\" in obj, get: obj => obj.dispose }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static from(browsingContext, event) {\n            const request = new Request(browsingContext, event);\n            request.#initialize();\n            return request;\n        }\n        #responseContentPromise = (__runInitializers(this, _instanceExtraInitializers), null);\n        #requestBodyPromise = null;\n        #error;\n        #redirect;\n        #response;\n        #browsingContext;\n        #disposables = new DisposableStack();\n        #event;\n        constructor(browsingContext, event) {\n            super();\n            this.#browsingContext = browsingContext;\n            this.#event = event;\n        }\n        #initialize() {\n            const browsingContextEmitter = this.#disposables.use(new EventEmitter(this.#browsingContext));\n            browsingContextEmitter.once('closed', ({ reason }) => {\n                this.#error = reason;\n                this.emit('error', this.#error);\n                this.dispose();\n            });\n            const sessionEmitter = this.#disposables.use(new EventEmitter(this.#session));\n            sessionEmitter.on('network.beforeRequestSent', event => {\n                if (event.context !== this.#browsingContext.id ||\n                    event.request.request !== this.id) {\n                    return;\n                }\n                // This is a workaround to detect if a beforeRequestSent is for a request\n                // sent after continueWithAuth. Currently, only emitted in Firefox.\n                const previousRequestHasAuth = this.#event.request.headers.find(header => {\n                    return header.name.toLowerCase() === 'authorization';\n                });\n                const newRequestHasAuth = event.request.headers.find(header => {\n                    return header.name.toLowerCase() === 'authorization';\n                });\n                const isAfterAuth = newRequestHasAuth && !previousRequestHasAuth;\n                if (event.redirectCount !== this.#event.redirectCount + 1 &&\n                    !isAfterAuth) {\n                    return;\n                }\n                this.#redirect = Request.from(this.#browsingContext, event);\n                this.emit('redirect', this.#redirect);\n                this.dispose();\n            });\n            sessionEmitter.on('network.authRequired', event => {\n                if (event.context !== this.#browsingContext.id ||\n                    event.request.request !== this.id ||\n                    // Don't try to authenticate for events that are not blocked\n                    !event.isBlocked) {\n                    return;\n                }\n                this.emit('authenticate', undefined);\n            });\n            sessionEmitter.on('network.fetchError', event => {\n                if (event.context !== this.#browsingContext.id ||\n                    event.request.request !== this.id ||\n                    this.#event.redirectCount !== event.redirectCount) {\n                    return;\n                }\n                this.#error = event.errorText;\n                this.emit('error', this.#error);\n                this.dispose();\n            });\n            sessionEmitter.on('network.responseCompleted', event => {\n                if (event.context !== this.#browsingContext.id ||\n                    event.request.request !== this.id ||\n                    this.#event.redirectCount !== event.redirectCount) {\n                    return;\n                }\n                this.#response = event.response;\n                this.#event.request.timings = event.request.timings;\n                this.emit('success', this.#response);\n                // In case this is a redirect.\n                if (this.#response.status >= 300 && this.#response.status < 400) {\n                    return;\n                }\n                this.dispose();\n            });\n        }\n        get #session() {\n            return this.#browsingContext.userContext.browser.session;\n        }\n        get disposed() {\n            return this.#disposables.disposed;\n        }\n        get error() {\n            return this.#error;\n        }\n        get headers() {\n            return this.#event.request.headers;\n        }\n        get id() {\n            return this.#event.request.request;\n        }\n        get initiator() {\n            return {\n                ...this.#event.initiator,\n                // Initiator URL is not specified in BiDi.\n                // @ts-expect-error non-standard property.\n                url: this.#event.request['goog:resourceInitiator']?.url,\n                // @ts-expect-error non-standard property.\n                stack: this.#event.request['goog:resourceInitiator']?.stack,\n            };\n        }\n        get method() {\n            return this.#event.request.method;\n        }\n        get navigation() {\n            return this.#event.navigation ?? undefined;\n        }\n        get redirect() {\n            return this.#redirect;\n        }\n        get lastRedirect() {\n            let redirect = this.#redirect;\n            while (redirect) {\n                if (redirect && !redirect.#redirect) {\n                    return redirect;\n                }\n                redirect = redirect.#redirect;\n            }\n            return redirect;\n        }\n        get response() {\n            return this.#response;\n        }\n        get url() {\n            return this.#event.request.url;\n        }\n        get isBlocked() {\n            return this.#event.isBlocked;\n        }\n        get resourceType() {\n            // @ts-expect-error non-standard attribute.\n            return this.#event.request['goog:resourceType'] ?? undefined;\n        }\n        get postData() {\n            // @ts-expect-error non-standard attribute.\n            return this.#event.request['goog:postData'] ?? undefined;\n        }\n        get hasPostData() {\n            return (this.#event.request.bodySize ?? 0) > 0;\n        }\n        async continueRequest({ url, method, headers, cookies, body, }) {\n            await this.#session.send('network.continueRequest', {\n                request: this.id,\n                url,\n                method,\n                headers,\n                body,\n                cookies,\n            });\n        }\n        async failRequest() {\n            await this.#session.send('network.failRequest', {\n                request: this.id,\n            });\n        }\n        async provideResponse({ statusCode, reasonPhrase, headers, body, }) {\n            await this.#session.send('network.provideResponse', {\n                request: this.id,\n                statusCode,\n                reasonPhrase,\n                headers,\n                body,\n            });\n        }\n        async fetchPostData() {\n            if (!this.hasPostData) {\n                return undefined;\n            }\n            if (!this.#requestBodyPromise) {\n                this.#requestBodyPromise = (async () => {\n                    const data = await this.#session.send('network.getData', {\n                        dataType: \"request\" /* Bidi.Network.DataType.Request */,\n                        request: this.id,\n                    });\n                    if (data.result.bytes.type === 'string') {\n                        return data.result.bytes.value;\n                    }\n                    // TODO: support base64 response.\n                    throw new UnsupportedOperation(`Collected request body data of type ${data.result.bytes.type} is not supported`);\n                })();\n            }\n            return await this.#requestBodyPromise;\n        }\n        async getResponseContent() {\n            if (!this.#responseContentPromise) {\n                this.#responseContentPromise = (async () => {\n                    try {\n                        const data = await this.#session.send('network.getData', {\n                            dataType: \"response\" /* Bidi.Network.DataType.Response */,\n                            request: this.id,\n                        });\n                        return stringToTypedArray(data.result.bytes.value, data.result.bytes.type === 'base64');\n                    }\n                    catch (error) {\n                        if (error instanceof ProtocolError &&\n                            error.originalMessage.includes('No resource with given identifier found')) {\n                            throw new ProtocolError('Could not load response body for this request. This might happen if the request is a preflight request.');\n                        }\n                        throw error;\n                    }\n                })();\n            }\n            return await this.#responseContentPromise;\n        }\n        async continueWithAuth(parameters) {\n            if (parameters.action === 'provideCredentials') {\n                await this.#session.send('network.continueWithAuth', {\n                    request: this.id,\n                    action: parameters.action,\n                    credentials: parameters.credentials,\n                });\n            }\n            else {\n                await this.#session.send('network.continueWithAuth', {\n                    request: this.id,\n                    action: parameters.action,\n                });\n            }\n        }\n        dispose() {\n            this[disposeSymbol]();\n        }\n        [(_dispose_decorators = [inertIfDisposed], disposeSymbol)]() {\n            this.#disposables.dispose();\n            super[disposeSymbol]();\n        }\n        timing() {\n            return this.#event.request.timings;\n        }\n    };\n})();\nexport { Request };\n//# sourceMappingURL=Request.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nimport { EventEmitter } from '../../common/EventEmitter.js';\nimport { inertIfDisposed, throwIfDisposed } from '../../util/decorators.js';\nimport { DisposableStack, disposeSymbol } from '../../util/disposable.js';\n/**\n * @internal\n */\nlet UserPrompt = (() => {\n    let _classSuper = EventEmitter;\n    let _instanceExtraInitializers = [];\n    let _dispose_decorators;\n    let _handle_decorators;\n    return class UserPrompt extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            __esDecorate(this, null, _dispose_decorators, { kind: \"method\", name: \"dispose\", static: false, private: false, access: { has: obj => \"dispose\" in obj, get: obj => obj.dispose }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _handle_decorators, { kind: \"method\", name: \"handle\", static: false, private: false, access: { has: obj => \"handle\" in obj, get: obj => obj.handle }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static from(browsingContext, info) {\n            const userPrompt = new UserPrompt(browsingContext, info);\n            userPrompt.#initialize();\n            return userPrompt;\n        }\n        #reason = __runInitializers(this, _instanceExtraInitializers);\n        #result;\n        #disposables = new DisposableStack();\n        browsingContext;\n        info;\n        constructor(context, info) {\n            super();\n            this.browsingContext = context;\n            this.info = info;\n        }\n        #initialize() {\n            const browserContextEmitter = this.#disposables.use(new EventEmitter(this.browsingContext));\n            browserContextEmitter.once('closed', ({ reason }) => {\n                this.dispose(`User prompt already closed: ${reason}`);\n            });\n            const sessionEmitter = this.#disposables.use(new EventEmitter(this.#session));\n            sessionEmitter.on('browsingContext.userPromptClosed', parameters => {\n                if (parameters.context !== this.browsingContext.id) {\n                    return;\n                }\n                this.#result = parameters;\n                this.emit('handled', parameters);\n                this.dispose('User prompt already handled.');\n            });\n        }\n        get #session() {\n            return this.browsingContext.userContext.browser.session;\n        }\n        get closed() {\n            return this.#reason !== undefined;\n        }\n        get disposed() {\n            return this.closed;\n        }\n        get handled() {\n            if (this.info.handler === \"accept\" /* Bidi.Session.UserPromptHandlerType.Accept */ ||\n                this.info.handler === \"dismiss\" /* Bidi.Session.UserPromptHandlerType.Dismiss */) {\n                return true;\n            }\n            return this.#result !== undefined;\n        }\n        get result() {\n            return this.#result;\n        }\n        dispose(reason) {\n            this.#reason = reason;\n            this[disposeSymbol]();\n        }\n        async handle(options = {}) {\n            await this.#session.send('browsingContext.handleUserPrompt', {\n                ...options,\n                context: this.info.context,\n            });\n            // SAFETY: `handled` is triggered before the above promise resolved.\n            return this.#result;\n        }\n        [(_dispose_decorators = [inertIfDisposed], _handle_decorators = [throwIfDisposed(prompt => {\n                // SAFETY: Disposal implies this exists.\n                return prompt.#reason;\n            })], disposeSymbol)]() {\n            this.#reason ??=\n                'User prompt already closed, probably because the associated browsing context was destroyed.';\n            this.emit('closed', { reason: this.#reason });\n            this.#disposables.dispose();\n            super[disposeSymbol]();\n        }\n    };\n})();\nexport { UserPrompt };\n//# sourceMappingURL=UserPrompt.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nimport { EventEmitter } from '../../common/EventEmitter.js';\nimport { inertIfDisposed, throwIfDisposed } from '../../util/decorators.js';\nimport { DisposableStack, disposeSymbol } from '../../util/disposable.js';\nimport { Navigation } from './Navigation.js';\nimport { WindowRealm } from './Realm.js';\nimport { Request } from './Request.js';\nimport { UserPrompt } from './UserPrompt.js';\n/**\n * @internal\n */\nlet BrowsingContext = (() => {\n    var _a;\n    let _classSuper = EventEmitter;\n    let _instanceExtraInitializers = [];\n    let _dispose_decorators;\n    let _activate_decorators;\n    let _captureScreenshot_decorators;\n    let _close_decorators;\n    let _traverseHistory_decorators;\n    let _navigate_decorators;\n    let _reload_decorators;\n    let _setCacheBehavior_decorators;\n    let _print_decorators;\n    let _handleUserPrompt_decorators;\n    let _setViewport_decorators;\n    let _performActions_decorators;\n    let _releaseActions_decorators;\n    let _createWindowRealm_decorators;\n    let _addPreloadScript_decorators;\n    let _addIntercept_decorators;\n    let _removePreloadScript_decorators;\n    let _setGeolocationOverride_decorators;\n    let _setTimezoneOverride_decorators;\n    let _setScreenOrientationOverride_decorators;\n    let _getCookies_decorators;\n    let _setCookie_decorators;\n    let _setFiles_decorators;\n    let _subscribe_decorators;\n    let _addInterception_decorators;\n    let _deleteCookie_decorators;\n    let _locateNodes_decorators;\n    return class BrowsingContext extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            _deleteCookie_decorators = [throwIfDisposed(context => {\n                    // SAFETY: Disposal implies this exists.\n                    return context.#reason;\n                })];\n            _locateNodes_decorators = [throwIfDisposed(context => {\n                    // SAFETY: Disposal implies this exists.\n                    return context.#reason;\n                })];\n            __esDecorate(this, null, _dispose_decorators, { kind: \"method\", name: \"dispose\", static: false, private: false, access: { has: obj => \"dispose\" in obj, get: obj => obj.dispose }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _activate_decorators, { kind: \"method\", name: \"activate\", static: false, private: false, access: { has: obj => \"activate\" in obj, get: obj => obj.activate }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _captureScreenshot_decorators, { kind: \"method\", name: \"captureScreenshot\", static: false, private: false, access: { has: obj => \"captureScreenshot\" in obj, get: obj => obj.captureScreenshot }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _close_decorators, { kind: \"method\", name: \"close\", static: false, private: false, access: { has: obj => \"close\" in obj, get: obj => obj.close }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _traverseHistory_decorators, { kind: \"method\", name: \"traverseHistory\", static: false, private: false, access: { has: obj => \"traverseHistory\" in obj, get: obj => obj.traverseHistory }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _navigate_decorators, { kind: \"method\", name: \"navigate\", static: false, private: false, access: { has: obj => \"navigate\" in obj, get: obj => obj.navigate }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _reload_decorators, { kind: \"method\", name: \"reload\", static: false, private: false, access: { has: obj => \"reload\" in obj, get: obj => obj.reload }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setCacheBehavior_decorators, { kind: \"method\", name: \"setCacheBehavior\", static: false, private: false, access: { has: obj => \"setCacheBehavior\" in obj, get: obj => obj.setCacheBehavior }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _print_decorators, { kind: \"method\", name: \"print\", static: false, private: false, access: { has: obj => \"print\" in obj, get: obj => obj.print }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _handleUserPrompt_decorators, { kind: \"method\", name: \"handleUserPrompt\", static: false, private: false, access: { has: obj => \"handleUserPrompt\" in obj, get: obj => obj.handleUserPrompt }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setViewport_decorators, { kind: \"method\", name: \"setViewport\", static: false, private: false, access: { has: obj => \"setViewport\" in obj, get: obj => obj.setViewport }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _performActions_decorators, { kind: \"method\", name: \"performActions\", static: false, private: false, access: { has: obj => \"performActions\" in obj, get: obj => obj.performActions }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _releaseActions_decorators, { kind: \"method\", name: \"releaseActions\", static: false, private: false, access: { has: obj => \"releaseActions\" in obj, get: obj => obj.releaseActions }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _createWindowRealm_decorators, { kind: \"method\", name: \"createWindowRealm\", static: false, private: false, access: { has: obj => \"createWindowRealm\" in obj, get: obj => obj.createWindowRealm }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _addPreloadScript_decorators, { kind: \"method\", name: \"addPreloadScript\", static: false, private: false, access: { has: obj => \"addPreloadScript\" in obj, get: obj => obj.addPreloadScript }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _addIntercept_decorators, { kind: \"method\", name: \"addIntercept\", static: false, private: false, access: { has: obj => \"addIntercept\" in obj, get: obj => obj.addIntercept }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _removePreloadScript_decorators, { kind: \"method\", name: \"removePreloadScript\", static: false, private: false, access: { has: obj => \"removePreloadScript\" in obj, get: obj => obj.removePreloadScript }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setGeolocationOverride_decorators, { kind: \"method\", name: \"setGeolocationOverride\", static: false, private: false, access: { has: obj => \"setGeolocationOverride\" in obj, get: obj => obj.setGeolocationOverride }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setTimezoneOverride_decorators, { kind: \"method\", name: \"setTimezoneOverride\", static: false, private: false, access: { has: obj => \"setTimezoneOverride\" in obj, get: obj => obj.setTimezoneOverride }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setScreenOrientationOverride_decorators, { kind: \"method\", name: \"setScreenOrientationOverride\", static: false, private: false, access: { has: obj => \"setScreenOrientationOverride\" in obj, get: obj => obj.setScreenOrientationOverride }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _getCookies_decorators, { kind: \"method\", name: \"getCookies\", static: false, private: false, access: { has: obj => \"getCookies\" in obj, get: obj => obj.getCookies }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setCookie_decorators, { kind: \"method\", name: \"setCookie\", static: false, private: false, access: { has: obj => \"setCookie\" in obj, get: obj => obj.setCookie }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setFiles_decorators, { kind: \"method\", name: \"setFiles\", static: false, private: false, access: { has: obj => \"setFiles\" in obj, get: obj => obj.setFiles }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _subscribe_decorators, { kind: \"method\", name: \"subscribe\", static: false, private: false, access: { has: obj => \"subscribe\" in obj, get: obj => obj.subscribe }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _addInterception_decorators, { kind: \"method\", name: \"addInterception\", static: false, private: false, access: { has: obj => \"addInterception\" in obj, get: obj => obj.addInterception }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _deleteCookie_decorators, { kind: \"method\", name: \"deleteCookie\", static: false, private: false, access: { has: obj => \"deleteCookie\" in obj, get: obj => obj.deleteCookie }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _locateNodes_decorators, { kind: \"method\", name: \"locateNodes\", static: false, private: false, access: { has: obj => \"locateNodes\" in obj, get: obj => obj.locateNodes }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static from(userContext, parent, id, url, originalOpener) {\n            const browsingContext = new BrowsingContext(userContext, parent, id, url, originalOpener);\n            browsingContext.#initialize();\n            return browsingContext;\n        }\n        #navigation = __runInitializers(this, _instanceExtraInitializers);\n        #reason;\n        #url;\n        #children = new Map();\n        #disposables = new DisposableStack();\n        #realms = new Map();\n        #requests = new Map();\n        defaultRealm;\n        id;\n        parent;\n        userContext;\n        originalOpener;\n        #emulationState = { javaScriptEnabled: true };\n        constructor(context, parent, id, url, originalOpener) {\n            super();\n            this.#url = url;\n            this.id = id;\n            this.parent = parent;\n            this.userContext = context;\n            this.originalOpener = originalOpener;\n            this.defaultRealm = this.#createWindowRealm();\n        }\n        #initialize() {\n            const userContextEmitter = this.#disposables.use(new EventEmitter(this.userContext));\n            userContextEmitter.once('closed', ({ reason }) => {\n                this.dispose(`Browsing context already closed: ${reason}`);\n            });\n            const sessionEmitter = this.#disposables.use(new EventEmitter(this.#session));\n            sessionEmitter.on('input.fileDialogOpened', info => {\n                if (this.id !== info.context) {\n                    return;\n                }\n                this.emit('filedialogopened', info);\n            });\n            sessionEmitter.on('browsingContext.contextCreated', info => {\n                if (info.parent !== this.id) {\n                    return;\n                }\n                const browsingContext = BrowsingContext.from(this.userContext, this, info.context, info.url, info.originalOpener);\n                this.#children.set(info.context, browsingContext);\n                const browsingContextEmitter = this.#disposables.use(new EventEmitter(browsingContext));\n                browsingContextEmitter.once('closed', () => {\n                    browsingContextEmitter.removeAllListeners();\n                    this.#children.delete(browsingContext.id);\n                });\n                this.emit('browsingcontext', { browsingContext });\n            });\n            sessionEmitter.on('browsingContext.contextDestroyed', info => {\n                if (info.context !== this.id) {\n                    return;\n                }\n                this.dispose('Browsing context already closed.');\n            });\n            sessionEmitter.on('browsingContext.historyUpdated', info => {\n                if (info.context !== this.id) {\n                    return;\n                }\n                this.#url = info.url;\n                this.emit('historyUpdated', undefined);\n            });\n            sessionEmitter.on('browsingContext.domContentLoaded', info => {\n                if (info.context !== this.id) {\n                    return;\n                }\n                this.#url = info.url;\n                this.emit('DOMContentLoaded', undefined);\n            });\n            sessionEmitter.on('browsingContext.load', info => {\n                if (info.context !== this.id) {\n                    return;\n                }\n                this.#url = info.url;\n                this.emit('load', undefined);\n            });\n            sessionEmitter.on('browsingContext.navigationStarted', info => {\n                if (info.context !== this.id) {\n                    return;\n                }\n                // Note: we should not update this.#url at this point since the context\n                // has not finished navigating to the info.url yet.\n                for (const [id, request] of this.#requests) {\n                    if (request.disposed) {\n                        this.#requests.delete(id);\n                    }\n                }\n                // If the navigation hasn't finished, then this is nested navigation. The\n                // current navigation will handle this.\n                if (this.#navigation !== undefined && !this.#navigation.disposed) {\n                    return;\n                }\n                // Note the navigation ID is null for this event.\n                this.#navigation = Navigation.from(this);\n                const navigationEmitter = this.#disposables.use(new EventEmitter(this.#navigation));\n                for (const eventName of ['fragment', 'failed', 'aborted']) {\n                    navigationEmitter.once(eventName, ({ url }) => {\n                        navigationEmitter[disposeSymbol]();\n                        this.#url = url;\n                    });\n                }\n                this.emit('navigation', { navigation: this.#navigation });\n            });\n            sessionEmitter.on('network.beforeRequestSent', event => {\n                if (event.context !== this.id) {\n                    return;\n                }\n                if (this.#requests.has(event.request.request)) {\n                    // Means the request is a redirect. This is handled in Request.\n                    // Or an Auth event was issued\n                    return;\n                }\n                const request = Request.from(this, event);\n                this.#requests.set(request.id, request);\n                this.emit('request', { request });\n            });\n            sessionEmitter.on('log.entryAdded', entry => {\n                if (entry.source.context !== this.id) {\n                    return;\n                }\n                this.emit('log', { entry });\n            });\n            sessionEmitter.on('browsingContext.userPromptOpened', info => {\n                if (info.context !== this.id) {\n                    return;\n                }\n                const userPrompt = UserPrompt.from(this, info);\n                this.emit('userprompt', { userPrompt });\n            });\n        }\n        get #session() {\n            return this.userContext.browser.session;\n        }\n        get children() {\n            return this.#children.values();\n        }\n        get closed() {\n            return this.#reason !== undefined;\n        }\n        get disposed() {\n            return this.closed;\n        }\n        get realms() {\n            // eslint-disable-next-line @typescript-eslint/no-this-alias -- Required\n            const self = this;\n            return (function* () {\n                yield self.defaultRealm;\n                yield* self.#realms.values();\n            })();\n        }\n        get top() {\n            let context = this;\n            for (let { parent } = context; parent; { parent } = context) {\n                context = parent;\n            }\n            return context;\n        }\n        get url() {\n            return this.#url;\n        }\n        #createWindowRealm(sandbox) {\n            const realm = WindowRealm.from(this, sandbox);\n            realm.on('worker', realm => {\n                this.emit('worker', { realm });\n            });\n            return realm;\n        }\n        dispose(reason) {\n            this.#reason = reason;\n            for (const context of this.#children.values()) {\n                context.dispose('Parent browsing context was disposed');\n            }\n            this[disposeSymbol]();\n        }\n        async activate() {\n            await this.#session.send('browsingContext.activate', {\n                context: this.id,\n            });\n        }\n        async captureScreenshot(options = {}) {\n            const { result: { data }, } = await this.#session.send('browsingContext.captureScreenshot', {\n                context: this.id,\n                ...options,\n            });\n            return data;\n        }\n        async close(promptUnload) {\n            await Promise.all([...this.#children.values()].map(async (child) => {\n                await child.close(promptUnload);\n            }));\n            await this.#session.send('browsingContext.close', {\n                context: this.id,\n                promptUnload,\n            });\n        }\n        async traverseHistory(delta) {\n            await this.#session.send('browsingContext.traverseHistory', {\n                context: this.id,\n                delta,\n            });\n        }\n        async navigate(url, wait) {\n            await this.#session.send('browsingContext.navigate', {\n                context: this.id,\n                url,\n                wait,\n            });\n        }\n        async reload(options = {}) {\n            await this.#session.send('browsingContext.reload', {\n                context: this.id,\n                ...options,\n            });\n        }\n        async setCacheBehavior(cacheBehavior) {\n            await this.#session.send('network.setCacheBehavior', {\n                contexts: [this.id],\n                cacheBehavior,\n            });\n        }\n        async print(options = {}) {\n            const { result: { data }, } = await this.#session.send('browsingContext.print', {\n                context: this.id,\n                ...options,\n            });\n            return data;\n        }\n        async handleUserPrompt(options = {}) {\n            await this.#session.send('browsingContext.handleUserPrompt', {\n                context: this.id,\n                ...options,\n            });\n        }\n        async setViewport(options = {}) {\n            await this.#session.send('browsingContext.setViewport', {\n                context: this.id,\n                ...options,\n            });\n        }\n        async performActions(actions) {\n            await this.#session.send('input.performActions', {\n                context: this.id,\n                actions,\n            });\n        }\n        async releaseActions() {\n            await this.#session.send('input.releaseActions', {\n                context: this.id,\n            });\n        }\n        createWindowRealm(sandbox) {\n            return this.#createWindowRealm(sandbox);\n        }\n        async addPreloadScript(functionDeclaration, options = {}) {\n            return await this.userContext.browser.addPreloadScript(functionDeclaration, {\n                ...options,\n                contexts: [this],\n            });\n        }\n        async addIntercept(options) {\n            const { result: { intercept }, } = await this.userContext.browser.session.send('network.addIntercept', {\n                ...options,\n                contexts: [this.id],\n            });\n            return intercept;\n        }\n        async removePreloadScript(script) {\n            await this.userContext.browser.removePreloadScript(script);\n        }\n        async setGeolocationOverride(options) {\n            if (!('coordinates' in options)) {\n                throw new Error('Missing coordinates');\n            }\n            await this.userContext.browser.session.send('emulation.setGeolocationOverride', {\n                coordinates: options.coordinates,\n                contexts: [this.id],\n            });\n        }\n        async setTimezoneOverride(timezoneId) {\n            if (timezoneId?.startsWith('GMT')) {\n                // CDP requires `GMT` prefix before timezone offset, while BiDi does not. Remove the\n                // `GMT` for interop between CDP and BiDi.\n                timezoneId = timezoneId?.replace('GMT', '');\n            }\n            await this.userContext.browser.session.send('emulation.setTimezoneOverride', {\n                timezone: timezoneId ?? null,\n                contexts: [this.id],\n            });\n        }\n        async setScreenOrientationOverride(screenOrientation) {\n            await this.#session.send('emulation.setScreenOrientationOverride', {\n                screenOrientation,\n                contexts: [this.id],\n            });\n        }\n        async getCookies(options = {}) {\n            const { result: { cookies }, } = await this.#session.send('storage.getCookies', {\n                ...options,\n                partition: {\n                    type: 'context',\n                    context: this.id,\n                },\n            });\n            return cookies;\n        }\n        async setCookie(cookie) {\n            await this.#session.send('storage.setCookie', {\n                cookie,\n                partition: {\n                    type: 'context',\n                    context: this.id,\n                },\n            });\n        }\n        async setFiles(element, files) {\n            await this.#session.send('input.setFiles', {\n                context: this.id,\n                element,\n                files,\n            });\n        }\n        async subscribe(events) {\n            await this.#session.subscribe(events, [this.id]);\n        }\n        async addInterception(events) {\n            await this.#session.subscribe(events, [this.id]);\n        }\n        [(_dispose_decorators = [inertIfDisposed], _activate_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _captureScreenshot_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _close_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _traverseHistory_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _navigate_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _reload_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setCacheBehavior_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _print_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _handleUserPrompt_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setViewport_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _performActions_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _releaseActions_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _createWindowRealm_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _addPreloadScript_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _addIntercept_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _removePreloadScript_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setGeolocationOverride_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setTimezoneOverride_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setScreenOrientationOverride_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _getCookies_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setCookie_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setFiles_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _subscribe_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _addInterception_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], disposeSymbol)]() {\n            this.#reason ??=\n                'Browsing context already closed, probably because the user context closed.';\n            this.emit('closed', { reason: this.#reason });\n            this.#disposables.dispose();\n            super[disposeSymbol]();\n        }\n        async deleteCookie(...cookieFilters) {\n            await Promise.all(cookieFilters.map(async (filter) => {\n                await this.#session.send('storage.deleteCookies', {\n                    filter: filter,\n                    partition: {\n                        type: 'context',\n                        context: this.id,\n                    },\n                });\n            }));\n        }\n        async locateNodes(locator, startNodes) {\n            // TODO: add other locateNodes options if needed.\n            const result = await this.#session.send('browsingContext.locateNodes', {\n                context: this.id,\n                locator,\n                startNodes: startNodes.length ? startNodes : undefined,\n            });\n            return result.result.nodes;\n        }\n        async setJavaScriptEnabled(enabled) {\n            await this.userContext.browser.session.send('emulation.setScriptingEnabled', {\n                // Enabled `null` means `default`, `false` means `disabled`.\n                enabled: enabled ? null : false,\n                contexts: [this.id],\n            });\n            this.#emulationState.javaScriptEnabled = enabled;\n        }\n        isJavaScriptEnabled() {\n            return this.#emulationState.javaScriptEnabled;\n        }\n        async setUserAgent(userAgent) {\n            await this.#session.send('emulation.setUserAgentOverride', {\n                userAgent,\n                contexts: [this.id],\n            });\n        }\n        async setOfflineMode(enabled) {\n            await this.#session.send('emulation.setNetworkConditions', {\n                networkConditions: enabled\n                    ? {\n                        type: 'offline',\n                    }\n                    : null,\n                contexts: [this.id],\n            });\n        }\n    };\n})();\nexport { BrowsingContext };\n//# sourceMappingURL=BrowsingContext.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nimport { EventEmitter } from '../../common/EventEmitter.js';\nimport { assert } from '../../util/assert.js';\nimport { inertIfDisposed, throwIfDisposed } from '../../util/decorators.js';\nimport { DisposableStack, disposeSymbol } from '../../util/disposable.js';\nimport { BrowsingContext } from './BrowsingContext.js';\n/**\n * @internal\n */\nlet UserContext = (() => {\n    let _classSuper = EventEmitter;\n    let _instanceExtraInitializers = [];\n    let _dispose_decorators;\n    let _createBrowsingContext_decorators;\n    let _remove_decorators;\n    let _getCookies_decorators;\n    let _setCookie_decorators;\n    let _setPermissions_decorators;\n    return class UserContext extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            __esDecorate(this, null, _dispose_decorators, { kind: \"method\", name: \"dispose\", static: false, private: false, access: { has: obj => \"dispose\" in obj, get: obj => obj.dispose }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _createBrowsingContext_decorators, { kind: \"method\", name: \"createBrowsingContext\", static: false, private: false, access: { has: obj => \"createBrowsingContext\" in obj, get: obj => obj.createBrowsingContext }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _remove_decorators, { kind: \"method\", name: \"remove\", static: false, private: false, access: { has: obj => \"remove\" in obj, get: obj => obj.remove }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _getCookies_decorators, { kind: \"method\", name: \"getCookies\", static: false, private: false, access: { has: obj => \"getCookies\" in obj, get: obj => obj.getCookies }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setCookie_decorators, { kind: \"method\", name: \"setCookie\", static: false, private: false, access: { has: obj => \"setCookie\" in obj, get: obj => obj.setCookie }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setPermissions_decorators, { kind: \"method\", name: \"setPermissions\", static: false, private: false, access: { has: obj => \"setPermissions\" in obj, get: obj => obj.setPermissions }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static DEFAULT = 'default';\n        static create(browser, id) {\n            const context = new UserContext(browser, id);\n            context.#initialize();\n            return context;\n        }\n        #reason = __runInitializers(this, _instanceExtraInitializers);\n        // Note these are only top-level contexts.\n        #browsingContexts = new Map();\n        #disposables = new DisposableStack();\n        #id;\n        browser;\n        constructor(browser, id) {\n            super();\n            this.#id = id;\n            this.browser = browser;\n        }\n        #initialize() {\n            const browserEmitter = this.#disposables.use(new EventEmitter(this.browser));\n            browserEmitter.once('closed', ({ reason }) => {\n                this.dispose(`User context was closed: ${reason}`);\n            });\n            browserEmitter.once('disconnected', ({ reason }) => {\n                this.dispose(`User context was closed: ${reason}`);\n            });\n            const sessionEmitter = this.#disposables.use(new EventEmitter(this.#session));\n            sessionEmitter.on('browsingContext.contextCreated', info => {\n                if (info.parent) {\n                    return;\n                }\n                if (info.userContext !== this.#id) {\n                    return;\n                }\n                const browsingContext = BrowsingContext.from(this, undefined, info.context, info.url, info.originalOpener);\n                this.#browsingContexts.set(browsingContext.id, browsingContext);\n                const browsingContextEmitter = this.#disposables.use(new EventEmitter(browsingContext));\n                browsingContextEmitter.on('closed', () => {\n                    browsingContextEmitter.removeAllListeners();\n                    this.#browsingContexts.delete(browsingContext.id);\n                });\n                this.emit('browsingcontext', { browsingContext });\n            });\n        }\n        get #session() {\n            return this.browser.session;\n        }\n        get browsingContexts() {\n            return this.#browsingContexts.values();\n        }\n        get closed() {\n            return this.#reason !== undefined;\n        }\n        get disposed() {\n            return this.closed;\n        }\n        get id() {\n            return this.#id;\n        }\n        dispose(reason) {\n            this.#reason = reason;\n            this[disposeSymbol]();\n        }\n        async createBrowsingContext(type, options = {}) {\n            const { result: { context: contextId }, } = await this.#session.send('browsingContext.create', {\n                type,\n                ...options,\n                referenceContext: options.referenceContext?.id,\n                userContext: this.#id,\n            });\n            const browsingContext = this.#browsingContexts.get(contextId);\n            assert(browsingContext, 'The WebDriver BiDi implementation is failing to create a browsing context correctly.');\n            // We use an array to avoid the promise from being awaited.\n            return browsingContext;\n        }\n        async remove() {\n            try {\n                await this.#session.send('browser.removeUserContext', {\n                    userContext: this.#id,\n                });\n            }\n            finally {\n                this.dispose('User context already closed.');\n            }\n        }\n        async getCookies(options = {}, sourceOrigin = undefined) {\n            const { result: { cookies }, } = await this.#session.send('storage.getCookies', {\n                ...options,\n                partition: {\n                    type: 'storageKey',\n                    userContext: this.#id,\n                    sourceOrigin,\n                },\n            });\n            return cookies;\n        }\n        async setCookie(cookie, sourceOrigin) {\n            await this.#session.send('storage.setCookie', {\n                cookie,\n                partition: {\n                    type: 'storageKey',\n                    sourceOrigin,\n                    userContext: this.id,\n                },\n            });\n        }\n        async setPermissions(origin, descriptor, state) {\n            await this.#session.send('permissions.setPermission', {\n                origin,\n                descriptor,\n                state,\n                userContext: this.#id,\n            });\n        }\n        [(_dispose_decorators = [inertIfDisposed], _createBrowsingContext_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _remove_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _getCookies_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setCookie_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], _setPermissions_decorators = [throwIfDisposed(context => {\n                // SAFETY: Disposal implies this exists.\n                return context.#reason;\n            })], disposeSymbol)]() {\n            this.#reason ??=\n                'User context already closed, probably because the browser disconnected/closed.';\n            this.emit('closed', { reason: this.#reason });\n            this.#disposables.dispose();\n            super[disposeSymbol]();\n        }\n    };\n})();\nexport { UserContext };\n//# sourceMappingURL=UserContext.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { debugError } from '../common/util.js';\n/**\n * @internal\n */\nexport class BidiDeserializer {\n    static deserialize(result) {\n        if (!result) {\n            debugError('Service did not produce a result.');\n            return undefined;\n        }\n        switch (result.type) {\n            case 'array':\n                return result.value?.map(value => {\n                    return this.deserialize(value);\n                });\n            case 'set':\n                return result.value?.reduce((acc, value) => {\n                    return acc.add(this.deserialize(value));\n                }, new Set());\n            case 'object':\n                return result.value?.reduce((acc, tuple) => {\n                    const { key, value } = this.#deserializeTuple(tuple);\n                    acc[key] = value;\n                    return acc;\n                }, {});\n            case 'map':\n                return result.value?.reduce((acc, tuple) => {\n                    const { key, value } = this.#deserializeTuple(tuple);\n                    return acc.set(key, value);\n                }, new Map());\n            case 'promise':\n                return {};\n            case 'regexp':\n                return new RegExp(result.value.pattern, result.value.flags);\n            case 'date':\n                return new Date(result.value);\n            case 'undefined':\n                return undefined;\n            case 'null':\n                return null;\n            case 'number':\n                return this.#deserializeNumber(result.value);\n            case 'bigint':\n                return BigInt(result.value);\n            case 'boolean':\n                return Boolean(result.value);\n            case 'string':\n                return result.value;\n        }\n        debugError(`Deserialization of type ${result.type} not supported.`);\n        return undefined;\n    }\n    static #deserializeNumber(value) {\n        switch (value) {\n            case '-0':\n                return -0;\n            case 'NaN':\n                return NaN;\n            case 'Infinity':\n                return Infinity;\n            case '-Infinity':\n                return -Infinity;\n            default:\n                return value;\n        }\n    }\n    static #deserializeTuple([serializedKey, serializedValue]) {\n        const key = typeof serializedKey === 'string'\n            ? serializedKey\n            : this.deserialize(serializedKey);\n        const value = this.deserialize(serializedValue);\n        return { key, value };\n    }\n}\n//# sourceMappingURL=Deserializer.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { JSHandle } from '../api/JSHandle.js';\nimport { UnsupportedOperation } from '../common/Errors.js';\nimport { BidiDeserializer } from './Deserializer.js';\n/**\n * @internal\n */\nexport class BidiJSHandle extends JSHandle {\n    static from(value, realm) {\n        return new BidiJSHandle(value, realm);\n    }\n    #remoteValue;\n    realm;\n    #disposed = false;\n    constructor(value, realm) {\n        super();\n        this.#remoteValue = value;\n        this.realm = realm;\n    }\n    get disposed() {\n        return this.#disposed;\n    }\n    async jsonValue() {\n        return await this.evaluate(value => {\n            return value;\n        });\n    }\n    asElement() {\n        return null;\n    }\n    async dispose() {\n        if (this.#disposed) {\n            return;\n        }\n        this.#disposed = true;\n        await this.realm.destroyHandles([this]);\n    }\n    get isPrimitiveValue() {\n        switch (this.#remoteValue.type) {\n            case 'string':\n            case 'number':\n            case 'bigint':\n            case 'boolean':\n            case 'undefined':\n            case 'null':\n                return true;\n            default:\n                return false;\n        }\n    }\n    toString() {\n        if (this.isPrimitiveValue) {\n            return 'JSHandle:' + BidiDeserializer.deserialize(this.#remoteValue);\n        }\n        return 'JSHandle@' + this.#remoteValue.type;\n    }\n    get id() {\n        return 'handle' in this.#remoteValue ? this.#remoteValue.handle : undefined;\n    }\n    remoteValue() {\n        return this.#remoteValue;\n    }\n    remoteObject() {\n        throw new UnsupportedOperation('Not available in WebDriver BiDi');\n    }\n}\n//# sourceMappingURL=JSHandle.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nvar __addDisposableResource = (this && this.__addDisposableResource) || function (env, value, async) {\n    if (value !== null && value !== void 0) {\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n        var dispose, inner;\n        if (async) {\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n            dispose = value[Symbol.asyncDispose];\n        }\n        if (dispose === void 0) {\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n            dispose = value[Symbol.dispose];\n            if (async) inner = dispose;\n        }\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n        env.stack.push({ value: value, dispose: dispose, async: async });\n    }\n    else if (async) {\n        env.stack.push({ async: true });\n    }\n    return value;\n};\nvar __disposeResources = (this && this.__disposeResources) || (function (SuppressedError) {\n    return function (env) {\n        function fail(e) {\n            env.error = env.hasError ? new SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n            env.hasError = true;\n        }\n        var r, s = 0;\n        function next() {\n            while (r = env.stack.pop()) {\n                try {\n                    if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n                    if (r.dispose) {\n                        var result = r.dispose.call(r.value);\n                        if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n                    }\n                    else s |= 1;\n                }\n                catch (e) {\n                    fail(e);\n                }\n            }\n            if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n            if (env.hasError) throw env.error;\n        }\n        return next();\n    };\n})(typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n    var e = new Error(message);\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n});\nimport { bindIsolatedHandle, ElementHandle, } from '../api/ElementHandle.js';\nimport { UnsupportedOperation } from '../common/Errors.js';\nimport { environment } from '../environment.js';\nimport { AsyncIterableUtil } from '../util/AsyncIterableUtil.js';\nimport { throwIfDisposed } from '../util/decorators.js';\nimport { BidiJSHandle } from './JSHandle.js';\n/**\n * @internal\n */\nlet BidiElementHandle = (() => {\n    let _classSuper = ElementHandle;\n    let _instanceExtraInitializers = [];\n    let _autofill_decorators;\n    let _contentFrame_decorators;\n    return class BidiElementHandle extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            _autofill_decorators = [throwIfDisposed()];\n            _contentFrame_decorators = [throwIfDisposed(), bindIsolatedHandle];\n            __esDecorate(this, null, _autofill_decorators, { kind: \"method\", name: \"autofill\", static: false, private: false, access: { has: obj => \"autofill\" in obj, get: obj => obj.autofill }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _contentFrame_decorators, { kind: \"method\", name: \"contentFrame\", static: false, private: false, access: { has: obj => \"contentFrame\" in obj, get: obj => obj.contentFrame }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        #backendNodeId = __runInitializers(this, _instanceExtraInitializers);\n        static from(value, realm) {\n            return new BidiElementHandle(value, realm);\n        }\n        constructor(value, realm) {\n            super(BidiJSHandle.from(value, realm));\n        }\n        get realm() {\n            // SAFETY: See the super call in the constructor.\n            return this.handle.realm;\n        }\n        get frame() {\n            return this.realm.environment;\n        }\n        remoteValue() {\n            return this.handle.remoteValue();\n        }\n        async autofill(data) {\n            const client = this.frame.client;\n            const nodeInfo = await client.send('DOM.describeNode', {\n                objectId: this.handle.id,\n            });\n            const fieldId = nodeInfo.node.backendNodeId;\n            const frameId = this.frame._id;\n            await client.send('Autofill.trigger', {\n                fieldId,\n                frameId,\n                card: data.creditCard,\n            });\n        }\n        async contentFrame() {\n            const env_1 = { stack: [], error: void 0, hasError: false };\n            try {\n                const handle = __addDisposableResource(env_1, (await this.evaluateHandle(element => {\n                    if (element instanceof HTMLIFrameElement ||\n                        element instanceof HTMLFrameElement) {\n                        return element.contentWindow;\n                    }\n                    return;\n                })), false);\n                const value = handle.remoteValue();\n                if (value.type === 'window') {\n                    return (this.frame\n                        .page()\n                        .frames()\n                        .find(frame => {\n                        return frame._id === value.value.context;\n                    }) ?? null);\n                }\n                return null;\n            }\n            catch (e_1) {\n                env_1.error = e_1;\n                env_1.hasError = true;\n            }\n            finally {\n                __disposeResources(env_1);\n            }\n        }\n        async uploadFile(...files) {\n            // Locate all files and confirm that they exist.\n            const path = environment.value.path;\n            if (path) {\n                files = files.map(file => {\n                    if (path.win32.isAbsolute(file) || path.posix.isAbsolute(file)) {\n                        return file;\n                    }\n                    else {\n                        return path.resolve(file);\n                    }\n                });\n            }\n            await this.frame.setFiles(this, files);\n        }\n        async *queryAXTree(name, role) {\n            const results = await this.frame.locateNodes(this, {\n                type: 'accessibility',\n                value: {\n                    role,\n                    name,\n                },\n            });\n            return yield* AsyncIterableUtil.map(results, node => {\n                // TODO: maybe change ownership since the default ownership is probably none.\n                return Promise.resolve(BidiElementHandle.from(node, this.realm));\n            });\n        }\n        async backendNodeId() {\n            if (!this.frame.page().browser().cdpSupported) {\n                throw new UnsupportedOperation();\n            }\n            if (this.#backendNodeId) {\n                return this.#backendNodeId;\n            }\n            const { node } = await this.frame.client.send('DOM.describeNode', {\n                objectId: this.handle.id,\n            });\n            this.#backendNodeId = node.backendNodeId;\n            return this.#backendNodeId;\n        }\n    };\n})();\nexport { BidiElementHandle };\n//# sourceMappingURL=ElementHandle.js.map","/**\n * @license\n * Copyright 2017 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { Dialog } from '../api/Dialog.js';\nexport class BidiDialog extends Dialog {\n    static from(prompt) {\n        return new BidiDialog(prompt);\n    }\n    #prompt;\n    constructor(prompt) {\n        super(prompt.info.type, prompt.info.message, prompt.info.defaultValue);\n        this.#prompt = prompt;\n        this.handled = prompt.handled;\n    }\n    async handle(options) {\n        await this.#prompt.handle({\n            accept: options.accept,\n            userText: options.text,\n        });\n    }\n}\n//# sourceMappingURL=Dialog.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __addDisposableResource = (this && this.__addDisposableResource) || function (env, value, async) {\n    if (value !== null && value !== void 0) {\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n        var dispose, inner;\n        if (async) {\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n            dispose = value[Symbol.asyncDispose];\n        }\n        if (dispose === void 0) {\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n            dispose = value[Symbol.dispose];\n            if (async) inner = dispose;\n        }\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n        env.stack.push({ value: value, dispose: dispose, async: async });\n    }\n    else if (async) {\n        env.stack.push({ async: true });\n    }\n    return value;\n};\nvar __disposeResources = (this && this.__disposeResources) || (function (SuppressedError) {\n    return function (env) {\n        function fail(e) {\n            env.error = env.hasError ? new SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n            env.hasError = true;\n        }\n        var r, s = 0;\n        function next() {\n            while (r = env.stack.pop()) {\n                try {\n                    if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n                    if (r.dispose) {\n                        var result = r.dispose.call(r.value);\n                        if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n                    }\n                    else s |= 1;\n                }\n                catch (e) {\n                    fail(e);\n                }\n            }\n            if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n            if (env.hasError) throw env.error;\n        }\n        return next();\n    };\n})(typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n    var e = new Error(message);\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n});\nimport { EventEmitter } from '../common/EventEmitter.js';\nimport { debugError } from '../common/util.js';\nimport { DisposableStack } from '../util/disposable.js';\nimport { interpolateFunction, stringifyFunction } from '../util/Function.js';\nimport { BidiElementHandle } from './ElementHandle.js';\nimport { BidiJSHandle } from './JSHandle.js';\n/**\n * @internal\n */\nexport class ExposableFunction {\n    static async from(frame, name, apply, isolate = false) {\n        const func = new ExposableFunction(frame, name, apply, isolate);\n        await func.#initialize();\n        return func;\n    }\n    #frame;\n    name;\n    #apply;\n    #isolate;\n    #channel;\n    #scripts = [];\n    #disposables = new DisposableStack();\n    constructor(frame, name, apply, isolate = false) {\n        this.#frame = frame;\n        this.name = name;\n        this.#apply = apply;\n        this.#isolate = isolate;\n        this.#channel = `__puppeteer__${this.#frame._id}_page_exposeFunction_${this.name}`;\n    }\n    async #initialize() {\n        const connection = this.#connection;\n        const channel = {\n            type: 'channel',\n            value: {\n                channel: this.#channel,\n                ownership: \"root\" /* Bidi.Script.ResultOwnership.Root */,\n            },\n        };\n        const connectionEmitter = this.#disposables.use(new EventEmitter(connection));\n        connectionEmitter.on('script.message', this.#handleMessage);\n        const functionDeclaration = stringifyFunction(interpolateFunction((callback) => {\n            Object.assign(globalThis, {\n                [PLACEHOLDER('name')]: function (...args) {\n                    return new Promise((resolve, reject) => {\n                        callback([resolve, reject, args]);\n                    });\n                },\n            });\n        }, { name: JSON.stringify(this.name) }));\n        const frames = [this.#frame];\n        for (const frame of frames) {\n            frames.push(...frame.childFrames());\n        }\n        await Promise.all(frames.map(async (frame) => {\n            const realm = this.#isolate ? frame.isolatedRealm() : frame.mainRealm();\n            try {\n                const [script] = await Promise.all([\n                    frame.browsingContext.addPreloadScript(functionDeclaration, {\n                        arguments: [channel],\n                        sandbox: realm.sandbox,\n                    }),\n                    realm.realm.callFunction(functionDeclaration, false, {\n                        arguments: [channel],\n                    }),\n                ]);\n                this.#scripts.push([frame, script]);\n            }\n            catch (error) {\n                // If it errors, the frame probably doesn't support call function. We\n                // fail gracefully.\n                debugError(error);\n            }\n        }));\n    }\n    get #connection() {\n        return this.#frame.page().browser().connection;\n    }\n    #handleMessage = async (params) => {\n        const env_1 = { stack: [], error: void 0, hasError: false };\n        try {\n            if (params.channel !== this.#channel) {\n                return;\n            }\n            const realm = this.#getRealm(params.source);\n            if (!realm) {\n                // Unrelated message.\n                return;\n            }\n            const dataHandle = __addDisposableResource(env_1, BidiJSHandle.from(params.data, realm), false);\n            const stack = __addDisposableResource(env_1, new DisposableStack(), false);\n            const args = [];\n            let result;\n            try {\n                const env_2 = { stack: [], error: void 0, hasError: false };\n                try {\n                    const argsHandle = __addDisposableResource(env_2, await dataHandle.evaluateHandle(([, , args]) => {\n                        return args;\n                    }), false);\n                    for (const [index, handle] of await argsHandle.getProperties()) {\n                        stack.use(handle);\n                        // Element handles are passed as is.\n                        if (handle instanceof BidiElementHandle) {\n                            args[+index] = handle;\n                            stack.use(handle);\n                            continue;\n                        }\n                        // Everything else is passed as the JS value.\n                        args[+index] = handle.jsonValue();\n                    }\n                    result = await this.#apply(...(await Promise.all(args)));\n                }\n                catch (e_1) {\n                    env_2.error = e_1;\n                    env_2.hasError = true;\n                }\n                finally {\n                    __disposeResources(env_2);\n                }\n            }\n            catch (error) {\n                try {\n                    if (error instanceof Error) {\n                        await dataHandle.evaluate(([, reject], name, message, stack) => {\n                            const error = new Error(message);\n                            error.name = name;\n                            if (stack) {\n                                error.stack = stack;\n                            }\n                            reject(error);\n                        }, error.name, error.message, error.stack);\n                    }\n                    else {\n                        await dataHandle.evaluate(([, reject], error) => {\n                            reject(error);\n                        }, error);\n                    }\n                }\n                catch (error) {\n                    debugError(error);\n                }\n                return;\n            }\n            try {\n                await dataHandle.evaluate(([resolve], result) => {\n                    resolve(result);\n                }, result);\n            }\n            catch (error) {\n                debugError(error);\n            }\n        }\n        catch (e_2) {\n            env_1.error = e_2;\n            env_1.hasError = true;\n        }\n        finally {\n            __disposeResources(env_1);\n        }\n    };\n    #getRealm(source) {\n        const frame = this.#findFrame(source.context);\n        if (!frame) {\n            // Unrelated message.\n            return;\n        }\n        return frame.realm(source.realm);\n    }\n    #findFrame(id) {\n        const frames = [this.#frame];\n        for (const frame of frames) {\n            if (frame._id === id) {\n                return frame;\n            }\n            frames.push(...frame.childFrames());\n        }\n        return;\n    }\n    [Symbol.dispose]() {\n        void this[Symbol.asyncDispose]().catch(debugError);\n    }\n    async [Symbol.asyncDispose]() {\n        this.#disposables.dispose();\n        await Promise.all(this.#scripts.map(async ([frame, script]) => {\n            const realm = this.#isolate ? frame.isolatedRealm() : frame.mainRealm();\n            try {\n                await Promise.all([\n                    realm.evaluate(name => {\n                        delete globalThis[name];\n                    }, this.name),\n                    ...frame.childFrames().map(childFrame => {\n                        return childFrame.evaluate(name => {\n                            delete globalThis[name];\n                        }, this.name);\n                    }),\n                    frame.browsingContext.removePreloadScript(script),\n                ]);\n            }\n            catch (error) {\n                debugError(error);\n            }\n        }));\n    }\n}\n//# sourceMappingURL=ExposedFunction.js.map","var __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nimport { HTTPResponse } from '../api/HTTPResponse.js';\nimport { UnsupportedOperation } from '../common/Errors.js';\nimport { SecurityDetails } from '../common/SecurityDetails.js';\nimport { invokeAtMostOnceForArguments } from '../util/decorators.js';\n/**\n * @internal\n */\nlet BidiHTTPResponse = (() => {\n    let _classSuper = HTTPResponse;\n    let _instanceExtraInitializers = [];\n    let _remoteAddress_decorators;\n    return class BidiHTTPResponse extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            _remoteAddress_decorators = [invokeAtMostOnceForArguments];\n            __esDecorate(this, null, _remoteAddress_decorators, { kind: \"method\", name: \"remoteAddress\", static: false, private: false, access: { has: obj => \"remoteAddress\" in obj, get: obj => obj.remoteAddress }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static from(data, request, cdpSupported) {\n            const response = new BidiHTTPResponse(data, request, cdpSupported);\n            response.#initialize();\n            return response;\n        }\n        #data = __runInitializers(this, _instanceExtraInitializers);\n        #request;\n        #securityDetails;\n        #cdpSupported = false;\n        constructor(data, request, cdpSupported) {\n            super();\n            this.#data = data;\n            this.#request = request;\n            this.#cdpSupported = cdpSupported;\n            // @ts-expect-error non-standard property.\n            const securityDetails = data['goog:securityDetails'];\n            if (cdpSupported && securityDetails) {\n                this.#securityDetails = new SecurityDetails(securityDetails);\n            }\n        }\n        #initialize() {\n            if (this.#data.fromCache) {\n                this.#request._fromMemoryCache = true;\n                this.#request\n                    .frame()\n                    ?.page()\n                    .trustedEmitter.emit(\"requestservedfromcache\" /* PageEvent.RequestServedFromCache */, this.#request);\n            }\n            this.#request.frame()?.page().trustedEmitter.emit(\"response\" /* PageEvent.Response */, this);\n        }\n        remoteAddress() {\n            return {\n                ip: '',\n                port: -1,\n            };\n        }\n        url() {\n            return this.#data.url;\n        }\n        status() {\n            return this.#data.status;\n        }\n        statusText() {\n            return this.#data.statusText;\n        }\n        headers() {\n            const headers = {};\n            for (const header of this.#data.headers) {\n                // TODO: How to handle Binary Headers\n                // https://w3c.github.io/webdriver-bidi/#type-network-Header\n                if (header.value.type === 'string') {\n                    headers[header.name.toLowerCase()] = header.value.value;\n                }\n            }\n            return headers;\n        }\n        request() {\n            return this.#request;\n        }\n        fromCache() {\n            return this.#data.fromCache;\n        }\n        timing() {\n            const bidiTiming = this.#request.timing();\n            return {\n                requestTime: bidiTiming.requestTime,\n                proxyStart: -1,\n                proxyEnd: -1,\n                dnsStart: bidiTiming.dnsStart,\n                dnsEnd: bidiTiming.dnsEnd,\n                connectStart: bidiTiming.connectStart,\n                connectEnd: bidiTiming.connectEnd,\n                sslStart: bidiTiming.tlsStart,\n                sslEnd: -1,\n                workerStart: -1,\n                workerReady: -1,\n                workerFetchStart: -1,\n                workerRespondWithSettled: -1,\n                workerRouterEvaluationStart: -1,\n                workerCacheLookupStart: -1,\n                sendStart: bidiTiming.requestStart,\n                sendEnd: -1,\n                pushStart: -1,\n                pushEnd: -1,\n                receiveHeadersStart: bidiTiming.responseStart,\n                receiveHeadersEnd: bidiTiming.responseEnd,\n            };\n        }\n        frame() {\n            return this.#request.frame();\n        }\n        fromServiceWorker() {\n            return false;\n        }\n        securityDetails() {\n            if (!this.#cdpSupported) {\n                throw new UnsupportedOperation();\n            }\n            return this.#securityDetails ?? null;\n        }\n        async content() {\n            return await this.#request.getResponseContent();\n        }\n    };\n})();\nexport { BidiHTTPResponse };\n//# sourceMappingURL=HTTPResponse.js.map","var _a;\nimport { HTTPRequest, STATUS_TEXTS, handleError, InterceptResolutionAction, } from '../api/HTTPRequest.js';\nimport { UnsupportedOperation } from '../common/Errors.js';\nimport { stringToBase64 } from '../util/encoding.js';\nimport { BidiHTTPResponse } from './HTTPResponse.js';\nexport const requests = new WeakMap();\n/**\n * @internal\n */\nexport class BidiHTTPRequest extends HTTPRequest {\n    static from(bidiRequest, frame, isNetworkInterceptionEnabled, redirect) {\n        const request = new _a(bidiRequest, frame, isNetworkInterceptionEnabled, redirect);\n        request.#initialize();\n        return request;\n    }\n    #redirectChain;\n    #response = null;\n    id;\n    #frame;\n    #request;\n    constructor(request, frame, isNetworkInterceptionEnabled, redirect) {\n        super();\n        requests.set(request, this);\n        this.interception.enabled = isNetworkInterceptionEnabled;\n        this.#request = request;\n        this.#frame = frame;\n        this.#redirectChain = redirect ? redirect.#redirectChain : [];\n        this.id = request.id;\n    }\n    get client() {\n        return this.#frame.client;\n    }\n    #initialize() {\n        this.#request.on('redirect', request => {\n            const httpRequest = _a.from(request, this.#frame, this.interception.enabled, this);\n            this.#redirectChain.push(this);\n            request.once('success', () => {\n                this.#frame\n                    .page()\n                    .trustedEmitter.emit(\"requestfinished\" /* PageEvent.RequestFinished */, httpRequest);\n            });\n            request.once('error', () => {\n                this.#frame\n                    .page()\n                    .trustedEmitter.emit(\"requestfailed\" /* PageEvent.RequestFailed */, httpRequest);\n            });\n            void httpRequest.finalizeInterceptions();\n        });\n        this.#request.once('success', data => {\n            this.#response = BidiHTTPResponse.from(data, this, this.#frame.page().browser().cdpSupported);\n        });\n        this.#request.on('authenticate', this.#handleAuthentication);\n        this.#frame.page().trustedEmitter.emit(\"request\" /* PageEvent.Request */, this);\n        if (this.#hasInternalHeaderOverwrite) {\n            this.interception.handlers.push(async () => {\n                await this.continue({\n                    headers: this.headers(),\n                }, 0);\n            });\n        }\n    }\n    canBeIntercepted() {\n        return this.#request.isBlocked;\n    }\n    interceptResolutionState() {\n        if (!this.#request.isBlocked) {\n            return { action: InterceptResolutionAction.Disabled };\n        }\n        return super.interceptResolutionState();\n    }\n    url() {\n        return this.#request.url;\n    }\n    resourceType() {\n        if (!this.#frame.page().browser().cdpSupported) {\n            throw new UnsupportedOperation();\n        }\n        return (this.#request.resourceType || 'other').toLowerCase();\n    }\n    method() {\n        return this.#request.method;\n    }\n    postData() {\n        if (!this.#frame.page().browser().cdpSupported) {\n            throw new UnsupportedOperation();\n        }\n        return this.#request.postData;\n    }\n    hasPostData() {\n        return this.#request.hasPostData;\n    }\n    async fetchPostData() {\n        return await this.#request.fetchPostData();\n    }\n    get #hasInternalHeaderOverwrite() {\n        return Boolean(Object.keys(this.#extraHTTPHeaders).length);\n    }\n    get #extraHTTPHeaders() {\n        return this.#frame?.page()._extraHTTPHeaders ?? {};\n    }\n    headers() {\n        // Callers should not be allowed to mutate internal structure.\n        const headers = {};\n        for (const header of this.#request.headers) {\n            headers[header.name.toLowerCase()] = header.value.value;\n        }\n        return {\n            ...headers,\n            ...this.#extraHTTPHeaders,\n        };\n    }\n    response() {\n        return this.#response;\n    }\n    failure() {\n        if (this.#request.error === undefined) {\n            return null;\n        }\n        return { errorText: this.#request.error };\n    }\n    isNavigationRequest() {\n        return this.#request.navigation !== undefined;\n    }\n    initiator() {\n        return {\n            ...this.#request.initiator,\n            type: this.#request.initiator?.type ?? 'other',\n        };\n    }\n    redirectChain() {\n        return this.#redirectChain.slice();\n    }\n    frame() {\n        return this.#frame;\n    }\n    async continue(overrides, priority) {\n        return await super.continue({\n            headers: this.#hasInternalHeaderOverwrite ? this.headers() : undefined,\n            ...overrides,\n        }, priority);\n    }\n    async _continue(overrides = {}) {\n        const headers = getBidiHeaders(overrides.headers);\n        this.interception.handled = true;\n        return await this.#request\n            .continueRequest({\n            url: overrides.url,\n            method: overrides.method,\n            body: overrides.postData\n                ? {\n                    type: 'base64',\n                    value: stringToBase64(overrides.postData),\n                }\n                : undefined,\n            headers: headers.length > 0 ? headers : undefined,\n        })\n            .catch(error => {\n            this.interception.handled = false;\n            return handleError(error);\n        });\n    }\n    async _abort() {\n        this.interception.handled = true;\n        return await this.#request.failRequest().catch(error => {\n            this.interception.handled = false;\n            throw error;\n        });\n    }\n    async _respond(response, _priority) {\n        this.interception.handled = true;\n        let parsedBody;\n        if (response.body) {\n            parsedBody = HTTPRequest.getResponse(response.body);\n        }\n        const headers = getBidiHeaders(response.headers);\n        const hasContentLength = headers.some(header => {\n            return header.name === 'content-length';\n        });\n        if (response.contentType) {\n            headers.push({\n                name: 'content-type',\n                value: {\n                    type: 'string',\n                    value: response.contentType,\n                },\n            });\n        }\n        if (parsedBody?.contentLength && !hasContentLength) {\n            headers.push({\n                name: 'content-length',\n                value: {\n                    type: 'string',\n                    value: String(parsedBody.contentLength),\n                },\n            });\n        }\n        const status = response.status || 200;\n        return await this.#request\n            .provideResponse({\n            statusCode: status,\n            headers: headers.length > 0 ? headers : undefined,\n            reasonPhrase: STATUS_TEXTS[status],\n            body: parsedBody?.base64\n                ? {\n                    type: 'base64',\n                    value: parsedBody?.base64,\n                }\n                : undefined,\n        })\n            .catch(error => {\n            this.interception.handled = false;\n            throw error;\n        });\n    }\n    #authenticationHandled = false;\n    #handleAuthentication = async () => {\n        if (!this.#frame) {\n            return;\n        }\n        const credentials = this.#frame.page()._credentials;\n        if (credentials && !this.#authenticationHandled) {\n            this.#authenticationHandled = true;\n            void this.#request.continueWithAuth({\n                action: 'provideCredentials',\n                credentials: {\n                    type: 'password',\n                    username: credentials.username,\n                    password: credentials.password,\n                },\n            });\n        }\n        else {\n            void this.#request.continueWithAuth({\n                action: 'cancel',\n            });\n        }\n    };\n    timing() {\n        return this.#request.timing();\n    }\n    getResponseContent() {\n        return this.#request.getResponseContent();\n    }\n}\n_a = BidiHTTPRequest;\nfunction getBidiHeaders(rawHeaders) {\n    const headers = [];\n    for (const [name, value] of Object.entries(rawHeaders ?? [])) {\n        if (!Object.is(value, undefined)) {\n            const values = Array.isArray(value) ? value : [value];\n            for (const value of values) {\n                headers.push({\n                    name: name.toLowerCase(),\n                    value: {\n                        type: 'string',\n                        value: String(value),\n                    },\n                });\n            }\n        }\n    }\n    return headers;\n}\n//# sourceMappingURL=HTTPRequest.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { isDate, isPlainObject, isRegExp } from '../common/util.js';\n/**\n * @internal\n */\nclass UnserializableError extends Error {\n}\n/**\n * @internal\n */\nexport class BidiSerializer {\n    static serialize(arg) {\n        switch (typeof arg) {\n            case 'symbol':\n            case 'function':\n                throw new UnserializableError(`Unable to serializable ${typeof arg}`);\n            case 'object':\n                return this.#serializeObject(arg);\n            case 'undefined':\n                return {\n                    type: 'undefined',\n                };\n            case 'number':\n                return this.#serializeNumber(arg);\n            case 'bigint':\n                return {\n                    type: 'bigint',\n                    value: arg.toString(),\n                };\n            case 'string':\n                return {\n                    type: 'string',\n                    value: arg,\n                };\n            case 'boolean':\n                return {\n                    type: 'boolean',\n                    value: arg,\n                };\n        }\n    }\n    static #serializeNumber(arg) {\n        let value;\n        if (Object.is(arg, -0)) {\n            value = '-0';\n        }\n        else if (Object.is(arg, Infinity)) {\n            value = 'Infinity';\n        }\n        else if (Object.is(arg, -Infinity)) {\n            value = '-Infinity';\n        }\n        else if (Object.is(arg, NaN)) {\n            value = 'NaN';\n        }\n        else {\n            value = arg;\n        }\n        return {\n            type: 'number',\n            value,\n        };\n    }\n    static #serializeObject(arg) {\n        if (arg === null) {\n            return {\n                type: 'null',\n            };\n        }\n        else if (Array.isArray(arg)) {\n            const parsedArray = arg.map(subArg => {\n                return this.serialize(subArg);\n            });\n            return {\n                type: 'array',\n                value: parsedArray,\n            };\n        }\n        else if (isPlainObject(arg)) {\n            try {\n                JSON.stringify(arg);\n            }\n            catch (error) {\n                if (error instanceof TypeError &&\n                    error.message.startsWith('Converting circular structure to JSON')) {\n                    error.message += ' Recursive objects are not allowed.';\n                }\n                throw error;\n            }\n            const parsedObject = [];\n            for (const key in arg) {\n                parsedObject.push([this.serialize(key), this.serialize(arg[key])]);\n            }\n            return {\n                type: 'object',\n                value: parsedObject,\n            };\n        }\n        else if (isRegExp(arg)) {\n            return {\n                type: 'regexp',\n                value: {\n                    pattern: arg.source,\n                    flags: arg.flags,\n                },\n            };\n        }\n        else if (isDate(arg)) {\n            return {\n                type: 'date',\n                value: arg.toISOString(),\n            };\n        }\n        throw new UnserializableError('Custom object serialization not possible. Use plain objects instead.');\n    }\n}\n//# sourceMappingURL=Serializer.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { ProtocolError, TimeoutError } from '../common/Errors.js';\nimport { PuppeteerURL } from '../common/util.js';\nimport { BidiDeserializer } from './Deserializer.js';\n/**\n * @internal\n */\nexport function createEvaluationError(details) {\n    if (details.exception.type !== 'error') {\n        return BidiDeserializer.deserialize(details.exception);\n    }\n    const [name = '', ...parts] = details.text.split(': ');\n    const message = parts.join(': ');\n    const error = new Error(message);\n    error.name = name;\n    // The first line is this function which we ignore.\n    const stackLines = [];\n    if (details.stackTrace && stackLines.length < Error.stackTraceLimit) {\n        for (const frame of details.stackTrace.callFrames.reverse()) {\n            if (PuppeteerURL.isPuppeteerURL(frame.url) &&\n                frame.url !== PuppeteerURL.INTERNAL_URL) {\n                const url = PuppeteerURL.parse(frame.url);\n                stackLines.unshift(`    at ${frame.functionName || url.functionName} (${url.functionName} at ${url.siteString}, <anonymous>:${frame.lineNumber}:${frame.columnNumber})`);\n            }\n            else {\n                stackLines.push(`    at ${frame.functionName || '<anonymous>'} (${frame.url}:${frame.lineNumber}:${frame.columnNumber})`);\n            }\n            if (stackLines.length >= Error.stackTraceLimit) {\n                break;\n            }\n        }\n    }\n    error.stack = [details.text, ...stackLines].join('\\n');\n    return error;\n}\n/**\n * @internal\n */\nexport function rewriteNavigationError(message, ms) {\n    return error => {\n        if (error instanceof ProtocolError) {\n            error.message += ` at ${message}`;\n        }\n        else if (error instanceof TimeoutError) {\n            error.message = `Navigation timeout of ${ms} ms exceeded`;\n        }\n        throw error;\n    };\n}\n//# sourceMappingURL=util.js.map","var __addDisposableResource = (this && this.__addDisposableResource) || function (env, value, async) {\n    if (value !== null && value !== void 0) {\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n        var dispose, inner;\n        if (async) {\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n            dispose = value[Symbol.asyncDispose];\n        }\n        if (dispose === void 0) {\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n            dispose = value[Symbol.dispose];\n            if (async) inner = dispose;\n        }\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n        env.stack.push({ value: value, dispose: dispose, async: async });\n    }\n    else if (async) {\n        env.stack.push({ async: true });\n    }\n    return value;\n};\nvar __disposeResources = (this && this.__disposeResources) || (function (SuppressedError) {\n    return function (env) {\n        function fail(e) {\n            env.error = env.hasError ? new SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n            env.hasError = true;\n        }\n        var r, s = 0;\n        function next() {\n            while (r = env.stack.pop()) {\n                try {\n                    if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n                    if (r.dispose) {\n                        var result = r.dispose.call(r.value);\n                        if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n                    }\n                    else s |= 1;\n                }\n                catch (e) {\n                    fail(e);\n                }\n            }\n            if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n            if (env.hasError) throw env.error;\n        }\n        return next();\n    };\n})(typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n    var e = new Error(message);\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n});\nimport { Realm } from '../api/Realm.js';\nimport { ARIAQueryHandler } from '../common/AriaQueryHandler.js';\nimport { LazyArg } from '../common/LazyArg.js';\nimport { scriptInjector } from '../common/ScriptInjector.js';\nimport { debugError, getSourcePuppeteerURLIfAvailable, getSourceUrlComment, isString, PuppeteerURL, SOURCE_URL_REGEX, } from '../common/util.js';\nimport { AsyncIterableUtil } from '../util/AsyncIterableUtil.js';\nimport { stringifyFunction } from '../util/Function.js';\nimport { BidiDeserializer } from './Deserializer.js';\nimport { BidiElementHandle } from './ElementHandle.js';\nimport { ExposableFunction } from './ExposedFunction.js';\nimport { BidiJSHandle } from './JSHandle.js';\nimport { BidiSerializer } from './Serializer.js';\nimport { createEvaluationError } from './util.js';\n/**\n * @internal\n */\nexport class BidiRealm extends Realm {\n    realm;\n    constructor(realm, timeoutSettings) {\n        super(timeoutSettings);\n        this.realm = realm;\n    }\n    initialize() {\n        this.realm.on('destroyed', ({ reason }) => {\n            this.taskManager.terminateAll(new Error(reason));\n            this.dispose();\n        });\n        this.realm.on('updated', () => {\n            this.internalPuppeteerUtil = undefined;\n            void this.taskManager.rerunAll();\n        });\n    }\n    internalPuppeteerUtil;\n    get puppeteerUtil() {\n        const promise = Promise.resolve();\n        scriptInjector.inject(script => {\n            if (this.internalPuppeteerUtil) {\n                void this.internalPuppeteerUtil.then(handle => {\n                    void handle.dispose();\n                });\n            }\n            this.internalPuppeteerUtil = promise.then(() => {\n                return this.evaluateHandle(script);\n            });\n        }, !this.internalPuppeteerUtil);\n        return this.internalPuppeteerUtil;\n    }\n    async evaluateHandle(pageFunction, ...args) {\n        return await this.#evaluate(false, pageFunction, ...args);\n    }\n    async evaluate(pageFunction, ...args) {\n        return await this.#evaluate(true, pageFunction, ...args);\n    }\n    async #evaluate(returnByValue, pageFunction, ...args) {\n        const sourceUrlComment = getSourceUrlComment(getSourcePuppeteerURLIfAvailable(pageFunction)?.toString() ??\n            PuppeteerURL.INTERNAL_URL);\n        let responsePromise;\n        const resultOwnership = returnByValue\n            ? \"none\" /* Bidi.Script.ResultOwnership.None */\n            : \"root\" /* Bidi.Script.ResultOwnership.Root */;\n        const serializationOptions = returnByValue\n            ? {}\n            : {\n                maxObjectDepth: 0,\n                maxDomDepth: 0,\n            };\n        if (isString(pageFunction)) {\n            const expression = SOURCE_URL_REGEX.test(pageFunction)\n                ? pageFunction\n                : `${pageFunction}\\n${sourceUrlComment}\\n`;\n            responsePromise = this.realm.evaluate(expression, true, {\n                resultOwnership,\n                userActivation: true,\n                serializationOptions,\n            });\n        }\n        else {\n            let functionDeclaration = stringifyFunction(pageFunction);\n            functionDeclaration = SOURCE_URL_REGEX.test(functionDeclaration)\n                ? functionDeclaration\n                : `${functionDeclaration}\\n${sourceUrlComment}\\n`;\n            responsePromise = this.realm.callFunction(functionDeclaration, \n            /* awaitPromise= */ true, {\n                // LazyArgs are used only internally and should not affect the order\n                // evaluate calls for the public APIs.\n                arguments: args.some(arg => {\n                    return arg instanceof LazyArg;\n                })\n                    ? await Promise.all(args.map(arg => {\n                        return this.serializeAsync(arg);\n                    }))\n                    : args.map(arg => {\n                        return this.serialize(arg);\n                    }),\n                resultOwnership,\n                userActivation: true,\n                serializationOptions,\n            });\n        }\n        const result = await responsePromise;\n        if ('type' in result && result.type === 'exception') {\n            throw createEvaluationError(result.exceptionDetails);\n        }\n        if (returnByValue) {\n            return BidiDeserializer.deserialize(result.result);\n        }\n        return this.createHandle(result.result);\n    }\n    createHandle(result) {\n        if ((result.type === 'node' || result.type === 'window') &&\n            this instanceof BidiFrameRealm) {\n            return BidiElementHandle.from(result, this);\n        }\n        return BidiJSHandle.from(result, this);\n    }\n    async serializeAsync(arg) {\n        if (arg instanceof LazyArg) {\n            arg = await arg.get(this);\n        }\n        return this.serialize(arg);\n    }\n    serialize(arg) {\n        if (arg instanceof BidiJSHandle || arg instanceof BidiElementHandle) {\n            if (arg.realm !== this) {\n                if (!(arg.realm instanceof BidiFrameRealm) ||\n                    !(this instanceof BidiFrameRealm)) {\n                    throw new Error(\"Trying to evaluate JSHandle from different global types. Usually this means you're using a handle from a worker in a page or vice versa.\");\n                }\n                if (arg.realm.environment !== this.environment) {\n                    throw new Error(\"Trying to evaluate JSHandle from different frames. Usually this means you're using a handle from a page on a different page.\");\n                }\n            }\n            if (arg.disposed) {\n                throw new Error('JSHandle is disposed!');\n            }\n            return arg.remoteValue();\n        }\n        return BidiSerializer.serialize(arg);\n    }\n    async destroyHandles(handles) {\n        if (this.disposed) {\n            return;\n        }\n        const handleIds = handles\n            .map(({ id }) => {\n            return id;\n        })\n            .filter((id) => {\n            return id !== undefined;\n        });\n        if (handleIds.length === 0) {\n            return;\n        }\n        await this.realm.disown(handleIds).catch(error => {\n            // Exceptions might happen in case of a page been navigated or closed.\n            // Swallow these since they are harmless and we don't leak anything in this case.\n            debugError(error);\n        });\n    }\n    async adoptHandle(handle) {\n        return (await this.evaluateHandle(node => {\n            return node;\n        }, handle));\n    }\n    async transferHandle(handle) {\n        if (handle.realm === this) {\n            return handle;\n        }\n        const transferredHandle = this.adoptHandle(handle);\n        await handle.dispose();\n        return await transferredHandle;\n    }\n}\n/**\n * @internal\n */\nexport class BidiFrameRealm extends BidiRealm {\n    static from(realm, frame) {\n        const frameRealm = new BidiFrameRealm(realm, frame);\n        frameRealm.#initialize();\n        return frameRealm;\n    }\n    #frame;\n    constructor(realm, frame) {\n        super(realm, frame.timeoutSettings);\n        this.#frame = frame;\n    }\n    #initialize() {\n        super.initialize();\n        // This should run first.\n        this.realm.on('updated', () => {\n            this.environment.clearDocumentHandle();\n            this.#bindingsInstalled = false;\n        });\n    }\n    #bindingsInstalled = false;\n    get puppeteerUtil() {\n        let promise = Promise.resolve();\n        if (!this.#bindingsInstalled) {\n            promise = Promise.all([\n                ExposableFunction.from(this.environment, '__ariaQuerySelector', ARIAQueryHandler.queryOne, !!this.sandbox),\n                ExposableFunction.from(this.environment, '__ariaQuerySelectorAll', async (element, selector) => {\n                    const results = ARIAQueryHandler.queryAll(element, selector);\n                    return await element.realm.evaluateHandle((...elements) => {\n                        return elements;\n                    }, ...(await AsyncIterableUtil.collect(results)));\n                }, !!this.sandbox),\n            ]);\n            this.#bindingsInstalled = true;\n        }\n        return promise.then(() => {\n            return super.puppeteerUtil;\n        });\n    }\n    get sandbox() {\n        return this.realm.sandbox;\n    }\n    get environment() {\n        return this.#frame;\n    }\n    async adoptBackendNode(backendNodeId) {\n        const env_1 = { stack: [], error: void 0, hasError: false };\n        try {\n            const { object } = await this.#frame.client.send('DOM.resolveNode', {\n                backendNodeId,\n                executionContextId: await this.realm.resolveExecutionContextId(),\n            });\n            const handle = __addDisposableResource(env_1, BidiElementHandle.from({\n                handle: object.objectId,\n                type: 'node',\n            }, this), false);\n            // We need the sharedId, so we perform the following to obtain it.\n            return await handle.evaluateHandle(element => {\n                return element;\n            });\n        }\n        catch (e_1) {\n            env_1.error = e_1;\n            env_1.hasError = true;\n        }\n        finally {\n            __disposeResources(env_1);\n        }\n    }\n}\n/**\n * @internal\n */\nexport class BidiWorkerRealm extends BidiRealm {\n    static from(realm, worker) {\n        const workerRealm = new BidiWorkerRealm(realm, worker);\n        workerRealm.initialize();\n        return workerRealm;\n    }\n    #worker;\n    constructor(realm, frame) {\n        super(realm, frame.timeoutSettings);\n        this.#worker = frame;\n    }\n    get environment() {\n        return this.#worker;\n    }\n    async adoptBackendNode() {\n        throw new Error('Cannot adopt DOM nodes into a worker.');\n    }\n}\n//# sourceMappingURL=Realm.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { WebWorker } from '../api/WebWorker.js';\nimport { UnsupportedOperation } from '../common/Errors.js';\nimport { BidiWorkerRealm } from './Realm.js';\n/**\n * @internal\n */\nexport class BidiWebWorker extends WebWorker {\n    static from(frame, realm) {\n        const worker = new BidiWebWorker(frame, realm);\n        return worker;\n    }\n    #frame;\n    #realm;\n    constructor(frame, realm) {\n        super(realm.origin);\n        this.#frame = frame;\n        this.#realm = BidiWorkerRealm.from(realm, this);\n    }\n    get frame() {\n        return this.#frame;\n    }\n    mainRealm() {\n        return this.#realm;\n    }\n    get client() {\n        throw new UnsupportedOperation();\n    }\n}\n//# sourceMappingURL=WebWorker.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nvar __setFunctionName = (this && this.__setFunctionName) || function (f, name, prefix) {\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\nimport { combineLatest, defer, delayWhen, filter, first, firstValueFrom, map, of, race, raceWith, switchMap, } from '../../third_party/rxjs/rxjs.js';\nimport { Frame, throwIfDetached, } from '../api/Frame.js';\nimport { Accessibility } from '../cdp/Accessibility.js';\nimport { ConsoleMessage, } from '../common/ConsoleMessage.js';\nimport { TargetCloseError, UnsupportedOperation } from '../common/Errors.js';\nimport { debugError, fromAbortSignal, fromEmitterEvent, timeout, } from '../common/util.js';\nimport { isErrorLike } from '../util/ErrorLike.js';\nimport { BidiCdpSession } from './CDPSession.js';\nimport { BidiDeserializer } from './Deserializer.js';\nimport { BidiDialog } from './Dialog.js';\nimport { ExposableFunction } from './ExposedFunction.js';\nimport { BidiHTTPRequest, requests } from './HTTPRequest.js';\nimport { BidiJSHandle } from './JSHandle.js';\nimport { BidiFrameRealm } from './Realm.js';\nimport { rewriteNavigationError } from './util.js';\nimport { BidiWebWorker } from './WebWorker.js';\n// TODO: Remove this and map CDP the correct method.\n// Requires breaking change.\nfunction convertConsoleMessageLevel(method) {\n    switch (method) {\n        case 'group':\n            return 'startGroup';\n        case 'groupCollapsed':\n            return 'startGroupCollapsed';\n        case 'groupEnd':\n            return 'endGroup';\n        default:\n            return method;\n    }\n}\nlet BidiFrame = (() => {\n    var _a;\n    let _classSuper = Frame;\n    let _instanceExtraInitializers = [];\n    let _goto_decorators;\n    let _setContent_decorators;\n    let _waitForNavigation_decorators;\n    let _private_waitForLoad$_decorators;\n    let _private_waitForLoad$_descriptor;\n    let _private_waitForNetworkIdle$_decorators;\n    let _private_waitForNetworkIdle$_descriptor;\n    let _setFiles_decorators;\n    let _locateNodes_decorators;\n    return class BidiFrame extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            _goto_decorators = [throwIfDetached];\n            _setContent_decorators = [throwIfDetached];\n            _waitForNavigation_decorators = [throwIfDetached];\n            _private_waitForLoad$_decorators = [throwIfDetached];\n            _private_waitForNetworkIdle$_decorators = [throwIfDetached];\n            _setFiles_decorators = [throwIfDetached];\n            _locateNodes_decorators = [throwIfDetached];\n            __esDecorate(this, null, _goto_decorators, { kind: \"method\", name: \"goto\", static: false, private: false, access: { has: obj => \"goto\" in obj, get: obj => obj.goto }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setContent_decorators, { kind: \"method\", name: \"setContent\", static: false, private: false, access: { has: obj => \"setContent\" in obj, get: obj => obj.setContent }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _waitForNavigation_decorators, { kind: \"method\", name: \"waitForNavigation\", static: false, private: false, access: { has: obj => \"waitForNavigation\" in obj, get: obj => obj.waitForNavigation }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, _private_waitForLoad$_descriptor = { value: __setFunctionName(function (options = {}) {\n                    let { waitUntil = 'load' } = options;\n                    const { timeout: ms = this.timeoutSettings.navigationTimeout() } = options;\n                    if (!Array.isArray(waitUntil)) {\n                        waitUntil = [waitUntil];\n                    }\n                    const events = new Set();\n                    for (const lifecycleEvent of waitUntil) {\n                        switch (lifecycleEvent) {\n                            case 'load': {\n                                events.add('load');\n                                break;\n                            }\n                            case 'domcontentloaded': {\n                                events.add('DOMContentLoaded');\n                                break;\n                            }\n                        }\n                    }\n                    if (events.size === 0) {\n                        return of(undefined);\n                    }\n                    return combineLatest([...events].map(event => {\n                        return fromEmitterEvent(this.browsingContext, event);\n                    })).pipe(map(() => { }), first(), raceWith(timeout(ms), this.#detached$().pipe(map(() => {\n                        throw new Error('Frame detached.');\n                    }))));\n                }, \"#waitForLoad$\") }, _private_waitForLoad$_decorators, { kind: \"method\", name: \"#waitForLoad$\", static: false, private: true, access: { has: obj => #waitForLoad$ in obj, get: obj => obj.#waitForLoad$ }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, _private_waitForNetworkIdle$_descriptor = { value: __setFunctionName(function (options = {}) {\n                    let { waitUntil = 'load' } = options;\n                    if (!Array.isArray(waitUntil)) {\n                        waitUntil = [waitUntil];\n                    }\n                    let concurrency = Infinity;\n                    for (const event of waitUntil) {\n                        switch (event) {\n                            case 'networkidle0': {\n                                concurrency = Math.min(0, concurrency);\n                                break;\n                            }\n                            case 'networkidle2': {\n                                concurrency = Math.min(2, concurrency);\n                                break;\n                            }\n                        }\n                    }\n                    if (concurrency === Infinity) {\n                        return of(undefined);\n                    }\n                    return this.page().waitForNetworkIdle$({\n                        idleTime: 500,\n                        timeout: options.timeout ?? this.timeoutSettings.timeout(),\n                        concurrency,\n                    });\n                }, \"#waitForNetworkIdle$\") }, _private_waitForNetworkIdle$_decorators, { kind: \"method\", name: \"#waitForNetworkIdle$\", static: false, private: true, access: { has: obj => #waitForNetworkIdle$ in obj, get: obj => obj.#waitForNetworkIdle$ }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _setFiles_decorators, { kind: \"method\", name: \"setFiles\", static: false, private: false, access: { has: obj => \"setFiles\" in obj, get: obj => obj.setFiles }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _locateNodes_decorators, { kind: \"method\", name: \"locateNodes\", static: false, private: false, access: { has: obj => \"locateNodes\" in obj, get: obj => obj.locateNodes }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static from(parent, browsingContext) {\n            const frame = new BidiFrame(parent, browsingContext);\n            frame.#initialize();\n            return frame;\n        }\n        #parent = __runInitializers(this, _instanceExtraInitializers);\n        browsingContext;\n        #frames = new WeakMap();\n        realms;\n        _id;\n        client;\n        accessibility;\n        constructor(parent, browsingContext) {\n            super();\n            this.#parent = parent;\n            this.browsingContext = browsingContext;\n            this._id = browsingContext.id;\n            this.client = new BidiCdpSession(this);\n            this.realms = {\n                default: BidiFrameRealm.from(this.browsingContext.defaultRealm, this),\n                internal: BidiFrameRealm.from(this.browsingContext.createWindowRealm(`__puppeteer_internal_${Math.ceil(Math.random() * 10000)}`), this),\n            };\n            this.accessibility = new Accessibility(this.realms.default, this._id);\n        }\n        #initialize() {\n            for (const browsingContext of this.browsingContext.children) {\n                this.#createFrameTarget(browsingContext);\n            }\n            this.browsingContext.on('browsingcontext', ({ browsingContext }) => {\n                this.#createFrameTarget(browsingContext);\n            });\n            this.browsingContext.on('closed', () => {\n                for (const session of BidiCdpSession.sessions.values()) {\n                    if (session.frame === this) {\n                        session.onClose();\n                    }\n                }\n                this.page().trustedEmitter.emit(\"framedetached\" /* PageEvent.FrameDetached */, this);\n            });\n            this.browsingContext.on('request', ({ request }) => {\n                const httpRequest = BidiHTTPRequest.from(request, this, this.page().isNetworkInterceptionEnabled);\n                request.once('success', () => {\n                    this.page().trustedEmitter.emit(\"requestfinished\" /* PageEvent.RequestFinished */, httpRequest);\n                });\n                request.once('error', () => {\n                    this.page().trustedEmitter.emit(\"requestfailed\" /* PageEvent.RequestFailed */, httpRequest);\n                });\n                void httpRequest.finalizeInterceptions();\n            });\n            this.browsingContext.on('navigation', ({ navigation }) => {\n                navigation.once('fragment', () => {\n                    this.page().trustedEmitter.emit(\"framenavigated\" /* PageEvent.FrameNavigated */, this);\n                });\n            });\n            this.browsingContext.on('load', () => {\n                this.page().trustedEmitter.emit(\"load\" /* PageEvent.Load */, undefined);\n            });\n            this.browsingContext.on('DOMContentLoaded', () => {\n                this._hasStartedLoading = true;\n                this.page().trustedEmitter.emit(\"domcontentloaded\" /* PageEvent.DOMContentLoaded */, undefined);\n                this.page().trustedEmitter.emit(\"framenavigated\" /* PageEvent.FrameNavigated */, this);\n            });\n            this.browsingContext.on('userprompt', ({ userPrompt }) => {\n                this.page().trustedEmitter.emit(\"dialog\" /* PageEvent.Dialog */, BidiDialog.from(userPrompt));\n            });\n            this.browsingContext.on('log', ({ entry }) => {\n                if (this._id !== entry.source.context) {\n                    return;\n                }\n                if (isConsoleLogEntry(entry)) {\n                    const args = entry.args.map(arg => {\n                        return this.mainRealm().createHandle(arg);\n                    });\n                    const text = args\n                        .reduce((value, arg) => {\n                        const parsedValue = arg instanceof BidiJSHandle && arg.isPrimitiveValue\n                            ? BidiDeserializer.deserialize(arg.remoteValue())\n                            : arg.toString();\n                        return `${value} ${parsedValue}`;\n                    }, '')\n                        .slice(1);\n                    this.page().trustedEmitter.emit(\"console\" /* PageEvent.Console */, new ConsoleMessage(convertConsoleMessageLevel(entry.method), text, args, getStackTraceLocations(entry.stackTrace), this));\n                }\n                else if (isJavaScriptLogEntry(entry)) {\n                    const error = new Error(entry.text ?? '');\n                    const messageHeight = error.message.split('\\n').length;\n                    const messageLines = error.stack.split('\\n').splice(0, messageHeight);\n                    const stackLines = [];\n                    if (entry.stackTrace) {\n                        for (const frame of entry.stackTrace.callFrames) {\n                            // Note we need to add `1` because the values are 0-indexed.\n                            stackLines.push(`    at ${frame.functionName || '<anonymous>'} (${frame.url}:${frame.lineNumber + 1}:${frame.columnNumber + 1})`);\n                            if (stackLines.length >= Error.stackTraceLimit) {\n                                break;\n                            }\n                        }\n                    }\n                    error.stack = [...messageLines, ...stackLines].join('\\n');\n                    this.page().trustedEmitter.emit(\"pageerror\" /* PageEvent.PageError */, error);\n                }\n                else {\n                    debugError(`Unhandled LogEntry with type \"${entry.type}\", text \"${entry.text}\" and level \"${entry.level}\"`);\n                }\n            });\n            this.browsingContext.on('worker', ({ realm }) => {\n                const worker = BidiWebWorker.from(this, realm);\n                realm.on('destroyed', () => {\n                    this.page().trustedEmitter.emit(\"workerdestroyed\" /* PageEvent.WorkerDestroyed */, worker);\n                });\n                this.page().trustedEmitter.emit(\"workercreated\" /* PageEvent.WorkerCreated */, worker);\n            });\n        }\n        #createFrameTarget(browsingContext) {\n            const frame = BidiFrame.from(this, browsingContext);\n            this.#frames.set(browsingContext, frame);\n            this.page().trustedEmitter.emit(\"frameattached\" /* PageEvent.FrameAttached */, frame);\n            browsingContext.on('closed', () => {\n                this.#frames.delete(browsingContext);\n            });\n            return frame;\n        }\n        get timeoutSettings() {\n            return this.page()._timeoutSettings;\n        }\n        mainRealm() {\n            return this.realms.default;\n        }\n        isolatedRealm() {\n            return this.realms.internal;\n        }\n        realm(id) {\n            for (const realm of Object.values(this.realms)) {\n                if (realm.realm.id === id) {\n                    return realm;\n                }\n            }\n            return;\n        }\n        page() {\n            let parent = this.#parent;\n            while (parent instanceof BidiFrame) {\n                parent = parent.#parent;\n            }\n            return parent;\n        }\n        url() {\n            return this.browsingContext.url;\n        }\n        parentFrame() {\n            if (this.#parent instanceof BidiFrame) {\n                return this.#parent;\n            }\n            return null;\n        }\n        childFrames() {\n            return [...this.browsingContext.children].map(child => {\n                return this.#frames.get(child);\n            });\n        }\n        #detached$() {\n            return defer(() => {\n                if (this.detached) {\n                    return of(this);\n                }\n                return fromEmitterEvent(this.page().trustedEmitter, \"framedetached\" /* PageEvent.FrameDetached */).pipe(filter(detachedFrame => {\n                    return detachedFrame === this;\n                }));\n            });\n        }\n        async goto(url, options = {}) {\n            const [response] = await Promise.all([\n                this.waitForNavigation(options),\n                // Some implementations currently only report errors when the\n                // readiness=interactive.\n                //\n                // Related: https://bugzilla.mozilla.org/show_bug.cgi?id=1846601\n                this.browsingContext\n                    .navigate(url, \"interactive\" /* Bidi.BrowsingContext.ReadinessState.Interactive */)\n                    .catch(error => {\n                    if (isErrorLike(error) &&\n                        error.message.includes('net::ERR_HTTP_RESPONSE_CODE_FAILURE')) {\n                        return;\n                    }\n                    if (error.message.includes('navigation canceled')) {\n                        return;\n                    }\n                    if (error.message.includes('Navigation was aborted by another navigation')) {\n                        return;\n                    }\n                    throw error;\n                }),\n            ]).catch(rewriteNavigationError(url, options.timeout ?? this.timeoutSettings.navigationTimeout()));\n            return response;\n        }\n        async setContent(html, options = {}) {\n            await Promise.all([\n                this.setFrameContent(html),\n                firstValueFrom(combineLatest([\n                    this.#waitForLoad$(options),\n                    this.#waitForNetworkIdle$(options),\n                ])),\n            ]);\n        }\n        async waitForNavigation(options = {}) {\n            const { timeout: ms = this.timeoutSettings.navigationTimeout(), signal } = options;\n            const frames = this.childFrames().map(frame => {\n                return frame.#detached$();\n            });\n            return await firstValueFrom(combineLatest([\n                race(fromEmitterEvent(this.browsingContext, 'navigation'), fromEmitterEvent(this.browsingContext, 'historyUpdated').pipe(map(() => {\n                    return { navigation: null };\n                })))\n                    .pipe(first())\n                    .pipe(switchMap(({ navigation }) => {\n                    if (navigation === null) {\n                        return of(null);\n                    }\n                    return this.#waitForLoad$(options).pipe(delayWhen(() => {\n                        if (frames.length === 0) {\n                            return of(undefined);\n                        }\n                        return combineLatest(frames);\n                    }), raceWith(fromEmitterEvent(navigation, 'fragment'), fromEmitterEvent(navigation, 'failed'), fromEmitterEvent(navigation, 'aborted')), switchMap(() => {\n                        if (navigation.request) {\n                            function requestFinished$(request) {\n                                if (navigation === null) {\n                                    return of(null);\n                                }\n                                // Reduces flakiness if the response events arrive after\n                                // the load event.\n                                // Usually, the response or error is already there at this point.\n                                if (request.response || request.error) {\n                                    return of(navigation);\n                                }\n                                if (request.redirect) {\n                                    return requestFinished$(request.redirect);\n                                }\n                                return fromEmitterEvent(request, 'success')\n                                    .pipe(raceWith(fromEmitterEvent(request, 'error')), raceWith(fromEmitterEvent(request, 'redirect')))\n                                    .pipe(switchMap(() => {\n                                    return requestFinished$(request);\n                                }));\n                            }\n                            return requestFinished$(navigation.request);\n                        }\n                        return of(navigation);\n                    }));\n                })),\n                this.#waitForNetworkIdle$(options),\n            ]).pipe(map(([navigation]) => {\n                if (!navigation) {\n                    return null;\n                }\n                const request = navigation.request;\n                if (!request) {\n                    return null;\n                }\n                const lastRequest = request.lastRedirect ?? request;\n                const httpRequest = requests.get(lastRequest);\n                return httpRequest.response();\n            }), raceWith(timeout(ms), fromAbortSignal(signal), this.#detached$().pipe(map(() => {\n                throw new TargetCloseError('Frame detached.');\n            })))));\n        }\n        waitForDevicePrompt() {\n            throw new UnsupportedOperation();\n        }\n        get detached() {\n            return this.browsingContext.closed;\n        }\n        #exposedFunctions = new Map();\n        async exposeFunction(name, apply) {\n            if (this.#exposedFunctions.has(name)) {\n                throw new Error(`Failed to add page binding with name ${name}: globalThis['${name}'] already exists!`);\n            }\n            const exposable = await ExposableFunction.from(this, name, apply);\n            this.#exposedFunctions.set(name, exposable);\n        }\n        async removeExposedFunction(name) {\n            const exposedFunction = this.#exposedFunctions.get(name);\n            if (!exposedFunction) {\n                throw new Error(`Failed to remove page binding with name ${name}: window['${name}'] does not exists!`);\n            }\n            this.#exposedFunctions.delete(name);\n            await exposedFunction[Symbol.asyncDispose]();\n        }\n        async createCDPSession() {\n            if (!this.page().browser().cdpSupported) {\n                throw new UnsupportedOperation();\n            }\n            const cdpConnection = this.page().browser().cdpConnection;\n            return await cdpConnection._createSession({ targetId: this._id });\n        }\n        get #waitForLoad$() { return _private_waitForLoad$_descriptor.value; }\n        get #waitForNetworkIdle$() { return _private_waitForNetworkIdle$_descriptor.value; }\n        async setFiles(element, files) {\n            await this.browsingContext.setFiles(\n            // SAFETY: ElementHandles are always remote references.\n            element.remoteValue(), files);\n        }\n        async locateNodes(element, locator) {\n            return await this.browsingContext.locateNodes(locator, \n            // SAFETY: ElementHandles are always remote references.\n            [element.remoteValue()]);\n        }\n    };\n})();\nexport { BidiFrame };\nfunction isConsoleLogEntry(event) {\n    return event.type === 'console';\n}\nfunction isJavaScriptLogEntry(event) {\n    return event.type === 'javascript';\n}\nfunction getStackTraceLocations(stackTrace) {\n    const stackTraceLocations = [];\n    if (stackTrace) {\n        for (const callFrame of stackTrace.callFrames) {\n            stackTraceLocations.push({\n                url: callFrame.url,\n                lineNumber: callFrame.lineNumber,\n                columnNumber: callFrame.columnNumber,\n            });\n        }\n    }\n    return stackTraceLocations;\n}\n//# sourceMappingURL=Frame.js.map","/**\n * @license\n * Copyright 2017 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { Keyboard, Mouse, MouseButton, Touchscreen, } from '../api/Input.js';\nimport { UnsupportedOperation } from '../common/Errors.js';\nimport { TouchError } from '../common/Errors.js';\nvar SourceActionsType;\n(function (SourceActionsType) {\n    SourceActionsType[\"None\"] = \"none\";\n    SourceActionsType[\"Key\"] = \"key\";\n    SourceActionsType[\"Pointer\"] = \"pointer\";\n    SourceActionsType[\"Wheel\"] = \"wheel\";\n})(SourceActionsType || (SourceActionsType = {}));\nvar ActionType;\n(function (ActionType) {\n    ActionType[\"Pause\"] = \"pause\";\n    ActionType[\"KeyDown\"] = \"keyDown\";\n    ActionType[\"KeyUp\"] = \"keyUp\";\n    ActionType[\"PointerUp\"] = \"pointerUp\";\n    ActionType[\"PointerDown\"] = \"pointerDown\";\n    ActionType[\"PointerMove\"] = \"pointerMove\";\n    ActionType[\"Scroll\"] = \"scroll\";\n})(ActionType || (ActionType = {}));\nconst getBidiKeyValue = (key) => {\n    switch (key) {\n        case '\\r':\n        case '\\n':\n            key = 'Enter';\n            break;\n    }\n    // Measures the number of code points rather than UTF-16 code units.\n    if ([...key].length === 1) {\n        return key;\n    }\n    switch (key) {\n        case 'Cancel':\n            return '\\uE001';\n        case 'Help':\n            return '\\uE002';\n        case 'Backspace':\n            return '\\uE003';\n        case 'Tab':\n            return '\\uE004';\n        case 'Clear':\n            return '\\uE005';\n        case 'Enter':\n            return '\\uE007';\n        case 'Shift':\n        case 'ShiftLeft':\n            return '\\uE008';\n        case 'Control':\n        case 'ControlLeft':\n            return '\\uE009';\n        case 'Alt':\n        case 'AltLeft':\n            return '\\uE00A';\n        case 'Pause':\n            return '\\uE00B';\n        case 'Escape':\n            return '\\uE00C';\n        case 'PageUp':\n            return '\\uE00E';\n        case 'PageDown':\n            return '\\uE00F';\n        case 'End':\n            return '\\uE010';\n        case 'Home':\n            return '\\uE011';\n        case 'ArrowLeft':\n            return '\\uE012';\n        case 'ArrowUp':\n            return '\\uE013';\n        case 'ArrowRight':\n            return '\\uE014';\n        case 'ArrowDown':\n            return '\\uE015';\n        case 'Insert':\n            return '\\uE016';\n        case 'Delete':\n            return '\\uE017';\n        case 'NumpadEqual':\n            return '\\uE019';\n        case 'Numpad0':\n            return '\\uE01A';\n        case 'Numpad1':\n            return '\\uE01B';\n        case 'Numpad2':\n            return '\\uE01C';\n        case 'Numpad3':\n            return '\\uE01D';\n        case 'Numpad4':\n            return '\\uE01E';\n        case 'Numpad5':\n            return '\\uE01F';\n        case 'Numpad6':\n            return '\\uE020';\n        case 'Numpad7':\n            return '\\uE021';\n        case 'Numpad8':\n            return '\\uE022';\n        case 'Numpad9':\n            return '\\uE023';\n        case 'NumpadMultiply':\n            return '\\uE024';\n        case 'NumpadAdd':\n            return '\\uE025';\n        case 'NumpadSubtract':\n            return '\\uE027';\n        case 'NumpadDecimal':\n            return '\\uE028';\n        case 'NumpadDivide':\n            return '\\uE029';\n        case 'F1':\n            return '\\uE031';\n        case 'F2':\n            return '\\uE032';\n        case 'F3':\n            return '\\uE033';\n        case 'F4':\n            return '\\uE034';\n        case 'F5':\n            return '\\uE035';\n        case 'F6':\n            return '\\uE036';\n        case 'F7':\n            return '\\uE037';\n        case 'F8':\n            return '\\uE038';\n        case 'F9':\n            return '\\uE039';\n        case 'F10':\n            return '\\uE03A';\n        case 'F11':\n            return '\\uE03B';\n        case 'F12':\n            return '\\uE03C';\n        case 'Meta':\n        case 'MetaLeft':\n            return '\\uE03D';\n        case 'ShiftRight':\n            return '\\uE050';\n        case 'ControlRight':\n            return '\\uE051';\n        case 'AltRight':\n            return '\\uE052';\n        case 'MetaRight':\n            return '\\uE053';\n        case 'Digit0':\n            return '0';\n        case 'Digit1':\n            return '1';\n        case 'Digit2':\n            return '2';\n        case 'Digit3':\n            return '3';\n        case 'Digit4':\n            return '4';\n        case 'Digit5':\n            return '5';\n        case 'Digit6':\n            return '6';\n        case 'Digit7':\n            return '7';\n        case 'Digit8':\n            return '8';\n        case 'Digit9':\n            return '9';\n        case 'KeyA':\n            return 'a';\n        case 'KeyB':\n            return 'b';\n        case 'KeyC':\n            return 'c';\n        case 'KeyD':\n            return 'd';\n        case 'KeyE':\n            return 'e';\n        case 'KeyF':\n            return 'f';\n        case 'KeyG':\n            return 'g';\n        case 'KeyH':\n            return 'h';\n        case 'KeyI':\n            return 'i';\n        case 'KeyJ':\n            return 'j';\n        case 'KeyK':\n            return 'k';\n        case 'KeyL':\n            return 'l';\n        case 'KeyM':\n            return 'm';\n        case 'KeyN':\n            return 'n';\n        case 'KeyO':\n            return 'o';\n        case 'KeyP':\n            return 'p';\n        case 'KeyQ':\n            return 'q';\n        case 'KeyR':\n            return 'r';\n        case 'KeyS':\n            return 's';\n        case 'KeyT':\n            return 't';\n        case 'KeyU':\n            return 'u';\n        case 'KeyV':\n            return 'v';\n        case 'KeyW':\n            return 'w';\n        case 'KeyX':\n            return 'x';\n        case 'KeyY':\n            return 'y';\n        case 'KeyZ':\n            return 'z';\n        case 'Semicolon':\n            return ';';\n        case 'Equal':\n            return '=';\n        case 'Comma':\n            return ',';\n        case 'Minus':\n            return '-';\n        case 'Period':\n            return '.';\n        case 'Slash':\n            return '/';\n        case 'Backquote':\n            return '`';\n        case 'BracketLeft':\n            return '[';\n        case 'Backslash':\n            return '\\\\';\n        case 'BracketRight':\n            return ']';\n        case 'Quote':\n            return '\"';\n        default:\n            throw new Error(`Unknown key: \"${key}\"`);\n    }\n};\n/**\n * @internal\n */\nexport class BidiKeyboard extends Keyboard {\n    #page;\n    constructor(page) {\n        super();\n        this.#page = page;\n    }\n    async down(key, _options) {\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Key,\n                id: \"__puppeteer_keyboard\" /* InputId.Keyboard */,\n                actions: [\n                    {\n                        type: ActionType.KeyDown,\n                        value: getBidiKeyValue(key),\n                    },\n                ],\n            },\n        ]);\n    }\n    async up(key) {\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Key,\n                id: \"__puppeteer_keyboard\" /* InputId.Keyboard */,\n                actions: [\n                    {\n                        type: ActionType.KeyUp,\n                        value: getBidiKeyValue(key),\n                    },\n                ],\n            },\n        ]);\n    }\n    async press(key, options = {}) {\n        const { delay = 0 } = options;\n        const actions = [\n            {\n                type: ActionType.KeyDown,\n                value: getBidiKeyValue(key),\n            },\n        ];\n        if (delay > 0) {\n            actions.push({\n                type: ActionType.Pause,\n                duration: delay,\n            });\n        }\n        actions.push({\n            type: ActionType.KeyUp,\n            value: getBidiKeyValue(key),\n        });\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Key,\n                id: \"__puppeteer_keyboard\" /* InputId.Keyboard */,\n                actions,\n            },\n        ]);\n    }\n    async type(text, options = {}) {\n        const { delay = 0 } = options;\n        // This spread separates the characters into code points rather than UTF-16\n        // code units.\n        const values = [...text].map(getBidiKeyValue);\n        const actions = [];\n        if (delay <= 0) {\n            for (const value of values) {\n                actions.push({\n                    type: ActionType.KeyDown,\n                    value,\n                }, {\n                    type: ActionType.KeyUp,\n                    value,\n                });\n            }\n        }\n        else {\n            for (const value of values) {\n                actions.push({\n                    type: ActionType.KeyDown,\n                    value,\n                }, {\n                    type: ActionType.Pause,\n                    duration: delay,\n                }, {\n                    type: ActionType.KeyUp,\n                    value,\n                });\n            }\n        }\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Key,\n                id: \"__puppeteer_keyboard\" /* InputId.Keyboard */,\n                actions,\n            },\n        ]);\n    }\n    async sendCharacter(char) {\n        // Measures the number of code points rather than UTF-16 code units.\n        if ([...char].length > 1) {\n            throw new Error('Cannot send more than 1 character.');\n        }\n        const frame = await this.#page.focusedFrame();\n        await frame.isolatedRealm().evaluate(async (char) => {\n            document.execCommand('insertText', false, char);\n        }, char);\n    }\n}\nconst getBidiButton = (button) => {\n    switch (button) {\n        case MouseButton.Left:\n            return 0;\n        case MouseButton.Middle:\n            return 1;\n        case MouseButton.Right:\n            return 2;\n        case MouseButton.Back:\n            return 3;\n        case MouseButton.Forward:\n            return 4;\n    }\n};\n/**\n * @internal\n */\nexport class BidiMouse extends Mouse {\n    #page;\n    #lastMovePoint = { x: 0, y: 0 };\n    constructor(page) {\n        super();\n        this.#page = page;\n    }\n    async reset() {\n        this.#lastMovePoint = { x: 0, y: 0 };\n        await this.#page.mainFrame().browsingContext.releaseActions();\n    }\n    async move(x, y, options = {}) {\n        const from = this.#lastMovePoint;\n        const to = {\n            x: Math.round(x),\n            y: Math.round(y),\n        };\n        const actions = [];\n        const steps = options.steps ?? 0;\n        for (let i = 0; i < steps; ++i) {\n            actions.push({\n                type: ActionType.PointerMove,\n                x: from.x + (to.x - from.x) * (i / steps),\n                y: from.y + (to.y - from.y) * (i / steps),\n                origin: options.origin,\n            });\n        }\n        actions.push({\n            type: ActionType.PointerMove,\n            ...to,\n            origin: options.origin,\n        });\n        // https://w3c.github.io/webdriver-bidi/#command-input-performActions:~:text=input.PointerMoveAction%20%3D%20%7B%0A%20%20type%3A%20%22pointerMove%22%2C%0A%20%20x%3A%20js%2Dint%2C\n        this.#lastMovePoint = to;\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Pointer,\n                id: \"__puppeteer_mouse\" /* InputId.Mouse */,\n                actions,\n            },\n        ]);\n    }\n    async down(options = {}) {\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Pointer,\n                id: \"__puppeteer_mouse\" /* InputId.Mouse */,\n                actions: [\n                    {\n                        type: ActionType.PointerDown,\n                        button: getBidiButton(options.button ?? MouseButton.Left),\n                    },\n                ],\n            },\n        ]);\n    }\n    async up(options = {}) {\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Pointer,\n                id: \"__puppeteer_mouse\" /* InputId.Mouse */,\n                actions: [\n                    {\n                        type: ActionType.PointerUp,\n                        button: getBidiButton(options.button ?? MouseButton.Left),\n                    },\n                ],\n            },\n        ]);\n    }\n    async click(x, y, options = {}) {\n        const actions = [\n            {\n                type: ActionType.PointerMove,\n                x: Math.round(x),\n                y: Math.round(y),\n                origin: options.origin,\n            },\n        ];\n        const pointerDownAction = {\n            type: ActionType.PointerDown,\n            button: getBidiButton(options.button ?? MouseButton.Left),\n        };\n        const pointerUpAction = {\n            type: ActionType.PointerUp,\n            button: pointerDownAction.button,\n        };\n        for (let i = 1; i < (options.count ?? 1); ++i) {\n            actions.push(pointerDownAction, pointerUpAction);\n        }\n        actions.push(pointerDownAction);\n        if (options.delay) {\n            actions.push({\n                type: ActionType.Pause,\n                duration: options.delay,\n            });\n        }\n        actions.push(pointerUpAction);\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Pointer,\n                id: \"__puppeteer_mouse\" /* InputId.Mouse */,\n                actions,\n            },\n        ]);\n    }\n    async wheel(options = {}) {\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Wheel,\n                id: \"__puppeteer_wheel\" /* InputId.Wheel */,\n                actions: [\n                    {\n                        type: ActionType.Scroll,\n                        ...(this.#lastMovePoint ?? {\n                            x: 0,\n                            y: 0,\n                        }),\n                        deltaX: options.deltaX ?? 0,\n                        deltaY: options.deltaY ?? 0,\n                    },\n                ],\n            },\n        ]);\n    }\n    drag() {\n        throw new UnsupportedOperation();\n    }\n    dragOver() {\n        throw new UnsupportedOperation();\n    }\n    dragEnter() {\n        throw new UnsupportedOperation();\n    }\n    drop() {\n        throw new UnsupportedOperation();\n    }\n    dragAndDrop() {\n        throw new UnsupportedOperation();\n    }\n}\n/**\n * @internal\n */\nclass BidiTouchHandle {\n    #started = false;\n    #x;\n    #y;\n    #bidiId;\n    #page;\n    #touchScreen;\n    #properties;\n    constructor(page, touchScreen, id, x, y, properties) {\n        this.#page = page;\n        this.#touchScreen = touchScreen;\n        this.#x = Math.round(x);\n        this.#y = Math.round(y);\n        this.#properties = properties;\n        this.#bidiId = `${\"__puppeteer_finger\" /* InputId.Finger */}_${id}`;\n    }\n    async start(options = {}) {\n        if (this.#started) {\n            throw new TouchError('Touch has already started');\n        }\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Pointer,\n                id: this.#bidiId,\n                parameters: {\n                    pointerType: \"touch\" /* Bidi.Input.PointerType.Touch */,\n                },\n                actions: [\n                    {\n                        type: ActionType.PointerMove,\n                        x: this.#x,\n                        y: this.#y,\n                        origin: options.origin,\n                    },\n                    {\n                        ...this.#properties,\n                        type: ActionType.PointerDown,\n                        button: 0,\n                    },\n                ],\n            },\n        ]);\n        this.#started = true;\n    }\n    move(x, y) {\n        const newX = Math.round(x);\n        const newY = Math.round(y);\n        return this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Pointer,\n                id: this.#bidiId,\n                parameters: {\n                    pointerType: \"touch\" /* Bidi.Input.PointerType.Touch */,\n                },\n                actions: [\n                    {\n                        ...this.#properties,\n                        type: ActionType.PointerMove,\n                        x: newX,\n                        y: newY,\n                    },\n                ],\n            },\n        ]);\n    }\n    async end() {\n        await this.#page.mainFrame().browsingContext.performActions([\n            {\n                type: SourceActionsType.Pointer,\n                id: this.#bidiId,\n                parameters: {\n                    pointerType: \"touch\" /* Bidi.Input.PointerType.Touch */,\n                },\n                actions: [\n                    {\n                        type: ActionType.PointerUp,\n                        button: 0,\n                    },\n                ],\n            },\n        ]);\n        this.#touchScreen.removeHandle(this);\n    }\n}\n/**\n * @internal\n */\nexport class BidiTouchscreen extends Touchscreen {\n    #page;\n    constructor(page) {\n        super();\n        this.#page = page;\n    }\n    async touchStart(x, y, options = {}) {\n        const id = this.idGenerator();\n        const properties = {\n            width: 0.5 * 2, // 2 times default touch radius.\n            height: 0.5 * 2, // 2 times default touch radius.\n            pressure: 0.5,\n            altitudeAngle: Math.PI / 2,\n        };\n        const touch = new BidiTouchHandle(this.#page, this, id, x, y, properties);\n        await touch.start(options);\n        this.touches.push(touch);\n        return touch;\n    }\n}\n//# sourceMappingURL=Input.js.map","/**\n * @license\n * Copyright 2022 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __addDisposableResource = (this && this.__addDisposableResource) || function (env, value, async) {\n    if (value !== null && value !== void 0) {\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n        var dispose, inner;\n        if (async) {\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n            dispose = value[Symbol.asyncDispose];\n        }\n        if (dispose === void 0) {\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n            dispose = value[Symbol.dispose];\n            if (async) inner = dispose;\n        }\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n        env.stack.push({ value: value, dispose: dispose, async: async });\n    }\n    else if (async) {\n        env.stack.push({ async: true });\n    }\n    return value;\n};\nvar __disposeResources = (this && this.__disposeResources) || (function (SuppressedError) {\n    return function (env) {\n        function fail(e) {\n            env.error = env.hasError ? new SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n            env.hasError = true;\n        }\n        var r, s = 0;\n        function next() {\n            while (r = env.stack.pop()) {\n                try {\n                    if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n                    if (r.dispose) {\n                        var result = r.dispose.call(r.value);\n                        if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n                    }\n                    else s |= 1;\n                }\n                catch (e) {\n                    fail(e);\n                }\n            }\n            if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n            if (env.hasError) throw env.error;\n        }\n        return next();\n    };\n})(typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n    var e = new Error(message);\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n});\nimport { firstValueFrom, from, raceWith } from '../../third_party/rxjs/rxjs.js';\nimport { Page, } from '../api/Page.js';\nimport { Coverage } from '../cdp/Coverage.js';\nimport { EmulationManager } from '../cdp/EmulationManager.js';\nimport { Tracing } from '../cdp/Tracing.js';\nimport { UnsupportedOperation } from '../common/Errors.js';\nimport { EventEmitter } from '../common/EventEmitter.js';\nimport { FileChooser } from '../common/FileChooser.js';\nimport { evaluationString, isString, parsePDFOptions, timeout, } from '../common/util.js';\nimport { assert } from '../util/assert.js';\nimport { bubble } from '../util/decorators.js';\nimport { Deferred } from '../util/Deferred.js';\nimport { stringToTypedArray } from '../util/encoding.js';\nimport { BidiElementHandle } from './ElementHandle.js';\nimport { BidiFrame } from './Frame.js';\nimport { BidiKeyboard, BidiMouse, BidiTouchscreen } from './Input.js';\nimport { rewriteNavigationError } from './util.js';\n/**\n * Implements Page using WebDriver BiDi.\n *\n * @internal\n */\nlet BidiPage = (() => {\n    let _classSuper = Page;\n    let _trustedEmitter_decorators;\n    let _trustedEmitter_initializers = [];\n    let _trustedEmitter_extraInitializers = [];\n    return class BidiPage extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            _trustedEmitter_decorators = [bubble()];\n            __esDecorate(this, null, _trustedEmitter_decorators, { kind: \"accessor\", name: \"trustedEmitter\", static: false, private: false, access: { has: obj => \"trustedEmitter\" in obj, get: obj => obj.trustedEmitter, set: (obj, value) => { obj.trustedEmitter = value; } }, metadata: _metadata }, _trustedEmitter_initializers, _trustedEmitter_extraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static from(browserContext, browsingContext) {\n            const page = new BidiPage(browserContext, browsingContext);\n            page.#initialize();\n            return page;\n        }\n        #trustedEmitter_accessor_storage = __runInitializers(this, _trustedEmitter_initializers, new EventEmitter());\n        get trustedEmitter() { return this.#trustedEmitter_accessor_storage; }\n        set trustedEmitter(value) { this.#trustedEmitter_accessor_storage = value; }\n        #browserContext = __runInitializers(this, _trustedEmitter_extraInitializers);\n        #frame;\n        #viewport = null;\n        #workers = new Set();\n        keyboard;\n        mouse;\n        touchscreen;\n        tracing;\n        coverage;\n        #cdpEmulationManager;\n        #emulatedNetworkConditions;\n        #fileChooserDeferreds = new Set();\n        _client() {\n            return this.#frame.client;\n        }\n        constructor(browserContext, browsingContext) {\n            super();\n            this.#browserContext = browserContext;\n            this.#frame = BidiFrame.from(this, browsingContext);\n            this.#cdpEmulationManager = new EmulationManager(this.#frame.client);\n            this.tracing = new Tracing(this.#frame.client);\n            this.coverage = new Coverage(this.#frame.client);\n            this.keyboard = new BidiKeyboard(this);\n            this.mouse = new BidiMouse(this);\n            this.touchscreen = new BidiTouchscreen(this);\n        }\n        #initialize() {\n            this.#frame.browsingContext.on('closed', () => {\n                this.trustedEmitter.emit(\"close\" /* PageEvent.Close */, undefined);\n                this.trustedEmitter.removeAllListeners();\n            });\n            this.trustedEmitter.on(\"workercreated\" /* PageEvent.WorkerCreated */, worker => {\n                this.#workers.add(worker);\n            });\n            this.trustedEmitter.on(\"workerdestroyed\" /* PageEvent.WorkerDestroyed */, worker => {\n                this.#workers.delete(worker);\n            });\n        }\n        /**\n         * @internal\n         */\n        #overrideNavigatorPropertiesPreloadScript;\n        async setUserAgent(userAgentOrOptions, userAgentMetadata) {\n            let userAgent;\n            let metadata;\n            let platform;\n            if (typeof userAgentOrOptions === 'string') {\n                userAgent = userAgentOrOptions;\n                metadata = userAgentMetadata;\n            }\n            else {\n                userAgent =\n                    userAgentOrOptions.userAgent ??\n                        (await this.#browserContext.browser().userAgent());\n                metadata = userAgentOrOptions.userAgentMetadata;\n                platform = userAgentOrOptions.platform;\n            }\n            if (!this.#browserContext.browser().cdpSupported &&\n                (metadata || platform)) {\n                throw new UnsupportedOperation('Current Browser does not support `userAgentMetadata` or `platform`');\n            }\n            else if (this.#browserContext.browser().cdpSupported &&\n                (metadata || platform)) {\n                return await this._client().send('Network.setUserAgentOverride', {\n                    userAgent: userAgent,\n                    userAgentMetadata: metadata,\n                    platform: platform,\n                });\n            }\n            const enable = userAgent !== '';\n            userAgent = userAgent ?? (await this.#browserContext.browser().userAgent());\n            await this.#frame.browsingContext.setUserAgent(enable ? userAgent : null);\n            const overrideNavigatorProperties = (platform) => {\n                if (platform) {\n                    Object.defineProperty(navigator, 'platform', {\n                        value: platform,\n                        configurable: true,\n                    });\n                }\n            };\n            const frames = [this.#frame];\n            for (const frame of frames) {\n                frames.push(...frame.childFrames());\n            }\n            if (this.#overrideNavigatorPropertiesPreloadScript) {\n                await this.removeScriptToEvaluateOnNewDocument(this.#overrideNavigatorPropertiesPreloadScript);\n            }\n            const [evaluateToken] = await Promise.all([\n                enable\n                    ? this.evaluateOnNewDocument(overrideNavigatorProperties, platform || undefined)\n                    : undefined,\n                // When we disable the UserAgent we want to\n                // evaluate the original value in all Browsing Contexts\n                ...frames.map(frame => {\n                    return frame.evaluate(overrideNavigatorProperties, platform || undefined);\n                }),\n            ]);\n            this.#overrideNavigatorPropertiesPreloadScript = evaluateToken?.identifier;\n        }\n        async setBypassCSP(enabled) {\n            // TODO: handle CDP-specific cases such as MPArch.\n            await this._client().send('Page.setBypassCSP', { enabled });\n        }\n        async queryObjects(prototypeHandle) {\n            assert(!prototypeHandle.disposed, 'Prototype JSHandle is disposed!');\n            assert(prototypeHandle.id, 'Prototype JSHandle must not be referencing primitive value');\n            const response = await this.#frame.client.send('Runtime.queryObjects', {\n                prototypeObjectId: prototypeHandle.id,\n            });\n            return this.#frame.mainRealm().createHandle({\n                type: 'array',\n                handle: response.objects.objectId,\n            });\n        }\n        browser() {\n            return this.browserContext().browser();\n        }\n        browserContext() {\n            return this.#browserContext;\n        }\n        mainFrame() {\n            return this.#frame;\n        }\n        resize(_params) {\n            throw new Error('Method not implemented for WebDriver BiDi yet.');\n        }\n        openDevTools() {\n            throw new Error('Method not implemented for WebDriver BiDi yet.');\n        }\n        async focusedFrame() {\n            const env_1 = { stack: [], error: void 0, hasError: false };\n            try {\n                const handle = __addDisposableResource(env_1, (await this.mainFrame()\n                    .isolatedRealm()\n                    .evaluateHandle(() => {\n                    let win = window;\n                    while (win.document.activeElement instanceof win.HTMLIFrameElement ||\n                        win.document.activeElement instanceof win.HTMLFrameElement) {\n                        if (win.document.activeElement.contentWindow === null) {\n                            break;\n                        }\n                        win = win.document.activeElement.contentWindow;\n                    }\n                    return win;\n                })), false);\n                const value = handle.remoteValue();\n                assert(value.type === 'window');\n                const frame = this.frames().find(frame => {\n                    return frame._id === value.value.context;\n                });\n                assert(frame);\n                return frame;\n            }\n            catch (e_1) {\n                env_1.error = e_1;\n                env_1.hasError = true;\n            }\n            finally {\n                __disposeResources(env_1);\n            }\n        }\n        frames() {\n            const frames = [this.#frame];\n            for (const frame of frames) {\n                frames.push(...frame.childFrames());\n            }\n            return frames;\n        }\n        isClosed() {\n            return this.#frame.detached;\n        }\n        async close(options) {\n            const env_2 = { stack: [], error: void 0, hasError: false };\n            try {\n                const _guard = __addDisposableResource(env_2, await this.#browserContext.waitForScreenshotOperations(), false);\n                try {\n                    await this.#frame.browsingContext.close(options?.runBeforeUnload);\n                }\n                catch {\n                    return;\n                }\n            }\n            catch (e_2) {\n                env_2.error = e_2;\n                env_2.hasError = true;\n            }\n            finally {\n                __disposeResources(env_2);\n            }\n        }\n        async reload(options = {}) {\n            const [response] = await Promise.all([\n                this.#frame.waitForNavigation(options),\n                this.#frame.browsingContext.reload({\n                    ignoreCache: options.ignoreCache ? true : undefined,\n                }),\n            ]).catch(rewriteNavigationError(this.url(), options.timeout ?? this._timeoutSettings.navigationTimeout()));\n            return response;\n        }\n        setDefaultNavigationTimeout(timeout) {\n            this._timeoutSettings.setDefaultNavigationTimeout(timeout);\n        }\n        setDefaultTimeout(timeout) {\n            this._timeoutSettings.setDefaultTimeout(timeout);\n        }\n        getDefaultTimeout() {\n            return this._timeoutSettings.timeout();\n        }\n        getDefaultNavigationTimeout() {\n            return this._timeoutSettings.navigationTimeout();\n        }\n        isJavaScriptEnabled() {\n            return this.#frame.browsingContext.isJavaScriptEnabled();\n        }\n        async setGeolocation(options) {\n            const { longitude, latitude, accuracy = 0 } = options;\n            if (longitude < -180 || longitude > 180) {\n                throw new Error(`Invalid longitude \"${longitude}\": precondition -180 <= LONGITUDE <= 180 failed.`);\n            }\n            if (latitude < -90 || latitude > 90) {\n                throw new Error(`Invalid latitude \"${latitude}\": precondition -90 <= LATITUDE <= 90 failed.`);\n            }\n            if (accuracy < 0) {\n                throw new Error(`Invalid accuracy \"${accuracy}\": precondition 0 <= ACCURACY failed.`);\n            }\n            return await this.#frame.browsingContext.setGeolocationOverride({\n                coordinates: {\n                    latitude: options.latitude,\n                    longitude: options.longitude,\n                    accuracy: options.accuracy,\n                },\n            });\n        }\n        async setJavaScriptEnabled(enabled) {\n            return await this.#frame.browsingContext.setJavaScriptEnabled(enabled);\n        }\n        async emulateMediaType(type) {\n            return await this.#cdpEmulationManager.emulateMediaType(type);\n        }\n        async emulateCPUThrottling(factor) {\n            return await this.#cdpEmulationManager.emulateCPUThrottling(factor);\n        }\n        async emulateMediaFeatures(features) {\n            return await this.#cdpEmulationManager.emulateMediaFeatures(features);\n        }\n        async emulateTimezone(timezoneId) {\n            return await this.#frame.browsingContext.setTimezoneOverride(timezoneId);\n        }\n        async emulateIdleState(overrides) {\n            return await this.#cdpEmulationManager.emulateIdleState(overrides);\n        }\n        async emulateVisionDeficiency(type) {\n            return await this.#cdpEmulationManager.emulateVisionDeficiency(type);\n        }\n        async setViewport(viewport) {\n            if (!this.browser().cdpSupported) {\n                const viewportSize = viewport?.width && viewport?.height\n                    ? {\n                        width: viewport.width,\n                        height: viewport.height,\n                    }\n                    : null;\n                const devicePixelRatio = viewport?.deviceScaleFactor\n                    ? viewport.deviceScaleFactor\n                    : null;\n                // If `viewport` is not set, remove screen orientation override.\n                const screenOrientation = viewport\n                    ? viewport.isLandscape\n                        ? {\n                            natural: \"landscape\" /* Bidi.Emulation.ScreenOrientationNatural.Landscape */,\n                            type: 'landscape-primary',\n                        }\n                        : {\n                            natural: \"portrait\" /* Bidi.Emulation.ScreenOrientationNatural.Portrait */,\n                            type: 'portrait-primary',\n                        }\n                    : null;\n                await Promise.all([\n                    this.#frame.browsingContext.setViewport({\n                        viewport: viewportSize,\n                        devicePixelRatio,\n                    }),\n                    this.#frame.browsingContext.setScreenOrientationOverride(screenOrientation),\n                ]);\n                this.#viewport = viewport;\n                return;\n            }\n            const needsReload = await this.#cdpEmulationManager.emulateViewport(viewport);\n            this.#viewport = viewport;\n            if (needsReload) {\n                await this.reload();\n            }\n        }\n        viewport() {\n            return this.#viewport;\n        }\n        async pdf(options = {}) {\n            const { timeout: ms = this._timeoutSettings.timeout(), path = undefined } = options;\n            const { printBackground: background, margin, landscape, width, height, pageRanges: ranges, scale, preferCSSPageSize, } = parsePDFOptions(options, 'cm');\n            const pageRanges = ranges ? ranges.split(', ') : [];\n            await firstValueFrom(from(this.mainFrame()\n                .isolatedRealm()\n                .evaluate(() => {\n                return document.fonts.ready;\n            })).pipe(raceWith(timeout(ms))));\n            const data = await firstValueFrom(from(this.#frame.browsingContext.print({\n                background,\n                margin,\n                orientation: landscape ? 'landscape' : 'portrait',\n                page: {\n                    width,\n                    height,\n                },\n                pageRanges,\n                scale,\n                shrinkToFit: !preferCSSPageSize,\n            })).pipe(raceWith(timeout(ms))));\n            const typedArray = stringToTypedArray(data, true);\n            await this._maybeWriteTypedArrayToFile(path, typedArray);\n            return typedArray;\n        }\n        async createPDFStream(options) {\n            const typedArray = await this.pdf(options);\n            return new ReadableStream({\n                start(controller) {\n                    controller.enqueue(typedArray);\n                    controller.close();\n                },\n            });\n        }\n        async _screenshot(options) {\n            const { clip, type, captureBeyondViewport, quality } = options;\n            if (options.omitBackground !== undefined && options.omitBackground) {\n                throw new UnsupportedOperation(`BiDi does not support 'omitBackground'.`);\n            }\n            if (options.optimizeForSpeed !== undefined && options.optimizeForSpeed) {\n                throw new UnsupportedOperation(`BiDi does not support 'optimizeForSpeed'.`);\n            }\n            if (options.fromSurface !== undefined && !options.fromSurface) {\n                throw new UnsupportedOperation(`BiDi does not support 'fromSurface'.`);\n            }\n            if (clip !== undefined && clip.scale !== undefined && clip.scale !== 1) {\n                throw new UnsupportedOperation(`BiDi does not support 'scale' in 'clip'.`);\n            }\n            let box;\n            if (clip) {\n                if (captureBeyondViewport) {\n                    box = clip;\n                }\n                else {\n                    // The clip is always with respect to the document coordinates, so we\n                    // need to convert this to viewport coordinates when we aren't capturing\n                    // beyond the viewport.\n                    const [pageLeft, pageTop] = await this.evaluate(() => {\n                        if (!window.visualViewport) {\n                            throw new Error('window.visualViewport is not supported.');\n                        }\n                        return [\n                            window.visualViewport.pageLeft,\n                            window.visualViewport.pageTop,\n                        ];\n                    });\n                    box = {\n                        ...clip,\n                        x: clip.x - pageLeft,\n                        y: clip.y - pageTop,\n                    };\n                }\n            }\n            const data = await this.#frame.browsingContext.captureScreenshot({\n                origin: captureBeyondViewport ? 'document' : 'viewport',\n                format: {\n                    type: `image/${type}`,\n                    ...(quality !== undefined ? { quality: quality / 100 } : {}),\n                },\n                ...(box ? { clip: { type: 'box', ...box } } : {}),\n            });\n            return data;\n        }\n        async createCDPSession() {\n            return await this.#frame.createCDPSession();\n        }\n        async bringToFront() {\n            await this.#frame.browsingContext.activate();\n        }\n        async evaluateOnNewDocument(pageFunction, ...args) {\n            const expression = evaluationExpression(pageFunction, ...args);\n            const script = await this.#frame.browsingContext.addPreloadScript(expression);\n            return { identifier: script };\n        }\n        async removeScriptToEvaluateOnNewDocument(id) {\n            await this.#frame.browsingContext.removePreloadScript(id);\n        }\n        async exposeFunction(name, pptrFunction) {\n            return await this.mainFrame().exposeFunction(name, 'default' in pptrFunction ? pptrFunction.default : pptrFunction);\n        }\n        isDragInterceptionEnabled() {\n            return false;\n        }\n        async setCacheEnabled(enabled) {\n            if (!this.#browserContext.browser().cdpSupported) {\n                await this.#frame.browsingContext.setCacheBehavior(enabled ? 'default' : 'bypass');\n                return;\n            }\n            // TODO: handle CDP-specific cases such as MPArch.\n            await this._client().send('Network.setCacheDisabled', {\n                cacheDisabled: !enabled,\n            });\n        }\n        async cookies(...urls) {\n            const normalizedUrls = (urls.length ? urls : [this.url()]).map(url => {\n                return new URL(url);\n            });\n            const cookies = await this.#frame.browsingContext.getCookies();\n            return cookies\n                .map(cookie => {\n                return bidiToPuppeteerCookie(cookie);\n            })\n                .filter(cookie => {\n                return normalizedUrls.some(url => {\n                    return testUrlMatchCookie(cookie, url);\n                });\n            });\n        }\n        isServiceWorkerBypassed() {\n            throw new UnsupportedOperation();\n        }\n        target() {\n            throw new UnsupportedOperation();\n        }\n        async waitForFileChooser(options = {}) {\n            const { timeout = this._timeoutSettings.timeout() } = options;\n            const deferred = Deferred.create({\n                message: `Waiting for \\`FileChooser\\` failed: ${timeout}ms exceeded`,\n                timeout,\n            });\n            this.#fileChooserDeferreds.add(deferred);\n            if (options.signal) {\n                options.signal.addEventListener('abort', () => {\n                    deferred.reject(options.signal?.reason);\n                }, { once: true });\n            }\n            this.#frame.browsingContext.once('filedialogopened', info => {\n                if (!info.element) {\n                    return;\n                }\n                const chooser = new FileChooser(BidiElementHandle.from({\n                    sharedId: info.element.sharedId,\n                    handle: info.element.handle,\n                    type: 'node',\n                }, this.#frame.mainRealm()), info.multiple);\n                for (const deferred of this.#fileChooserDeferreds) {\n                    deferred.resolve(chooser);\n                    this.#fileChooserDeferreds.delete(deferred);\n                }\n            });\n            try {\n                return await deferred.valueOrThrow();\n            }\n            catch (error) {\n                this.#fileChooserDeferreds.delete(deferred);\n                throw error;\n            }\n        }\n        workers() {\n            return [...this.#workers];\n        }\n        get isNetworkInterceptionEnabled() {\n            return (Boolean(this.#requestInterception) ||\n                Boolean(this.#extraHeadersInterception) ||\n                Boolean(this.#authInterception));\n        }\n        #requestInterception;\n        async setRequestInterception(enable) {\n            this.#requestInterception = await this.#toggleInterception([\"beforeRequestSent\" /* Bidi.Network.InterceptPhase.BeforeRequestSent */], this.#requestInterception, enable);\n        }\n        /**\n         * @internal\n         */\n        _extraHTTPHeaders = {};\n        #extraHeadersInterception;\n        async setExtraHTTPHeaders(headers) {\n            const extraHTTPHeaders = {};\n            for (const [key, value] of Object.entries(headers)) {\n                assert(isString(value), `Expected value of header \"${key}\" to be String, but \"${typeof value}\" is found.`);\n                extraHTTPHeaders[key.toLowerCase()] = value;\n            }\n            this._extraHTTPHeaders = extraHTTPHeaders;\n            this.#extraHeadersInterception = await this.#toggleInterception([\"beforeRequestSent\" /* Bidi.Network.InterceptPhase.BeforeRequestSent */], this.#extraHeadersInterception, Boolean(Object.keys(this._extraHTTPHeaders).length));\n        }\n        /**\n         * @internal\n         */\n        _credentials = null;\n        #authInterception;\n        async authenticate(credentials) {\n            this.#authInterception = await this.#toggleInterception([\"authRequired\" /* Bidi.Network.InterceptPhase.AuthRequired */], this.#authInterception, Boolean(credentials));\n            this._credentials = credentials;\n        }\n        async #toggleInterception(phases, interception, expected) {\n            if (expected && !interception) {\n                return await this.#frame.browsingContext.addIntercept({\n                    phases,\n                });\n            }\n            else if (!expected && interception) {\n                await this.#frame.browsingContext.userContext.browser.removeIntercept(interception);\n                return;\n            }\n            return interception;\n        }\n        setDragInterception() {\n            throw new UnsupportedOperation();\n        }\n        setBypassServiceWorker() {\n            throw new UnsupportedOperation();\n        }\n        async setOfflineMode(enabled) {\n            if (!this.#browserContext.browser().cdpSupported) {\n                return await this.#frame.browsingContext.setOfflineMode(enabled);\n            }\n            if (!this.#emulatedNetworkConditions) {\n                this.#emulatedNetworkConditions = {\n                    offline: false,\n                    upload: -1,\n                    download: -1,\n                    latency: 0,\n                };\n            }\n            this.#emulatedNetworkConditions.offline = enabled;\n            return await this.#applyNetworkConditions();\n        }\n        async emulateNetworkConditions(networkConditions) {\n            if (!this.#browserContext.browser().cdpSupported) {\n                if (!networkConditions?.offline &&\n                    ((networkConditions?.upload ?? -1) >= 0 ||\n                        (networkConditions?.download ?? -1) >= 0 ||\n                        (networkConditions?.latency ?? 0) > 0)) {\n                    // WebDriver BiDi supports only offline mode.\n                    throw new UnsupportedOperation();\n                }\n                return await this.#frame.browsingContext.setOfflineMode(networkConditions?.offline ?? false);\n            }\n            if (!this.#emulatedNetworkConditions) {\n                this.#emulatedNetworkConditions = {\n                    offline: networkConditions?.offline ?? false,\n                    upload: -1,\n                    download: -1,\n                    latency: 0,\n                };\n            }\n            this.#emulatedNetworkConditions.upload = networkConditions\n                ? networkConditions.upload\n                : -1;\n            this.#emulatedNetworkConditions.download = networkConditions\n                ? networkConditions.download\n                : -1;\n            this.#emulatedNetworkConditions.latency = networkConditions\n                ? networkConditions.latency\n                : 0;\n            this.#emulatedNetworkConditions.offline =\n                networkConditions?.offline ?? false;\n            return await this.#applyNetworkConditions();\n        }\n        async #applyNetworkConditions() {\n            if (!this.#emulatedNetworkConditions) {\n                return;\n            }\n            await this._client().send('Network.emulateNetworkConditions', {\n                offline: this.#emulatedNetworkConditions.offline,\n                latency: this.#emulatedNetworkConditions.latency,\n                uploadThroughput: this.#emulatedNetworkConditions.upload,\n                downloadThroughput: this.#emulatedNetworkConditions.download,\n            });\n        }\n        async setCookie(...cookies) {\n            const pageURL = this.url();\n            const pageUrlStartsWithHTTP = pageURL.startsWith('http');\n            for (const cookie of cookies) {\n                let cookieUrl = cookie.url || '';\n                if (!cookieUrl && pageUrlStartsWithHTTP) {\n                    cookieUrl = pageURL;\n                }\n                assert(cookieUrl !== 'about:blank', `Blank page can not have cookie \"${cookie.name}\"`);\n                assert(!String.prototype.startsWith.call(cookieUrl || '', 'data:'), `Data URL page can not have cookie \"${cookie.name}\"`);\n                // TODO: Support Chrome cookie partition keys\n                assert(cookie.partitionKey === undefined ||\n                    typeof cookie.partitionKey === 'string', 'BiDi only allows domain partition keys');\n                const normalizedUrl = URL.canParse(cookieUrl)\n                    ? new URL(cookieUrl)\n                    : undefined;\n                const domain = cookie.domain ?? normalizedUrl?.hostname;\n                assert(domain !== undefined, `At least one of the url and domain needs to be specified`);\n                const bidiCookie = {\n                    domain: domain,\n                    name: cookie.name,\n                    value: {\n                        type: 'string',\n                        value: cookie.value,\n                    },\n                    ...(cookie.path !== undefined ? { path: cookie.path } : {}),\n                    ...(cookie.httpOnly !== undefined ? { httpOnly: cookie.httpOnly } : {}),\n                    ...(cookie.secure !== undefined ? { secure: cookie.secure } : {}),\n                    ...(cookie.sameSite !== undefined\n                        ? { sameSite: convertCookiesSameSiteCdpToBiDi(cookie.sameSite) }\n                        : {}),\n                    ...{ expiry: convertCookiesExpiryCdpToBiDi(cookie.expires) },\n                    // Chrome-specific properties.\n                    ...cdpSpecificCookiePropertiesFromPuppeteerToBidi(cookie, 'sameParty', 'sourceScheme', 'priority', 'url'),\n                };\n                if (cookie.partitionKey !== undefined) {\n                    await this.browserContext().userContext.setCookie(bidiCookie, cookie.partitionKey);\n                }\n                else {\n                    await this.#frame.browsingContext.setCookie(bidiCookie);\n                }\n            }\n        }\n        async deleteCookie(...cookies) {\n            await Promise.all(cookies.map(async (deleteCookieRequest) => {\n                const cookieUrl = deleteCookieRequest.url ?? this.url();\n                const normalizedUrl = URL.canParse(cookieUrl)\n                    ? new URL(cookieUrl)\n                    : undefined;\n                const domain = deleteCookieRequest.domain ?? normalizedUrl?.hostname;\n                assert(domain !== undefined, `At least one of the url and domain needs to be specified`);\n                const filter = {\n                    domain: domain,\n                    name: deleteCookieRequest.name,\n                    ...(deleteCookieRequest.path !== undefined\n                        ? { path: deleteCookieRequest.path }\n                        : {}),\n                };\n                await this.#frame.browsingContext.deleteCookie(filter);\n            }));\n        }\n        async removeExposedFunction(name) {\n            await this.#frame.removeExposedFunction(name);\n        }\n        metrics() {\n            throw new UnsupportedOperation();\n        }\n        async goBack(options = {}) {\n            return await this.#go(-1, options);\n        }\n        async goForward(options = {}) {\n            return await this.#go(1, options);\n        }\n        async #go(delta, options) {\n            const controller = new AbortController();\n            try {\n                const [response] = await Promise.all([\n                    this.waitForNavigation({\n                        ...options,\n                        signal: controller.signal,\n                    }),\n                    this.#frame.browsingContext.traverseHistory(delta),\n                ]);\n                return response;\n            }\n            catch (error) {\n                controller.abort();\n                throw error;\n            }\n        }\n        waitForDevicePrompt() {\n            throw new UnsupportedOperation();\n        }\n    };\n})();\nexport { BidiPage };\n// eslint-disable-next-line @typescript-eslint/no-unsafe-function-type\nfunction evaluationExpression(fun, ...args) {\n    return `() => {${evaluationString(fun, ...args)}}`;\n}\n/**\n * Check domains match.\n */\nfunction testUrlMatchCookieHostname(cookie, normalizedUrl) {\n    const cookieDomain = cookie.domain.toLowerCase();\n    const urlHostname = normalizedUrl.hostname.toLowerCase();\n    if (cookieDomain === urlHostname) {\n        return true;\n    }\n    // TODO: does not consider additional restrictions w.r.t to IP\n    // addresses which is fine as it is for representation and does not\n    // mean that cookies actually apply that way in the browser.\n    // https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.3\n    return cookieDomain.startsWith('.') && urlHostname.endsWith(cookieDomain);\n}\n/**\n * Check paths match.\n * Spec: https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.4\n */\nfunction testUrlMatchCookiePath(cookie, normalizedUrl) {\n    const uriPath = normalizedUrl.pathname;\n    const cookiePath = cookie.path;\n    if (uriPath === cookiePath) {\n        // The cookie-path and the request-path are identical.\n        return true;\n    }\n    if (uriPath.startsWith(cookiePath)) {\n        // The cookie-path is a prefix of the request-path.\n        if (cookiePath.endsWith('/')) {\n            // The last character of the cookie-path is %x2F (\"/\").\n            return true;\n        }\n        if (uriPath[cookiePath.length] === '/') {\n            // The first character of the request-path that is not included in the cookie-path\n            // is a %x2F (\"/\") character.\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Checks the cookie matches the URL according to the spec:\n */\nfunction testUrlMatchCookie(cookie, url) {\n    const normalizedUrl = new URL(url);\n    assert(cookie !== undefined);\n    if (!testUrlMatchCookieHostname(cookie, normalizedUrl)) {\n        return false;\n    }\n    return testUrlMatchCookiePath(cookie, normalizedUrl);\n}\nexport function bidiToPuppeteerCookie(bidiCookie, returnCompositePartitionKey = false) {\n    const partitionKey = bidiCookie[CDP_SPECIFIC_PREFIX + 'partitionKey'];\n    function getPartitionKey() {\n        if (typeof partitionKey === 'string') {\n            return { partitionKey };\n        }\n        if (typeof partitionKey === 'object' && partitionKey !== null) {\n            if (returnCompositePartitionKey) {\n                return {\n                    partitionKey: {\n                        sourceOrigin: partitionKey.topLevelSite,\n                        hasCrossSiteAncestor: partitionKey.hasCrossSiteAncestor ?? false,\n                    },\n                };\n            }\n            return {\n                // TODO: a breaking change in Puppeteer is required to change\n                // partitionKey type and report the composite partition key.\n                partitionKey: partitionKey.topLevelSite,\n            };\n        }\n        return {};\n    }\n    return {\n        name: bidiCookie.name,\n        // Presents binary value as base64 string.\n        value: bidiCookie.value.value,\n        domain: bidiCookie.domain,\n        path: bidiCookie.path,\n        size: bidiCookie.size,\n        httpOnly: bidiCookie.httpOnly,\n        secure: bidiCookie.secure,\n        sameSite: convertCookiesSameSiteBiDiToCdp(bidiCookie.sameSite),\n        expires: bidiCookie.expiry ?? -1,\n        session: bidiCookie.expiry === undefined || bidiCookie.expiry <= 0,\n        // Extending with CDP-specific properties with `goog:` prefix.\n        ...cdpSpecificCookiePropertiesFromBidiToPuppeteer(bidiCookie, 'sameParty', 'sourceScheme', 'partitionKeyOpaque', 'priority'),\n        ...getPartitionKey(),\n    };\n}\nconst CDP_SPECIFIC_PREFIX = 'goog:';\n/**\n * Gets CDP-specific properties from the BiDi cookie and returns them as a new object.\n */\nfunction cdpSpecificCookiePropertiesFromBidiToPuppeteer(bidiCookie, ...propertyNames) {\n    const result = {};\n    for (const property of propertyNames) {\n        if (bidiCookie[CDP_SPECIFIC_PREFIX + property] !== undefined) {\n            result[property] = bidiCookie[CDP_SPECIFIC_PREFIX + property];\n        }\n    }\n    return result;\n}\n/**\n * Gets CDP-specific properties from the cookie, adds CDP-specific prefixes and returns\n * them as a new object which can be used in BiDi.\n */\nexport function cdpSpecificCookiePropertiesFromPuppeteerToBidi(cookieParam, ...propertyNames) {\n    const result = {};\n    for (const property of propertyNames) {\n        if (cookieParam[property] !== undefined) {\n            result[CDP_SPECIFIC_PREFIX + property] = cookieParam[property];\n        }\n    }\n    return result;\n}\nfunction convertCookiesSameSiteBiDiToCdp(sameSite) {\n    return sameSite === 'strict' ? 'Strict' : sameSite === 'lax' ? 'Lax' : 'None';\n}\nexport function convertCookiesSameSiteCdpToBiDi(sameSite) {\n    return sameSite === 'Strict'\n        ? \"strict\" /* Bidi.Network.SameSite.Strict */\n        : sameSite === 'Lax'\n            ? \"lax\" /* Bidi.Network.SameSite.Lax */\n            : \"none\" /* Bidi.Network.SameSite.None */;\n}\nexport function convertCookiesExpiryCdpToBiDi(expiry) {\n    return [undefined, -1].includes(expiry) ? undefined : expiry;\n}\nexport function convertCookiesPartitionKeyFromPuppeteerToBiDi(partitionKey) {\n    if (partitionKey === undefined || typeof partitionKey === 'string') {\n        return partitionKey;\n    }\n    if (partitionKey.hasCrossSiteAncestor) {\n        throw new UnsupportedOperation('WebDriver BiDi does not support `hasCrossSiteAncestor` yet.');\n    }\n    return partitionKey.sourceOrigin;\n}\n//# sourceMappingURL=Page.js.map","/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { Target, TargetType } from '../api/Target.js';\nimport { UnsupportedOperation } from '../common/Errors.js';\nimport { BidiPage } from './Page.js';\n/**\n * @internal\n */\nexport class BidiBrowserTarget extends Target {\n    #browser;\n    constructor(browser) {\n        super();\n        this.#browser = browser;\n    }\n    asPage() {\n        throw new UnsupportedOperation();\n    }\n    url() {\n        return '';\n    }\n    createCDPSession() {\n        throw new UnsupportedOperation();\n    }\n    type() {\n        return TargetType.BROWSER;\n    }\n    browser() {\n        return this.#browser;\n    }\n    browserContext() {\n        return this.#browser.defaultBrowserContext();\n    }\n    opener() {\n        throw new UnsupportedOperation();\n    }\n}\n/**\n * @internal\n */\nexport class BidiPageTarget extends Target {\n    #page;\n    constructor(page) {\n        super();\n        this.#page = page;\n    }\n    async page() {\n        return this.#page;\n    }\n    async asPage() {\n        return BidiPage.from(this.browserContext(), this.#page.mainFrame().browsingContext);\n    }\n    url() {\n        return this.#page.url();\n    }\n    createCDPSession() {\n        return this.#page.createCDPSession();\n    }\n    type() {\n        return TargetType.PAGE;\n    }\n    browser() {\n        return this.browserContext().browser();\n    }\n    browserContext() {\n        return this.#page.browserContext();\n    }\n    opener() {\n        throw new UnsupportedOperation();\n    }\n}\n/**\n * @internal\n */\nexport class BidiFrameTarget extends Target {\n    #frame;\n    #page;\n    constructor(frame) {\n        super();\n        this.#frame = frame;\n    }\n    async page() {\n        if (this.#page === undefined) {\n            this.#page = BidiPage.from(this.browserContext(), this.#frame.browsingContext);\n        }\n        return this.#page;\n    }\n    async asPage() {\n        return BidiPage.from(this.browserContext(), this.#frame.browsingContext);\n    }\n    url() {\n        return this.#frame.url();\n    }\n    createCDPSession() {\n        return this.#frame.createCDPSession();\n    }\n    type() {\n        return TargetType.PAGE;\n    }\n    browser() {\n        return this.browserContext().browser();\n    }\n    browserContext() {\n        return this.#frame.page().browserContext();\n    }\n    opener() {\n        throw new UnsupportedOperation();\n    }\n}\n/**\n * @internal\n */\nexport class BidiWorkerTarget extends Target {\n    #worker;\n    constructor(worker) {\n        super();\n        this.#worker = worker;\n    }\n    async page() {\n        throw new UnsupportedOperation();\n    }\n    async asPage() {\n        throw new UnsupportedOperation();\n    }\n    url() {\n        return this.#worker.url();\n    }\n    createCDPSession() {\n        throw new UnsupportedOperation();\n    }\n    type() {\n        return TargetType.OTHER;\n    }\n    browser() {\n        return this.browserContext().browser();\n    }\n    browserContext() {\n        return this.#worker.frame.page().browserContext();\n    }\n    opener() {\n        throw new UnsupportedOperation();\n    }\n}\n//# sourceMappingURL=Target.js.map","/**\n * @license\n * Copyright 2022 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __addDisposableResource = (this && this.__addDisposableResource) || function (env, value, async) {\n    if (value !== null && value !== void 0) {\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n        var dispose, inner;\n        if (async) {\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n            dispose = value[Symbol.asyncDispose];\n        }\n        if (dispose === void 0) {\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n            dispose = value[Symbol.dispose];\n            if (async) inner = dispose;\n        }\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n        env.stack.push({ value: value, dispose: dispose, async: async });\n    }\n    else if (async) {\n        env.stack.push({ async: true });\n    }\n    return value;\n};\nvar __disposeResources = (this && this.__disposeResources) || (function (SuppressedError) {\n    return function (env) {\n        function fail(e) {\n            env.error = env.hasError ? new SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n            env.hasError = true;\n        }\n        var r, s = 0;\n        function next() {\n            while (r = env.stack.pop()) {\n                try {\n                    if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n                    if (r.dispose) {\n                        var result = r.dispose.call(r.value);\n                        if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n                    }\n                    else s |= 1;\n                }\n                catch (e) {\n                    fail(e);\n                }\n            }\n            if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n            if (env.hasError) throw env.error;\n        }\n        return next();\n    };\n})(typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n    var e = new Error(message);\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n});\nimport { WEB_PERMISSION_TO_PROTOCOL_PERMISSION } from '../api/Browser.js';\nimport { BrowserContext } from '../api/BrowserContext.js';\nimport { EventEmitter } from '../common/EventEmitter.js';\nimport { debugError } from '../common/util.js';\nimport { assert } from '../util/assert.js';\nimport { bubble } from '../util/decorators.js';\nimport { UserContext } from './core/UserContext.js';\nimport { BidiPage, bidiToPuppeteerCookie, cdpSpecificCookiePropertiesFromPuppeteerToBidi, convertCookiesExpiryCdpToBiDi, convertCookiesPartitionKeyFromPuppeteerToBiDi, convertCookiesSameSiteCdpToBiDi, } from './Page.js';\nimport { BidiWorkerTarget } from './Target.js';\nimport { BidiFrameTarget, BidiPageTarget } from './Target.js';\n/**\n * @internal\n */\nlet BidiBrowserContext = (() => {\n    let _classSuper = BrowserContext;\n    let _trustedEmitter_decorators;\n    let _trustedEmitter_initializers = [];\n    let _trustedEmitter_extraInitializers = [];\n    return class BidiBrowserContext extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            _trustedEmitter_decorators = [bubble()];\n            __esDecorate(this, null, _trustedEmitter_decorators, { kind: \"accessor\", name: \"trustedEmitter\", static: false, private: false, access: { has: obj => \"trustedEmitter\" in obj, get: obj => obj.trustedEmitter, set: (obj, value) => { obj.trustedEmitter = value; } }, metadata: _metadata }, _trustedEmitter_initializers, _trustedEmitter_extraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static from(browser, userContext, options) {\n            const context = new BidiBrowserContext(browser, userContext, options);\n            context.#initialize();\n            return context;\n        }\n        #trustedEmitter_accessor_storage = __runInitializers(this, _trustedEmitter_initializers, new EventEmitter());\n        get trustedEmitter() { return this.#trustedEmitter_accessor_storage; }\n        set trustedEmitter(value) { this.#trustedEmitter_accessor_storage = value; }\n        #browser = __runInitializers(this, _trustedEmitter_extraInitializers);\n        #defaultViewport;\n        // This is public because of cookies.\n        userContext;\n        #pages = new WeakMap();\n        #targets = new Map();\n        #overrides = [];\n        constructor(browser, userContext, options) {\n            super();\n            this.#browser = browser;\n            this.userContext = userContext;\n            this.#defaultViewport = options.defaultViewport;\n        }\n        #initialize() {\n            // Create targets for existing browsing contexts.\n            for (const browsingContext of this.userContext.browsingContexts) {\n                this.#createPage(browsingContext);\n            }\n            this.userContext.on('browsingcontext', ({ browsingContext }) => {\n                const page = this.#createPage(browsingContext);\n                // We need to wait for the DOMContentLoaded as the\n                // browsingContext still may be navigating from the about:blank\n                if (browsingContext.originalOpener) {\n                    for (const context of this.userContext.browsingContexts) {\n                        if (context.id === browsingContext.originalOpener) {\n                            this.#pages\n                                .get(context)\n                                .trustedEmitter.emit(\"popup\" /* PageEvent.Popup */, page);\n                        }\n                    }\n                }\n            });\n            this.userContext.on('closed', () => {\n                this.trustedEmitter.removeAllListeners();\n            });\n        }\n        #createPage(browsingContext) {\n            const page = BidiPage.from(this, browsingContext);\n            this.#pages.set(browsingContext, page);\n            page.trustedEmitter.on(\"close\" /* PageEvent.Close */, () => {\n                this.#pages.delete(browsingContext);\n            });\n            // -- Target stuff starts here --\n            const pageTarget = new BidiPageTarget(page);\n            const pageTargets = new Map();\n            this.#targets.set(page, [pageTarget, pageTargets]);\n            page.trustedEmitter.on(\"frameattached\" /* PageEvent.FrameAttached */, frame => {\n                const bidiFrame = frame;\n                const target = new BidiFrameTarget(bidiFrame);\n                pageTargets.set(bidiFrame, target);\n                this.trustedEmitter.emit(\"targetcreated\" /* BrowserContextEvent.TargetCreated */, target);\n            });\n            page.trustedEmitter.on(\"framenavigated\" /* PageEvent.FrameNavigated */, frame => {\n                const bidiFrame = frame;\n                const target = pageTargets.get(bidiFrame);\n                // If there is no target, then this is the page's frame.\n                if (target === undefined) {\n                    this.trustedEmitter.emit(\"targetchanged\" /* BrowserContextEvent.TargetChanged */, pageTarget);\n                }\n                else {\n                    this.trustedEmitter.emit(\"targetchanged\" /* BrowserContextEvent.TargetChanged */, target);\n                }\n            });\n            page.trustedEmitter.on(\"framedetached\" /* PageEvent.FrameDetached */, frame => {\n                const bidiFrame = frame;\n                const target = pageTargets.get(bidiFrame);\n                if (target === undefined) {\n                    return;\n                }\n                pageTargets.delete(bidiFrame);\n                this.trustedEmitter.emit(\"targetdestroyed\" /* BrowserContextEvent.TargetDestroyed */, target);\n            });\n            page.trustedEmitter.on(\"workercreated\" /* PageEvent.WorkerCreated */, worker => {\n                const bidiWorker = worker;\n                const target = new BidiWorkerTarget(bidiWorker);\n                pageTargets.set(bidiWorker, target);\n                this.trustedEmitter.emit(\"targetcreated\" /* BrowserContextEvent.TargetCreated */, target);\n            });\n            page.trustedEmitter.on(\"workerdestroyed\" /* PageEvent.WorkerDestroyed */, worker => {\n                const bidiWorker = worker;\n                const target = pageTargets.get(bidiWorker);\n                if (target === undefined) {\n                    return;\n                }\n                pageTargets.delete(worker);\n                this.trustedEmitter.emit(\"targetdestroyed\" /* BrowserContextEvent.TargetDestroyed */, target);\n            });\n            page.trustedEmitter.on(\"close\" /* PageEvent.Close */, () => {\n                this.#targets.delete(page);\n                this.trustedEmitter.emit(\"targetdestroyed\" /* BrowserContextEvent.TargetDestroyed */, pageTarget);\n            });\n            this.trustedEmitter.emit(\"targetcreated\" /* BrowserContextEvent.TargetCreated */, pageTarget);\n            // -- Target stuff ends here --\n            return page;\n        }\n        targets() {\n            return [...this.#targets.values()].flatMap(([target, frames]) => {\n                return [target, ...frames.values()];\n            });\n        }\n        async newPage(options) {\n            const env_1 = { stack: [], error: void 0, hasError: false };\n            try {\n                const _guard = __addDisposableResource(env_1, await this.waitForScreenshotOperations(), false);\n                const type = options?.type === 'window'\n                    ? \"window\" /* Bidi.BrowsingContext.CreateType.Window */\n                    : \"tab\" /* Bidi.BrowsingContext.CreateType.Tab */;\n                const context = await this.userContext.createBrowsingContext(type);\n                const page = this.#pages.get(context);\n                if (!page) {\n                    throw new Error('Page is not found');\n                }\n                if (this.#defaultViewport) {\n                    try {\n                        await page.setViewport(this.#defaultViewport);\n                    }\n                    catch {\n                        // No support for setViewport in Firefox.\n                    }\n                }\n                return page;\n            }\n            catch (e_1) {\n                env_1.error = e_1;\n                env_1.hasError = true;\n            }\n            finally {\n                __disposeResources(env_1);\n            }\n        }\n        async close() {\n            assert(this.userContext.id !== UserContext.DEFAULT, 'Default BrowserContext cannot be closed!');\n            try {\n                await this.userContext.remove();\n            }\n            catch (error) {\n                debugError(error);\n            }\n            this.#targets.clear();\n        }\n        browser() {\n            return this.#browser;\n        }\n        async pages(_includeAll = false) {\n            return [...this.userContext.browsingContexts].map(context => {\n                return this.#pages.get(context);\n            });\n        }\n        async overridePermissions(origin, permissions) {\n            const permissionsSet = new Set(permissions.map(permission => {\n                const protocolPermission = WEB_PERMISSION_TO_PROTOCOL_PERMISSION.get(permission);\n                if (!protocolPermission) {\n                    throw new Error('Unknown permission: ' + permission);\n                }\n                return permission;\n            }));\n            await Promise.all(Array.from(WEB_PERMISSION_TO_PROTOCOL_PERMISSION.keys()).map(permission => {\n                const result = this.userContext.setPermissions(origin, {\n                    name: permission,\n                }, permissionsSet.has(permission)\n                    ? \"granted\" /* Bidi.Permissions.PermissionState.Granted */\n                    : \"denied\" /* Bidi.Permissions.PermissionState.Denied */);\n                this.#overrides.push({ origin, permission });\n                // TODO: some permissions are outdated and setting them to denied does\n                // not work.\n                if (!permissionsSet.has(permission)) {\n                    return result.catch(debugError);\n                }\n                return result;\n            }));\n        }\n        async clearPermissionOverrides() {\n            const promises = this.#overrides.map(({ permission, origin }) => {\n                return this.userContext\n                    .setPermissions(origin, {\n                    name: permission,\n                }, \"prompt\" /* Bidi.Permissions.PermissionState.Prompt */)\n                    .catch(debugError);\n            });\n            this.#overrides = [];\n            await Promise.all(promises);\n        }\n        get id() {\n            if (this.userContext.id === UserContext.DEFAULT) {\n                return undefined;\n            }\n            return this.userContext.id;\n        }\n        async cookies() {\n            const cookies = await this.userContext.getCookies();\n            return cookies.map(cookie => {\n                return bidiToPuppeteerCookie(cookie, true);\n            });\n        }\n        async setCookie(...cookies) {\n            await Promise.all(cookies.map(async (cookie) => {\n                const bidiCookie = {\n                    domain: cookie.domain,\n                    name: cookie.name,\n                    value: {\n                        type: 'string',\n                        value: cookie.value,\n                    },\n                    ...(cookie.path !== undefined ? { path: cookie.path } : {}),\n                    ...(cookie.httpOnly !== undefined ? { httpOnly: cookie.httpOnly } : {}),\n                    ...(cookie.secure !== undefined ? { secure: cookie.secure } : {}),\n                    ...(cookie.sameSite !== undefined\n                        ? { sameSite: convertCookiesSameSiteCdpToBiDi(cookie.sameSite) }\n                        : {}),\n                    ...{ expiry: convertCookiesExpiryCdpToBiDi(cookie.expires) },\n                    // Chrome-specific properties.\n                    ...cdpSpecificCookiePropertiesFromPuppeteerToBidi(cookie, 'sameParty', 'sourceScheme', 'priority', 'url'),\n                };\n                return await this.userContext.setCookie(bidiCookie, convertCookiesPartitionKeyFromPuppeteerToBiDi(cookie.partitionKey));\n            }));\n        }\n    };\n})();\nexport { BidiBrowserContext };\n//# sourceMappingURL=BrowserContext.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nvar __addDisposableResource = (this && this.__addDisposableResource) || function (env, value, async) {\n    if (value !== null && value !== void 0) {\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n        var dispose, inner;\n        if (async) {\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n            dispose = value[Symbol.asyncDispose];\n        }\n        if (dispose === void 0) {\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n            dispose = value[Symbol.dispose];\n            if (async) inner = dispose;\n        }\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n        env.stack.push({ value: value, dispose: dispose, async: async });\n    }\n    else if (async) {\n        env.stack.push({ async: true });\n    }\n    return value;\n};\nvar __disposeResources = (this && this.__disposeResources) || (function (SuppressedError) {\n    return function (env) {\n        function fail(e) {\n            env.error = env.hasError ? new SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n            env.hasError = true;\n        }\n        var r, s = 0;\n        function next() {\n            while (r = env.stack.pop()) {\n                try {\n                    if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n                    if (r.dispose) {\n                        var result = r.dispose.call(r.value);\n                        if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n                    }\n                    else s |= 1;\n                }\n                catch (e) {\n                    fail(e);\n                }\n            }\n            if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n            if (env.hasError) throw env.error;\n        }\n        return next();\n    };\n})(typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n    var e = new Error(message);\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n});\nimport { UnsupportedOperation } from '../../common/Errors.js';\nimport { EventEmitter } from '../../common/EventEmitter.js';\nimport { inertIfDisposed, throwIfDisposed } from '../../util/decorators.js';\nimport { DisposableStack, disposeSymbol } from '../../util/disposable.js';\nimport { SharedWorkerRealm } from './Realm.js';\nimport { UserContext } from './UserContext.js';\n/**\n * @internal\n */\nlet Browser = (() => {\n    let _classSuper = EventEmitter;\n    let _instanceExtraInitializers = [];\n    let _dispose_decorators;\n    let _close_decorators;\n    let _addPreloadScript_decorators;\n    let _removeIntercept_decorators;\n    let _removePreloadScript_decorators;\n    let _createUserContext_decorators;\n    let _installExtension_decorators;\n    let _uninstallExtension_decorators;\n    return class Browser extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            __esDecorate(this, null, _dispose_decorators, { kind: \"method\", name: \"dispose\", static: false, private: false, access: { has: obj => \"dispose\" in obj, get: obj => obj.dispose }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _close_decorators, { kind: \"method\", name: \"close\", static: false, private: false, access: { has: obj => \"close\" in obj, get: obj => obj.close }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _addPreloadScript_decorators, { kind: \"method\", name: \"addPreloadScript\", static: false, private: false, access: { has: obj => \"addPreloadScript\" in obj, get: obj => obj.addPreloadScript }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _removeIntercept_decorators, { kind: \"method\", name: \"removeIntercept\", static: false, private: false, access: { has: obj => \"removeIntercept\" in obj, get: obj => obj.removeIntercept }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _removePreloadScript_decorators, { kind: \"method\", name: \"removePreloadScript\", static: false, private: false, access: { has: obj => \"removePreloadScript\" in obj, get: obj => obj.removePreloadScript }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _createUserContext_decorators, { kind: \"method\", name: \"createUserContext\", static: false, private: false, access: { has: obj => \"createUserContext\" in obj, get: obj => obj.createUserContext }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _installExtension_decorators, { kind: \"method\", name: \"installExtension\", static: false, private: false, access: { has: obj => \"installExtension\" in obj, get: obj => obj.installExtension }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _uninstallExtension_decorators, { kind: \"method\", name: \"uninstallExtension\", static: false, private: false, access: { has: obj => \"uninstallExtension\" in obj, get: obj => obj.uninstallExtension }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static async from(session) {\n            const browser = new Browser(session);\n            await browser.#initialize();\n            return browser;\n        }\n        #closed = (__runInitializers(this, _instanceExtraInitializers), false);\n        #reason;\n        #disposables = new DisposableStack();\n        #userContexts = new Map();\n        session;\n        #sharedWorkers = new Map();\n        constructor(session) {\n            super();\n            this.session = session;\n        }\n        async #initialize() {\n            const sessionEmitter = this.#disposables.use(new EventEmitter(this.session));\n            sessionEmitter.once('ended', ({ reason }) => {\n                this.dispose(reason);\n            });\n            sessionEmitter.on('script.realmCreated', info => {\n                if (info.type !== 'shared-worker') {\n                    return;\n                }\n                this.#sharedWorkers.set(info.realm, SharedWorkerRealm.from(this, info.realm, info.origin));\n            });\n            await this.#syncUserContexts();\n            await this.#syncBrowsingContexts();\n        }\n        async #syncUserContexts() {\n            const { result: { userContexts }, } = await this.session.send('browser.getUserContexts', {});\n            for (const context of userContexts) {\n                this.#createUserContext(context.userContext);\n            }\n        }\n        async #syncBrowsingContexts() {\n            // In case contexts are created or destroyed during `getTree`, we use this\n            // set to detect them.\n            const contextIds = new Set();\n            let contexts;\n            {\n                const env_1 = { stack: [], error: void 0, hasError: false };\n                try {\n                    const sessionEmitter = __addDisposableResource(env_1, new EventEmitter(this.session), false);\n                    sessionEmitter.on('browsingContext.contextCreated', info => {\n                        contextIds.add(info.context);\n                    });\n                    const { result } = await this.session.send('browsingContext.getTree', {});\n                    contexts = result.contexts;\n                }\n                catch (e_1) {\n                    env_1.error = e_1;\n                    env_1.hasError = true;\n                }\n                finally {\n                    __disposeResources(env_1);\n                }\n            }\n            // Simulating events so contexts are created naturally.\n            for (const info of contexts) {\n                if (!contextIds.has(info.context)) {\n                    this.session.emit('browsingContext.contextCreated', info);\n                }\n                if (info.children) {\n                    contexts.push(...info.children);\n                }\n            }\n        }\n        #createUserContext(id) {\n            const userContext = UserContext.create(this, id);\n            this.#userContexts.set(userContext.id, userContext);\n            const userContextEmitter = this.#disposables.use(new EventEmitter(userContext));\n            userContextEmitter.once('closed', () => {\n                userContextEmitter.removeAllListeners();\n                this.#userContexts.delete(userContext.id);\n            });\n            return userContext;\n        }\n        get closed() {\n            return this.#closed;\n        }\n        get defaultUserContext() {\n            // SAFETY: A UserContext is always created for the default context.\n            return this.#userContexts.get(UserContext.DEFAULT);\n        }\n        get disconnected() {\n            return this.#reason !== undefined;\n        }\n        get disposed() {\n            return this.disconnected;\n        }\n        get userContexts() {\n            return this.#userContexts.values();\n        }\n        dispose(reason, closed = false) {\n            this.#closed = closed;\n            this.#reason = reason;\n            this[disposeSymbol]();\n        }\n        async close() {\n            try {\n                await this.session.send('browser.close', {});\n            }\n            finally {\n                this.dispose('Browser already closed.', true);\n            }\n        }\n        async addPreloadScript(functionDeclaration, options = {}) {\n            const { result: { script }, } = await this.session.send('script.addPreloadScript', {\n                functionDeclaration,\n                ...options,\n                contexts: options.contexts?.map(context => {\n                    return context.id;\n                }),\n            });\n            return script;\n        }\n        async removeIntercept(intercept) {\n            await this.session.send('network.removeIntercept', {\n                intercept,\n            });\n        }\n        async removePreloadScript(script) {\n            await this.session.send('script.removePreloadScript', {\n                script,\n            });\n        }\n        async createUserContext(options) {\n            const proxyConfig = options.proxyServer === undefined\n                ? undefined\n                : {\n                    proxyType: 'manual',\n                    httpProxy: options.proxyServer,\n                    sslProxy: options.proxyServer,\n                    noProxy: options.proxyBypassList,\n                };\n            const { result: { userContext }, } = await this.session.send('browser.createUserContext', {\n                proxy: proxyConfig,\n            });\n            if (options.downloadBehavior?.policy === 'allowAndName') {\n                throw new UnsupportedOperation('`allowAndName` is not supported in WebDriver BiDi');\n            }\n            if (options.downloadBehavior?.policy === 'allow') {\n                if (options.downloadBehavior.downloadPath === undefined) {\n                    throw new UnsupportedOperation('`downloadPath` is required in `allow` download behavior');\n                }\n                await this.session.send('browser.setDownloadBehavior', {\n                    downloadBehavior: {\n                        type: 'allowed',\n                        destinationFolder: options.downloadBehavior.downloadPath,\n                    },\n                    userContexts: [userContext],\n                });\n            }\n            if (options.downloadBehavior?.policy === 'deny') {\n                await this.session.send('browser.setDownloadBehavior', {\n                    downloadBehavior: { type: 'denied' },\n                    userContexts: [userContext],\n                });\n            }\n            return this.#createUserContext(userContext);\n        }\n        async installExtension(path) {\n            const { result: { extension }, } = await this.session.send('webExtension.install', {\n                extensionData: { type: 'path', path },\n            });\n            return extension;\n        }\n        async uninstallExtension(id) {\n            await this.session.send('webExtension.uninstall', { extension: id });\n        }\n        [(_dispose_decorators = [inertIfDisposed], _close_decorators = [throwIfDisposed(browser => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return browser.#reason;\n            })], _addPreloadScript_decorators = [throwIfDisposed(browser => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return browser.#reason;\n            })], _removeIntercept_decorators = [throwIfDisposed(browser => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return browser.#reason;\n            })], _removePreloadScript_decorators = [throwIfDisposed(browser => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return browser.#reason;\n            })], _createUserContext_decorators = [throwIfDisposed(browser => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return browser.#reason;\n            })], _installExtension_decorators = [throwIfDisposed(browser => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return browser.#reason;\n            })], _uninstallExtension_decorators = [throwIfDisposed(browser => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return browser.#reason;\n            })], disposeSymbol)]() {\n            this.#reason ??=\n                'Browser was disconnected, probably because the session ended.';\n            if (this.closed) {\n                this.emit('closed', { reason: this.#reason });\n            }\n            this.emit('disconnected', { reason: this.#reason });\n            this.#disposables.dispose();\n            super[disposeSymbol]();\n        }\n    };\n})();\nexport { Browser };\n//# sourceMappingURL=Browser.js.map","/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nimport { EventEmitter } from '../../common/EventEmitter.js';\nimport { bubble, inertIfDisposed, throwIfDisposed, } from '../../util/decorators.js';\nimport { DisposableStack, disposeSymbol } from '../../util/disposable.js';\nimport { Browser } from './Browser.js';\n/**\n * @internal\n */\nlet Session = (() => {\n    let _classSuper = EventEmitter;\n    let _instanceExtraInitializers = [];\n    let _connection_decorators;\n    let _connection_initializers = [];\n    let _connection_extraInitializers = [];\n    let _dispose_decorators;\n    let _send_decorators;\n    let _subscribe_decorators;\n    let _addIntercepts_decorators;\n    let _end_decorators;\n    return class Session extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            __esDecorate(this, null, _connection_decorators, { kind: \"accessor\", name: \"connection\", static: false, private: false, access: { has: obj => \"connection\" in obj, get: obj => obj.connection, set: (obj, value) => { obj.connection = value; } }, metadata: _metadata }, _connection_initializers, _connection_extraInitializers);\n            __esDecorate(this, null, _dispose_decorators, { kind: \"method\", name: \"dispose\", static: false, private: false, access: { has: obj => \"dispose\" in obj, get: obj => obj.dispose }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _send_decorators, { kind: \"method\", name: \"send\", static: false, private: false, access: { has: obj => \"send\" in obj, get: obj => obj.send }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _subscribe_decorators, { kind: \"method\", name: \"subscribe\", static: false, private: false, access: { has: obj => \"subscribe\" in obj, get: obj => obj.subscribe }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _addIntercepts_decorators, { kind: \"method\", name: \"addIntercepts\", static: false, private: false, access: { has: obj => \"addIntercepts\" in obj, get: obj => obj.addIntercepts }, metadata: _metadata }, null, _instanceExtraInitializers);\n            __esDecorate(this, null, _end_decorators, { kind: \"method\", name: \"end\", static: false, private: false, access: { has: obj => \"end\" in obj, get: obj => obj.end }, metadata: _metadata }, null, _instanceExtraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        static async from(connection, capabilities) {\n            const { result } = await connection.send('session.new', {\n                capabilities,\n            });\n            const session = new Session(connection, result);\n            await session.#initialize();\n            return session;\n        }\n        #reason = __runInitializers(this, _instanceExtraInitializers);\n        #disposables = new DisposableStack();\n        #info;\n        browser;\n        #connection_accessor_storage = __runInitializers(this, _connection_initializers, void 0);\n        get connection() { return this.#connection_accessor_storage; }\n        set connection(value) { this.#connection_accessor_storage = value; }\n        constructor(connection, info) {\n            super();\n            __runInitializers(this, _connection_extraInitializers);\n            this.#info = info;\n            this.connection = connection;\n        }\n        async #initialize() {\n            // SAFETY: We use `any` to allow assignment of the readonly property.\n            this.browser = await Browser.from(this);\n            const browserEmitter = this.#disposables.use(this.browser);\n            browserEmitter.once('closed', ({ reason }) => {\n                this.dispose(reason);\n            });\n            // TODO: Currently, some implementations do not emit navigationStarted event\n            // for fragment navigations (as per spec) and some do. This could emits a\n            // synthetic navigationStarted to work around this inconsistency.\n            const seen = new WeakSet();\n            this.on('browsingContext.fragmentNavigated', info => {\n                if (seen.has(info)) {\n                    return;\n                }\n                seen.add(info);\n                this.emit('browsingContext.navigationStarted', info);\n                this.emit('browsingContext.fragmentNavigated', info);\n            });\n        }\n        get capabilities() {\n            return this.#info.capabilities;\n        }\n        get disposed() {\n            return this.ended;\n        }\n        get ended() {\n            return this.#reason !== undefined;\n        }\n        get id() {\n            return this.#info.sessionId;\n        }\n        dispose(reason) {\n            this.#reason = reason;\n            this[disposeSymbol]();\n        }\n        /**\n         * Currently, there is a 1:1 relationship between the session and the\n         * session. In the future, we might support multiple sessions and in that\n         * case we always needs to make sure that the session for the right session\n         * object is used, so we implement this method here, although it's not defined\n         * in the spec.\n         */\n        async send(method, params) {\n            return await this.connection.send(method, params);\n        }\n        async subscribe(events, contexts) {\n            await this.send('session.subscribe', {\n                events,\n                contexts,\n            });\n        }\n        async addIntercepts(events, contexts) {\n            await this.send('session.subscribe', {\n                events,\n                contexts,\n            });\n        }\n        async end() {\n            try {\n                await this.send('session.end', {});\n            }\n            finally {\n                this.dispose(`Session already ended.`);\n            }\n        }\n        [(_connection_decorators = [bubble()], _dispose_decorators = [inertIfDisposed], _send_decorators = [throwIfDisposed(session => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return session.#reason;\n            })], _subscribe_decorators = [throwIfDisposed(session => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return session.#reason;\n            })], _addIntercepts_decorators = [throwIfDisposed(session => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return session.#reason;\n            })], _end_decorators = [throwIfDisposed(session => {\n                // SAFETY: By definition of `disposed`, `#reason` is defined.\n                return session.#reason;\n            })], disposeSymbol)]() {\n            this.#reason ??=\n                'Session already destroyed, probably because the connection broke.';\n            this.emit('ended', { reason: this.#reason });\n            this.#disposables.dispose();\n            super[disposeSymbol]();\n        }\n    };\n})();\nexport { Session };\n//# sourceMappingURL=Session.js.map","/**\n * @license\n * Copyright 2022 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n    var _, done = false;\n    for (var i = decorators.length - 1; i >= 0; i--) {\n        var context = {};\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n        if (kind === \"accessor\") {\n            if (result === void 0) continue;\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n            if (_ = accept(result.get)) descriptor.get = _;\n            if (_ = accept(result.set)) descriptor.set = _;\n            if (_ = accept(result.init)) initializers.unshift(_);\n        }\n        else if (_ = accept(result)) {\n            if (kind === \"field\") initializers.unshift(_);\n            else descriptor[key] = _;\n        }\n    }\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\n    done = true;\n};\nvar __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {\n    var useValue = arguments.length > 2;\n    for (var i = 0; i < initializers.length; i++) {\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n    }\n    return useValue ? value : void 0;\n};\nvar __setFunctionName = (this && this.__setFunctionName) || function (f, name, prefix) {\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\nimport { Browser, } from '../api/Browser.js';\nimport { ProtocolError } from '../common/Errors.js';\nimport { EventEmitter } from '../common/EventEmitter.js';\nimport { debugError } from '../common/util.js';\nimport { bubble } from '../util/decorators.js';\nimport { BidiBrowserContext } from './BrowserContext.js';\nimport { Session } from './core/Session.js';\nimport { BidiBrowserTarget } from './Target.js';\n/**\n * @internal\n */\nlet BidiBrowser = (() => {\n    let _classSuper = Browser;\n    let _private_trustedEmitter_decorators;\n    let _private_trustedEmitter_initializers = [];\n    let _private_trustedEmitter_extraInitializers = [];\n    let _private_trustedEmitter_descriptor;\n    return class BidiBrowser extends _classSuper {\n        static {\n            const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n            _private_trustedEmitter_decorators = [bubble()];\n            __esDecorate(this, _private_trustedEmitter_descriptor = { get: __setFunctionName(function () { return this.#trustedEmitter_accessor_storage; }, \"#trustedEmitter\", \"get\"), set: __setFunctionName(function (value) { this.#trustedEmitter_accessor_storage = value; }, \"#trustedEmitter\", \"set\") }, _private_trustedEmitter_decorators, { kind: \"accessor\", name: \"#trustedEmitter\", static: false, private: true, access: { has: obj => #trustedEmitter in obj, get: obj => obj.#trustedEmitter, set: (obj, value) => { obj.#trustedEmitter = value; } }, metadata: _metadata }, _private_trustedEmitter_initializers, _private_trustedEmitter_extraInitializers);\n            if (_metadata) Object.defineProperty(this, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });\n        }\n        protocol = 'webDriverBiDi';\n        static subscribeModules = [\n            'browsingContext',\n            'network',\n            'log',\n            'script',\n            'input',\n        ];\n        static subscribeCdpEvents = [\n            // Coverage\n            'goog:cdp.Debugger.scriptParsed',\n            'goog:cdp.CSS.styleSheetAdded',\n            'goog:cdp.Runtime.executionContextsCleared',\n            // Tracing\n            'goog:cdp.Tracing.tracingComplete',\n            // TODO: subscribe to all CDP events in the future.\n            'goog:cdp.Network.requestWillBeSent',\n            'goog:cdp.Debugger.scriptParsed',\n            'goog:cdp.Page.screencastFrame',\n        ];\n        static async create(opts) {\n            const session = await Session.from(opts.connection, {\n                firstMatch: opts.capabilities?.firstMatch,\n                alwaysMatch: {\n                    ...opts.capabilities?.alwaysMatch,\n                    // Capabilities that come from Puppeteer's API take precedence.\n                    acceptInsecureCerts: opts.acceptInsecureCerts,\n                    unhandledPromptBehavior: {\n                        default: \"ignore\" /* Bidi.Session.UserPromptHandlerType.Ignore */,\n                    },\n                    webSocketUrl: true,\n                    // Puppeteer with WebDriver BiDi does not support prerendering\n                    // yet because WebDriver BiDi behavior is not specified. See\n                    // https://github.com/w3c/webdriver-bidi/issues/321.\n                    'goog:prerenderingDisabled': true,\n                    // TODO: remove after Puppeteer rolled Chrome to 142 after Oct 28, 2025.\n                    'goog:disableNetworkDurableMessages': true,\n                },\n            });\n            // Subscribe to all WebDriver BiDi events. Also subscribe to CDP events if CDP\n            // connection is available.\n            await session.subscribe((opts.cdpConnection\n                ? [...BidiBrowser.subscribeModules, ...BidiBrowser.subscribeCdpEvents]\n                : BidiBrowser.subscribeModules).filter(module => {\n                if (!opts.networkEnabled) {\n                    return (module !== 'network' &&\n                        module !== 'goog:cdp.Network.requestWillBeSent');\n                }\n                return true;\n            }));\n            await Promise.all([\"request\" /* Bidi.Network.DataType.Request */, \"response\" /* Bidi.Network.DataType.Response */].map(\n            // Data collectors might be not implemented for specific data type, so create them\n            // separately and ignore protocol errors.\n            async (dataType) => {\n                try {\n                    await session.send('network.addDataCollector', {\n                        dataTypes: [dataType],\n                        // Buffer size of 20 MB is equivalent to the CDP:\n                        maxEncodedDataSize: 20_000_000,\n                    });\n                }\n                catch (err) {\n                    if (err instanceof ProtocolError) {\n                        debugError(err);\n                    }\n                    else {\n                        throw err;\n                    }\n                }\n            }));\n            const browser = new BidiBrowser(session.browser, opts);\n            browser.#initialize();\n            return browser;\n        }\n        #trustedEmitter_accessor_storage = __runInitializers(this, _private_trustedEmitter_initializers, new EventEmitter());\n        get #trustedEmitter() { return _private_trustedEmitter_descriptor.get.call(this); }\n        set #trustedEmitter(value) { return _private_trustedEmitter_descriptor.set.call(this, value); }\n        #process = __runInitializers(this, _private_trustedEmitter_extraInitializers);\n        #closeCallback;\n        #browserCore;\n        #defaultViewport;\n        #browserContexts = new WeakMap();\n        #target = new BidiBrowserTarget(this);\n        #cdpConnection;\n        #networkEnabled;\n        constructor(browserCore, opts) {\n            super();\n            this.#process = opts.process;\n            this.#closeCallback = opts.closeCallback;\n            this.#browserCore = browserCore;\n            this.#defaultViewport = opts.defaultViewport;\n            this.#cdpConnection = opts.cdpConnection;\n            this.#networkEnabled = opts.networkEnabled;\n        }\n        #initialize() {\n            // Initializing existing contexts.\n            for (const userContext of this.#browserCore.userContexts) {\n                this.#createBrowserContext(userContext);\n            }\n            this.#browserCore.once('disconnected', () => {\n                this.#trustedEmitter.emit(\"disconnected\" /* BrowserEvent.Disconnected */, undefined);\n                this.#trustedEmitter.removeAllListeners();\n            });\n            this.#process?.once('close', () => {\n                this.#browserCore.dispose('Browser process exited.', true);\n                this.connection.dispose();\n            });\n        }\n        get #browserName() {\n            return this.#browserCore.session.capabilities.browserName;\n        }\n        get #browserVersion() {\n            return this.#browserCore.session.capabilities.browserVersion;\n        }\n        get cdpSupported() {\n            return this.#cdpConnection !== undefined;\n        }\n        get cdpConnection() {\n            return this.#cdpConnection;\n        }\n        async userAgent() {\n            return this.#browserCore.session.capabilities.userAgent;\n        }\n        #createBrowserContext(userContext) {\n            const browserContext = BidiBrowserContext.from(this, userContext, {\n                defaultViewport: this.#defaultViewport,\n            });\n            this.#browserContexts.set(userContext, browserContext);\n            browserContext.trustedEmitter.on(\"targetcreated\" /* BrowserContextEvent.TargetCreated */, target => {\n                this.#trustedEmitter.emit(\"targetcreated\" /* BrowserEvent.TargetCreated */, target);\n            });\n            browserContext.trustedEmitter.on(\"targetchanged\" /* BrowserContextEvent.TargetChanged */, target => {\n                this.#trustedEmitter.emit(\"targetchanged\" /* BrowserEvent.TargetChanged */, target);\n            });\n            browserContext.trustedEmitter.on(\"targetdestroyed\" /* BrowserContextEvent.TargetDestroyed */, target => {\n                this.#trustedEmitter.emit(\"targetdestroyed\" /* BrowserEvent.TargetDestroyed */, target);\n            });\n            return browserContext;\n        }\n        get connection() {\n            // SAFETY: We only have one implementation.\n            return this.#browserCore.session.connection;\n        }\n        wsEndpoint() {\n            return this.connection.url;\n        }\n        async close() {\n            if (this.connection.closed) {\n                return;\n            }\n            try {\n                await this.#browserCore.close();\n                await this.#closeCallback?.call(null);\n            }\n            catch (error) {\n                // Fail silently.\n                debugError(error);\n            }\n            finally {\n                this.connection.dispose();\n            }\n        }\n        get connected() {\n            return !this.#browserCore.disconnected;\n        }\n        process() {\n            return this.#process ?? null;\n        }\n        async createBrowserContext(options = {}) {\n            const userContext = await this.#browserCore.createUserContext(options);\n            return this.#createBrowserContext(userContext);\n        }\n        async version() {\n            return `${this.#browserName}/${this.#browserVersion}`;\n        }\n        browserContexts() {\n            return [...this.#browserCore.userContexts].map(context => {\n                return this.#browserContexts.get(context);\n            });\n        }\n        defaultBrowserContext() {\n            return this.#browserContexts.get(this.#browserCore.defaultUserContext);\n        }\n        newPage() {\n            return this.defaultBrowserContext().newPage();\n        }\n        installExtension(path) {\n            return this.#browserCore.installExtension(path);\n        }\n        async uninstallExtension(id) {\n            await this.#browserCore.uninstallExtension(id);\n        }\n        targets() {\n            return [\n                this.#target,\n                ...this.browserContexts().flatMap(context => {\n                    return context.targets();\n                }),\n            ];\n        }\n        target() {\n            return this.#target;\n        }\n        async disconnect() {\n            try {\n                await this.#browserCore.session.end();\n            }\n            catch (error) {\n                // Fail silently.\n                debugError(error);\n            }\n            finally {\n                this.connection.dispose();\n            }\n        }\n        get debugInfo() {\n            return {\n                pendingProtocolErrors: this.connection.getPendingProtocolErrors(),\n            };\n        }\n        isNetworkEnabled() {\n            return this.#networkEnabled;\n        }\n    };\n})();\nexport { BidiBrowser };\n//# sourceMappingURL=Browser.js.map"],"names":["mitt","n","t","e","i","__importDefault","this","mod","EventEmitter_1","mitt_1","require$$0","EventEmitter","__privateAdd","_emitter","type","handler","__privateGet","event","onceHandler","eventData","log","LogType","_a","ProcessingQueue_1","log_js_1","ProcessingQueue","processor","logger","_ProcessingQueue_instances","_logger","_processor","_queue","_isProcessing","__privateSet","entry","name","__privateMethod","processIfNeeded_fn","arrayEntry","entryPromise","error","__publicField","cdp","chromiumBidi","BiDiModule","Script","EventNames","Log","BrowsingContext","Input","Network","Bluetooth","Speculation","webdriverBidi","ErrorResponse","Exception","message","stacktrace","commandId","InvalidArgumentException","InvalidSelectorException","InvalidSessionIdException","MoveTargetOutOfBoundsException","NoSuchAlertException","NoSuchElementException","NoSuchFrameException","NoSuchHandleException","NoSuchHistoryEntryException","NoSuchInterceptException","NoSuchNodeException","NoSuchRequestException","NoSuchScriptException","NoSuchUserContextException","SessionNotCreatedException","UnknownCommandException","UnknownErrorException","UnableToCaptureScreenException","UnableToCloseBrowserException","UnsupportedOperationException","NoSuchStoragePartitionException","UnableToSetCookieException","UnableToSetFileInputException","UnderspecifiedStoragePartitionException","InvalidWebExtensionException","NoSuchWebExtensionException","NoSuchNetworkCollectorException","NoSuchNetworkDataException","UnavailableNetworkDataException","webdriverBidiPermissions","webdriverBidiBluetooth","webdriverBidiNavSpeculation","__createBinding","m","k","k2","desc","__setModuleDefault","v","__importStar","ownKeys","o","ar","result","__exportStar","exports","p","require$$1","require$$2","require$$3","require$$4","require$$5","require$$6","BidiNoOpParser_1","BidiNoOpParser","params","BrowserProcessor_1","getProxyStr","protocol_js_1","BrowserProcessor","browserCdpClient","browsingContextStorage","configStorage","userContextStorage","_BrowserProcessor_instances","_browserCdpClient","_browsingContextStorage","_configStorage","_userContextStorage","w3cParams","globalConfig","request","proxyStr","proxyBypassList","context","applyDownloadBehavior_fn","userContext","err","topLevelTargetIds","b","clientWindows","targetId","getWindowInfo_fn","uniqueClientWindowIds","uniqueClientWindows","window","userContexts","c","downloadBehavior","windowInfo","toCdpDownloadBehavior_fn","proxyConfig","servers","CdpProcessor_1","CdpProcessor","realmStorage","cdpConnection","_realmStorage","_cdpConnection","sessionId","realm","BrowsingContextProcessor_1","BrowsingContextProcessor","contextConfigStorage","eventManager","_BrowsingContextProcessor_instances","_contextConfigStorage","_eventManager","onContextCreatedSubscribeHook_fn","referenceContext","existingContexts","newWindow","_b","config","impactedTopLevelContexts","getRelatedTopLevelBrowsingContexts_fn","userContextId","parentCdpClient","detachedFromTargetPromise","resolve","onContextDestroyed","browsingContextId","userContextIds","topLevelBrowsingContexts","browsingContext","contextId","EmulationProcessor_1","isValidLocale","isValidTimezone","isTimeZoneOffsetString","ErrorResponse_js_1","EmulationProcessor","_EmulationProcessor_instances","geolocation","browsingContexts","locale","scriptingEnabled","timezone","browsingContextIds","allowGlobal","assert_1","assert","predicate","graphemeTools","isSingleComplexGrapheme","isSingleGrapheme","value","InputSource","NoneSource","KeySource","_KeySource_instances","_modifiers","setModifier_fn","bit","PointerSource","id","subtype","_clickContexts","buttons","button","storedContext","x","y","time","_x","_y","_time","_DOUBLE_CLICK_TIME_MS","_MAX_DOUBLE_CLICK_RADIUS","WheelSource","keyUtils","getNormalizedKey","getKeyCode","getKeyLocation","key","USKeyboardLayout","ActionDispatcher_1","assert_js_1","graphemeTools_js_1","InputSource_js_1","keyUtils_js_1","USKeyboardLayout_js_1","CALCULATE_IN_VIEW_CENTER_PT_DECL","h","IS_MAC_DECL","getElementCenter","element","_d","_c","ActionDispatcher","inputState","isMacOS","_ActionDispatcher_instances","_tickStart","_tickDuration","_inputState","_contextId","_isMacOS","optionsByTick","options","action","promises","option","dispatchAction_fn","context_get","source","keyState","dispatchKeyDownAction_fn","dispatchKeyUpAction_fn","dispatchPointerDownAction_fn","dispatchPointerMoveAction_fn","dispatchPointerUpAction_fn","dispatchScrollAction_fn","pointerType","width","height","pressure","twist","tangentialPressure","tiltX","tiltY","getTilt","modifiers","radiusX","radiusY","getRadii","getCdpButton","force","startX","startY","offsetX","offsetY","origin","duration","targetX","targetY","getCoordinateFromOrigin_fn","last","ratio","getFrameOffset_fn","backendNodeId","frameBoxModel","frameOffset","posX","posY","_source","targetDeltaX","targetDeltaY","currentDeltaX","currentDeltaY","deltaX","deltaY","rawKey","isGrapheme","repeat","code","location","unmodifiedText","getKeyEventUnmodifiedText","text","getKeyEventText","command","altitudeAngle","azimuthAngle","tiltXRadians","tiltYRadians","tanAlt","factor","Mutex_1","Mutex","_Mutex_instances","_locked","_acquirers","state","release_fn","release","InputState_1","Mutex_js_1","InputState","_sources","_mutex","pointerId","pointerIds","pressed","InputStateManager_1","InputState_js_1","InputStateManager","InputProcessor_1","ActionDispatcher_js_1","InputStateManager_js_1","InputProcessor","_InputProcessor_instances","_inputStateManager","actionsByTick","getActionsByTick_fn","topContext","hiddenSandboxRealm","fileListLength","paths","index","handle","path","sortedFiles","objectId","actions","item","base64","base64ToString","base64Str","NetworkUtils","computeHeadersSize","stringToBase64","bidiNetworkHeadersFromCdpNetworkHeaders","bidiNetworkHeadersFromCdpNetworkHeadersEntries","cdpNetworkHeadersFromBidiNetworkHeaders","bidiNetworkHeadersFromCdpFetchHeaders","cdpFetchHeadersFromBidiNetworkHeaders","networkHeaderFromCookieHeaders","cdpAuthChallengeResponseFromBidiAuthContinueWithAuthAction","cdpToBiDiCookie","deserializeByteValue","bidiToCdpCookie","sameSiteBiDiToCdp","isSpecialScheme","matchUrlPattern","bidiBodySizeFromCdpPostDataEntries","getTiming","base64_js_1","headers","requestHeaders","acc","header","str","typedArrayToBase64","typedArray","chunks","chunk","binaryString","cookieValue","cookie","sameSiteCdpToBiDi","partitionKey","deserializedValue","sameSite","protocol","getScheme","url","pattern","parsedUrl","entries","size","timing","offset","NetworkProcessor_1","parseBiDiHeaders","NetworkUtils_js_1","_NetworkProcessor","networkStorage","_NetworkProcessor_instances","_networkStorage","urlPatterns","parsedUrlPatterns","intercept","toggleNetwork_fn","getBlockedRequestOrFail_fn","networkId","getRequestOrFail_fn","contexts","cacheDisabled","headerValue","method","urlPattern","patternUrl","hasProtocol","hasHostname","hasPort","hasPathname","hasSearch","unescapeURLPattern","scheme","insideBrackets","serializePort","defaultPorts","collectorId","affectedBrowsingContexts","cdpExtraHeaders","extraHeaders","phases","NetworkProcessor","forbidden","isEscaped","FORBIDDEN_HEADER_NAME_SYMBOLS","FORBIDDEN_HEADER_VALUE_SYMBOLS","includesChar","chars","char","parsedHeaders","bidiHeader","PermissionsProcessor_1","PermissionsProcessor","__viteBrowserExternal","uuid","uuidv4","bytesToHex","bytes","byte","randomValues","ChannelProxy_1","uuid_js_1","_ChannelProxy","channel","_ChannelProxy_instances","_properties","_id","channelHandle","_ChannelProxy_static","createAndGetHandleInRealm_fn","sendMessageHandle","createSendMessageHandle_fn","startListener_fn","getHandleFromWindow_fn","delegate","channelProxy","w","channelProxyEval","createChannelProxyEvalStr_fn","queue","queueNonEmptyResolver","createChannelHandleResult","channelHandleResult","ChannelProxy","PreloadScript_1","ChannelProxy_js_1","PreloadScript","_PreloadScript_instances","_cdpPreloadScripts","_functionDeclaration","_targetIds","_channels","_sandbox","_contexts","_userContexts","a","cdpTargets","runImmediately","cdpTarget","addCdpPreloadScriptResult","getEvaluateString_fn","cdpPreloadScript","cdpPreloadScriptId","cdpTargetId","channelsArgStr","ScriptProcessor_1","PreloadScript_js_1","ScriptProcessor","preloadScriptStorage","_ScriptProcessor_instances","_preloadScriptStorage","onRealmCreatedSubscribeHook_fn","preloadScript","contextsToRunIn","getRealm_fn","contextsToReport","realms","reportContext","realmsForContext","target","SessionProcessor_1","SessionProcessor","initConnection","_SessionProcessor_instances","_initConnection","_created","matchedCapabitlites","mergeCapabilities_fn","version","googChannel","capabilitiesRequest","mergedCapabilities","first","match","getUnhandledPromptBehavior_fn","capabilityValue","StorageProcessor_1","NetworkProcessor_js_1","StorageProcessor","_StorageProcessor_instances","expandStoragePartitionSpec_fn","cdpResponse","getCdpBrowserContextId_fn","isNoSuchUserContextError_fn","cdpCookiesToDelete","cdpCookie","bidiCookie","matchCookie_fn","expandStoragePartitionSpecByBrowsingContext_fn","descriptor","expandStoragePartitionSpecByStorageKey_fn","unsupportedPartitionKeys","sourceOrigin","partitionSpec","filter","WebExtensionProcessor_1","WebExtensionProcessor","OutgoingMessage_1","_OutgoingMessage","_message","_googChannel","messagePromise","OutgoingMessage","CommandProcessor_1","EventEmitter_js_1","BidiNoOpParser_js_1","BrowserProcessor_js_1","CdpProcessor_js_1","BrowsingContextProcessor_js_1","EmulationProcessor_js_1","require$$7","InputProcessor_js_1","require$$8","require$$9","PermissionsProcessor_js_1","require$$10","ScriptProcessor_js_1","require$$11","SessionProcessor_js_1","require$$12","StorageProcessor_js_1","require$$13","WebExtensionProcessor_js_1","require$$14","OutgoingMessage_js_1","require$$15","CommandProcessor","bluetoothProcessor","parser","_CommandProcessor_instances","_bluetoothProcessor","_browserProcessor","_browsingContextProcessor","_cdpProcessor","_emulationProcessor","_inputProcessor","_networkProcessor","_permissionsProcessor","_scriptProcessor","_sessionProcessor","_storageProcessor","_webExtensionProcessor","_parser","processCommand_fn","response","errorException","processTargetParams_fn","BluetoothProcessor_1","BluetoothGattItem","BluetoothDescriptor","characteristic","BluetoothCharacteristic","service","BluetoothService","device","BluetoothDevice","address","BluetoothProcessor","_BluetoothProcessor_instances","_bluetoothDevices","_bluetoothCharacteristics","_bluetoothDescriptors","getDevice_fn","getService_fn","getCharacteristic_fn","getDescriptor_fn","serviceUuid","characteristicUuid","descriptorUuid","ContextConfig_1","ContextConfig","configs","ContextConfigStorage_1","ContextConfig_js_1","ContextConfigStorage","_ContextConfigStorage_instances","_global","_userContextConfigs","_browsingContextConfigs","topLevelBrowsingContextId","getExtraHeaders_fn","globalHeaders","userContextHeaders","browsingContextHeaders","UserContextStorage_1","UserContextStorage","browserClient","_browserClient","foundContexts","knownUserContextIds","Deferred_1","Deferred","_isFinished","_promise","_result","_resolve","_reject","reject","_error","onFulfilled","onRejected","reason","onFinally","getTimestamp","unitConversions","inchesFromCm","cm","SharedId","getSharedId","parseSharedId","SHARED_ID_DIVIDER","frameId","documentId","parseLegacySharedId","sharedId","elementId","legacyFormattedSharedId","Realm_1","Realm$1","cdpClient","executionContextId","realmId","_Realm_instances","_cdpClient","_executionContextId","_origin","_realmId","cdpValue","resultOwnership","bidiValue","releaseObject_fn","deepSerializedValue","internalIdMap","weakLocalObjectReference","expression","awaitPromise","serializationOptions","userActivation","includeCommandLineApi","cdpEvaluateResult","_Realm_static","getSerializationOptions_fn","getExceptionResult_fn","registerEvent_fn","cdpRemoteObject","argument","cdpRemoteObjectToCallArgument_fn","remoteObject","functionDeclaration","thisLocalValue","argumentsLocalValues","callFunctionAndSerializeScript","thisAndArgumentsList","argumentLocalValue","cdpCallFunctionResult","localValue","keyValueArray","flattenKeyValuePairs_fn","args","flattenValueList_fn","mappingLocalValue","keyArg","valueArg","listLocalValue","serializeCdpExceptionDetails_fn","cdpExceptionDetails","lineOffset","callFrames","frame","exception","exceptionDetails","serialization","getAdditionalSerializationParameters_fn","getMaxObjectDepth_fn","additionalParameters","Realm","WindowRealm_1","Realm_js_1","SharedId_js_1","WindowRealm$1","sandbox","_WindowRealm_instances","_browsingContextId","navigableId","getBrowsingContextId_fn","parsedSharedId","object","maybeBrowsingContext","WindowRealm","urlHelpers","urlMatchesAboutBlank","NavigationTracker_1","Deferred_js_1","time_js_1","urlHelpers_js_1","NavigationResult","eventName","NavigationState","isInitial","_NavigationState_instances","_started","_finished","_isInitial","finish_fn","navigationResult","_NavigationTracker","_NavigationTracker_instances","_loaderIdToNavigationsMap","_lastCommittedNavigation","_pendingNavigation","_isInitialNavigation","canBeInitialNavigation","navigation","loaderId","unreachableUrl","getNavigationForFrameNavigated_fn","navigationType","fragmentNavigation","errorText","existingNavigation","_e","_NavigationTracker_static","isFragmentNavigation_fn","pendingNavigation","_f","NavigationTracker","BrowsingContextImpl_1","serializeOrigin","unitConversions_js_1","WindowRealm_js_1","NavigationTracker_js_1","BrowsingContextImpl","parentId","originalOpener","_BrowsingContextImpl_instances","_children","_hiddenSandbox","_downloadIdToUrlMap","_loaderId","_parentId","_originalOpener","_lifecycle","_cdpTarget","_defaultRealmDeferred","_navigationTracker","_lastUserPromptType","initListeners_fn","emitContextDestroyed","failLifecycleIfNotFinished_fn","deleteAllChildren_fn","children","child","parent","childId","getOrCreateSandboxInternal_fn","maxDepth","addParentField","wait","navigationState","cdpNavigatePromise","cdpNavigateResult","documentChanged_fn","waitNavigation_fn","ignoreCache","resetLifecycleIfFinished_fn","cdpReloadPromise","viewport","devicePixelRatio","screenOrientation","accept","userText","formatParameters","getImageFormatParameters","captureBeyondViewport","script","originResult","deserializeDOMRect","rect","clip","getIntersectionRect","parseRect_fn","cdpParams","range","rangeParts","parseInteger","lowerBound","upperBound","rangeLowerPart","rangeUpperPart","delta","history","locateNodesByLocator_fn","getAllRelatedCdpTargets_fn","userAgent","acceptLanguage","networkConditions","maybeSandboxes","auxData","uniqueId","accepted","promptType","_BrowsingContextImpl_static","getPromptType_fn","promptHandler","getPromptHandler_fn","cdpType","defaultPromptHandler","contextConfig","_g","_h","cdpCommandPromise","getLocatorDelegate_fn","locator","maxNodeCount","startNodes","cssSelector","locateNodesUsingCss","returnedNodes","startNode","xPathSelector","locateNodesUsingXpath","xPathResult","innerTextSelector","fullMatch","ignoreCase","searchText","locateNodesUsingInnerText","node","currentMaxDepth","nodeInnerText","childNodes","childNodeMatches","bindings","role","aborted","collect","contextNodes","selector","contextNode","locatorResult","locatorDelegate","targets","quality","normalizeRect","box","second","WorkerRealm_1","WorkerRealm","ownerRealms","realmType","_realmType","_ownerRealms","owners","owner","logHelper","logMessageFormatter","getRemoteValuesText","specifiers","isFormatSpecifier","spec","output","argFormat","argValues","tokens","token","arg","stringFromArg","toJson","pair","val","formatText","LogManager_1","logHelper_js_1","getBidiStackTrace","cdpStackTrace","stackFrames","callFrame","getLogLevel","consoleApiType","getLogMethod","LogManager","_LogManager_instances","logManager","initializeEntryAddedEventListener_fn","heuristicSerializeArg_fn","argsPromise","_LogManager_static","getExceptionText_fn","CollectorsStorage_1","CollectorsStorage","maxEncodedDataSize","_CollectorsStorage_instances","_collectors","_responseCollectors","_requestBodyCollectors","_maxEncodedDataSize","requestId","dataType","requestToCollectorsMap","getRequestToCollectorMap_fn","topLevelBrowsingContext","collectorIds","shouldCollectRequest_fn","affectedRequests","collector","DefaultMap_1","DefaultMap","getDefaultValue","_getDefaultValue","NetworkRequest_1","DefaultMap_js_1","REALM_REGEX","NetworkRequest","redirectCount","_NetworkRequest_instances","_fetchId","_interceptPhase","_servedFromCache","_redirectCount","_request","_requestOverrides","_responseOverrides","_response","_emittedEvents","fragment","getBodySizeFromHeaders_fn","emitEventsIfReady_fn","emitEvent_fn","getBaseEventParams_fn","errorReason","isBlockedInPhase_fn","continueResponse_fn","continueRequest_fn","continueWithAuth_fn","getResponseEventParams_fn","overrides","overrideHeaders","getOverrideHeader_fn","postData","getCdpBodyFromBiDiBytesValue","getSizeFromBiDiBytesValue","responseHeaders","authChallenge","username","password","credentials","responseCode","statusCode_get","isDataUrl_fn","isNonInterceptable_fn","method_get","navigationId_get","cookies_get","cookies","blockedReasons","bodySize","maybeInitiator","_j","_i","_k","requestHeaders_get","headerMap","authChallenges_get","headerName","authChallenges","timings_get","responseTimeOffset","_l","_n","_m","_p","_o","_r","_q","_t","_s","_v","_u","phaseChanged_fn","interceptsInPhase_fn","phase","requestExtraInfoCompleted","noInterceptionExpected","requestInterceptionExpected","requestInterceptionCompleted","getBeforeRequestEvent_fn","responseExtraInfoCompleted","responseInterceptionExpected","getResponseStartedEvent_fn","responseInterceptionCompleted","getResponseReceivedEvent_fn","responsePhrase","authChallengeResponse","getEvent","isIgnoredEvent_fn","interceptProps","blockedBy","getRequestData_fn","cdpHeaders","cdpRawHeaders","getDestination_fn","getInitiatorType_fn","_NetworkRequest_static","getInitiator_fn","faviconUrl","cookieHeader","initiatorType","body","parsedBody","CollectorsStorage_js_1","NetworkRequest_js_1","NetworkStorage","_NetworkStorage_instances","_collectorsStorage","_requests","_intercepts","_defaultCacheBehavior","listeners","getOrCreateNetworkRequest_fn","listener","getCollectedResponseData_fn","getCollectedRequestData_fn","stages","intercepts","interceptId","requests","fetchId","behavior","responseBody","CdpTarget_1","chromium_bidi_js_1","BrowsingContextImpl_js_1","LogManager_js_1","NetworkStorage_js_1","_CdpTarget","_CdpTarget_instances","_parentCdpClient","_unblocked","_windowId","_deviceAccessEnabled","_cacheDisableState","_preloadEnabled","_fetchDomainStages","setEventListeners_fn","unblock_fn","patterns","blockedRequest","isExpectedError_fn","disable","defaultCacheDisabled","enabled","fetchEnable","fetchChanged","enableFetch_fn","disableFetch_fn","metricsOverride","toCdpScreenOrientationAngle_fn","moduleOrEvent","results","ignoreFileDialog_fn","frameTree","restoreFrameTreeState_fn","updateWindowId_fn","setUserContextConfig_fn","initAndEvaluatePreloadScripts_fn","maybeContext","parentBrowsingContext","oldStages","windowId","orientation","CdpTarget","CdpTargetManager_1","WorkerRealm_js_1","CdpTarget_js_1","cdpToBidiTargetTypes","CdpTargetManager","selfTargetId","speculationProcessor","defaultUserContextId","_CdpTargetManager_instances","_targetKeysToBeIgnoredByAutoAttach","_selfTargetId","_speculationProcessor","_defaultUserContextId","_workers","handleAttachedToTargetEvent_fn","handleDetachedFromTargetEvent_fn","handleTargetInfoChangedEvent_fn","handleTargetCrashedEvent_fn","handleFrameAttachedEvent_fn","handleFrameSubtreeWillBeDetached_fn","parentSessionCdpClient","targetInfo","targetCdpClient","detach","targetKey","createCdpTarget_fn","findFrameParentId_fn","handleWorkerTarget_fn","parentSessionId","ownerRealm","workerRealm","worker","BrowsingContextStorage_1","BrowsingContextStorage","_eventEmitter","PreloadScriptStorage_1","PreloadScriptStorage","_scripts","scriptInUserContext","RealmStorage_1","RealmStorage","_knownHandlesToRealmMap","_realmMap","sandboxFilterValue","maybeRealm","Buffer_1","Buffer$1","capacity","onItemRemoved","_capacity","_entries","_onItemRemoved","Buffer","IdWrapper_1","_IdWrapper","__privateWrapper","_counter","IdWrapper","events","isCdpEvent","assertSupportedEvent","SubscriptionManager_1","cartesianProduct","unrollEvents","difference","d","allEvents","addEvents","SubscriptionManager","_SubscriptionManager_instances","_subscriptions","_knownSubscriptionIds","googChannels","subscription","isSubscribedTo_fn","eventNames","contextIds","topLevelContext","inputEventNames","newSubscriptions","eventsMatched","intersection","subscriptionEventNames","equal","subscriptionIds","subscriptionIdsSet","includesEvent","setA","setB","EventManager_1","Buffer_js_1","IdWrapper_js_1","events_js_1","SubscriptionManager_js_1","EventWrapper","_idWrapper","_event","eventBufferLength","EventManager","_EventManager_instances","_eventToContextsMap","_eventBuffers","_lastMessageSent","_subscriptionManager","_subscribeHooks","hook","eventWrapper","sortedGoogChannels","bufferEvent_fn","markEventSent_fn","unrolledEventNames","subscribeStepEvents","subscriptionNavigableIds","subscribedNavigableIds","getBufferedEvents_fn","bufferMapKey","_EventManager_static","getMapKey_fn","lastSentMapKey","lastId","googChannelMap","lastSentMessageId","wrapper","e1","e2","SpeculationProcessor_1","SpeculationProcessor","prefetchStatus","BidiServer_1","ProcessingQueue_js_1","CommandProcessor_js_1","BluetoothProcessor_js_1","ContextConfigStorage_js_1","UserContextStorage_js_1","CdpTargetManager_js_1","BrowsingContextStorage_js_1","PreloadScriptStorage_js_1","RealmStorage_js_1","EventManager_js_1","SpeculationProcessor_js_1","_BidiServer","bidiTransport","_BidiServer_instances","_messageQueue","_transport","_commandProcessor","_handleIncomingMessage","_processOutgoingMessage","messageEntry","topLevelContextsLoaded_fn","browserContextIds","targetInfos","info","BidiServer","BidiServer_js_1","_BidiCdpSession","CDPSession","_detached","_connection","_sessionId","connection","UnsupportedOperation","TargetCloseError","session","BidiCdpSession","debugProtocolSend","debug","debugProtocolReceive","BidiConnection","transport","idGenerator","delay","timeout","_BidiConnection_instances","_url","_delay","_timeout","_closed","_callbacks","_emitters","CallbackRegistry","emitter","define_process_env_default","toWebDriverOnlyEvent_fn","ConnectionClosedError","stringifiedMessage","f","createProtocolError","debugError","bidiServerLogger","prefix","connectBidiOverCdp","transportBiDi","NoOpTransport","cdpConnectionAdapter","CdpConnectionAdapter","pptrTransport","bidiServer","pptrBiDiConnection","BidiMapper.BidiServer","_cdp","_adapters","_browserCdpConnection","CDPClientAdapter","adapter","BidiMapper.EventEmitter","client","_client","_forwardMessage","_onMessage","onMessage","__runInitializers","thisArg","initializers","useValue","__esDecorate","ctor","descriptorIn","decorators","contextIn","extraInitializers","kind","_","done","Navigation","_classSuper","_instanceExtraInitializers","_dispose_decorators","_Navigation_instances","_navigation","_browsingContext","_disposables","DisposableStack","initialize_fn","disposeSymbol","inertIfDisposed","browsingContextEmitter","matches_fn","sessionEmitter","session_get","_metadata","obj","_disown_decorators","_callFunction_decorators","_evaluate_decorators","_resolveExecutionContextId_decorators","_reason","handles","throwIfDisposed","_WindowRealm","DedicatedWorkerRealm","realmEmitter","_DedicatedWorkerRealm_instances","_SharedWorkerRealm","browser","_SharedWorkerRealm_instances","SharedWorkerRealm","Request","_Request_instances","_responseContentPromise","_requestBodyPromise","_redirect","redirect","statusCode","reasonPhrase","data","stringToTypedArray","ProtocolError","parameters","previousRequestHasAuth","isAfterAuth","UserPrompt","_handle_decorators","_UserPrompt_instances","userPrompt","prompt","_activate_decorators","_captureScreenshot_decorators","_close_decorators","_traverseHistory_decorators","_navigate_decorators","_reload_decorators","_setCacheBehavior_decorators","_print_decorators","_handleUserPrompt_decorators","_setViewport_decorators","_performActions_decorators","_releaseActions_decorators","_createWindowRealm_decorators","_addPreloadScript_decorators","_addIntercept_decorators","_removePreloadScript_decorators","_setGeolocationOverride_decorators","_setTimezoneOverride_decorators","_setScreenOrientationOverride_decorators","_getCookies_decorators","_setCookie_decorators","_setFiles_decorators","_subscribe_decorators","_addInterception_decorators","_deleteCookie_decorators","_locateNodes_decorators","_BrowsingContext_instances","_realms","_emulationState","createWindowRealm_fn","self","promptUnload","cacheBehavior","timezoneId","files","cookieFilters","navigationEmitter","UserContext","_createBrowsingContext_decorators","_remove_decorators","_setPermissions_decorators","_UserContext_instances","_browsingContexts","browserEmitter","BidiDeserializer","tuple","_BidiDeserializer_static","deserializeTuple_fn","deserializeNumber_fn","serializedKey","serializedValue","_BidiJSHandle","JSHandle","_remoteValue","_disposed","BidiJSHandle","__addDisposableResource","env","async","dispose","inner","__disposeResources","SuppressedError","fail","s","next","suppressed","BidiElementHandle","ElementHandle","_autofill_decorators","_contentFrame_decorators","_backendNodeId","fieldId","env_1","e_1","environment","file","AsyncIterableUtil","bindIsolatedHandle","_BidiDialog","Dialog","_prompt","BidiDialog","_ExposableFunction","apply","isolate","_ExposableFunction_instances","_frame","_apply","_isolate","_channel","_handleMessage","dataHandle","stack","env_2","argsHandle","e_2","func","childFrame","connection_get","stringifyFunction","interpolateFunction","callback","frames","findFrame_fn","ExposableFunction","BidiHTTPResponse","HTTPResponse","_remoteAddress_decorators","cdpSupported","_BidiHTTPResponse_instances","_data","_securityDetails","_cdpSupported","securityDetails","SecurityDetails","bidiTiming","invokeAtMostOnceForArguments","BidiHTTPRequest","HTTPRequest","isNetworkInterceptionEnabled","_BidiHTTPRequest_instances","_redirectChain","_authenticationHandled","_handleAuthentication","bidiRequest","InterceptResolutionAction","extraHTTPHeaders_get","priority","hasInternalHeaderOverwrite_get","getBidiHeaders","handleError","_priority","hasContentLength","status","STATUS_TEXTS","httpRequest","rawHeaders","values","UnserializableError","BidiSerializer","_BidiSerializer_static","serializeObject_fn","serializeNumber_fn","subArg","isPlainObject","parsedObject","isRegExp","isDate","createEvaluationError","details","parts","stackLines","PuppeteerURL","rewriteNavigationError","ms","TimeoutError","BidiRealm","timeoutSettings","_BidiRealm_instances","promise","scriptInjector","pageFunction","evaluate_fn","BidiFrameRealm","LazyArg","handleIds","transferredHandle","returnByValue","sourceUrlComment","getSourceUrlComment","getSourcePuppeteerURLIfAvailable","responsePromise","isString","SOURCE_URL_REGEX","_BidiFrameRealm","_BidiFrameRealm_instances","_bindingsInstalled","frameRealm","ARIAQueryHandler","elements","__superGet","_BidiWorkerRealm","_worker","BidiWorkerRealm","_BidiWebWorker","WebWorker","_realm","BidiWebWorker","__setFunctionName","convertConsoleMessageLevel","BidiFrame","Frame","_goto_decorators","_setContent_decorators","_waitForNavigation_decorators","_private_waitForLoad$_decorators","_private_waitForLoad$_descriptor","_private_waitForNetworkIdle$_decorators","_private_waitForNetworkIdle$_descriptor","_BidiFrame_instances","_parent","_frames","_exposedFunctions","Accessibility","isErrorLike","html","firstValueFrom","combineLatest","waitForLoad$_get","waitForNetworkIdle$_get","signal","detached$_fn","race","fromEmitterEvent","map","switchMap","of","delayWhen","raceWith","requestFinished$","lastRequest","fromAbortSignal","exposable","exposedFunction","createFrameTarget_fn","isConsoleLogEntry","parsedValue","ConsoleMessage","getStackTraceLocations","isJavaScriptLogEntry","messageHeight","messageLines","defer","detachedFrame","throwIfDetached","waitUntil","lifecycleEvent","__privateIn","concurrency","stackTrace","stackTraceLocations","SourceActionsType","ActionType","getBidiKeyValue","BidiKeyboard","Keyboard","page","_page","_options","getBidiButton","MouseButton","BidiMouse","Mouse","_lastMovePoint","from","to","steps","pointerDownAction","pointerUpAction","BidiTouchHandle","touchScreen","properties","_bidiId","_touchScreen","TouchError","newX","newY","BidiTouchscreen","Touchscreen","touch","BidiPage","Page","_trustedEmitter_decorators","_trustedEmitter_initializers","_trustedEmitter_extraInitializers","browserContext","_BidiPage_instances","_trustedEmitter_accessor_storage","_browserContext","_viewport","_cdpEmulationManager","_emulatedNetworkConditions","_fileChooserDeferreds","_overrideNavigatorPropertiesPreloadScript","_requestInterception","_extraHeadersInterception","_authInterception","EmulationManager","Tracing","Coverage","userAgentOrOptions","userAgentMetadata","metadata","platform","enable","overrideNavigatorProperties","evaluateToken","prototypeHandle","_params","win","_guard","longitude","latitude","accuracy","features","viewportSize","needsReload","background","margin","landscape","ranges","scale","preferCSSPageSize","parsePDFOptions","pageRanges","controller","pageLeft","pageTop","evaluationExpression","pptrFunction","urls","normalizedUrls","bidiToPuppeteerCookie","testUrlMatchCookie","deferred","chooser","FileChooser","toggleInterception_fn","extraHTTPHeaders","applyNetworkConditions_fn","pageURL","pageUrlStartsWithHTTP","cookieUrl","normalizedUrl","domain","convertCookiesSameSiteCdpToBiDi","convertCookiesExpiryCdpToBiDi","cdpSpecificCookiePropertiesFromPuppeteerToBidi","deleteCookieRequest","go_fn","interception","expected","bubble","fun","evaluationString","testUrlMatchCookieHostname","cookieDomain","urlHostname","testUrlMatchCookiePath","uriPath","cookiePath","returnCompositePartitionKey","CDP_SPECIFIC_PREFIX","getPartitionKey","convertCookiesSameSiteBiDiToCdp","cdpSpecificCookiePropertiesFromBidiToPuppeteer","propertyNames","property","cookieParam","expiry","convertCookiesPartitionKeyFromPuppeteerToBiDi","BidiBrowserTarget","Target","_browser","TargetType","BidiPageTarget","BidiFrameTarget","BidiWorkerTarget","BidiBrowserContext","BrowserContext","_BidiBrowserContext_instances","_defaultViewport","_pages","_targets","_overrides","_includeAll","permissions","permissionsSet","permission","WEB_PERMISSION_TO_PROTOCOL_PERMISSION","createPage_fn","pageTarget","pageTargets","bidiFrame","bidiWorker","Browser","_removeIntercept_decorators","_createUserContext_decorators","_installExtension_decorators","_uninstallExtension_decorators","_Browser_instances","_sharedWorkers","closed","createUserContext_fn","extension","syncUserContexts_fn","syncBrowsingContexts_fn","userContextEmitter","Session","_connection_decorators","_connection_initializers","_connection_extraInitializers","_send_decorators","_addIntercepts_decorators","_end_decorators","_Session_instances","_info","_connection_accessor_storage","capabilities","seen","BidiBrowser","_private_trustedEmitter_decorators","_private_trustedEmitter_initializers","_private_trustedEmitter_extraInitializers","_private_trustedEmitter_descriptor","browserCore","opts","_BidiBrowser_instances","_process","_closeCallback","_browserCore","_browserContexts","_target","_networkEnabled","module","createBrowserContext_fn","browserName_get","browserVersion_get","trustedEmitter_get","trustedEmitter_set"],"mappings":"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O,CAC7B,OAAQA,EAAK,CACT,IAAK,IACD,MAAO,eACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,OACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,QAGX,IAAK,IACL,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,UACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,WACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,OACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,UACX,IAAK,IACD,MAAO,aACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,IACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,OACX,IAAK,IACD,MAAO,iBACX,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,UACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,OACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,WACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,OACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,UACX,IAAK,IACD,MAAO,aACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,SACX,QACI,OAAOA,CACd,CACL,CAKA,SAAS0B,GAAWE,EAAK,CACrB,OAAQA,EAAG,CACP,IAAK,IACL,IAAK,IACD,MAAO,YACX,IAAK,KACL,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,YACX,IAAK,IACL,IAAK,IACD,MAAO,cACX,IAAK,IACL,IAAK,IACD,MAAO,eACX,IAAK,IACL,IAAK,IACD,MAAO,QACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,QAGX,IAAK,IACD,MAAO,gBACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,OACX,IAAK,IACL,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,SACX,IAAK,IACL,IAAK,IACD,MAAO,QACX,IAAK,IACL,IAAK,IACD,MAAO,YACX,IAAK,IACL,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,UACX,IAAK,IACD,MAAO,WACX,IAAK,IACD,MAAO,cACX,IAAK,IACD,MAAO,eACX,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,WACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,aACX,IAAK,IACL,IAAK,IACD,MAAO,QACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,OACX,IAAK,IACD,MAAO,OACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,WACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,aACX,IAAK,IACD,MAAO,UACX,IAAK,IACD,MAAO,SACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,KACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,MACX,IAAK,IACD,MAAO,cACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACD,MAAO,UACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACL,IAAK,IACD,MAAO,UACX,IAAK,IACD,MAAO,YACX,IAAK,IACD,MAAO,cACX,IAAK,IACL,IAAK,IACD,MAAO,gBACX,IAAK,IACD,MAAO,eACX,IAAK,IACD,MAAO,cACX,IAAK,IACD,MAAO,iBACX,IAAK,IACD,MAAO,iBACX,QACI,MACP,CACL,CAKA,SAASD,GAAeC,EAAK,CACzB,OAAQA,EAAG,CACP,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACD,MAAO,GACX,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACD,MAAO,GACX,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACD,MAAO,GACX,QACI,MAAO,EACd,CACL,WC9dA,OAAO,eAAeC,GAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EACxCA,GAAA,aAAG,OAGvBA,GAAA,aAAuB,CACnB,EAAK,GACL,EAAK,GACL,EAAK,GACL,EAAK,GACL,EAAK,GACL,EAAK,GACL,EAAK,GACL,EAAK,GACL,EAAK,GACL,EAAK,GACL,MAAO,EACP,KAAM,EACN,UAAW,EACX,IAAK,EACL,QAAS,GACT,YAAa,GACb,MAAO,GACP,MAAO,GACP,MAAO,GACP,UAAW,GACX,WAAY,GACZ,YAAa,GACb,aAAc,GACd,QAAS,GACT,SAAU,GACV,MAAO,GACP,SAAU,GACV,OAAQ,GACR,QAAS,GACT,WAAY,GACZ,MAAO,GACP,QAAS,GACT,OAAQ,GACR,QAAS,GACT,SAAU,GACV,IAAK,GACL,QAAS,GACT,KAAM,GACN,QAAS,GACT,UAAW,GACX,QAAS,GACT,QAAS,GACT,QAAS,GACT,WAAY,GACZ,QAAS,GACT,QAAS,GACT,UAAW,GACX,OAAQ,GACR,KAAM,GACN,YAAa,GACb,OAAQ,GACR,QAAS,GACT,OAAQ,GACR,cAAe,GACf,OAAQ,GACR,OAAQ,GACR,OAAQ,GACR,OAAQ,GACR,OAAQ,GACR,OAAQ,GACR,OAAQ,GACR,OAAQ,GACR,OAAQ,GACR,OAAQ,GACR,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,KAAM,GACN,SAAU,GACV,UAAW,GACX,YAAa,GACb,eAAgB,IAChB,UAAW,IACX,eAAgB,IAChB,aAAc,IACd,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,QAAS,IACT,WAAY,IACZ,gBAAiB,IACjB,gBAAiB,IACjB,cAAe,IACf,eAAgB,IAChB,mBAAoB,IACpB,UAAW,IACX,eAAgB,IAChB,UAAW,IACX,MAAO,IACP,YAAa,IACb,MAAO,IACP,MAAO,IACP,OAAQ,IACR,MAAO,IACP,UAAW,IACX,YAAa,IACb,UAAW,IACX,aAAc,IACd,MAAO,IACP,SAAU,IACV,MAAO,IACP,OAAQ,EACR,MAAO,GACP,MAAO,GACP,QAAS,GACT,IAAK,GACL,OAAQ,GACR,WAAY,GACZ,IAAK,GACL,MAAO,GACP,QAAS,GACT,UAAW,GACX,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,KAAM,GACN,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,OAAQ,IACR,IAAK,IACL,IAAK,IACL,KAAM,IACN,MAAO,IACP,MAAO,IACP,SAAU,IACV,KAAM,IACN,QAAS,IACT,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,EAAG,GACH,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,IAAK,IACL,IAAK,IACL,EAAG,IACH,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,OAAQ,GACR,QAAS,GACT,WAAY,IACZ,SAAU,GACd,EC/PA,OAAO,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O,IACX,IAAK,QACD,MAAO,IACX,IAAK,QACD,MAAO,IACX,IAAK,QACL,IAAK,YACD,MAAO,IACX,IAAK,UACL,IAAK,cACD,MAAO,IACX,IAAK,MACL,IAAK,UACD,MAAO,IACX,IAAK,QACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,WACD,MAAO,IACX,IAAK,MACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,YACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,aACD,MAAO,IACX,IAAK,YACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,cACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,UACD,MAAO,IACX,IAAK,iBACD,MAAO,IACX,IAAK,YACD,MAAO,IACX,IAAK,iBACD,MAAO,IACX,IAAK,gBACD,MAAO,IACX,IAAK,eACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,KACD,MAAO,IACX,IAAK,MACD,MAAO,IACX,IAAK,MACD,MAAO,IACX,IAAK,MACD,MAAO,IACX,IAAK,OACL,IAAK,WACD,MAAO,IACX,IAAK,aACD,MAAO,IACX,IAAK,eACD,MAAO,IACX,IAAK,WACD,MAAO,IACX,IAAK,YACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,OACD,MAAO,IACX,IAAK,YACD,MAAO,IACX,IAAK,QACD,MAAO,IACX,IAAK,QACD,MAAO,IACX,IAAK,QACD,MAAO,IACX,IAAK,SACD,MAAO,IACX,IAAK,QACD,MAAO,IACX,IAAK,YACD,MAAO,IACX,IAAK,cACD,MAAO,IACX,IAAK,YACD,MAAO,KACX,IAAK,eACD,MAAO,IACX,IAAK,QACD,MAAO,IACX,QACI,MAAM,IAAI,MAAM,iBAAiBA,CAAG,GAAG,CAC9C,CACL,SAIO,MAAMi5C,WAAqBC,EAAS,CAEvC,YAAYC,EAAM,CACd,QAFJhnD,EAAA,KAAAinD,IAGI5lD,EAAA,KAAK4lD,GAAQD,EAChB,CACD,MAAM,KAAKn5C,EAAKq5C,EAAU,CACtB,MAAM9mD,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,IACxB,GAAI,uBACJ,QAAS,CACL,CACI,KAAMC,GAAW,QACjB,MAAOC,GAAgBh5C,CAAG,CAC7B,CACJ,CACJ,CACb,CAAS,CACJ,CACD,MAAM,GAAGA,EAAK,CACV,MAAMzN,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,IACxB,GAAI,uBACJ,QAAS,CACL,CACI,KAAMC,GAAW,MACjB,MAAOC,GAAgBh5C,CAAG,CAC7B,CACJ,CACJ,CACb,CAAS,CACJ,CACD,MAAM,MAAMA,EAAKyB,EAAU,GAAI,CAC3B,KAAM,CAAE,MAAA0hC,EAAQ,CAAG,EAAG1hC,EAChByG,EAAU,CACZ,CACI,KAAM6wC,GAAW,QACjB,MAAOC,GAAgBh5C,CAAG,CAC7B,CACb,EACYmjC,EAAQ,GACRj7B,EAAQ,KAAK,CACT,KAAM6wC,GAAW,MACjB,SAAU5V,CAC1B,CAAa,EAELj7B,EAAQ,KAAK,CACT,KAAM6wC,GAAW,MACjB,MAAOC,GAAgBh5C,CAAG,CACtC,CAAS,EACD,MAAMzN,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,IACxB,GAAI,uBACJ,QAAA5wC,CACH,CACb,CAAS,CACJ,CACD,MAAM,KAAK7C,EAAM5D,EAAU,GAAI,CAC3B,KAAM,CAAE,MAAA0hC,EAAQ,CAAG,EAAG1hC,EAGhB6wC,EAAS,CAAC,GAAGjtC,CAAI,EAAE,IAAI2zC,EAAe,EACtC9wC,EAAU,CAAA,EAChB,GAAIi7B,GAAS,EACT,UAAW/kC,KAASk0C,EAChBpqC,EAAQ,KAAK,CACT,KAAM6wC,GAAW,QACjB,MAAA36C,CACpB,EAAmB,CACC,KAAM26C,GAAW,MACjB,MAAA36C,CACpB,CAAiB,MAIL,WAAWA,KAASk0C,EAChBpqC,EAAQ,KAAK,CACT,KAAM6wC,GAAW,QACjB,MAAA36C,CACpB,EAAmB,CACC,KAAM26C,GAAW,MACjB,SAAU5V,CAC9B,EAAmB,CACC,KAAM4V,GAAW,MACjB,MAAA36C,CACpB,CAAiB,EAGT,MAAM7L,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,IACxB,GAAI,uBACJ,QAAA5wC,CACH,CACb,CAAS,CACJ,CACD,MAAM,cAAc2F,EAAM,CAEtB,GAAI,CAAC,GAAGA,CAAI,EAAE,OAAS,EACnB,MAAM,IAAI,MAAM,oCAAoC,EAGxD,MADc,MAAMtb,EAAA,KAAK6mD,IAAM,aAAY,GAC/B,cAAa,EAAG,SAAS,MAAOvrC,GAAS,CACjD,SAAS,YAAY,aAAc,GAAOA,CAAI,CACjD,EAAEA,CAAI,CACV,CACL,CA5GIurC,GAAA,YA6GJ,MAAME,GAAiBr6C,GAAW,CAC9B,OAAQA,EAAM,CACV,KAAKs6C,GAAY,KACb,MAAO,GACX,KAAKA,GAAY,OACb,MAAO,GACX,KAAKA,GAAY,MACb,MAAO,GACX,KAAKA,GAAY,KACb,MAAO,GACX,KAAKA,GAAY,QACb,MAAO,EACd,CACL,YAIO,MAAMC,WAAkBC,EAAM,CAGjC,YAAYN,EAAM,CACd,QAHJhnD,EAAA,KAAAinD,IACAjnD,EAAA,KAAAunD,GAAiB,CAAE,EAAG,EAAG,EAAG,CAAC,GAGzBlmD,EAAA,KAAK4lD,GAAQD,EAChB,CACD,MAAM,OAAQ,CACV3lD,EAAA,KAAKkmD,GAAiB,CAAE,EAAG,EAAG,EAAG,IACjC,MAAMnnD,EAAA,KAAK6mD,IAAM,UAAW,EAAC,gBAAgB,eAAc,CAC9D,CACD,MAAM,KAAKj6C,EAAGC,EAAGqC,EAAU,CAAA,EAAI,CAC3B,MAAMk4C,EAAOpnD,EAAA,KAAKmnD,IACZE,EAAK,CACP,EAAG,KAAK,MAAMz6C,CAAC,EACf,EAAG,KAAK,MAAMC,CAAC,CAC3B,EACc8I,EAAU,CAAA,EACV2xC,EAAQp4C,EAAQ,OAAS,EAC/B,QAAS9P,EAAI,EAAGA,EAAIkoD,EAAO,EAAEloD,EACzBuW,EAAQ,KAAK,CACT,KAAM6wC,GAAW,YACjB,EAAGY,EAAK,GAAKC,EAAG,EAAID,EAAK,IAAMhoD,EAAIkoD,GACnC,EAAGF,EAAK,GAAKC,EAAG,EAAID,EAAK,IAAMhoD,EAAIkoD,GACnC,OAAQp4C,EAAQ,MAChC,CAAa,EAELyG,EAAQ,KAAK,CACT,KAAM6wC,GAAW,YACjB,GAAGa,EACH,OAAQn4C,EAAQ,MAC5B,CAAS,EAEDjO,EAAA,KAAKkmD,GAAiBE,GACtB,MAAMrnD,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,QACxB,GAAI,oBACJ,QAAA5wC,CACH,CACb,CAAS,CACJ,CACD,MAAM,KAAKzG,EAAU,GAAI,CACrB,MAAMlP,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,QACxB,GAAI,oBACJ,QAAS,CACL,CACI,KAAMC,GAAW,YACjB,OAAQO,GAAc73C,EAAQ,QAAU83C,GAAY,IAAI,CAC3D,CACJ,CACJ,CACb,CAAS,CACJ,CACD,MAAM,GAAG93C,EAAU,GAAI,CACnB,MAAMlP,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,QACxB,GAAI,oBACJ,QAAS,CACL,CACI,KAAMC,GAAW,UACjB,OAAQO,GAAc73C,EAAQ,QAAU83C,GAAY,IAAI,CAC3D,CACJ,CACJ,CACb,CAAS,CACJ,CACD,MAAM,MAAMp6C,EAAGC,EAAGqC,EAAU,CAAA,EAAI,CAC5B,MAAMyG,EAAU,CACZ,CACI,KAAM6wC,GAAW,YACjB,EAAG,KAAK,MAAM55C,CAAC,EACf,EAAG,KAAK,MAAMC,CAAC,EACf,OAAQqC,EAAQ,MACnB,CACb,EACcq4C,EAAoB,CACtB,KAAMf,GAAW,YACjB,OAAQO,GAAc73C,EAAQ,QAAU83C,GAAY,IAAI,CACpE,EACcQ,EAAkB,CACpB,KAAMhB,GAAW,UACjB,OAAQe,EAAkB,MACtC,EACQ,QAASnoD,EAAI,EAAGA,GAAK8P,EAAQ,OAAS,GAAI,EAAE9P,EACxCuW,EAAQ,KAAK4xC,EAAmBC,CAAe,EAEnD7xC,EAAQ,KAAK4xC,CAAiB,EAC1Br4C,EAAQ,OACRyG,EAAQ,KAAK,CACT,KAAM6wC,GAAW,MACjB,SAAUt3C,EAAQ,KAClC,CAAa,EAELyG,EAAQ,KAAK6xC,CAAe,EAC5B,MAAMxnD,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,QACxB,GAAI,oBACJ,QAAA5wC,CACH,CACb,CAAS,CACJ,CACD,MAAM,MAAMzG,EAAU,GAAI,CACtB,MAAMlP,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,MACxB,GAAI,oBACJ,QAAS,CACL,CACI,KAAMC,GAAW,OACjB,GAAIxmD,EAAA,KAAKmnD,KAAkB,CACvB,EAAG,EACH,EAAG,CAC/B,EACwB,OAAQj4C,EAAQ,QAAU,EAC1B,OAAQA,EAAQ,QAAU,CAC7B,CACJ,CACJ,CACb,CAAS,CACJ,CACD,MAAO,CACH,MAAM,IAAIghC,CACb,CACD,UAAW,CACP,MAAM,IAAIA,CACb,CACD,WAAY,CACR,MAAM,IAAIA,CACb,CACD,MAAO,CACH,MAAM,IAAIA,CACb,CACD,aAAc,CACV,MAAM,IAAIA,CACb,CACL,CA3II2W,GAAA,YACAM,GAAA,qCA8IJ,MAAMM,EAAgB,CAQlB,YAAYb,EAAMc,EAAap7C,EAAIM,EAAGC,EAAG86C,EAAY,CAPrD/nD,EAAA,KAAAkvB,GAAW,IACXlvB,EAAA,KAAAmN,IACAnN,EAAA,KAAAoN,IACApN,EAAA,KAAAgoD,IACAhoD,EAAA,KAAAinD,IACAjnD,EAAA,KAAAioD,IACAjoD,EAAA,KAAA2c,IAEItb,EAAA,KAAK4lD,GAAQD,GACb3lD,EAAA,KAAK4mD,GAAeH,GACpBzmD,EAAA,KAAK8L,GAAK,KAAK,MAAMH,CAAC,GACtB3L,EAAA,KAAK+L,GAAK,KAAK,MAAMH,CAAC,GACtB5L,EAAA,KAAKsb,GAAcorC,GACnB1mD,EAAA,KAAK2mD,GAAU,sBAAgDt7C,CAAE,GACpE,CACD,MAAM,MAAM4C,EAAU,GAAI,CACtB,GAAIlP,EAAA,KAAK8uB,IACL,MAAM,IAAIg5B,GAAW,2BAA2B,EAEpD,MAAM9nD,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,QACxB,GAAIvmD,EAAA,KAAK4nD,IACT,WAAY,CACR,YAAa,OAChB,EACD,QAAS,CACL,CACI,KAAMpB,GAAW,YACjB,EAAGxmD,EAAA,KAAK+M,IACR,EAAG/M,EAAA,KAAKgN,IACR,OAAQkC,EAAQ,MACnB,EACD,CACI,GAAGlP,EAAA,KAAKuc,IACR,KAAMiqC,GAAW,YACjB,OAAQ,CACX,CACJ,CACJ,CACb,CAAS,EACDvlD,EAAA,KAAK6tB,GAAW,GACnB,CACD,KAAKliB,EAAGC,EAAG,CACP,MAAMk7C,EAAO,KAAK,MAAMn7C,CAAC,EACnBo7C,EAAO,KAAK,MAAMn7C,CAAC,EACzB,OAAO7M,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACzD,CACI,KAAMN,GAAkB,QACxB,GAAIvmD,EAAA,KAAK4nD,IACT,WAAY,CACR,YAAa,OAChB,EACD,QAAS,CACL,CACI,GAAG5nD,EAAA,KAAKuc,IACR,KAAMiqC,GAAW,YACjB,EAAGuB,EACH,EAAGC,CACN,CACJ,CACJ,CACb,CAAS,CACJ,CACD,MAAM,KAAM,CACR,MAAMhoD,EAAA,KAAK6mD,IAAM,UAAS,EAAG,gBAAgB,eAAe,CACxD,CACI,KAAMN,GAAkB,QACxB,GAAIvmD,EAAA,KAAK4nD,IACT,WAAY,CACR,YAAa,OAChB,EACD,QAAS,CACL,CACI,KAAMpB,GAAW,UACjB,OAAQ,CACX,CACJ,CACJ,CACb,CAAS,EACDxmD,EAAA,KAAK6nD,IAAa,aAAa,IAAI,CACtC,CACL,CAlFI/4B,GAAA,YACA/hB,GAAA,YACAC,GAAA,YACA46C,GAAA,YACAf,GAAA,YACAgB,GAAA,YACAtrC,GAAA,mBAgFG,MAAM0rC,WAAwBC,EAAY,CAE7C,YAAYtB,EAAM,CACd,QAFJhnD,EAAA,KAAAinD,IAGI5lD,EAAA,KAAK4lD,GAAQD,EAChB,CACD,MAAM,WAAWh6C,EAAGC,EAAGqC,EAAU,CAAA,EAAI,CACjC,MAAM5C,EAAK,KAAK,cACVq7C,EAAa,CACf,MAAO,GAAM,EACb,OAAQ,GAAM,EACd,SAAU,GACV,cAAe,KAAK,GAAK,CACrC,EACcQ,EAAQ,IAAIV,GAAgBznD,EAAA,KAAK6mD,IAAO,KAAMv6C,EAAIM,EAAGC,EAAG86C,CAAU,EACxE,aAAMQ,EAAM,MAAMj5C,CAAO,EACzB,KAAK,QAAQ,KAAKi5C,CAAK,EAChBA,CACV,CACL,CAlBItB,GAAA,YCjmBJ;AAAA;AAAA;AAAA;AAAA,GAKA,IAAIrT,GAA8C,SAAUC,EAAMC,EAAcC,EAAYC,EAAWN,EAAcO,EAAmB,CACpI,SAAS1gB,EAAOwe,EAAG,CAAE,GAAIA,IAAM,QAAU,OAAOA,GAAM,WAAY,MAAM,IAAI,UAAU,mBAAmB,EAAG,OAAOA,CAAI,CAKvH,QAJImC,EAAOF,EAAU,KAAMnmC,EAAMqmC,IAAS,SAAW,MAAQA,IAAS,SAAW,MAAQ,QACrFj0B,EAAS,CAAC6zB,GAAgBD,EAAOG,EAAU,OAAYH,EAAOA,EAAK,UAAY,KAC/E9xB,EAAa+xB,IAAiB7zB,EAAS,OAAO,yBAAyBA,EAAQ+zB,EAAU,IAAI,EAAI,CAAA,GACjGG,EAAGC,EAAO,GACL50C,EAAIu0C,EAAW,OAAS,EAAGv0C,GAAK,EAAGA,IAAK,CAC7C,IAAIiI,EAAU,CAAA,EACd,QAAS5B,KAAKmuC,EAAWvsC,EAAQ5B,CAAC,EAAIA,IAAM,SAAW,CAAA,EAAKmuC,EAAUnuC,CAAC,EACvE,QAASA,KAAKmuC,EAAU,OAAQvsC,EAAQ,OAAO5B,CAAC,EAAImuC,EAAU,OAAOnuC,CAAC,EACtE4B,EAAQ,eAAiB,SAAUsqC,EAAG,CAAE,GAAIqC,EAAM,MAAM,IAAI,UAAU,wDAAwD,EAAGH,EAAkB,KAAK1gB,EAAOwe,GAAK,IAAI,CAAC,GACzK,IAAIrsC,KAAaquC,EAAWv0C,CAAC,GAAG00C,IAAS,WAAa,CAAE,IAAKnyB,EAAW,IAAK,IAAKA,EAAW,GAAG,EAAKA,EAAWlU,CAAG,EAAGpG,CAAO,EAC7H,GAAIysC,IAAS,WAAY,CACrB,GAAIxuC,IAAW,OAAQ,SACvB,GAAIA,IAAW,MAAQ,OAAOA,GAAW,SAAU,MAAM,IAAI,UAAU,iBAAiB,GACpFyuC,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,IAAI,IAAGguC,EAAa,QAAQS,CAAC,CACtD,MACQA,EAAI5gB,EAAO7tB,CAAM,KAClBwuC,IAAS,QAASR,EAAa,QAAQS,CAAC,EACvCpyB,EAAWlU,CAAG,EAAIsmC,EAE9B,CACGl0B,GAAQ,OAAO,eAAeA,EAAQ+zB,EAAU,KAAMjyB,CAAU,EACpEqyB,EAAO,EACX,EACIZ,GAAwD,SAAUC,EAASC,EAAcznC,EAAO,CAEhG,QADI0nC,EAAW,UAAU,OAAS,EACzBn0C,EAAI,EAAGA,EAAIk0C,EAAa,OAAQl0C,IACrCyM,EAAQ0nC,EAAWD,EAAal0C,CAAC,EAAE,KAAKi0C,EAASxnC,CAAK,EAAIynC,EAAal0C,CAAC,EAAE,KAAKi0C,CAAO,EAE1F,OAAOE,EAAW1nC,EAAQ,MAC9B,EACIgvC,GAAoE,SAAUC,EAAKjvC,EAAOkvC,EAAO,CACjG,GAAIlvC,GAAU,KAA0B,CACpC,GAAI,OAAOA,GAAU,UAAY,OAAOA,GAAU,WAAY,MAAM,IAAI,UAAU,kBAAkB,EACpG,IAAImvC,EAASC,EACb,GAAIF,EAAO,CACP,GAAI,CAAC,OAAO,aAAc,MAAM,IAAI,UAAU,qCAAqC,EACnFC,EAAUnvC,EAAM,OAAO,YAAY,CACtC,CACD,GAAImvC,IAAY,OAAQ,CACpB,GAAI,CAAC,OAAO,QAAS,MAAM,IAAI,UAAU,gCAAgC,EACzEA,EAAUnvC,EAAM,OAAO,OAAO,EAC1BkvC,IAAOE,EAAQD,EACtB,CACD,GAAI,OAAOA,GAAY,WAAY,MAAM,IAAI,UAAU,wBAAwB,EAC3EC,IAAOD,EAAU,UAAW,CAAE,GAAI,CAAEC,EAAM,KAAK,IAAI,CAAI,OAAQ97C,EAAG,CAAE,OAAO,QAAQ,OAAOA,CAAC,CAAE,IACjG27C,EAAI,MAAM,KAAK,CAAE,MAAOjvC,EAAO,QAASmvC,EAAS,MAAOD,CAAK,CAAE,CAClE,MACQA,GACLD,EAAI,MAAM,KAAK,CAAE,MAAO,EAAM,CAAA,EAElC,OAAOjvC,CACX,EACIqvC,GAA2D,SAAUC,EAAiB,CACtF,OAAO,SAAUL,EAAK,CAClB,SAASM,EAAKj8C,EAAG,CACb27C,EAAI,MAAQA,EAAI,SAAW,IAAIK,EAAgBh8C,EAAG27C,EAAI,MAAO,0CAA0C,EAAI37C,EAC3G27C,EAAI,SAAW,EAClB,CACD,IAAI,EAAGO,EAAI,EACX,SAASC,GAAO,CACZ,KAAO,EAAIR,EAAI,MAAM,IAAG,GACpB,GAAI,CACA,GAAI,CAAC,EAAE,OAASO,IAAM,EAAG,OAAOA,EAAI,EAAGP,EAAI,MAAM,KAAK,CAAC,EAAG,QAAQ,UAAU,KAAKQ,CAAI,EACrF,GAAI,EAAE,QAAS,CACX,IAAIh2C,EAAS,EAAE,QAAQ,KAAK,EAAE,KAAK,EACnC,GAAI,EAAE,MAAO,OAAO+1C,GAAK,EAAG,QAAQ,QAAQ/1C,CAAM,EAAE,KAAKg2C,EAAM,SAASn8C,EAAG,CAAE,OAAAi8C,EAAKj8C,CAAC,EAAUm8C,GAAO,CAAE,CACzG,MACID,GAAK,CACb,OACMl8C,EAAG,CACNi8C,EAAKj8C,CAAC,CACT,CAEL,GAAIk8C,IAAM,EAAG,OAAOP,EAAI,SAAW,QAAQ,OAAOA,EAAI,KAAK,EAAI,QAAQ,QAAO,EAC9E,GAAIA,EAAI,SAAU,MAAMA,EAAI,KAC/B,CACD,OAAOQ,EAAI,CACnB,CACA,EAAG,OAAO,iBAAoB,WAAa,gBAAkB,SAAU95C,EAAO+5C,EAAY/4C,EAAS,CAC/F,IAAIrD,EAAI,IAAI,MAAMqD,CAAO,EACzB,OAAOrD,EAAE,KAAO,kBAAmBA,EAAE,MAAQqC,EAAOrC,EAAE,WAAao8C,EAAYp8C,CACnF,CAAC,EAuBE,IAACipD,IAAY,IAAM,6CAClB,IAAIlU,EAAcmU,GACdC,EACAC,EAA+B,CAAA,EAC/BC,EAAoC,CAAA,EACxC,OAAOloD,EAAA,cAAuB4zC,CAAY,CA8BtC,YAAYuU,EAAgBl+C,EAAiB,CACzC,QA/BD3K,EAAA,KAAA8oD,GAYH9oD,EAAA,KAAA+oD,EAAmCvV,GAAkB,KAAMmV,EAA8B,IAAI5oD,CAAc,GAG3GC,EAAA,KAAAgpD,EAAkBxV,GAAkB,KAAMoV,CAAiC,GAC3E5oD,EAAA,KAAAg9C,GACAh9C,EAAA,KAAAipD,EAAY,MACZjpD,EAAA,KAAAknC,EAAW,IAAI,KACfrlC,EAAA,iBACAA,EAAA,cACAA,EAAA,oBACAA,EAAA,gBACAA,EAAA,iBACA7B,EAAA,KAAAkpD,GACAlpD,EAAA,KAAAmpD,GACAnpD,EAAA,KAAAopD,EAAwB,IAAI,KA8B5BppD,EAAA,KAAAqpD,GA+aArpD,EAAA,KAAAspD,GAOAznD,EAAA,yBAAoB,CAAA,GACpB7B,EAAA,KAAAupD,GAaA1nD,EAAA,oBAAe,MACf7B,EAAA,KAAAwpD,GA7dInoD,EAAA,KAAK2nD,EAAkBH,GACvBxnD,EAAA,KAAK27C,EAASwG,GAAU,KAAK,KAAM74C,CAAe,GAClDtJ,EAAA,KAAK6nD,EAAuB,IAAIO,GAAiBrpD,EAAA,KAAK48C,GAAO,MAAM,GACnE,KAAK,QAAU,IAAI0M,GAAQtpD,EAAA,KAAK48C,GAAO,MAAM,EAC7C,KAAK,SAAW,IAAI2M,GAASvpD,EAAA,KAAK48C,GAAO,MAAM,EAC/C,KAAK,SAAW,IAAI8J,GAAa,IAAI,EACrC,KAAK,MAAQ,IAAIO,GAAU,IAAI,EAC/B,KAAK,YAAc,IAAIgB,GAAgB,IAAI,CAC9C,CAjCD,OAAO,KAAKQ,EAAgBl+C,EAAiB,OACzC,MAAMq8C,EAAO,IAAItmD,EAASmoD,EAAgBl+C,CAAe,EACzD,OAAAnJ,EAAAd,EAAAsmD,EAAK8B,EAAAhU,IAAL,KAAAp0C,GACOsmD,CACV,CAED,IAAI,gBAAiB,CAAE,OAAO5mD,EAAA,KAAK2oD,EAAmC,CACtE,IAAI,eAAe98C,EAAO,CAAE5K,EAAA,KAAK0nD,EAAmC98C,EAAQ,CAa5E,SAAU,CACN,OAAO7L,EAAA,KAAK48C,GAAO,MACtB,CA4BD,MAAM,aAAa4M,EAAoBC,EAAmB,CACtD,IAAI90B,EACA+0B,EACAC,EAYJ,GAXI,OAAOH,GAAuB,UAC9B70B,EAAY60B,EACZE,EAAWD,IAGX90B,EACI60B,EAAmB,WACd,MAAMxpD,EAAA,KAAK4oD,GAAgB,QAAO,EAAG,UAAW,EACzDc,EAAWF,EAAmB,kBAC9BG,EAAWH,EAAmB,UAE9B,CAACxpD,EAAA,KAAK4oD,GAAgB,QAAS,EAAC,eAC/Bc,GAAYC,GACb,MAAM,IAAIzZ,EAAqB,oEAAoE,EAElG,GAAIlwC,EAAA,KAAK4oD,GAAgB,QAAO,EAAG,eACnCc,GAAYC,GACb,OAAO,MAAM,KAAK,UAAU,KAAK,+BAAgC,CAC7D,UAAWh1B,EACX,kBAAmB+0B,EACnB,SAAUC,CAC9B,CAAiB,EAEL,MAAMC,EAASj1B,IAAc,GAC7BA,EAAYA,GAAc,MAAM30B,EAAA,KAAK4oD,GAAgB,QAAS,EAAC,UAAS,EACxE,MAAM5oD,EAAA,KAAK48C,GAAO,gBAAgB,aAAagN,EAASj1B,EAAY,IAAI,EACxE,MAAMk1B,EAA+BF,IAAa,CAC1CA,IACA,OAAO,eAAe,UAAW,WAAY,CACzC,MAAOA,GACP,aAAc,EACtC,CAAqB,CAErB,EACkB/L,GAAS,CAAC59C,EAAA,KAAK48C,EAAM,EAC3B,UAAW9vB,MAAS8wB,GAChBA,GAAO,KAAK,GAAG9wB,GAAM,YAAa,CAAA,EAElC9sB,EAAA,KAAKipD,IACL,MAAM,KAAK,oCAAoCjpD,EAAA,KAAKipD,EAAyC,EAEjG,KAAM,CAACa,EAAa,EAAI,MAAM,QAAQ,IAAI,CACtCF,EACM,KAAK,sBAAsBC,EAA6BF,GAAY,MAAS,EAC7E,OAGN,GAAG/L,GAAO,IAAI9wB,IACHA,GAAM,SAAS+8B,EAA6BF,GAAY,MAAS,CAC3E,CACjB,CAAa,EACD1oD,EAAA,KAAKgoD,EAA4Ca,IAAA,YAAAA,GAAe,WACnE,CACD,MAAM,aAAallB,EAAS,CAExB,MAAM,KAAK,UAAU,KAAK,oBAAqB,CAAE,QAAAA,CAAO,CAAE,CAC7D,CACD,MAAM,aAAamlB,EAAiB,CAChCv+C,GAAO,CAACu+C,EAAgB,SAAU,iCAAiC,EACnEv+C,GAAOu+C,EAAgB,GAAI,4DAA4D,EACvF,MAAM7kC,EAAW,MAAMllB,EAAA,KAAK48C,GAAO,OAAO,KAAK,uBAAwB,CACnE,kBAAmBmN,EAAgB,EACnD,CAAa,EACD,OAAO/pD,EAAA,KAAK48C,GAAO,UAAS,EAAG,aAAa,CACxC,KAAM,QACN,OAAQ13B,EAAS,QAAQ,QACzC,CAAa,CACJ,CACD,SAAU,CACN,OAAO,KAAK,iBAAiB,SAChC,CACD,gBAAiB,CACb,OAAOllB,EAAA,KAAK4oD,EACf,CACD,WAAY,CACR,OAAO5oD,EAAA,KAAK48C,EACf,CACD,OAAOoN,EAAS,CACZ,MAAM,IAAI,MAAM,gDAAgD,CACnE,CACD,cAAe,CACX,MAAM,IAAI,MAAM,gDAAgD,CACnE,CACD,MAAM,cAAe,CACjB,MAAMlO,EAAQ,CAAE,MAAO,CAAE,EAAE,MAAO,OAAQ,SAAU,IACpD,GAAI,CAcA,MAAMjwC,EAbSgvC,GAAwBiB,EAAQ,MAAM,KAAK,UAAW,EAChE,cAAe,EACf,eAAe,IAAM,CACtB,IAAImO,EAAM,OACV,MAAOA,EAAI,SAAS,yBAAyBA,EAAI,mBAC7CA,EAAI,SAAS,yBAAyBA,EAAI,mBACtCA,EAAI,SAAS,cAAc,gBAAkB,MAGjDA,EAAMA,EAAI,SAAS,cAAc,cAErC,OAAOA,CAC3B,CAAiB,EAAI,EAAK,EACW,cACrBz+C,GAAOK,EAAM,OAAS,QAAQ,EAC9B,MAAMihB,EAAQ,KAAK,OAAM,EAAG,KAAKA,GACtBA,EAAM,MAAQjhB,EAAM,MAAM,OACpC,EACDL,OAAAA,GAAOshB,CAAK,EACLA,CACV,OACMivB,EAAK,CACRD,EAAM,MAAQC,EACdD,EAAM,SAAW,EACpB,QACO,CACJZ,GAAmBY,CAAK,CAC3B,CACJ,CACD,QAAS,CACL,MAAM8B,EAAS,CAAC59C,EAAA,KAAK48C,EAAM,EAC3B,UAAW9vB,KAAS8wB,EAChBA,EAAO,KAAK,GAAG9wB,EAAM,YAAa,CAAA,EAEtC,OAAO8wB,CACV,CACD,UAAW,CACP,OAAO59C,EAAA,KAAK48C,GAAO,QACtB,CACD,MAAM,MAAM1tC,EAAS,CACjB,MAAMiuC,EAAQ,CAAE,MAAO,CAAE,EAAE,MAAO,OAAQ,SAAU,IACpD,GAAI,CACA,MAAM+M,EAASrP,GAAwBsC,EAAO,MAAMn9C,EAAA,KAAK4oD,GAAgB,8BAA+B,EAAK,EAC7G,GAAI,CACA,MAAM5oD,EAAA,KAAK48C,GAAO,gBAAgB,MAAM1tC,GAAA,YAAAA,EAAS,eAAe,CACnE,MACK,CACF,MACH,CACJ,OACMmuC,EAAK,CACRF,EAAM,MAAQE,EACdF,EAAM,SAAW,EACpB,QACO,CACJjC,GAAmBiC,CAAK,CAC3B,CACJ,CACD,MAAM,OAAOjuC,EAAU,GAAI,CACvB,KAAM,CAACgW,CAAQ,EAAI,MAAM,QAAQ,IAAI,CACjCllB,EAAA,KAAK48C,GAAO,kBAAkB1tC,CAAO,EACrClP,EAAA,KAAK48C,GAAO,gBAAgB,OAAO,CAC/B,YAAa1tC,EAAQ,YAAc,GAAO,MAC9D,CAAiB,CACJ,CAAA,EAAE,MAAM6xC,GAAuB,KAAK,IAAK,EAAE7xC,EAAQ,SAAW,KAAK,iBAAiB,kBAAiB,CAAE,CAAC,EACzG,OAAOgW,CACV,CACD,4BAA4B2rB,EAAS,CACjC,KAAK,iBAAiB,4BAA4BA,CAAO,CAC5D,CACD,kBAAkBA,EAAS,CACvB,KAAK,iBAAiB,kBAAkBA,CAAO,CAClD,CACD,mBAAoB,CAChB,OAAO,KAAK,iBAAiB,SAChC,CACD,6BAA8B,CAC1B,OAAO,KAAK,iBAAiB,mBAChC,CACD,qBAAsB,CAClB,OAAO7wC,EAAA,KAAK48C,GAAO,gBAAgB,oBAAmB,CACzD,CACD,MAAM,eAAe1tC,EAAS,CAC1B,KAAM,CAAE,UAAAi7C,EAAW,SAAAC,EAAU,SAAAC,EAAW,CAAC,EAAKn7C,EAC9C,GAAIi7C,EAAY,MAAQA,EAAY,IAChC,MAAM,IAAI,MAAM,sBAAsBA,CAAS,kDAAkD,EAErG,GAAIC,EAAW,KAAOA,EAAW,GAC7B,MAAM,IAAI,MAAM,qBAAqBA,CAAQ,+CAA+C,EAEhG,GAAIC,EAAW,EACX,MAAM,IAAI,MAAM,qBAAqBA,CAAQ,uCAAuC,EAExF,OAAO,MAAMrqD,EAAA,KAAK48C,GAAO,gBAAgB,uBAAuB,CAC5D,YAAa,CACT,SAAU1tC,EAAQ,SAClB,UAAWA,EAAQ,UACnB,SAAUA,EAAQ,QACrB,CACjB,CAAa,CACJ,CACD,MAAM,qBAAqB01B,EAAS,CAChC,OAAO,MAAM5kC,EAAA,KAAK48C,GAAO,gBAAgB,qBAAqBhY,CAAO,CACxE,CACD,MAAM,iBAAiB9kC,EAAM,CACzB,OAAO,MAAME,EAAA,KAAK8oD,GAAqB,iBAAiBhpD,CAAI,CAC/D,CACD,MAAM,qBAAqBwT,EAAQ,CAC/B,OAAO,MAAMtT,EAAA,KAAK8oD,GAAqB,qBAAqBx1C,CAAM,CACrE,CACD,MAAM,qBAAqBg3C,EAAU,CACjC,OAAO,MAAMtqD,EAAA,KAAK8oD,GAAqB,qBAAqBwB,CAAQ,CACvE,CACD,MAAM,gBAAgBhR,EAAY,CAC9B,OAAO,MAAMt5C,EAAA,KAAK48C,GAAO,gBAAgB,oBAAoBtD,CAAU,CAC1E,CACD,MAAM,iBAAiB7b,EAAW,CAC9B,OAAO,MAAMz9B,EAAA,KAAK8oD,GAAqB,iBAAiBrrB,CAAS,CACpE,CACD,MAAM,wBAAwB39B,EAAM,CAChC,OAAO,MAAME,EAAA,KAAK8oD,GAAqB,wBAAwBhpD,CAAI,CACtE,CACD,MAAM,YAAYkzB,EAAU,CACxB,GAAI,CAAC,KAAK,QAAS,EAAC,aAAc,CAC9B,MAAMu3B,EAAev3B,GAAA,MAAAA,EAAU,QAASA,GAAA,MAAAA,EAAU,QAC5C,CACE,MAAOA,EAAS,MAChB,OAAQA,EAAS,MACpB,EACC,KACAC,EAAmBD,GAAA,MAAAA,EAAU,kBAC7BA,EAAS,kBACT,KAEAE,EAAoBF,EACpBA,EAAS,YACL,CACE,QAAS,YACT,KAAM,mBACT,EACC,CACE,QAAS,WACT,KAAM,kBACT,EACH,KACN,MAAM,QAAQ,IAAI,CACdhzB,EAAA,KAAK48C,GAAO,gBAAgB,YAAY,CACpC,SAAU2N,EACV,iBAAAt3B,CACxB,CAAqB,EACDjzB,EAAA,KAAK48C,GAAO,gBAAgB,6BAA6B1pB,CAAiB,CAC9F,CAAiB,EACDjyB,EAAA,KAAK4nD,EAAY71B,GACjB,MACH,CACD,MAAMw3B,EAAc,MAAMxqD,EAAA,KAAK8oD,GAAqB,gBAAgB91B,CAAQ,EAC5E/xB,EAAA,KAAK4nD,EAAY71B,GACbw3B,GACA,MAAM,KAAK,QAElB,CACD,UAAW,CACP,OAAOxqD,EAAA,KAAK6oD,EACf,CACD,MAAM,IAAI35C,EAAU,GAAI,CACpB,KAAM,CAAE,QAAS8xC,EAAK,KAAK,iBAAiB,QAAO,EAAI,KAAAxrC,EAAO,MAAW,EAAGtG,EACtE,CAAE,gBAAiBu7C,EAAY,OAAAC,EAAQ,UAAAC,EAAW,MAAA16C,EAAO,OAAAC,GAAQ,WAAY06C,GAAQ,MAAAC,GAAO,kBAAAC,EAAiB,EAAMC,GAAgB77C,EAAS,IAAI,EAChJ87C,GAAaJ,GAASA,GAAO,MAAM,IAAI,EAAI,GACjD,MAAMxG,GAAegD,GAAK,KAAK,UAAW,EACrC,cAAe,EACf,SAAS,IACH,SAAS,MAAM,KACzB,CAAC,EAAE,KAAKpC,GAASnU,GAAQmQ,CAAE,CAAC,CAAC,CAAC,EAC/B,MAAMtK,GAAO,MAAM0N,GAAegD,GAAKpnD,EAAA,KAAK48C,GAAO,gBAAgB,MAAM,CACrE,WAAA6N,EACA,OAAAC,EACA,YAAaC,EAAY,YAAc,WACvC,KAAM,CACF,MAAA16C,EACA,OAAAC,EACH,EACD,WAAA86C,GACA,MAAAH,GACA,YAAa,CAACC,EAC9B,CAAa,CAAC,EAAE,KAAK9F,GAASnU,GAAQmQ,CAAE,CAAC,CAAC,CAAC,EACzBvpC,EAAak/B,GAAmBD,GAAM,EAAI,EAChD,aAAM,KAAK,4BAA4BlhC,EAAMiC,CAAU,EAChDA,CACV,CACD,MAAM,gBAAgBvI,EAAS,CAC3B,MAAMuI,EAAa,MAAM,KAAK,IAAIvI,CAAO,EACzC,OAAO,IAAI,eAAe,CACtB,MAAM+7C,EAAY,CACdA,EAAW,QAAQxzC,CAAU,EAC7BwzC,EAAW,MAAK,CACnB,CACjB,CAAa,CACJ,CACD,MAAM,YAAY/7C,EAAS,CACvB,KAAM,CAAE,KAAA0kB,EAAM,KAAA9zB,EAAM,sBAAAyzB,EAAuB,QAAAqE,CAAO,EAAK1oB,EACvD,GAAIA,EAAQ,iBAAmB,QAAaA,EAAQ,eAChD,MAAM,IAAIghC,EAAqB,yCAAyC,EAE5E,GAAIhhC,EAAQ,mBAAqB,QAAaA,EAAQ,iBAClD,MAAM,IAAIghC,EAAqB,2CAA2C,EAE9E,GAAIhhC,EAAQ,cAAgB,QAAa,CAACA,EAAQ,YAC9C,MAAM,IAAIghC,EAAqB,sCAAsC,EAEzE,GAAItc,IAAS,QAAaA,EAAK,QAAU,QAAaA,EAAK,QAAU,EACjE,MAAM,IAAIsc,EAAqB,0CAA0C,EAE7E,IAAIpY,EACJ,GAAIlE,EACA,GAAIL,EACAuE,EAAMlE,MAEL,CAID,KAAM,CAACs3B,GAAUC,EAAO,EAAI,MAAM,KAAK,SAAS,IAAM,CAClD,GAAI,CAAC,OAAO,eACR,MAAM,IAAI,MAAM,yCAAyC,EAE7D,MAAO,CACH,OAAO,eAAe,SACtB,OAAO,eAAe,OAClD,CACA,CAAqB,EACDrzB,EAAM,CACF,GAAGlE,EACH,EAAGA,EAAK,EAAIs3B,GACZ,EAAGt3B,EAAK,EAAIu3B,EACpC,CACiB,CAUL,OARa,MAAMnrD,EAAA,KAAK48C,GAAO,gBAAgB,kBAAkB,CAC7D,OAAQrpB,EAAwB,WAAa,WAC7C,OAAQ,CACJ,KAAM,SAASzzB,CAAI,GACnB,GAAI83B,IAAY,OAAY,CAAE,QAASA,EAAU,GAAK,EAAG,EAC5D,EACD,GAAIE,EAAM,CAAE,KAAM,CAAE,KAAM,MAAO,GAAGA,EAAO,EAAG,EAC9D,CAAa,CAEJ,CACD,MAAM,kBAAmB,CACrB,OAAO,MAAM93B,EAAA,KAAK48C,GAAO,kBAC5B,CACD,MAAM,cAAe,CACjB,MAAM58C,EAAA,KAAK48C,GAAO,gBAAgB,SAAQ,CAC7C,CACD,MAAM,sBAAsB2E,KAAiBn1B,EAAM,CAC/C,MAAMxB,EAAawgC,GAAqB7J,EAAc,GAAGn1B,CAAI,EAE7D,MAAO,CAAE,WADM,MAAMpsB,EAAA,KAAK48C,GAAO,gBAAgB,iBAAiBhyB,CAAU,EAE/E,CACD,MAAM,oCAAoCte,EAAI,CAC1C,MAAMtM,EAAA,KAAK48C,GAAO,gBAAgB,oBAAoBtwC,CAAE,CAC3D,CACD,MAAM,eAAenL,EAAMkqD,EAAc,CACrC,OAAO,MAAM,KAAK,UAAW,EAAC,eAAelqD,EAAM,YAAakqD,EAAeA,EAAa,QAAUA,CAAY,CACrH,CACD,2BAA4B,CACxB,MAAO,EACV,CACD,MAAM,gBAAgBzmB,EAAS,CAC3B,GAAI,CAAC5kC,EAAA,KAAK4oD,GAAgB,QAAO,EAAG,aAAc,CAC9C,MAAM5oD,EAAA,KAAK48C,GAAO,gBAAgB,iBAAiBhY,EAAU,UAAY,QAAQ,EACjF,MACH,CAED,MAAM,KAAK,UAAU,KAAK,2BAA4B,CAClD,cAAe,CAACA,CAChC,CAAa,CACJ,CACD,MAAM,WAAW0mB,EAAM,CACnB,MAAMC,GAAkBD,EAAK,OAASA,EAAO,CAAC,KAAK,IAAK,CAAA,GAAG,IAAIjzC,GACpD,IAAI,IAAIA,CAAG,CACrB,EAED,OADgB,MAAMrY,EAAA,KAAK48C,GAAO,gBAAgB,WAAU,GAEvD,IAAI9kC,GACE0zC,GAAsB1zC,CAAM,CACtC,EACI,OAAOA,GACDyzC,EAAe,KAAKlzC,GAChBozC,GAAmB3zC,EAAQO,CAAG,CACxC,CACJ,CACJ,CACD,yBAA0B,CACtB,MAAM,IAAI63B,CACb,CACD,QAAS,CACL,MAAM,IAAIA,CACb,CACD,MAAM,mBAAmBhhC,EAAU,GAAI,CACnC,KAAM,CAAE,QAAA2hC,EAAU,KAAK,iBAAiB,QAAO,CAAI,EAAG3hC,EAChDw8C,EAAWzjC,GAAS,OAAO,CAC7B,QAAS,uCAAuC4oB,CAAO,cACvD,QAAAA,CAChB,CAAa,EACD7wC,EAAA,KAAKgpD,GAAsB,IAAI0C,CAAQ,EACnCx8C,EAAQ,QACRA,EAAQ,OAAO,iBAAiB,QAAS,IAAM,OAC3Cw8C,EAAS,QAAOprD,EAAA4O,EAAQ,SAAR,YAAA5O,EAAgB,MAAM,CAC1D,EAAmB,CAAE,KAAM,EAAI,CAAE,EAErBN,EAAA,KAAK48C,GAAO,gBAAgB,KAAK,mBAAoBnN,GAAQ,CACzD,GAAI,CAACA,EAAK,QACN,OAEJ,MAAMkc,EAAU,IAAIC,GAAYpQ,GAAkB,KAAK,CACnD,SAAU/L,EAAK,QAAQ,SACvB,OAAQA,EAAK,QAAQ,OACrB,KAAM,MAC1B,EAAmBzvC,EAAA,KAAK48C,GAAO,UAAW,CAAA,EAAGnN,EAAK,QAAQ,EAC1C,UAAWic,KAAY1rD,EAAA,KAAKgpD,GACxB0C,EAAS,QAAQC,CAAO,EACxB3rD,EAAA,KAAKgpD,GAAsB,OAAO0C,CAAQ,CAE9D,CAAa,EACD,GAAI,CACA,OAAO,MAAMA,EAAS,cACzB,OACMlqD,EAAO,CACV,MAAAxB,EAAA,KAAKgpD,GAAsB,OAAO0C,CAAQ,EACpClqD,CACT,CACJ,CACD,SAAU,CACN,MAAO,CAAC,GAAGxB,EAAA,KAAK8mC,EAAQ,CAC3B,CACD,IAAI,8BAA+B,CAC/B,MAAQ,EAAQ9mC,EAAA,KAAKkpD,IACjB,EAAQlpD,EAAA,KAAKmpD,IACb,EAAQnpD,EAAA,KAAKopD,EACpB,CAED,MAAM,uBAAuBQ,EAAQ,CACjC3oD,EAAA,KAAKioD,EAAuB,MAAM9nD,EAAA,KAAKsnD,EAAAmD,IAAL,UAAyB,CAAC,mBAAmB,EAAuD7rD,EAAA,KAAKkpD,GAAsBU,GACpK,CAMD,MAAM,oBAAoBzyC,EAAS,CAC/B,MAAM20C,EAAmB,CAAA,EACzB,SAAW,CAACr+C,EAAK5B,CAAK,IAAK,OAAO,QAAQsL,CAAO,EAC7C3L,GAAO02C,GAASr2C,CAAK,EAAG,6BAA6B4B,CAAG,wBAAwB,OAAO5B,CAAK,aAAa,EACzGigD,EAAiBr+C,EAAI,YAAa,CAAA,EAAI5B,EAE1C,KAAK,kBAAoBigD,EACzB7qD,EAAA,KAAKkoD,EAA4B,MAAM/nD,EAAA,KAAKsnD,EAAAmD,IAAL,UAAyB,CAAC,mBAAmB,EAAuD7rD,EAAA,KAAKmpD,GAA2B,EAAQ,OAAO,KAAK,KAAK,iBAAiB,EAAE,QAC1N,CAMD,MAAM,aAAahrB,EAAa,CAC5Bl9B,EAAA,KAAKmoD,EAAoB,MAAMhoD,EAAA,KAAKsnD,EAAAmD,IAAL,UAAyB,CAAC,gBAAgE7rD,EAAA,KAAKopD,GAAmB,EAAQjrB,IACzJ,KAAK,aAAeA,CACvB,CAaD,qBAAsB,CAClB,MAAM,IAAI+R,CACb,CACD,wBAAyB,CACrB,MAAM,IAAIA,CACb,CACD,MAAM,eAAetL,EAAS,CAC1B,OAAK5kC,EAAA,KAAK4oD,GAAgB,QAAO,EAAG,cAG/B5oD,EAAA,KAAK+oD,IACN9nD,EAAA,KAAK8nD,EAA6B,CAC9B,QAAS,GACT,OAAQ,GACR,SAAU,GACV,QAAS,CAC7B,GAEY/oD,EAAA,KAAK+oD,GAA2B,QAAUnkB,EACnC,MAAMxjC,EAAA,KAAKsnD,EAAAqD,IAAL,YAXF,MAAM/rD,EAAA,KAAK48C,GAAO,gBAAgB,eAAehY,CAAO,CAYtE,CACD,MAAM,yBAAyB/P,EAAmB,CAC9C,GAAI,CAAC70B,EAAA,KAAK4oD,GAAgB,QAAO,EAAG,aAAc,CAC9C,GAAI,EAAC/zB,GAAA,MAAAA,EAAmB,aAClBA,GAAA,YAAAA,EAAmB,SAAU,KAAO,KACjCA,GAAA,YAAAA,EAAmB,WAAY,KAAO,KACtCA,GAAA,YAAAA,EAAmB,UAAW,GAAK,GAExC,MAAM,IAAIqb,EAEd,OAAO,MAAMlwC,EAAA,KAAK48C,GAAO,gBAAgB,gBAAe/nB,GAAA,YAAAA,EAAmB,UAAW,EAAK,CAC9F,CACD,OAAK70B,EAAA,KAAK+oD,IACN9nD,EAAA,KAAK8nD,EAA6B,CAC9B,SAASl0B,GAAA,YAAAA,EAAmB,UAAW,GACvC,OAAQ,GACR,SAAU,GACV,QAAS,CAC7B,GAEY70B,EAAA,KAAK+oD,GAA2B,OAASl0B,EACnCA,EAAkB,OAClB,GACN70B,EAAA,KAAK+oD,GAA2B,SAAWl0B,EACrCA,EAAkB,SAClB,GACN70B,EAAA,KAAK+oD,GAA2B,QAAUl0B,EACpCA,EAAkB,QAClB,EACN70B,EAAA,KAAK+oD,GAA2B,SAC5Bl0B,GAAA,YAAAA,EAAmB,UAAW,GAC3B,MAAMzzB,EAAA,KAAKsnD,EAAAqD,IAAL,UAChB,CAYD,MAAM,aAAaptB,EAAS,CACxB,MAAMqtB,EAAU,KAAK,MACfC,EAAwBD,EAAQ,WAAW,MAAM,EACvD,UAAWl0C,KAAU6mB,EAAS,CAC1B,IAAIutB,EAAYp0C,EAAO,KAAO,GAC1B,CAACo0C,GAAaD,IACdC,EAAYF,GAEhBxgD,GAAO0gD,IAAc,cAAe,mCAAmCp0C,EAAO,IAAI,GAAG,EACrFtM,GAAO,CAAC,OAAO,UAAU,WAAW,KAAK0gD,GAAa,GAAI,OAAO,EAAG,sCAAsCp0C,EAAO,IAAI,GAAG,EAExHtM,GAAOsM,EAAO,eAAiB,QAC3B,OAAOA,EAAO,cAAiB,SAAU,wCAAwC,EACrF,MAAMq0C,EAAgB,IAAI,SAASD,CAAS,EACtC,IAAI,IAAIA,CAAS,EACjB,OACAE,EAASt0C,EAAO,SAAUq0C,GAAA,YAAAA,EAAe,UAC/C3gD,GAAO4gD,IAAW,OAAW,0DAA0D,EACvF,MAAM5qC,GAAa,CACf,OAAQ4qC,EACR,KAAMt0C,EAAO,KACb,MAAO,CACH,KAAM,SACN,MAAOA,EAAO,KACjB,EACD,GAAIA,EAAO,OAAS,OAAY,CAAE,KAAMA,EAAO,IAAM,EAAG,GACxD,GAAIA,EAAO,WAAa,OAAY,CAAE,SAAUA,EAAO,QAAU,EAAG,GACpE,GAAIA,EAAO,SAAW,OAAY,CAAE,OAAQA,EAAO,MAAQ,EAAG,GAC9D,GAAIA,EAAO,WAAa,OAClB,CAAE,SAAUu0C,GAAgCv0C,EAAO,QAAQ,CAAG,EAC9D,GACD,OAAQw0C,GAA8Bx0C,EAAO,OAAO,EAEzD,GAAGy0C,GAA+Cz0C,EAAQ,YAAa,eAAgB,WAAY,KAAK,CAC5H,EACoBA,EAAO,eAAiB,OACxB,MAAM,KAAK,eAAc,EAAG,YAAY,UAAU0J,GAAY1J,EAAO,YAAY,EAGjF,MAAM9X,EAAA,KAAK48C,GAAO,gBAAgB,UAAUp7B,EAAU,CAE7D,CACJ,CACD,MAAM,gBAAgBmd,EAAS,CAC3B,MAAM,QAAQ,IAAIA,EAAQ,IAAI,MAAO6tB,GAAwB,CACzD,MAAMN,EAAYM,EAAoB,KAAO,KAAK,IAAG,EAC/CL,EAAgB,IAAI,SAASD,CAAS,EACtC,IAAI,IAAIA,CAAS,EACjB,OACAE,EAASI,EAAoB,SAAUL,GAAA,YAAAA,EAAe,UAC5D3gD,GAAO4gD,IAAW,OAAW,0DAA0D,EACvF,MAAMpqC,EAAS,CACX,OAAQoqC,EACR,KAAMI,EAAoB,KAC1B,GAAIA,EAAoB,OAAS,OAC3B,CAAE,KAAMA,EAAoB,IAAM,EAClC,EAC1B,EACgB,MAAMxsD,EAAA,KAAK48C,GAAO,gBAAgB,aAAa56B,CAAM,CACxD,CAAA,CAAC,CACL,CACD,MAAM,sBAAsB7gB,EAAM,CAC9B,MAAMnB,EAAA,KAAK48C,GAAO,sBAAsBz7C,CAAI,CAC/C,CACD,SAAU,CACN,MAAM,IAAI+uC,CACb,CACD,MAAM,OAAOhhC,EAAU,GAAI,CACvB,OAAO,MAAM9N,EAAA,KAAKsnD,EAAA+D,IAAL,UAAS,GAAIv9C,EAC7B,CACD,MAAM,UAAUA,EAAU,GAAI,CAC1B,OAAO,MAAM9N,EAAA,KAAKsnD,EAAA+D,IAAL,UAAS,EAAGv9C,EAC5B,CAkBD,qBAAsB,CAClB,MAAM,IAAIghC,CACb,CACT,EA/pBQyY,EAAA,YAGAC,EAAA,YACAhM,EAAA,YACAiM,EAAA,YACA/hB,EAAA,YAMAgiB,EAAA,YACAC,EAAA,YACAC,EAAA,YA1BGN,EAAA,YAyCHhU,GAAW,UAAG,CACV10C,EAAA,KAAK48C,GAAO,gBAAgB,GAAG,SAAU,IAAM,CAC3C,KAAK,eAAe,KAAK,QAA+B,MAAS,EACjE,KAAK,eAAe,oBACpC,CAAa,EACD,KAAK,eAAe,GAAG,gBAA+C5U,GAAU,CAC5EhoC,EAAA,KAAK8mC,GAAS,IAAIkB,CAAM,CACxC,CAAa,EACD,KAAK,eAAe,GAAG,kBAAmDA,GAAU,CAChFhoC,EAAA,KAAK8mC,GAAS,OAAOkB,CAAM,CAC3C,CAAa,CACJ,EAIDihB,EAAA,YA+aAC,EAAA,YAQAC,EAAA,YAcAC,EAAA,YAKMyC,GAAmB,eAAC/wC,EAAQ4xC,EAAcC,EAAU,CACtD,GAAIA,GAAY,CAACD,EACb,OAAO,MAAM1sD,EAAA,KAAK48C,GAAO,gBAAgB,aAAa,CAClD,OAAA9hC,CACpB,CAAiB,EAEA,GAAI,CAAC6xC,GAAYD,EAAc,CAChC,MAAM1sD,EAAA,KAAK48C,GAAO,gBAAgB,YAAY,QAAQ,gBAAgB8P,CAAY,EAClF,MACH,CACD,OAAOA,CACV,EAsDKX,GAAuB,gBAAG,CACvB/rD,EAAA,KAAK+oD,IAGV,MAAM,KAAK,UAAU,KAAK,mCAAoC,CAC1D,QAAS/oD,EAAA,KAAK+oD,GAA2B,QACzC,QAAS/oD,EAAA,KAAK+oD,GAA2B,QACzC,iBAAkB/oD,EAAA,KAAK+oD,GAA2B,OAClD,mBAAoB/oD,EAAA,KAAK+oD,GAA2B,QACpE,CAAa,CACJ,EA0EK0D,GAAG,eAACl4B,EAAOrlB,EAAS,CACtB,MAAM+7C,EAAa,IAAI,gBACvB,GAAI,CACA,KAAM,CAAC/lC,CAAQ,EAAI,MAAM,QAAQ,IAAI,CACjC,KAAK,kBAAkB,CACnB,GAAGhW,EACH,OAAQ+7C,EAAW,MAC3C,CAAqB,EACDjrD,EAAA,KAAK48C,GAAO,gBAAgB,gBAAgBroB,CAAK,CACrE,CAAiB,EACD,OAAOrP,CACV,OACM1jB,EAAO,CACV,MAAAypD,EAAW,MAAK,EACVzpD,CACT,CACJ,GAtqBD,IAAA,CACI,MAAMyzC,EAAY,OAAO,QAAW,YAAc,OAAO,SAAW,OAAO,OAAOf,EAAY,OAAO,QAAQ,GAAK,IAAI,EAAI,OAC1HoU,EAA6B,CAACsE,GAAM,CAAE,EACtCpZ,GAAalzC,EAAM,KAAMgoD,EAA4B,CAAE,KAAM,WAAY,KAAM,iBAAkB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKpT,GAAO,mBAAoBA,EAAK,IAAKA,GAAOA,EAAI,eAAgB,IAAK,CAACA,EAAKrpC,IAAU,CAAEqpC,EAAI,eAAiBrpC,CAAM,GAAM,SAAUopC,GAAasT,EAA8BC,CAAiC,EACzVvT,GAAW,OAAO,eAAe30C,EAAM,OAAO,SAAU,CAAE,WAAY,GAAM,aAAc,GAAM,SAAU,GAAM,MAAO20C,CAAS,CAAE,CACzI,KANE30C,CA4qBX,GAAK,EAGL,SAAS8qD,GAAqByB,KAAQzgC,EAAM,CACxC,MAAO,UAAU0gC,GAAiBD,EAAK,GAAGzgC,CAAI,CAAC,GACnD,CAIA,SAAS2gC,GAA2Bj1C,EAAQq0C,EAAe,CACvD,MAAMa,EAAel1C,EAAO,OAAO,YAAW,EACxCm1C,EAAcd,EAAc,SAAS,YAAW,EACtD,OAAIa,IAAiBC,EACV,GAMJD,EAAa,WAAW,GAAG,GAAKC,EAAY,SAASD,CAAY,CAC5E,CAKA,SAASE,GAAuBp1C,EAAQq0C,EAAe,CACnD,MAAMgB,EAAUhB,EAAc,SACxBiB,EAAat1C,EAAO,KAK1B,MAJI,GAAAq1C,IAAYC,GAIZD,EAAQ,WAAWC,CAAU,IAEzBA,EAAW,SAAS,GAAG,GAIvBD,EAAQC,EAAW,MAAM,IAAM,KAO3C,CAIA,SAAS3B,GAAmB3zC,EAAQO,EAAK,CACrC,MAAM8zC,EAAgB,IAAI,IAAI9zC,CAAG,EAEjC,OADA7M,GAAOsM,IAAW,MAAS,EACtBi1C,GAA2Bj1C,EAAQq0C,CAAa,EAG9Ce,GAAuBp1C,EAAQq0C,CAAa,EAFxC,EAGf,CACO,SAASX,GAAsBhqC,EAAY6rC,EAA8B,GAAO,CACnF,MAAMr1C,EAAewJ,EAAW8rC,GAAsB,cAAc,EACpE,SAASC,GAAkB,CACvB,OAAI,OAAOv1C,GAAiB,SACjB,CAAE,aAAAA,CAAY,EAErB,OAAOA,GAAiB,UAAYA,IAAiB,KACjDq1C,EACO,CACH,aAAc,CACV,aAAcr1C,EAAa,aAC3B,qBAAsBA,EAAa,sBAAwB,EAC9D,CACrB,EAEmB,CAGH,aAAcA,EAAa,YAC3C,EAEe,EACV,CACD,MAAO,CACH,KAAMwJ,EAAW,KAEjB,MAAOA,EAAW,MAAM,MACxB,OAAQA,EAAW,OACnB,KAAMA,EAAW,KACjB,KAAMA,EAAW,KACjB,SAAUA,EAAW,SACrB,OAAQA,EAAW,OACnB,SAAUgsC,GAAgChsC,EAAW,QAAQ,EAC7D,QAASA,EAAW,QAAU,GAC9B,QAASA,EAAW,SAAW,QAAaA,EAAW,QAAU,EAEjE,GAAGisC,GAA+CjsC,EAAY,YAAa,eAAgB,qBAAsB,UAAU,EAC3H,GAAG+rC,EAAiB,CAC5B,CACA,CACA,MAAMD,GAAsB,QAI5B,SAASG,GAA+CjsC,KAAeksC,EAAe,CAClF,MAAMpoD,EAAS,CAAA,EACf,UAAWqoD,KAAYD,EACflsC,EAAW8rC,GAAsBK,CAAQ,IAAM,SAC/CroD,EAAOqoD,CAAQ,EAAInsC,EAAW8rC,GAAsBK,CAAQ,GAGpE,OAAOroD,CACX,CAKO,SAASinD,GAA+CqB,KAAgBF,EAAe,CAC1F,MAAMpoD,EAAS,CAAA,EACf,UAAWqoD,KAAYD,EACfE,EAAYD,CAAQ,IAAM,SAC1BroD,EAAOgoD,GAAsBK,CAAQ,EAAIC,EAAYD,CAAQ,GAGrE,OAAOroD,CACX,CACA,SAASkoD,GAAgCt1C,EAAU,CAC/C,OAAOA,IAAa,SAAW,SAAWA,IAAa,MAAQ,MAAQ,MAC3E,CACO,SAASm0C,GAAgCn0C,EAAU,CACtD,OAAOA,IAAa,SACd,SACAA,IAAa,MACT,MACA,MACd,CACO,SAASo0C,GAA8BuB,EAAQ,CAClD,MAAO,CAAC,OAAW,EAAE,EAAE,SAASA,CAAM,EAAI,OAAYA,CAC1D,CACO,SAASC,GAA8C91C,EAAc,CACxE,GAAIA,IAAiB,QAAa,OAAOA,GAAiB,SACtD,OAAOA,EAEX,GAAIA,EAAa,qBACb,MAAM,IAAIk4B,EAAqB,6DAA6D,EAEhG,OAAOl4B,EAAa,YACxB,CCl7BA;AAAA;AAAA;AAAA;AAAA,UAWO,MAAM+1C,WAA0BC,EAAO,CAE1C,YAAYjY,EAAS,CACjB,QAFJn2C,EAAA,KAAAquD,IAGIhtD,EAAA,KAAKgtD,GAAWlY,EACnB,CACD,QAAS,CACL,MAAM,IAAI7F,CACb,CACD,KAAM,CACF,MAAO,EACV,CACD,kBAAmB,CACf,MAAM,IAAIA,CACb,CACD,MAAO,CACH,OAAOge,GAAW,OACrB,CACD,SAAU,CACN,OAAOluD,EAAA,KAAKiuD,GACf,CACD,gBAAiB,CACb,OAAOjuD,EAAA,KAAKiuD,IAAS,uBACxB,CACD,QAAS,CACL,MAAM,IAAI/d,CACb,CACL,CA1BI+d,GAAA,mBA8BG,MAAME,WAAuBH,EAAO,CAEvC,YAAYpH,EAAM,CACd,QAFJhnD,EAAA,KAAAinD,IAGI5lD,EAAA,KAAK4lD,GAAQD,EAChB,CACD,MAAM,MAAO,CACT,OAAO5mD,EAAA,KAAK6mD,GACf,CACD,MAAM,QAAS,CACX,OAAOuB,GAAS,KAAK,KAAK,eAAc,EAAIpoD,EAAA,KAAK6mD,IAAM,YAAY,eAAe,CACrF,CACD,KAAM,CACF,OAAO7mD,EAAA,KAAK6mD,IAAM,KACrB,CACD,kBAAmB,CACf,OAAO7mD,EAAA,KAAK6mD,IAAM,kBACrB,CACD,MAAO,CACH,OAAOqH,GAAW,IACrB,CACD,SAAU,CACN,OAAO,KAAK,iBAAiB,SAChC,CACD,gBAAiB,CACb,OAAOluD,EAAA,KAAK6mD,IAAM,gBACrB,CACD,QAAS,CACL,MAAM,IAAI3W,CACb,CACL,CA7BI2W,GAAA,sBAiCG,MAAMuH,WAAwBJ,EAAO,CAGxC,YAAYlhC,EAAO,CACf,QAHJltB,EAAA,KAAAg9C,IACAh9C,EAAA,KAAAinD,IAGI5lD,EAAA,KAAK27C,GAAS9vB,EACjB,CACD,MAAM,MAAO,CACT,OAAI9sB,EAAA,KAAK6mD,MAAU,QACf5lD,EAAA,KAAK4lD,GAAQuB,GAAS,KAAK,KAAK,eAAc,EAAIpoD,EAAA,KAAK48C,IAAO,eAAe,GAE1E58C,EAAA,KAAK6mD,GACf,CACD,MAAM,QAAS,CACX,OAAOuB,GAAS,KAAK,KAAK,eAAgB,EAAEpoD,EAAA,KAAK48C,IAAO,eAAe,CAC1E,CACD,KAAM,CACF,OAAO58C,EAAA,KAAK48C,IAAO,KACtB,CACD,kBAAmB,CACf,OAAO58C,EAAA,KAAK48C,IAAO,kBACtB,CACD,MAAO,CACH,OAAOsR,GAAW,IACrB,CACD,SAAU,CACN,OAAO,KAAK,iBAAiB,SAChC,CACD,gBAAiB,CACb,OAAOluD,EAAA,KAAK48C,IAAO,KAAM,EAAC,eAAc,CAC3C,CACD,QAAS,CACL,MAAM,IAAI1M,CACb,CACL,CAjCI0M,GAAA,YACAiK,GAAA,mBAoCG,MAAMwH,WAAyBL,EAAO,CAEzC,YAAYhmB,EAAQ,CAChB,QAFJpoC,EAAA,KAAAgjD,IAGI3hD,EAAA,KAAK2hD,GAAU5a,EAClB,CACD,MAAM,MAAO,CACT,MAAM,IAAIkI,CACb,CACD,MAAM,QAAS,CACX,MAAM,IAAIA,CACb,CACD,KAAM,CACF,OAAOlwC,EAAA,KAAK4iD,IAAQ,KACvB,CACD,kBAAmB,CACf,MAAM,IAAI1S,CACb,CACD,MAAO,CACH,OAAOge,GAAW,KACrB,CACD,SAAU,CACN,OAAO,KAAK,iBAAiB,SAChC,CACD,gBAAiB,CACb,OAAOluD,EAAA,KAAK4iD,IAAQ,MAAM,KAAM,EAAC,eAAc,CAClD,CACD,QAAS,CACL,MAAM,IAAI1S,CACb,CACL,CA7BI0S,GAAA,YCnHJ;AAAA;AAAA;AAAA;AAAA,GAKA,IAAIpP,GAA8C,SAAUC,EAAMC,EAAcC,EAAYC,EAAWN,EAAcO,EAAmB,CACpI,SAAS1gB,EAAOwe,EAAG,CAAE,GAAIA,IAAM,QAAU,OAAOA,GAAM,WAAY,MAAM,IAAI,UAAU,mBAAmB,EAAG,OAAOA,CAAI,CAKvH,QAJImC,EAAOF,EAAU,KAAMnmC,EAAMqmC,IAAS,SAAW,MAAQA,IAAS,SAAW,MAAQ,QACrFj0B,EAAS,CAAC6zB,GAAgBD,EAAOG,EAAU,OAAYH,EAAOA,EAAK,UAAY,KAC/E9xB,EAAa+xB,IAAiB7zB,EAAS,OAAO,yBAAyBA,EAAQ+zB,EAAU,IAAI,EAAI,CAAA,GACjGG,EAAGC,EAAO,GACL50C,EAAIu0C,EAAW,OAAS,EAAGv0C,GAAK,EAAGA,IAAK,CAC7C,IAAIiI,EAAU,CAAA,EACd,QAAS5B,KAAKmuC,EAAWvsC,EAAQ5B,CAAC,EAAIA,IAAM,SAAW,CAAA,EAAKmuC,EAAUnuC,CAAC,EACvE,QAASA,KAAKmuC,EAAU,OAAQvsC,EAAQ,OAAO5B,CAAC,EAAImuC,EAAU,OAAOnuC,CAAC,EACtE4B,EAAQ,eAAiB,SAAUsqC,EAAG,CAAE,GAAIqC,EAAM,MAAM,IAAI,UAAU,wDAAwD,EAAGH,EAAkB,KAAK1gB,EAAOwe,GAAK,IAAI,CAAC,GACzK,IAAIrsC,KAAaquC,EAAWv0C,CAAC,GAAG00C,IAAS,WAAa,CAAE,IAAKnyB,EAAW,IAAK,IAAKA,EAAW,GAAG,EAAKA,EAAWlU,CAAG,EAAGpG,CAAO,EAC7H,GAAIysC,IAAS,WAAY,CACrB,GAAIxuC,IAAW,OAAQ,SACvB,GAAIA,IAAW,MAAQ,OAAOA,GAAW,SAAU,MAAM,IAAI,UAAU,iBAAiB,GACpFyuC,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,IAAI,IAAGguC,EAAa,QAAQS,CAAC,CACtD,MACQA,EAAI5gB,EAAO7tB,CAAM,KAClBwuC,IAAS,QAASR,EAAa,QAAQS,CAAC,EACvCpyB,EAAWlU,CAAG,EAAIsmC,EAE9B,CACGl0B,GAAQ,OAAO,eAAeA,EAAQ+zB,EAAU,KAAMjyB,CAAU,EACpEqyB,EAAO,EACX,EACIZ,GAAwD,SAAUC,EAASC,EAAcznC,EAAO,CAEhG,QADI0nC,EAAW,UAAU,OAAS,EACzBn0C,EAAI,EAAGA,EAAIk0C,EAAa,OAAQl0C,IACrCyM,EAAQ0nC,EAAWD,EAAal0C,CAAC,EAAE,KAAKi0C,EAASxnC,CAAK,EAAIynC,EAAal0C,CAAC,EAAE,KAAKi0C,CAAO,EAE1F,OAAOE,EAAW1nC,EAAQ,MAC9B,EACIgvC,GAAoE,SAAUC,EAAKjvC,EAAOkvC,EAAO,CACjG,GAAIlvC,GAAU,KAA0B,CACpC,GAAI,OAAOA,GAAU,UAAY,OAAOA,GAAU,WAAY,MAAM,IAAI,UAAU,kBAAkB,EACpG,IAAImvC,EAASC,EACb,GAAIF,EAAO,CACP,GAAI,CAAC,OAAO,aAAc,MAAM,IAAI,UAAU,qCAAqC,EACnFC,EAAUnvC,EAAM,OAAO,YAAY,CACtC,CACD,GAAImvC,IAAY,OAAQ,CACpB,GAAI,CAAC,OAAO,QAAS,MAAM,IAAI,UAAU,gCAAgC,EACzEA,EAAUnvC,EAAM,OAAO,OAAO,EAC1BkvC,IAAOE,EAAQD,EACtB,CACD,GAAI,OAAOA,GAAY,WAAY,MAAM,IAAI,UAAU,wBAAwB,EAC3EC,IAAOD,EAAU,UAAW,CAAE,GAAI,CAAEC,EAAM,KAAK,IAAI,CAAI,OAAQ97C,EAAG,CAAE,OAAO,QAAQ,OAAOA,CAAC,CAAE,IACjG27C,EAAI,MAAM,KAAK,CAAE,MAAOjvC,EAAO,QAASmvC,EAAS,MAAOD,CAAK,CAAE,CAClE,MACQA,GACLD,EAAI,MAAM,KAAK,CAAE,MAAO,EAAM,CAAA,EAElC,OAAOjvC,CACX,EACIqvC,GAA2D,SAAUC,EAAiB,CACtF,OAAO,SAAUL,EAAK,CAClB,SAASM,EAAKj8C,EAAG,CACb27C,EAAI,MAAQA,EAAI,SAAW,IAAIK,EAAgBh8C,EAAG27C,EAAI,MAAO,0CAA0C,EAAI37C,EAC3G27C,EAAI,SAAW,EAClB,CACD,IAAI,EAAGO,EAAI,EACX,SAASC,GAAO,CACZ,KAAO,EAAIR,EAAI,MAAM,IAAG,GACpB,GAAI,CACA,GAAI,CAAC,EAAE,OAASO,IAAM,EAAG,OAAOA,EAAI,EAAGP,EAAI,MAAM,KAAK,CAAC,EAAG,QAAQ,UAAU,KAAKQ,CAAI,EACrF,GAAI,EAAE,QAAS,CACX,IAAIh2C,EAAS,EAAE,QAAQ,KAAK,EAAE,KAAK,EACnC,GAAI,EAAE,MAAO,OAAO+1C,GAAK,EAAG,QAAQ,QAAQ/1C,CAAM,EAAE,KAAKg2C,EAAM,SAASn8C,EAAG,CAAE,OAAAi8C,EAAKj8C,CAAC,EAAUm8C,GAAO,CAAE,CACzG,MACID,GAAK,CACb,OACMl8C,EAAG,CACNi8C,EAAKj8C,CAAC,CACT,CAEL,GAAIk8C,IAAM,EAAG,OAAOP,EAAI,SAAW,QAAQ,OAAOA,EAAI,KAAK,EAAI,QAAQ,QAAO,EAC9E,GAAIA,EAAI,SAAU,MAAMA,EAAI,KAC/B,CACD,OAAOQ,EAAI,CACnB,CACA,EAAG,OAAO,iBAAoB,WAAa,gBAAkB,SAAU95C,EAAO+5C,EAAY/4C,EAAS,CAC/F,IAAIrD,EAAI,IAAI,MAAMqD,CAAO,EACzB,OAAOrD,EAAE,KAAO,kBAAmBA,EAAE,MAAQqC,EAAOrC,EAAE,WAAao8C,EAAYp8C,CACnF,CAAC,EAcE,IAACmvD,IAAsB,IAAM,2BAC5B,IAAIpa,EAAcqa,GACdjG,EACAC,EAA+B,CAAA,EAC/BC,EAAoC,CAAA,EACxC,OAAOloD,EAAA,cAAiC4zC,CAAY,CAsBhD,YAAY6B,EAASxuC,EAAa2H,EAAS,CACvC,QAvBDtP,EAAA,KAAA4uD,GAYH5uD,EAAA,KAAA+oD,EAAmCvV,GAAkB,KAAMmV,EAA8B,IAAI5oD,CAAc,GAG3GC,EAAA,KAAAquD,EAAW7a,GAAkB,KAAMoV,CAAiC,GACpE5oD,EAAA,KAAA6uD,GAEAhtD,EAAA,oBACA7B,EAAA,KAAA8uD,EAAS,IAAI,SACb9uD,EAAA,KAAA+uD,EAAW,IAAI,KACf/uD,EAAA,KAAAgvD,EAAa,CAAA,GAGT3tD,EAAA,KAAKgtD,EAAWlY,GAChB,KAAK,YAAcxuC,EACnBtG,EAAA,KAAKwtD,EAAmBv/C,EAAQ,gBACnC,CApBD,OAAO,KAAK6mC,EAASxuC,EAAa2H,EAAS,OACvC,MAAM7H,EAAU,IAAI/G,EAAmBy1C,EAASxuC,EAAa2H,CAAO,EACpE,OAAA9N,EAAAd,EAAA+G,EAAQmnD,EAAA9Z,IAAR,KAAAp0C,GACO+G,CACV,CAED,IAAI,gBAAiB,CAAE,OAAOrH,EAAA,KAAK2oD,EAAmC,CACtE,IAAI,eAAe98C,EAAO,CAAE5K,EAAA,KAAK0nD,EAAmC98C,EAAQ,CAgG5E,SAAU,CACN,MAAO,CAAC,GAAG7L,EAAA,KAAK2uD,GAAS,OAAM,CAAE,EAAE,QAAQ,CAAC,CAAC9uC,EAAQ+9B,CAAM,IAChD,CAAC/9B,EAAQ,GAAG+9B,EAAO,OAAQ,CAAA,CACrC,CACJ,CACD,MAAM,QAAQ1uC,EAAS,CACnB,MAAM4sC,EAAQ,CAAE,MAAO,CAAE,EAAE,MAAO,OAAQ,SAAU,IACpD,GAAI,CACA,MAAMoO,EAASrP,GAAwBiB,EAAO,MAAM,KAAK,4BAA2B,EAAI,EAAK,EACvFh8C,GAAOoP,GAAA,YAAAA,EAAS,QAAS,SACzB,SACA,MACA7H,EAAU,MAAM,KAAK,YAAY,sBAAsBvH,CAAI,EAC3D8mD,EAAO5mD,EAAA,KAAK0uD,GAAO,IAAIrnD,CAAO,EACpC,GAAI,CAACu/C,EACD,MAAM,IAAI,MAAM,mBAAmB,EAEvC,GAAI5mD,EAAA,KAAKyuD,GACL,GAAI,CACA,MAAM7H,EAAK,YAAY5mD,EAAA,KAAKyuD,EAAgB,CAC/C,MACK,CAEL,CAEL,OAAO7H,CACV,OACM7K,EAAK,CACRD,EAAM,MAAQC,EACdD,EAAM,SAAW,EACpB,QACO,CACJZ,GAAmBY,CAAK,CAC3B,CACJ,CACD,MAAM,OAAQ,CACVtwC,GAAO,KAAK,YAAY,KAAOkuC,GAAY,QAAS,0CAA0C,EAC9F,GAAI,CACA,MAAM,KAAK,YAAY,QAC1B,OACMl4C,EAAO,CACVqwC,GAAWrwC,CAAK,CACnB,CACDxB,EAAA,KAAK2uD,GAAS,OACjB,CACD,SAAU,CACN,OAAO3uD,EAAA,KAAKiuD,EACf,CACD,MAAM,MAAMY,EAAc,GAAO,CAC7B,MAAO,CAAC,GAAG,KAAK,YAAY,gBAAgB,EAAE,IAAIxnD,GACvCrH,EAAA,KAAK0uD,GAAO,IAAIrnD,CAAO,CACjC,CACJ,CACD,MAAM,oBAAoB8J,EAAQ29C,EAAa,CAC3C,MAAMC,EAAiB,IAAI,IAAID,EAAY,IAAIE,GAAc,CAEzD,GAAI,CADuBC,GAAsC,IAAID,CAAU,EAE3E,MAAM,IAAI,MAAM,uBAAyBA,CAAU,EAEvD,OAAOA,CACV,CAAA,CAAC,EACF,MAAM,QAAQ,IAAI,MAAM,KAAKC,GAAsC,KAAM,CAAA,EAAE,IAAID,GAAc,CACzF,MAAM1pD,EAAS,KAAK,YAAY,eAAe6L,EAAQ,CACnD,KAAM69C,CAC1B,EAAmBD,EAAe,IAAIC,CAAU,EAC1B,UACA,UAIN,OAHAhvD,EAAA,KAAK4uD,GAAW,KAAK,CAAE,OAAAz9C,EAAQ,WAAA69C,CAAY,CAAA,EAGtCD,EAAe,IAAIC,CAAU,EAG3B1pD,EAFIA,EAAO,MAAMusC,EAAU,CAGrC,CAAA,CAAC,CACL,CACD,MAAM,0BAA2B,CAC7B,MAAMziC,EAAWpP,EAAA,KAAK4uD,GAAW,IAAI,CAAC,CAAE,WAAAI,EAAY,OAAA79C,KACzC,KAAK,YACP,eAAeA,EAAQ,CACxB,KAAM69C,CACT,EAAE,QAAuD,EACrD,MAAMnd,EAAU,CACxB,EACD5wC,EAAA,KAAK2tD,EAAa,IAClB,MAAM,QAAQ,IAAIx/C,CAAQ,CAC7B,CACD,IAAI,IAAK,CACL,GAAI,KAAK,YAAY,KAAOsqC,GAAY,QAGxC,OAAO,KAAK,YAAY,EAC3B,CACD,MAAM,SAAU,CAEZ,OADgB,MAAM,KAAK,YAAY,WAAU,GAClC,IAAI5hC,GACR0zC,GAAsB1zC,EAAQ,EAAI,CAC5C,CACJ,CACD,MAAM,aAAa6mB,EAAS,CACxB,MAAM,QAAQ,IAAIA,EAAQ,IAAI,MAAO7mB,GAAW,CAC5C,MAAM0J,EAAa,CACf,OAAQ1J,EAAO,OACf,KAAMA,EAAO,KACb,MAAO,CACH,KAAM,SACN,MAAOA,EAAO,KACjB,EACD,GAAIA,EAAO,OAAS,OAAY,CAAE,KAAMA,EAAO,IAAM,EAAG,GACxD,GAAIA,EAAO,WAAa,OAAY,CAAE,SAAUA,EAAO,QAAU,EAAG,GACpE,GAAIA,EAAO,SAAW,OAAY,CAAE,OAAQA,EAAO,MAAQ,EAAG,GAC9D,GAAIA,EAAO,WAAa,OAClB,CAAE,SAAUu0C,GAAgCv0C,EAAO,QAAQ,CAAG,EAC9D,GACD,OAAQw0C,GAA8Bx0C,EAAO,OAAO,EAEzD,GAAGy0C,GAA+Cz0C,EAAQ,YAAa,eAAgB,WAAY,KAAK,CAC5H,EACgB,OAAO,MAAM,KAAK,YAAY,UAAU0J,EAAYssC,GAA8Ch2C,EAAO,YAAY,CAAC,CACzH,CAAA,CAAC,CACL,CACT,EA3NQ6wC,EAAA,YAGAsF,EAAA,YACAQ,EAAA,YAGAC,EAAA,YACAC,EAAA,YACAC,EAAA,YArBGJ,EAAA,YA4BH9Z,GAAW,UAAG,CAEV,UAAWnqC,KAAmB,KAAK,YAAY,iBAC3CnJ,EAAA,KAAKotD,EAAAU,IAAL,UAAiB3kD,GAErB,KAAK,YAAY,GAAG,kBAAmB,CAAC,CAAE,gBAAAA,CAAe,IAAO,CAC5D,MAAMq8C,EAAOxlD,EAAA,KAAKotD,EAAAU,IAAL,UAAiB3kD,GAG9B,GAAIA,EAAgB,eAChB,UAAWlD,KAAW,KAAK,YAAY,iBAC/BA,EAAQ,KAAOkD,EAAgB,gBAC/BvK,EAAA,KAAK0uD,GACA,IAAIrnD,CAAO,EACX,eAAe,KAAK,QAA+Bu/C,CAAI,CAIxF,CAAa,EACD,KAAK,YAAY,GAAG,SAAU,IAAM,CAChC,KAAK,eAAe,oBACpC,CAAa,CACJ,EACDsI,GAAW,SAAC3kD,EAAiB,CACzB,MAAMq8C,EAAOwB,GAAS,KAAK,KAAM79C,CAAe,EAChDvK,EAAA,KAAK0uD,GAAO,IAAInkD,EAAiBq8C,CAAI,EACrCA,EAAK,eAAe,GAAG,QAA+B,IAAM,CACxD5mD,EAAA,KAAK0uD,GAAO,OAAOnkD,CAAe,CAClD,CAAa,EAED,MAAM4kD,EAAa,IAAIhB,GAAevH,CAAI,EACpCwI,EAAc,IAAI,IACxB,OAAApvD,EAAA,KAAK2uD,GAAS,IAAI/H,EAAM,CAACuI,EAAYC,CAAW,CAAC,EACjDxI,EAAK,eAAe,GAAG,gBAA+C95B,GAAS,CAC3E,MAAMuiC,EAAYviC,EACZjN,EAAS,IAAIuuC,GAAgBiB,CAAS,EAC5CD,EAAY,IAAIC,EAAWxvC,CAAM,EACjC,KAAK,eAAe,KAAK,gBAAyDA,CAAM,CACxG,CAAa,EACD+mC,EAAK,eAAe,GAAG,iBAAiD95B,GAAS,CAC7E,MAAMuiC,EAAYviC,EACZjN,EAASuvC,EAAY,IAAIC,CAAS,EAEpCxvC,IAAW,OACX,KAAK,eAAe,KAAK,gBAAyDsvC,CAAU,EAG5F,KAAK,eAAe,KAAK,gBAAyDtvC,CAAM,CAE5G,CAAa,EACD+mC,EAAK,eAAe,GAAG,gBAA+C95B,GAAS,CAC3E,MAAMuiC,EAAYviC,EACZjN,EAASuvC,EAAY,IAAIC,CAAS,EACpCxvC,IAAW,SAGfuvC,EAAY,OAAOC,CAAS,EAC5B,KAAK,eAAe,KAAK,kBAA6DxvC,CAAM,EAC5G,CAAa,EACD+mC,EAAK,eAAe,GAAG,gBAA+C5e,GAAU,CAC5E,MAAMsnB,EAAatnB,EACbnoB,EAAS,IAAIwuC,GAAiBiB,CAAU,EAC9CF,EAAY,IAAIE,EAAYzvC,CAAM,EAClC,KAAK,eAAe,KAAK,gBAAyDA,CAAM,CACxG,CAAa,EACD+mC,EAAK,eAAe,GAAG,kBAAmD5e,GAAU,CAChF,MAAMsnB,EAAatnB,EACbnoB,EAASuvC,EAAY,IAAIE,CAAU,EACrCzvC,IAAW,SAGfuvC,EAAY,OAAOpnB,CAAM,EACzB,KAAK,eAAe,KAAK,kBAA6DnoB,CAAM,EAC5G,CAAa,EACD+mC,EAAK,eAAe,GAAG,QAA+B,IAAM,CACxD5mD,EAAA,KAAK2uD,GAAS,OAAO/H,CAAI,EACzB,KAAK,eAAe,KAAK,kBAA6DuI,CAAU,CAChH,CAAa,EACD,KAAK,eAAe,KAAK,gBAAyDA,CAAU,EAErFvI,CACV,GA5GD,IAAA,CACI,MAAM3R,EAAY,OAAO,QAAW,YAAc,OAAO,SAAW,OAAO,OAAOf,EAAY,OAAO,QAAQ,GAAK,IAAI,EAAI,OAC1HoU,EAA6B,CAACsE,GAAM,CAAE,EACtCpZ,GAAalzC,EAAM,KAAMgoD,EAA4B,CAAE,KAAM,WAAY,KAAM,iBAAkB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKpT,GAAO,mBAAoBA,EAAK,IAAKA,GAAOA,EAAI,eAAgB,IAAK,CAACA,EAAKrpC,IAAU,CAAEqpC,EAAI,eAAiBrpC,CAAM,GAAM,SAAUopC,GAAasT,EAA8BC,CAAiC,EACzVvT,GAAW,OAAO,eAAe30C,EAAM,OAAO,SAAU,CAAE,WAAY,GAAM,aAAc,GAAM,SAAU,GAAM,MAAO20C,CAAS,CAAE,CACzI,KANE30C,CAwOX,GAAC,ECrVD;AAAA;AAAA;AAAA;AAAA,GAKA,IAAI8yC,GAAwD,SAAUC,EAASC,EAAcznC,EAAO,CAEhG,QADI0nC,EAAW,UAAU,OAAS,EACzBn0C,EAAI,EAAGA,EAAIk0C,EAAa,OAAQl0C,IACrCyM,EAAQ0nC,EAAWD,EAAal0C,CAAC,EAAE,KAAKi0C,EAASxnC,CAAK,EAAIynC,EAAal0C,CAAC,EAAE,KAAKi0C,CAAO,EAE1F,OAAOE,EAAW1nC,EAAQ,MAC9B,EACI2nC,GAA8C,SAAUC,EAAMC,EAAcC,EAAYC,EAAWN,EAAcO,EAAmB,CACpI,SAAS1gB,EAAOwe,EAAG,CAAE,GAAIA,IAAM,QAAU,OAAOA,GAAM,WAAY,MAAM,IAAI,UAAU,mBAAmB,EAAG,OAAOA,CAAI,CAKvH,QAJImC,EAAOF,EAAU,KAAMnmC,EAAMqmC,IAAS,SAAW,MAAQA,IAAS,SAAW,MAAQ,QACrFj0B,EAAS,CAAC6zB,GAAgBD,EAAOG,EAAU,OAAYH,EAAOA,EAAK,UAAY,KAC/E9xB,EAAa+xB,IAAiB7zB,EAAS,OAAO,yBAAyBA,EAAQ+zB,EAAU,IAAI,EAAI,CAAA,GACjGG,EAAGC,EAAO,GACL50C,EAAIu0C,EAAW,OAAS,EAAGv0C,GAAK,EAAGA,IAAK,CAC7C,IAAIiI,EAAU,CAAA,EACd,QAAS5B,KAAKmuC,EAAWvsC,EAAQ5B,CAAC,EAAIA,IAAM,SAAW,CAAA,EAAKmuC,EAAUnuC,CAAC,EACvE,QAASA,KAAKmuC,EAAU,OAAQvsC,EAAQ,OAAO5B,CAAC,EAAImuC,EAAU,OAAOnuC,CAAC,EACtE4B,EAAQ,eAAiB,SAAUsqC,EAAG,CAAE,GAAIqC,EAAM,MAAM,IAAI,UAAU,wDAAwD,EAAGH,EAAkB,KAAK1gB,EAAOwe,GAAK,IAAI,CAAC,GACzK,IAAIrsC,KAAaquC,EAAWv0C,CAAC,GAAG00C,IAAS,WAAa,CAAE,IAAKnyB,EAAW,IAAK,IAAKA,EAAW,GAAG,EAAKA,EAAWlU,CAAG,EAAGpG,CAAO,EAC7H,GAAIysC,IAAS,WAAY,CACrB,GAAIxuC,IAAW,OAAQ,SACvB,GAAIA,IAAW,MAAQ,OAAOA,GAAW,SAAU,MAAM,IAAI,UAAU,iBAAiB,GACpFyuC,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,IAAI,IAAGguC,EAAa,QAAQS,CAAC,CACtD,MACQA,EAAI5gB,EAAO7tB,CAAM,KAClBwuC,IAAS,QAASR,EAAa,QAAQS,CAAC,EACvCpyB,EAAWlU,CAAG,EAAIsmC,EAE9B,CACGl0B,GAAQ,OAAO,eAAeA,EAAQ+zB,EAAU,KAAMjyB,CAAU,EACpEqyB,EAAO,EACX,EACI6G,GAAoE,SAAUC,EAAKjvC,EAAOkvC,EAAO,CACjG,GAAIlvC,GAAU,KAA0B,CACpC,GAAI,OAAOA,GAAU,UAAY,OAAOA,GAAU,WAAY,MAAM,IAAI,UAAU,kBAAkB,EACpG,IAAImvC,EAASC,EACb,GAAIF,EAAO,CACP,GAAI,CAAC,OAAO,aAAc,MAAM,IAAI,UAAU,qCAAqC,EACnFC,EAAUnvC,EAAM,OAAO,YAAY,CACtC,CACD,GAAImvC,IAAY,OAAQ,CACpB,GAAI,CAAC,OAAO,QAAS,MAAM,IAAI,UAAU,gCAAgC,EACzEA,EAAUnvC,EAAM,OAAO,OAAO,EAC1BkvC,IAAOE,EAAQD,EACtB,CACD,GAAI,OAAOA,GAAY,WAAY,MAAM,IAAI,UAAU,wBAAwB,EAC3EC,IAAOD,EAAU,UAAW,CAAE,GAAI,CAAEC,EAAM,KAAK,IAAI,CAAI,OAAQ97C,EAAG,CAAE,OAAO,QAAQ,OAAOA,CAAC,CAAE,IACjG27C,EAAI,MAAM,KAAK,CAAE,MAAOjvC,EAAO,QAASmvC,EAAS,MAAOD,CAAK,CAAE,CAClE,MACQA,GACLD,EAAI,MAAM,KAAK,CAAE,MAAO,EAAM,CAAA,EAElC,OAAOjvC,CACX,EACIqvC,GAA2D,SAAUC,EAAiB,CACtF,OAAO,SAAUL,EAAK,CAClB,SAASM,EAAKj8C,EAAG,CACb27C,EAAI,MAAQA,EAAI,SAAW,IAAIK,EAAgBh8C,EAAG27C,EAAI,MAAO,0CAA0C,EAAI37C,EAC3G27C,EAAI,SAAW,EAClB,CACD,IAAI,EAAGO,EAAI,EACX,SAASC,GAAO,CACZ,KAAO,EAAIR,EAAI,MAAM,IAAG,GACpB,GAAI,CACA,GAAI,CAAC,EAAE,OAASO,IAAM,EAAG,OAAOA,EAAI,EAAGP,EAAI,MAAM,KAAK,CAAC,EAAG,QAAQ,UAAU,KAAKQ,CAAI,EACrF,GAAI,EAAE,QAAS,CACX,IAAIh2C,EAAS,EAAE,QAAQ,KAAK,EAAE,KAAK,EACnC,GAAI,EAAE,MAAO,OAAO+1C,GAAK,EAAG,QAAQ,QAAQ/1C,CAAM,EAAE,KAAKg2C,EAAM,SAASn8C,EAAG,CAAE,OAAAi8C,EAAKj8C,CAAC,EAAUm8C,GAAO,CAAE,CACzG,MACID,GAAK,CACb,OACMl8C,EAAG,CACNi8C,EAAKj8C,CAAC,CACT,CAEL,GAAIk8C,IAAM,EAAG,OAAOP,EAAI,SAAW,QAAQ,OAAOA,EAAI,KAAK,EAAI,QAAQ,QAAO,EAC9E,GAAIA,EAAI,SAAU,MAAMA,EAAI,KAC/B,CACD,OAAOQ,EAAI,CACnB,CACA,EAAG,OAAO,iBAAoB,WAAa,gBAAkB,SAAU95C,EAAO+5C,EAAY/4C,EAAS,CAC/F,IAAIrD,EAAI,IAAI,MAAMqD,CAAO,EACzB,OAAOrD,EAAE,KAAO,kBAAmBA,EAAE,MAAQqC,EAAOrC,EAAE,WAAao8C,EAAYp8C,CACnF,CAAC,EAUD,IAAIowD,IAAW,IAAM,+BACjB,IAAIrb,EAAcv0C,EACdw0C,EAA6B,CAAA,EAC7BC,EACAmD,EACAW,EACAsX,EACApX,EACAqX,EACAC,EACAC,EACJ,OAAOrvD,EAAA,cAAsB4zC,CAAY,CAwBrC,YAAY9D,EAAS,CACjB,QAzBDxwC,EAAA,KAAAgwD,GAkBHhwD,EAAA,KAAAsxC,GAAWkC,GAAkB,KAAMe,CAA0B,EAAG,KAChEv0C,EAAA,KAAA21C,GACA31C,EAAA,KAAA40C,EAAe,IAAIC,IACnB70C,EAAA,KAAAwe,EAAgB,IAAI,KACpB3c,EAAA,gBACA7B,EAAA,KAAAiwD,EAAiB,IAAI,KAGjB,KAAK,QAAUzf,CAClB,CAdD,aAAa,KAAKA,EAAS,OACvB,MAAM2F,EAAU,IAAIz1C,EAAQ8vC,CAAO,EACnC,aAAMhvC,EAAAd,EAAAy1C,EAAQ6Z,EAAAlb,IAAR,KAAAp0C,GACCy1C,CACV,CA0ED,IAAI,QAAS,CACT,OAAO/1C,EAAA,KAAKkxC,EACf,CACD,IAAI,oBAAqB,CAErB,OAAOlxC,EAAA,KAAKoe,GAAc,IAAIs7B,GAAY,OAAO,CACpD,CACD,IAAI,cAAe,CACf,OAAO15C,EAAA,KAAKu1C,KAAY,MAC3B,CACD,IAAI,UAAW,CACX,OAAO,KAAK,YACf,CACD,IAAI,cAAe,CACf,OAAOv1C,EAAA,KAAKoe,GAAc,QAC7B,CACD,QAAQuK,EAAQmnC,EAAS,GAAO,CAC5B7uD,EAAA,KAAKiwC,EAAU4e,GACf7uD,EAAA,KAAKs0C,EAAU5sB,GACf,KAAKgsB,EAAa,GACrB,CACD,MAAM,OAAQ,CACV,GAAI,CACA,MAAM,KAAK,QAAQ,KAAK,gBAAiB,CAAE,CAAA,CAC9C,QACO,CACJ,KAAK,QAAQ,0BAA2B,EAAI,CAC/C,CACJ,CACD,MAAM,iBAAiBjpB,EAAqBxc,EAAU,GAAI,OACtD,KAAM,CAAE,OAAQ,CAAE,OAAAskB,CAAQ,CAAA,EAAM,MAAM,KAAK,QAAQ,KAAK,0BAA2B,CAC/E,oBAAA9H,EACA,GAAGxc,EACH,UAAU5O,EAAA4O,EAAQ,WAAR,YAAA5O,EAAkB,IAAI+G,GACrBA,EAAQ,GAEnC,CAAa,EACD,OAAOmsB,CACV,CACD,MAAM,gBAAgBna,EAAW,CAC7B,MAAM,KAAK,QAAQ,KAAK,0BAA2B,CAC/C,UAAAA,CAChB,CAAa,CACJ,CACD,MAAM,oBAAoBma,EAAQ,CAC9B,MAAM,KAAK,QAAQ,KAAK,6BAA8B,CAClD,OAAAA,CAChB,CAAa,CACJ,CACD,MAAM,kBAAkBtkB,EAAS,WAC7B,MAAM5G,EAAc4G,EAAQ,cAAgB,OACtC,OACA,CACE,UAAW,SACX,UAAWA,EAAQ,YACnB,SAAUA,EAAQ,YAClB,QAASA,EAAQ,eACrC,EACkB,CAAE,OAAQ,CAAE,YAAA3H,CAAa,CAAA,EAAM,MAAM,KAAK,QAAQ,KAAK,4BAA6B,CACtF,MAAOe,CACvB,CAAa,EACD,KAAIhI,EAAA4O,EAAQ,mBAAR,YAAA5O,EAA0B,UAAW,eACrC,MAAM,IAAI4vC,EAAqB,mDAAmD,EAEtF,KAAIvmC,EAAAuF,EAAQ,mBAAR,YAAAvF,EAA0B,UAAW,QAAS,CAC9C,GAAIuF,EAAQ,iBAAiB,eAAiB,OAC1C,MAAM,IAAIghC,EAAqB,yDAAyD,EAE5F,MAAM,KAAK,QAAQ,KAAK,8BAA+B,CACnD,iBAAkB,CACd,KAAM,UACN,kBAAmBhhC,EAAQ,iBAAiB,YAC/C,EACD,aAAc,CAAC3H,CAAW,CAC9C,CAAiB,CACJ,CACD,QAAIgH,EAAAW,EAAQ,mBAAR,YAAAX,EAA0B,UAAW,QACrC,MAAM,KAAK,QAAQ,KAAK,8BAA+B,CACnD,iBAAkB,CAAE,KAAM,QAAU,EACpC,aAAc,CAAChH,CAAW,CAC9C,CAAiB,EAEEnG,EAAA,KAAKwuD,EAAAG,IAAL,UAAwBxoD,EAClC,CACD,MAAM,iBAAiBiO,EAAM,CACzB,KAAM,CAAE,OAAQ,CAAE,UAAAw6C,CAAW,CAAA,EAAM,MAAM,KAAK,QAAQ,KAAK,uBAAwB,CAC/E,cAAe,CAAE,KAAM,OAAQ,KAAAx6C,CAAM,CACrD,CAAa,EACD,OAAOw6C,CACV,CACD,MAAM,mBAAmB1jD,EAAI,CACzB,MAAM,KAAK,QAAQ,KAAK,yBAA0B,CAAE,UAAWA,CAAE,CAAE,CACtE,CACD,EAAE8nC,EAAsB,CAACQ,EAAe,EAAG2C,EAAoB,CAAC9B,EAAgBM,GAEjE/1C,EAAA+1C,EAAQR,EAClB,CAAC,EAAG2C,EAA+B,CAACzC,EAAgBM,GAE1C/1C,EAAA+1C,EAAQR,EAClB,CAAC,EAAGia,EAA8B,CAAC/Z,EAAgBM,GAEzC/1C,EAAA+1C,EAAQR,EAClB,CAAC,EAAG6C,EAAkC,CAAC3C,EAAgBM,GAE7C/1C,EAAA+1C,EAAQR,EAClB,CAAC,EAAGka,EAAgC,CAACha,EAAgBM,GAE3C/1C,EAAA+1C,EAAQR,EAClB,CAAC,EAAGma,EAA+B,CAACja,EAAgBM,GAE1C/1C,EAAA+1C,EAAQR,EAClB,CAAC,EAAGoa,EAAiC,CAACla,EAAgBM,GAE5C/1C,EAAA+1C,EAAQR,EAClB,CAAC,EAAGZ,MAAkB,CACvB30C,EAAA,KAAKu1C,IAALt0C,EAAA,KAAKs0C,EACD,iEACA,KAAK,QACL,KAAK,KAAK,SAAU,CAAE,OAAQv1C,EAAA,KAAKu1C,EAAO,CAAE,EAEhD,KAAK,KAAK,eAAgB,CAAE,OAAQv1C,EAAA,KAAKu1C,EAAO,CAAE,EAClDv1C,EAAA,KAAKw0C,GAAa,UAClB,MAAMG,EAAa,GACtB,CACT,EArMQzD,EAAA,YACAqE,EAAA,YACAf,EAAA,YACAp2B,EAAA,YAEAyxC,EAAA,YAvBGD,EAAA,YA4BGlb,GAAW,gBAAG,CAChB,MAAMK,EAAiB/0C,EAAA,KAAKw0C,GAAa,IAAI,IAAI70C,EAAa,KAAK,OAAO,CAAC,EAC3Eo1C,EAAe,KAAK,QAAS,CAAC,CAAE,OAAApsB,CAAM,IAAO,CACzC,KAAK,QAAQA,CAAM,CACnC,CAAa,EACDosB,EAAe,GAAG,sBAAuBtF,GAAQ,CACzCA,EAAK,OAAS,iBAGlBzvC,EAAA,KAAK6vD,GAAe,IAAIpgB,EAAK,MAAOwG,GAAkB,KAAK,KAAMxG,EAAK,MAAOA,EAAK,MAAM,CAAC,CACzG,CAAa,EACD,MAAMruC,EAAA,KAAKwuD,EAAAK,IAAL,WACN,MAAM7uD,EAAA,KAAKwuD,EAAAM,IAAL,UACT,EACKD,GAAiB,gBAAG,CACtB,KAAM,CAAE,OAAQ,CAAE,aAAAhoD,CAAY,GAAQ,MAAM,KAAK,QAAQ,KAAK,0BAA2B,CAAA,CAAE,EAC3F,UAAWZ,KAAWY,EAClB7G,EAAA,KAAKwuD,EAAAG,IAAL,UAAwB1oD,EAAQ,YAEvC,EACK6oD,GAAqB,gBAAG,CAG1B,MAAMrlB,EAAa,IAAI,IACvB,IAAInxB,EACJ,CACI,MAAMoiC,EAAQ,CAAE,MAAO,CAAE,EAAE,MAAO,OAAQ,SAAU,IACpD,GAAI,CACuBjB,GAAwBiB,EAAO,IAAIn8C,EAAa,KAAK,OAAO,EAAG,EAAK,EAC5E,GAAG,iCAAkC8vC,GAAQ,CACxD5E,EAAW,IAAI4E,EAAK,OAAO,CACnD,CAAqB,EACD,KAAM,CAAE,OAAAnqC,CAAQ,EAAG,MAAM,KAAK,QAAQ,KAAK,0BAA2B,CAAA,CAAE,EACxEoU,EAAWpU,EAAO,QACrB,OACMy2C,EAAK,CACRD,EAAM,MAAQC,EACdD,EAAM,SAAW,EACpB,QACO,CACJZ,GAAmBY,CAAK,CAC3B,CACJ,CAED,UAAWrM,KAAQ/1B,EACVmxB,EAAW,IAAI4E,EAAK,OAAO,GAC5B,KAAK,QAAQ,KAAK,iCAAkCA,CAAI,EAExDA,EAAK,UACL/1B,EAAS,KAAK,GAAG+1B,EAAK,QAAQ,CAGzC,EACDsgB,GAAkB,SAACzjD,EAAI,CACnB,MAAM/E,EAAcmyC,GAAY,OAAO,KAAMptC,CAAE,EAC/CtM,EAAA,KAAKoe,GAAc,IAAI7W,EAAY,GAAIA,CAAW,EAClD,MAAM4oD,EAAqBnwD,EAAA,KAAKw0C,GAAa,IAAI,IAAI70C,EAAa4H,CAAW,CAAC,EAC9E,OAAA4oD,EAAmB,KAAK,SAAU,IAAM,CACpCA,EAAmB,mBAAkB,EACrCnwD,EAAA,KAAKoe,GAAc,OAAO7W,EAAY,EAAE,CACxD,CAAa,EACMA,CACV,GAzFD,IAAA,CACI,MAAM0tC,EAAY,OAAO,QAAW,YAAc,OAAO,SAAW,OAAO,OAAOf,EAAY,OAAO,QAAQ,GAAK,IAAI,EAAI,OAC1HV,GAAalzC,EAAM,KAAM8zC,EAAqB,CAAE,KAAM,SAAU,KAAM,UAAW,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKc,GAAO,YAAaA,EAAK,IAAKA,GAAOA,EAAI,OAAO,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAC1OX,GAAalzC,EAAM,KAAMi3C,EAAmB,CAAE,KAAM,SAAU,KAAM,QAAS,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKrC,GAAO,UAAWA,EAAK,IAAKA,GAAOA,EAAI,KAAK,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAClOX,GAAalzC,EAAM,KAAM43C,EAA8B,CAAE,KAAM,SAAU,KAAM,mBAAoB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKhD,GAAO,qBAAsBA,EAAK,IAAKA,GAAOA,EAAI,gBAAgB,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAC9QX,GAAalzC,EAAM,KAAMkvD,EAA6B,CAAE,KAAM,SAAU,KAAM,kBAAmB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKta,GAAO,oBAAqBA,EAAK,IAAKA,GAAOA,EAAI,eAAe,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAC1QX,GAAalzC,EAAM,KAAM83C,EAAiC,CAAE,KAAM,SAAU,KAAM,sBAAuB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKlD,GAAO,wBAAyBA,EAAK,IAAKA,GAAOA,EAAI,mBAAmB,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAC1RX,GAAalzC,EAAM,KAAMmvD,EAA+B,CAAE,KAAM,SAAU,KAAM,oBAAqB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKva,GAAO,sBAAuBA,EAAK,IAAKA,GAAOA,EAAI,iBAAiB,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAClRX,GAAalzC,EAAM,KAAMovD,EAA8B,CAAE,KAAM,SAAU,KAAM,mBAAoB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKxa,GAAO,qBAAsBA,EAAK,IAAKA,GAAOA,EAAI,gBAAgB,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAC9QX,GAAalzC,EAAM,KAAMqvD,EAAgC,CAAE,KAAM,SAAU,KAAM,qBAAsB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKza,GAAO,uBAAwBA,EAAK,IAAKA,GAAOA,EAAI,kBAAkB,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAClRc,GAAW,OAAO,eAAe30C,EAAM,OAAO,SAAU,CAAE,WAAY,GAAM,aAAc,GAAM,SAAU,GAAM,MAAO20C,CAAS,CAAE,CACzI,KAZE30C,CAwNX,GAAI,ECvUJ;AAAA;AAAA;AAAA;AAAA,GAKA,IAAI8yC,GAAwD,SAAUC,EAASC,EAAcznC,EAAO,CAEhG,QADI0nC,EAAW,UAAU,OAAS,EACzBn0C,EAAI,EAAGA,EAAIk0C,EAAa,OAAQl0C,IACrCyM,EAAQ0nC,EAAWD,EAAal0C,CAAC,EAAE,KAAKi0C,EAASxnC,CAAK,EAAIynC,EAAal0C,CAAC,EAAE,KAAKi0C,CAAO,EAE1F,OAAOE,EAAW1nC,EAAQ,MAC9B,EACI2nC,GAA8C,SAAUC,EAAMC,EAAcC,EAAYC,EAAWN,EAAcO,EAAmB,CACpI,SAAS1gB,EAAOwe,EAAG,CAAE,GAAIA,IAAM,QAAU,OAAOA,GAAM,WAAY,MAAM,IAAI,UAAU,mBAAmB,EAAG,OAAOA,CAAI,CAKvH,QAJImC,EAAOF,EAAU,KAAMnmC,EAAMqmC,IAAS,SAAW,MAAQA,IAAS,SAAW,MAAQ,QACrFj0B,EAAS,CAAC6zB,GAAgBD,EAAOG,EAAU,OAAYH,EAAOA,EAAK,UAAY,KAC/E9xB,EAAa+xB,IAAiB7zB,EAAS,OAAO,yBAAyBA,EAAQ+zB,EAAU,IAAI,EAAI,CAAA,GACjGG,EAAGC,EAAO,GACL50C,EAAIu0C,EAAW,OAAS,EAAGv0C,GAAK,EAAGA,IAAK,CAC7C,IAAIiI,EAAU,CAAA,EACd,QAAS5B,KAAKmuC,EAAWvsC,EAAQ5B,CAAC,EAAIA,IAAM,SAAW,CAAA,EAAKmuC,EAAUnuC,CAAC,EACvE,QAASA,KAAKmuC,EAAU,OAAQvsC,EAAQ,OAAO5B,CAAC,EAAImuC,EAAU,OAAOnuC,CAAC,EACtE4B,EAAQ,eAAiB,SAAUsqC,EAAG,CAAE,GAAIqC,EAAM,MAAM,IAAI,UAAU,wDAAwD,EAAGH,EAAkB,KAAK1gB,EAAOwe,GAAK,IAAI,CAAC,GACzK,IAAIrsC,KAAaquC,EAAWv0C,CAAC,GAAG00C,IAAS,WAAa,CAAE,IAAKnyB,EAAW,IAAK,IAAKA,EAAW,GAAG,EAAKA,EAAWlU,CAAG,EAAGpG,CAAO,EAC7H,GAAIysC,IAAS,WAAY,CACrB,GAAIxuC,IAAW,OAAQ,SACvB,GAAIA,IAAW,MAAQ,OAAOA,GAAW,SAAU,MAAM,IAAI,UAAU,iBAAiB,GACpFyuC,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,IAAI,IAAGguC,EAAa,QAAQS,CAAC,CACtD,MACQA,EAAI5gB,EAAO7tB,CAAM,KAClBwuC,IAAS,QAASR,EAAa,QAAQS,CAAC,EACvCpyB,EAAWlU,CAAG,EAAIsmC,EAE9B,CACGl0B,GAAQ,OAAO,eAAeA,EAAQ+zB,EAAU,KAAMjyB,CAAU,EACpEqyB,EAAO,EACX,EAQA,IAAIoc,IAAW,IAAM,oBACjB,IAAIlc,EAAcv0C,EACdw0C,EAA6B,CAAA,EAC7Bkc,EACAC,EAA2B,CAAA,EAC3BC,EAAgC,CAAA,EAChCnc,EACAoc,EACA7X,EACA8X,EACAC,EACJ,OAAOpwD,EAAA,cAAsB4zC,CAAY,CA0BrC,YAAYjE,EAAYR,EAAM,CAC1B,QA3BD7vC,EAAA,KAAA+wD,GAmBH/wD,EAAA,KAAA21C,EAAUnC,GAAkB,KAAMe,CAA0B,GAC5Dv0C,EAAA,KAAA40C,EAAe,IAAIC,IACnB70C,EAAA,KAAAgxD,GACAnvD,EAAA,gBACA7B,EAAA,KAAAixD,EAA+Bzd,GAAkB,KAAMkd,EAA0B,MAAM,GAKnFld,GAAkB,KAAMmd,CAA6B,EACrDtvD,EAAA,KAAK2vD,EAAQnhB,GACb,KAAK,WAAaQ,CACrB,CApBD,aAAa,KAAKA,EAAY6gB,EAAc,OACxC,KAAM,CAAE,OAAAxrD,CAAQ,EAAG,MAAM2qC,EAAW,KAAK,cAAe,CACpD,aAAA6gB,CAChB,CAAa,EACK1gB,EAAU,IAAI9vC,EAAQ2vC,EAAY3qC,CAAM,EAC9C,aAAMlE,EAAAd,EAAA8vC,EAAQugB,EAAAjc,IAAR,KAAAp0C,GACC8vC,CACV,CAMD,IAAI,YAAa,CAAE,OAAOpwC,EAAA,KAAK6wD,EAA+B,CAC9D,IAAI,WAAWhlD,EAAO,CAAE5K,EAAA,KAAK4vD,EAA+BhlD,EAAQ,CA2BpE,IAAI,cAAe,CACf,OAAO7L,EAAA,KAAK4wD,GAAM,YACrB,CACD,IAAI,UAAW,CACX,OAAO,KAAK,KACf,CACD,IAAI,OAAQ,CACR,OAAO5wD,EAAA,KAAKu1C,KAAY,MAC3B,CACD,IAAI,IAAK,CACL,OAAOv1C,EAAA,KAAK4wD,GAAM,SACrB,CACD,QAAQjoC,EAAQ,CACZ1nB,EAAA,KAAKs0C,EAAU5sB,GACf,KAAKgsB,EAAa,GACrB,CAQD,MAAM,KAAK96B,EAAQ3T,EAAQ,CACvB,OAAO,MAAM,KAAK,WAAW,KAAK2T,EAAQ3T,CAAM,CACnD,CACD,MAAM,UAAUyjC,EAAQjwB,EAAU,CAC9B,MAAM,KAAK,KAAK,oBAAqB,CACjC,OAAAiwB,EACA,SAAAjwB,CAChB,CAAa,CACJ,CACD,MAAM,cAAciwB,EAAQjwB,EAAU,CAClC,MAAM,KAAK,KAAK,oBAAqB,CACjC,OAAAiwB,EACA,SAAAjwB,CAChB,CAAa,CACJ,CACD,MAAM,KAAM,CACR,GAAI,CACA,MAAM,KAAK,KAAK,cAAe,CAAE,CAAA,CACpC,QACO,CACJ,KAAK,QAAQ,wBAAwB,CACxC,CACJ,CACD,EAAE22C,EAAyB,CAACzD,GAAQ,CAAA,EAAGxY,EAAsB,CAACQ,EAAe,EAAG4b,EAAmB,CAAC/a,EAAgBrF,GAErGpwC,EAAAowC,EAAQmF,EAClB,CAAC,EAAGoD,EAAwB,CAAClD,EAAgBrF,GAEnCpwC,EAAAowC,EAAQmF,EAClB,CAAC,EAAGkb,EAA4B,CAAChb,EAAgBrF,GAEvCpwC,EAAAowC,EAAQmF,EAClB,CAAC,EAAGmb,EAAkB,CAACjb,EAAgBrF,GAE7BpwC,EAAAowC,EAAQmF,EAClB,CAAC,EAAGZ,MAAkB,CACvB30C,EAAA,KAAKu1C,IAALt0C,EAAA,KAAKs0C,EACD,qEACJ,KAAK,KAAK,QAAS,CAAE,OAAQv1C,EAAA,KAAKu1C,EAAO,CAAE,EAC3Cv1C,EAAA,KAAKw0C,GAAa,UAClB,MAAMG,EAAa,GACtB,CACT,EAlGQY,EAAA,YACAf,EAAA,YACAoc,EAAA,YAEAC,EAAA,YAvBGF,EAAA,YAgCGjc,GAAW,gBAAG,CAEhB,KAAK,QAAU,MAAM6a,GAAQ,KAAK,IAAI,EACfvvD,EAAA,KAAKw0C,GAAa,IAAI,KAAK,OAAO,EAC1C,KAAK,SAAU,CAAC,CAAE,OAAA7rB,CAAM,IAAO,CAC1C,KAAK,QAAQA,CAAM,CACnC,CAAa,EAID,MAAMooC,EAAO,IAAI,QACjB,KAAK,GAAG,oCAAqCthB,GAAQ,CAC7CshB,EAAK,IAAIthB,CAAI,IAGjBshB,EAAK,IAAIthB,CAAI,EACb,KAAK,KAAK,oCAAqCA,CAAI,EACnD,KAAK,KAAK,oCAAqCA,CAAI,EACnE,CAAa,CACJ,GAlDD,IAAA,CACI,MAAMwF,EAAY,OAAO,QAAW,YAAc,OAAO,SAAW,OAAO,OAAOf,EAAY,OAAO,QAAQ,GAAK,IAAI,EAAI,OAC1HV,GAAalzC,EAAM,KAAM+vD,EAAwB,CAAE,KAAM,WAAY,KAAM,aAAc,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKnb,GAAO,eAAgBA,EAAK,IAAKA,GAAOA,EAAI,WAAY,IAAK,CAACA,EAAKrpC,IAAU,CAAEqpC,EAAI,WAAarpC,CAAM,GAAM,SAAUopC,GAAaqb,EAA0BC,CAA6B,EACjU/c,GAAalzC,EAAM,KAAM8zC,EAAqB,CAAE,KAAM,SAAU,KAAM,UAAW,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKc,GAAO,YAAaA,EAAK,IAAKA,GAAOA,EAAI,OAAO,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAC1OX,GAAalzC,EAAM,KAAMkwD,EAAkB,CAAE,KAAM,SAAU,KAAM,OAAQ,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKtb,GAAO,SAAUA,EAAK,IAAKA,GAAOA,EAAI,IAAI,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAC9NX,GAAalzC,EAAM,KAAMq4C,EAAuB,CAAE,KAAM,SAAU,KAAM,YAAa,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKzD,GAAO,cAAeA,EAAK,IAAKA,GAAOA,EAAI,SAAS,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAClPX,GAAalzC,EAAM,KAAMmwD,EAA2B,CAAE,KAAM,SAAU,KAAM,gBAAiB,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKvb,GAAO,kBAAmBA,EAAK,IAAKA,GAAOA,EAAI,aAAa,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EAClQX,GAAalzC,EAAM,KAAMowD,EAAiB,CAAE,KAAM,SAAU,KAAM,MAAO,OAAQ,GAAO,QAAS,GAAO,OAAQ,CAAE,IAAKxb,GAAO,QAASA,EAAK,IAAKA,GAAOA,EAAI,GAAG,EAAI,SAAUD,CAAW,EAAE,KAAMd,CAA0B,EACtNc,GAAW,OAAO,eAAe30C,EAAM,OAAO,SAAU,CAAE,WAAY,GAAM,aAAc,GAAM,SAAU,GAAM,MAAO20C,CAAS,CAAE,CACzI,KAVE30C,CAsHX,GAAI,EC/KJ;AAAA;AAAA;AAAA;AAAA,GAKA,IAAIkzC,GAA8C,SAAUC,EAAMC,EAAcC,EAAYC,EAAWN,EAAcO,EAAmB,CACpI,SAAS1gB,EAAOwe,EAAG,CAAE,GAAIA,IAAM,QAAU,OAAOA,GAAM,WAAY,MAAM,IAAI,UAAU,mBAAmB,EAAG,OAAOA,CAAI,CAKvH,QAJImC,EAAOF,EAAU,KAAMnmC,EAAMqmC,IAAS,SAAW,MAAQA,IAAS,SAAW,MAAQ,QACrFj0B,EAAS,CAAC6zB,GAAgBD,EAAOG,EAAU,OAAYH,EAAOA,EAAK,UAAY,KAC/E9xB,EAAa+xB,IAAiB7zB,EAAS,OAAO,yBAAyBA,EAAQ+zB,EAAU,IAAI,EAAI,CAAA,GACjGG,EAAGC,EAAO,GACL50C,EAAIu0C,EAAW,OAAS,EAAGv0C,GAAK,EAAGA,IAAK,CAC7C,IAAIiI,EAAU,CAAA,EACd,QAAS5B,KAAKmuC,EAAWvsC,EAAQ5B,CAAC,EAAIA,IAAM,SAAW,CAAA,EAAKmuC,EAAUnuC,CAAC,EACvE,QAASA,KAAKmuC,EAAU,OAAQvsC,EAAQ,OAAO5B,CAAC,EAAImuC,EAAU,OAAOnuC,CAAC,EACtE4B,EAAQ,eAAiB,SAAUsqC,EAAG,CAAE,GAAIqC,EAAM,MAAM,IAAI,UAAU,wDAAwD,EAAGH,EAAkB,KAAK1gB,EAAOwe,GAAK,IAAI,CAAC,GACzK,IAAIrsC,KAAaquC,EAAWv0C,CAAC,GAAG00C,IAAS,WAAa,CAAE,IAAKnyB,EAAW,IAAK,IAAKA,EAAW,GAAG,EAAKA,EAAWlU,CAAG,EAAGpG,CAAO,EAC7H,GAAIysC,IAAS,WAAY,CACrB,GAAIxuC,IAAW,OAAQ,SACvB,GAAIA,IAAW,MAAQ,OAAOA,GAAW,SAAU,MAAM,IAAI,UAAU,iBAAiB,GACpFyuC,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,GAAG,KAAGqc,EAAW,IAAMoyB,IACzCA,EAAI5gB,EAAO7tB,EAAO,IAAI,IAAGguC,EAAa,QAAQS,CAAC,CACtD,MACQA,EAAI5gB,EAAO7tB,CAAM,KAClBwuC,IAAS,QAASR,EAAa,QAAQS,CAAC,EACvCpyB,EAAWlU,CAAG,EAAIsmC,EAE9B,CACGl0B,GAAQ,OAAO,eAAeA,EAAQ+zB,EAAU,KAAMjyB,CAAU,EACpEqyB,EAAO,EACX,EACIZ,GAAwD,SAAUC,EAASC,EAAcznC,EAAO,CAEhG,QADI0nC,EAAW,UAAU,OAAS,EACzBn0C,EAAI,EAAGA,EAAIk0C,EAAa,OAAQl0C,IACrCyM,EAAQ0nC,EAAWD,EAAal0C,CAAC,EAAE,KAAKi0C,EAASxnC,CAAK,EAAIynC,EAAal0C,CAAC,EAAE,KAAKi0C,CAAO,EAE1F,OAAOE,EAAW1nC,EAAQ,MAC9B,EACIq3C,GAAwD,SAAUvR,EAAGxwC,EAAM4wC,EAAQ,CACnF,OAAI,OAAO5wC,GAAS,WAAUA,EAAOA,EAAK,YAAc,IAAI,OAAOA,EAAK,YAAa,GAAG,EAAI,IACrF,OAAO,eAAewwC,EAAG,OAAQ,CAAE,aAAc,GAAM,MAAOI,EAAS,GAAG,OAAOA,EAAQ,IAAK5wC,CAAI,EAAIA,CAAI,CAAE,CACvH,EAYG,IAAC6vD,IAAe,IAAM,6CACrB,IAAI9c,EAAcqb,GACd0B,EACAC,EAAuC,CAAA,EACvCC,EAA4C,CAAA,EAC5CC,EACJ,OAAO9wD,EAAA,cAA0B4zC,CAAY,CA4FzC,YAAYmd,EAAaC,EAAM,CAC3B,QA7FD1xD,EAAA,KAAA2xD,GAOH9vD,EAAA,gBAAW,iBA0EX7B,EAAA,KAAA+oD,EAAmCvV,GAAkB,KAAM8d,EAAsC,IAAIvxD,CAAc,GAGnHC,EAAA,KAAA4xD,EAAWpe,GAAkB,KAAM+d,CAAyC,GAC5EvxD,EAAA,KAAA6xD,GACA7xD,EAAA,KAAA8xD,GACA9xD,EAAA,KAAA6uD,GACA7uD,EAAA,KAAA+xD,EAAmB,IAAI,SACvB/xD,EAAA,KAAAgyD,EAAU,IAAI7D,GAAkB,IAAI,GACpCnuD,EAAA,KAAAiJ,GACAjJ,EAAA,KAAAiyD,GAGI5wD,EAAA,KAAKuwD,EAAWF,EAAK,SACrBrwD,EAAA,KAAKwwD,EAAiBH,EAAK,eAC3BrwD,EAAA,KAAKywD,EAAeL,GACpBpwD,EAAA,KAAKwtD,EAAmB6C,EAAK,iBAC7BrwD,EAAA,KAAK4H,EAAiByoD,EAAK,eAC3BrwD,EAAA,KAAK4wD,EAAkBP,EAAK,eAC/B,CAzED,aAAa,OAAOA,EAAM,WACtB,MAAMlhB,EAAU,MAAMggB,GAAQ,KAAKkB,EAAK,WAAY,CAChD,YAAYhxD,EAAAgxD,EAAK,eAAL,YAAAhxD,EAAmB,WAC/B,YAAa,CACT,IAAGqJ,EAAA2nD,EAAK,eAAL,YAAA3nD,EAAmB,YAEtB,oBAAqB2nD,EAAK,oBAC1B,wBAAyB,CACrB,QAAS,QACZ,EACD,aAAc,GAId,4BAA6B,GAE7B,qCAAsC,EACzC,CACjB,CAAa,EAGD,MAAMlhB,EAAQ,WAAWkhB,EAAK,cACxB,CAAC,GAAGhxD,EAAY,iBAAkB,GAAGA,EAAY,kBAAkB,EACnEA,EAAY,kBAAkB,OAAOwxD,GAClCR,EAAK,eAIH,GAHKQ,IAAW,WACfA,IAAW,oCAGtB,CAAC,EACF,MAAM,QAAQ,IAAI,CAAC,UAA+C,UAAgD,EAAC,IAGnH,MAAO32B,GAAa,CAChB,GAAI,CACA,MAAMiV,EAAQ,KAAK,2BAA4B,CAC3C,UAAW,CAACjV,CAAQ,EAEpB,mBAAoB,GAC5C,CAAqB,CACJ,OACM3zB,GAAK,CACR,GAAIA,cAAeovC,GACf/E,GAAWrqC,EAAG,MAGd,OAAMA,EAEb,CACJ,CAAA,CAAC,EACF,MAAMuuC,EAAU,IAAIz1C,EAAY8vC,EAAQ,QAASkhB,CAAI,EACrD,OAAAlwD,EAAAmN,EAAAwnC,EAAQwb,EAAA7c,IAAR,KAAAnmC,GACOwnC,CACV,CAyCD,IAAI,cAAe,CACf,OAAO/1C,EAAA,KAAK6I,KAAmB,MAClC,CACD,IAAI,eAAgB,CAChB,OAAO7I,EAAA,KAAK6I,EACf,CACD,MAAM,WAAY,CACd,OAAO7I,EAAA,KAAK0xD,GAAa,QAAQ,aAAa,SACjD,CAiBD,IAAI,YAAa,CAEb,OAAO1xD,EAAA,KAAK0xD,GAAa,QAAQ,UACpC,CACD,YAAa,CACT,OAAO,KAAK,WAAW,GAC1B,CACD,MAAM,OAAQ,OACV,GAAI,MAAK,WAAW,OAGpB,GAAI,CACA,MAAM1xD,EAAA,KAAK0xD,GAAa,QACxB,OAAMpxD,EAAAN,EAAA,KAAKyxD,KAAL,YAAAnxD,EAAqB,KAAK,MACnC,OACMkB,EAAO,CAEVqwC,GAAWrwC,CAAK,CACnB,QACO,CACJ,KAAK,WAAW,SACnB,CACJ,CACD,IAAI,WAAY,CACZ,MAAO,CAACxB,EAAA,KAAK0xD,GAAa,YAC7B,CACD,SAAU,CACN,OAAO1xD,EAAA,KAAKwxD,IAAY,IAC3B,CACD,MAAM,qBAAqBtiD,EAAU,GAAI,CACrC,MAAM3H,EAAc,MAAMvH,EAAA,KAAK0xD,GAAa,kBAAkBxiD,CAAO,EACrE,OAAO9N,EAAA,KAAKmwD,EAAAQ,IAAL,UAA2BxqD,EACrC,CACD,MAAM,SAAU,CACZ,MAAO,GAAGvH,EAAA,KAAKuxD,EAAAS,GAAY,IAAIhyD,EAAA,KAAKuxD,EAAAU,GAAe,EACtD,CACD,iBAAkB,CACd,MAAO,CAAC,GAAGjyD,EAAA,KAAK0xD,GAAa,YAAY,EAAE,IAAIrqD,GACpCrH,EAAA,KAAK2xD,GAAiB,IAAItqD,CAAO,CAC3C,CACJ,CACD,uBAAwB,CACpB,OAAOrH,EAAA,KAAK2xD,GAAiB,IAAI3xD,EAAA,KAAK0xD,GAAa,kBAAkB,CACxE,CACD,SAAU,CACN,OAAO,KAAK,wBAAwB,SACvC,CACD,iBAAiBl8C,EAAM,CACnB,OAAOxV,EAAA,KAAK0xD,GAAa,iBAAiBl8C,CAAI,CACjD,CACD,MAAM,mBAAmBlJ,EAAI,CACzB,MAAMtM,EAAA,KAAK0xD,GAAa,mBAAmBplD,CAAE,CAChD,CACD,SAAU,CACN,MAAO,CACHtM,EAAA,KAAK4xD,GACL,GAAG,KAAK,kBAAkB,QAAQvqD,GACvBA,EAAQ,SAClB,CACjB,CACS,CACD,QAAS,CACL,OAAOrH,EAAA,KAAK4xD,EACf,CACD,MAAM,YAAa,CACf,GAAI,CACA,MAAM5xD,EAAA,KAAK0xD,GAAa,QAAQ,IAAG,CACtC,OACMlwD,EAAO,CAEVqwC,GAAWrwC,CAAK,CACnB,QACO,CACJ,KAAK,WAAW,SACnB,CACJ,CACD,IAAI,WAAY,CACZ,MAAO,CACH,sBAAuB,KAAK,WAAW,yBAA0B,CACjF,CACS,CACD,kBAAmB,CACf,OAAOxB,EAAA,KAAK6xD,EACf,CACT,EArJQlJ,EAAA,YAjFG4I,EAAA,YAkFCW,GAAe,UAAG,CAAE,OAAOd,EAAmC,IAAI,KAAK,IAAI,CAAI,EAC/Ee,GAAe,SAACtmD,EAAO,CAAE,OAAOulD,EAAmC,IAAI,KAAK,KAAMvlD,CAAK,CAAI,EAC/F2lD,EAAA,YACAC,EAAA,YACAC,EAAA,YACAjD,EAAA,YACAkD,EAAA,YACAC,EAAA,YACA/oD,EAAA,YACAgpD,EAAA,YAUAnd,GAAW,UAAG,OAEV,UAAWntC,KAAevH,EAAA,KAAK0xD,GAAa,aACxCtwD,EAAA,KAAKmwD,EAAAQ,IAAL,UAA2BxqD,GAE/BvH,EAAA,KAAK0xD,GAAa,KAAK,eAAgB,IAAM,CACzC1xD,EAAA,KAAKuxD,EAAAW,IAAgB,KAAK,eAAgD,MAAS,EACnFlyD,EAAA,KAAKuxD,EAAAW,IAAgB,oBACrC,CAAa,GACD5xD,EAAAN,EAAA,KAAKwxD,KAAL,MAAAlxD,EAAe,KAAK,QAAS,IAAM,CAC/BN,EAAA,KAAK0xD,GAAa,QAAQ,0BAA2B,EAAI,EACzD,KAAK,WAAW,SAChC,EACS,EACGM,GAAY,UAAG,CACf,OAAOhyD,EAAA,KAAK0xD,GAAa,QAAQ,aAAa,WACjD,EACGO,GAAe,UAAG,CAClB,OAAOjyD,EAAA,KAAK0xD,GAAa,QAAQ,aAAa,cACjD,EAUDK,GAAqB,SAACxqD,EAAa,CAC/B,MAAMkhD,EAAiB6F,GAAmB,KAAK,KAAM/mD,EAAa,CAC9D,gBAAiBvH,EAAA,KAAKyuD,EACtC,CAAa,EACD,OAAAzuD,EAAA,KAAK2xD,GAAiB,IAAIpqD,EAAakhD,CAAc,EACrDA,EAAe,eAAe,GAAG,gBAAyD5oC,GAAU,CAChG7f,EAAA,KAAKuxD,EAAAW,IAAgB,KAAK,gBAAkDryC,CAAM,CAClG,CAAa,EACD4oC,EAAe,eAAe,GAAG,gBAAyD5oC,GAAU,CAChG7f,EAAA,KAAKuxD,EAAAW,IAAgB,KAAK,gBAAkDryC,CAAM,CAClG,CAAa,EACD4oC,EAAe,eAAe,GAAG,kBAA6D5oC,GAAU,CACpG7f,EAAA,KAAKuxD,EAAAW,IAAgB,KAAK,kBAAsDryC,CAAM,CACtG,CAAa,EACM4oC,CACV,GAhJD,IAAA,CACI,MAAMxT,EAAY,OAAO,QAAW,YAAc,OAAO,SAAW,OAAO,OAAOf,EAAY,OAAO,QAAQ,GAAK,IAAI,EAAI,OAC1H+c,EAAqC,CAACrE,GAAM,CAAE,EAC9CpZ,GAAalzC,EAAM8wD,EAAqC,CAAE,IAAKlO,GAAkB,UAAY,CAAE,OAAOljD,EAAA,KAAK2oD,EAAiC,EAAI,kBAAmB,KAAK,EAAG,IAAKzF,GAAkB,SAAUr3C,EAAO,CAAE5K,EAAA,KAAK0nD,EAAmC98C,EAAM,EAAI,kBAAmB,KAAK,CAAG,EAAEolD,EAAoC,CAAE,KAAM,WAAY,KAAM,kBAAmB,OAAQ,GAAO,QAAS,GAAM,OAAQ,CAAE,IAAK/b,GAAOiR,GAAAoL,EAAmBrc,GAAK,IAAKA,GAAOl1C,EAAAk1C,EAAIqc,EAAAW,IAAiB,IAAK,CAAChd,EAAKrpC,IAAU,CAAE5K,EAAAi0C,EAAIqc,EAAkB1lD,EAAlBsmD,GAA0B,CAAA,EAAI,SAAUld,CAAW,EAAEic,EAAsCC,CAAyC,EAC7nBlc,GAAW,OAAO,eAAe30C,EAAM,OAAO,SAAU,CAAE,WAAY,GAAM,aAAc,GAAM,SAAU,GAAM,MAAO20C,CAAS,CAAE,CACzI,KAEDxzC,EARGnB,EAQI,mBAAmB,CACtB,kBACA,UACA,MACA,SACA,OACZ,GACQmB,EAfGnB,EAeI,qBAAqB,CAExB,iCACA,+BACA,4CAEA,mCAEA,qCACA,iCACA,+BACZ,GA1BWA,CAuOX,GAAC","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101]}